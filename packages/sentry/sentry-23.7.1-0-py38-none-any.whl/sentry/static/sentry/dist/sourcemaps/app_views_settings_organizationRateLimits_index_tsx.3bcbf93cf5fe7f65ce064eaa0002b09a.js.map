{"version":3,"file":"chunks/app_views_settings_organizationRateLimits_index_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/panels/panelHeader.tsx","webpack:///./app/views/settings/organizationRateLimits/organizationRateLimits.tsx","webpack:///./app/views/settings/organizationRateLimits/index.tsx"],"sourcesContent":["import {css} from '@emotion/react';\nimport styled from '@emotion/styled';\n\nimport {space} from 'sentry/styles/space';\n\ntype Props = {\n  /**\n   * Do not add padding to left and right of the header\n   */\n  disablePadding?: boolean;\n  /**\n   * Usually we place controls at the right of a panel header, to make the\n   * spacing between the edges correct we will want less padding on the right.\n   * Use this when the panel has something such as buttons living there.\n   */\n  hasButtons?: boolean;\n  /**\n   * Use light text\n   */\n  lightText?: boolean;\n};\n\nconst getPadding = ({disablePadding, hasButtons}: Props) => css`\n  padding: ${hasButtons ? space(1) : space(2)} ${disablePadding ? 0 : space(2)};\n`;\n\nconst PanelHeader = styled('div')<Props>`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  color: ${p => (p.lightText ? p.theme.gray300 : p.theme.gray400)};\n  font-size: ${p => p.theme.fontSizeSmall};\n  font-weight: 600;\n  text-transform: uppercase;\n  border-bottom: 1px solid ${p => p.theme.border};\n  border-radius: calc(${p => p.theme.panelBorderRadius} - 1px)\n    calc(${p => p.theme.panelBorderRadius} - 1px) 0 0;\n  background: ${p => p.theme.backgroundSecondary};\n  line-height: 1;\n  position: relative;\n  ${getPadding};\n`;\n\nexport default PanelHeader;\n","import {RouteComponentProps} from 'react-router';\n\nimport FieldGroup from 'sentry/components/forms/fieldGroup';\nimport RangeField from 'sentry/components/forms/fields/rangeField';\nimport Form from 'sentry/components/forms/form';\nimport Panel from 'sentry/components/panels/panel';\nimport PanelAlert from 'sentry/components/panels/panelAlert';\nimport PanelBody from 'sentry/components/panels/panelBody';\nimport PanelHeader from 'sentry/components/panels/panelHeader';\nimport {t, tct} from 'sentry/locale';\nimport {Organization} from 'sentry/types';\nimport SettingsPageHeader from 'sentry/views/settings/components/settingsPageHeader';\nimport TextBlock from 'sentry/views/settings/components/text/textBlock';\n\nexport type OrganizationRateLimitProps = RouteComponentProps<{}, {}> & {\n  organization: Organization;\n};\n\nconst getRateLimitValues = () => {\n  const steps: number[] = [];\n  let i = 0;\n  while (i <= 1_000_000) {\n    steps.push(i);\n    if (i < 10_000) {\n      i += 1_000;\n    } else if (i < 100_000) {\n      i += 10_000;\n    } else {\n      i += 100_000;\n    }\n  }\n  return steps;\n};\n\n// We can just generate this once\nconst ACCOUNT_RATE_LIMIT_VALUES = getRateLimitValues();\n\nfunction OrganizationRateLimit({organization}: OrganizationRateLimitProps) {\n  // TODO(billy): Update organization.quota in organizationStore with new values\n\n  const {quota} = organization;\n  const {maxRate, maxRateInterval, projectLimit, accountLimit} = quota;\n  const initialData = {\n    projectRateLimit: projectLimit || 100,\n    accountRateLimit: accountLimit,\n  };\n\n  return (\n    <div>\n      <SettingsPageHeader title={t('Rate Limits')} />\n\n      <Panel>\n        <PanelHeader>{t('Adjust Limits')}</PanelHeader>\n        <PanelBody>\n          <PanelAlert type=\"info\">\n            {t(`Rate limits allow you to control how much data is stored for this\n                organization. When a rate is exceeded the system will begin discarding\n                data until the next interval.`)}\n          </PanelAlert>\n\n          <Form\n            data-test-id=\"rate-limit-editor\"\n            saveOnBlur\n            allowUndo\n            apiMethod=\"PUT\"\n            apiEndpoint={`/organizations/${organization.slug}/`}\n            initialData={initialData}\n          >\n            {!maxRate ? (\n              <RangeField\n                name=\"accountRateLimit\"\n                label={t('Account Limit')}\n                min={0}\n                max={1000000}\n                allowedValues={ACCOUNT_RATE_LIMIT_VALUES}\n                help={t(\n                  'The maximum number of events to accept across this entire organization.'\n                )}\n                placeholder=\"e.g. 500\"\n                formatLabel={value =>\n                  !value\n                    ? t('No Limit')\n                    : tct('[number] per hour', {\n                        number: value.toLocaleString(),\n                      })\n                }\n              />\n            ) : (\n              <FieldGroup\n                label={t('Account Limit')}\n                help={t(\n                  'The maximum number of events to accept across this entire organization.'\n                )}\n              >\n                <TextBlock css={{marginBottom: 0}}>\n                  {tct(\n                    'Your account is limited to a maximum of [maxRate] events per [maxRateInterval] seconds.',\n                    {\n                      maxRate,\n                      maxRateInterval,\n                    }\n                  )}\n                </TextBlock>\n              </FieldGroup>\n            )}\n            <RangeField\n              name=\"projectRateLimit\"\n              label={t('Per-Project Limit')}\n              help={t(\n                'The maximum percentage of the account limit (set above) that an individual project can consume.'\n              )}\n              step={5}\n              min={50}\n              max={100}\n              formatLabel={value =>\n                value !== 100 ? `${value}%` : t('No Limit \\u2014 100%')\n              }\n            />\n          </Form>\n        </PanelBody>\n      </Panel>\n    </div>\n  );\n}\n\nexport default OrganizationRateLimit;\n","import withOrganization from 'sentry/utils/withOrganization';\n\nimport OrganizationRateLimits from './organizationRateLimits';\n\nfunction OrganizationRateLimitsContainer(\n  props: React.ComponentProps<typeof OrganizationRateLimits>\n) {\n  return !props.organization ? null : <OrganizationRateLimits {...props} />;\n}\n\nexport default withOrganization(OrganizationRateLimitsContainer);\n"],"names":["getPadding","_ref","disablePadding","hasButtons","css","space","_styled","target","p","lightText","theme","gray300","gray400","fontSizeSmall","border","panelBorderRadius","backgroundSecondary","ACCOUNT_RATE_LIMIT_VALUES","getRateLimitValues","steps","i","push","_ref2","name","styles","OrganizationRateLimit","organization","quota","maxRate","maxRateInterval","projectLimit","accountLimit","initialData","projectRateLimit","accountRateLimit","_jsxs","children","_jsx","SettingsPageHeader","title","t","Panel","PanelHeader","PanelBody","PanelAlert","type","Form","saveOnBlur","allowUndo","apiMethod","apiEndpoint","slug","FieldGroup","label","help","TextBlock","tct","RangeField","min","max","allowedValues","placeholder","formatLabel","value","number","toLocaleString","step","displayName","withOrganization","props","OrganizationRateLimits"],"sourceRoot":""}