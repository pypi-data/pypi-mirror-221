{"version":3,"file":"chunks/app_components_modals_recoveryOptionsModal_tsx-app_utils_getRouteStringFromRoutes_tsx-app_uti-2f718b.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/modals/recoveryOptionsModal.tsx","webpack:///./app/utils/getRouteStringFromRoutes.tsx","webpack:///./app/utils/withProject.tsx","webpack:///./app/views/settings/components/text/textBlock.tsx","webpack:///../node_modules/lodash/findLastIndex.js"],"sourcesContent":["import {Fragment} from 'react';\n\nimport {ModalRenderProps} from 'sentry/actionCreators/modal';\nimport {Alert} from 'sentry/components/alert';\nimport {Button} from 'sentry/components/button';\nimport DeprecatedAsyncComponent from 'sentry/components/deprecatedAsyncComponent';\nimport {t} from 'sentry/locale';\nimport {space} from 'sentry/styles/space';\nimport {Authenticator} from 'sentry/types';\nimport TextBlock from 'sentry/views/settings/components/text/textBlock';\n\ntype Props = DeprecatedAsyncComponent['props'] &\n  ModalRenderProps & {\n    authenticatorName: string;\n  };\n\ntype State = DeprecatedAsyncComponent['state'] & {\n  authenticators: Authenticator[] | null;\n  skipSms: boolean;\n};\n\nclass RecoveryOptionsModal extends DeprecatedAsyncComponent<Props, State> {\n  getDefaultState() {\n    return {...super.getDefaultState(), skipSms: false};\n  }\n\n  getEndpoints(): ReturnType<DeprecatedAsyncComponent['getEndpoints']> {\n    return [['authenticators', '/users/me/authenticators/']];\n  }\n\n  handleSkipSms = () => {\n    this.setState({skipSms: true});\n  };\n\n  renderBody() {\n    const {authenticatorName, closeModal, Body, Header, Footer} = this.props;\n    const {authenticators, skipSms} = this.state;\n\n    const {recovery, sms} = authenticators!.reduce<{[key: string]: Authenticator}>(\n      (obj, item) => {\n        obj[item.id] = item;\n        return obj;\n      },\n      {}\n    );\n    const recoveryEnrolled = recovery && recovery.isEnrolled;\n    const displaySmsPrompt =\n      sms && !sms.isEnrolled && !skipSms && !sms.disallowNewEnrollment;\n\n    return (\n      <Fragment>\n        <Header closeButton>{t('Two-Factor Authentication Enabled')}</Header>\n\n        <Body>\n          <TextBlock>\n            {t('Two-factor authentication via %s has been enabled.', authenticatorName)}\n          </TextBlock>\n          <TextBlock>\n            {t('You should now set up recovery options to secure your account.')}\n          </TextBlock>\n\n          {displaySmsPrompt ? (\n            // set up backup phone number\n            <Alert type=\"warning\">\n              {t('We recommend adding a phone number as a backup 2FA method.')}\n            </Alert>\n          ) : (\n            // get recovery codes\n            <Alert type=\"warning\">\n              {t(\n                `Recovery codes are the only way to access your account if you lose\n                  your device and cannot receive two-factor authentication codes.`\n              )}\n            </Alert>\n          )}\n        </Body>\n\n        {displaySmsPrompt ? (\n          // set up backup phone number\n          <Footer>\n            <Button onClick={this.handleSkipSms} name=\"skipStep\" autoFocus>\n              {t('Skip this step')}\n            </Button>\n            <Button\n              priority=\"primary\"\n              onClick={closeModal}\n              to={`/settings/account/security/mfa/${sms.id}/enroll/`}\n              name=\"addPhone\"\n              css={{marginLeft: space(1)}}\n              autoFocus\n            >\n              {t('Add a Phone Number')}\n            </Button>\n          </Footer>\n        ) : (\n          // get recovery codes\n          <Footer>\n            <Button\n              priority=\"primary\"\n              onClick={closeModal}\n              to={\n                recoveryEnrolled\n                  ? `/settings/account/security/mfa/${recovery.authId}/`\n                  : '/settings/account/security/'\n              }\n              name=\"getCodes\"\n              autoFocus\n            >\n              {t('Get Recovery Codes')}\n            </Button>\n          </Footer>\n        )}\n      </Fragment>\n    );\n  }\n}\n\nexport default RecoveryOptionsModal;\n","import {PlainRoute} from 'react-router';\nimport findLastIndex from 'lodash/findLastIndex';\n\ntype RouteWithPath = Omit<PlainRoute, 'path'> & Required<Pick<PlainRoute, 'path'>>;\n\n/**\n * Creates a route string from an array of `routes` from react-router\n *\n * It will look for the last route path that begins with a `/` and\n * concatenate all of the following routes. Skips any routes without a path\n *\n * @param {Array<{}>} routes An array of route objects from react-router\n * @return String Returns a route path\n */\nexport default function getRouteStringFromRoutes(routes?: PlainRoute[]): string {\n  if (!Array.isArray(routes)) {\n    return '';\n  }\n\n  const routesWithPaths = routes.filter((route): route is RouteWithPath => !!route.path);\n\n  const lastAbsolutePathIndex = findLastIndex(routesWithPaths, ({path}) =>\n    path.startsWith('/')\n  );\n\n  return routesWithPaths\n    .slice(lastAbsolutePathIndex)\n    .filter(({path}) => !!path)\n    .map(({path}) => path)\n    .join('');\n}\n","import {Component} from 'react';\n\nimport SentryTypes from 'sentry/sentryTypes';\nimport {Project} from 'sentry/types';\nimport getDisplayName from 'sentry/utils/getDisplayName';\n\ntype InjectedProjectProps = {\n  project?: Project;\n};\n\n/**\n * Currently wraps component with project from context\n */\nconst withProject = <P extends InjectedProjectProps>(\n  WrappedComponent: React.ComponentType<P>\n) =>\n  class extends Component<\n    Omit<P, keyof InjectedProjectProps> & Partial<InjectedProjectProps>\n  > {\n    static displayName = `withProject(${getDisplayName(WrappedComponent)})`;\n    static contextTypes = {\n      project: SentryTypes.Project,\n    };\n\n    render() {\n      const {project, ...props} = this.props;\n      return (\n        <WrappedComponent\n          {...({project: project ?? this.context.project, ...props} as P)}\n        />\n      );\n    }\n  };\n\nexport default withProject;\n","import styled from '@emotion/styled';\n\nimport {space} from 'sentry/styles/space';\n\ntype Props = {\n  noMargin?: boolean;\n};\n\nconst TextBlock = styled('div')<Props>`\n  line-height: 1.5;\n  ${p => (p.noMargin ? '' : 'margin-bottom:' + space(3))};\n`;\n\nexport default TextBlock;\n","var baseFindIndex = require('./_baseFindIndex'),\n    baseIteratee = require('./_baseIteratee'),\n    toInteger = require('./toInteger');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * This method is like `_.findIndex` except that it iterates over elements\n * of `collection` from right to left.\n *\n * @static\n * @memberOf _\n * @since 2.0.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @param {number} [fromIndex=array.length-1] The index to search from.\n * @returns {number} Returns the index of the found element, else `-1`.\n * @example\n *\n * var users = [\n *   { 'user': 'barney',  'active': true },\n *   { 'user': 'fred',    'active': false },\n *   { 'user': 'pebbles', 'active': false }\n * ];\n *\n * _.findLastIndex(users, function(o) { return o.user == 'pebbles'; });\n * // => 2\n *\n * // The `_.matches` iteratee shorthand.\n * _.findLastIndex(users, { 'user': 'barney', 'active': true });\n * // => 0\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.findLastIndex(users, ['active', false]);\n * // => 2\n *\n * // The `_.property` iteratee shorthand.\n * _.findLastIndex(users, 'active');\n * // => 0\n */\nfunction findLastIndex(array, predicate, fromIndex) {\n  var length = array == null ? 0 : array.length;\n  if (!length) {\n    return -1;\n  }\n  var index = length - 1;\n  if (fromIndex !== undefined) {\n    index = toInteger(fromIndex);\n    index = fromIndex < 0\n      ? nativeMax(length + index, 0)\n      : nativeMin(index, length - 1);\n  }\n  return baseFindIndex(array, baseIteratee(predicate, 3), index, true);\n}\n\nmodule.exports = findLastIndex;\n"],"names":["RecoveryOptionsModal","DeprecatedAsyncComponent","constructor","arguments","_defineProperty","this","setState","skipSms","getDefaultState","super","getEndpoints","renderBody","authenticatorName","closeModal","Body","Header","Footer","props","authenticators","state","recovery","sms","reduce","obj","item","id","recoveryEnrolled","isEnrolled","displaySmsPrompt","disallowNewEnrollment","_jsxs","Fragment","children","_jsx","closeButton","t","TextBlock","Alert","type","Button","onClick","handleSkipSms","name","autoFocus","priority","to","css","_css","marginLeft","space","authId","getRouteStringFromRoutes","routes","Array","isArray","routesWithPaths","filter","route","path","lastAbsolutePathIndex","findLastIndex","_ref","startsWith","slice","_ref2","map","_ref3","join","WrappedComponent","_class","Component","render","project","context","getDisplayName","SentryTypes","Project","_styled","target","p","noMargin","baseFindIndex","baseIteratee","toInteger","nativeMax","Math","max","nativeMin","min","module","exports","array","predicate","fromIndex","length","index","undefined"],"sourceRoot":""}