{"version":3,"file":"chunks/app_views_newsletterConsent_index_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/forms/apiForm.tsx","webpack:///./app/components/forms/fields/radioField.tsx","webpack:///./app/components/narrowLayout.tsx","webpack:///./app/views/newsletterConsent/index.tsx"],"sourcesContent":["import {useCallback} from 'react';\n\nimport {addLoadingMessage, clearIndicators} from 'sentry/actionCreators/indicator';\nimport Form, {FormProps} from 'sentry/components/forms/form';\nimport {t} from 'sentry/locale';\nimport useApi from 'sentry/utils/useApi';\n\ntype Props = FormProps & {\n  apiEndpoint: string;\n  apiMethod: string;\n  onSubmit?: (data: Record<string, any>) => any | void;\n};\n\nfunction ApiForm({onSubmit, apiMethod, apiEndpoint, ...otherProps}: Props) {\n  const api = useApi();\n\n  const handleSubmit = useCallback(\n    (\n      data: Record<string, any>,\n      onSuccess: (response: Record<string, any>) => void,\n      onError: (error: any) => void\n    ) => {\n      const transformed = onSubmit?.(data);\n      addLoadingMessage(t('Saving changes\\u2026'));\n      api.request(apiEndpoint, {\n        method: apiMethod,\n        data: transformed ?? data,\n        success: response => {\n          clearIndicators();\n          onSuccess(response);\n        },\n        error: error => {\n          clearIndicators();\n          onError(error);\n        },\n      });\n    },\n    [api, onSubmit, apiMethod, apiEndpoint]\n  );\n\n  return <Form onSubmit={handleSubmit} {...otherProps} />;\n}\n\nexport default ApiForm;\n","import RadioGroup, {RadioGroupProps} from 'sentry/components/forms/controls/radioGroup';\nimport FormField from 'sentry/components/forms/formField';\n\n// XXX(epurkhiser): This is wrong, it should not be inheriting these props\nimport {InputFieldProps, OnEvent} from './inputField';\n\nexport interface RadioFieldProps extends Omit<InputFieldProps, 'type'> {\n  choices?: RadioGroupProps<any>['choices'];\n  orientInline?: RadioGroupProps<any>['orientInline'];\n}\n\nfunction handleChange(\n  id: string,\n  onChange: OnEvent,\n  onBlur: OnEvent,\n  e: React.FormEvent<HTMLInputElement>\n) {\n  onChange(id, e);\n  onBlur(id, e);\n}\n\nfunction RadioField(props: RadioFieldProps) {\n  return (\n    <FormField {...props}>\n      {({id, onChange, onBlur, value, disabled, orientInline, ...fieldProps}) => (\n        // XXX: The label must be present on the role=\"radiogroup\" element. The\n        // `htmlFor` attribute on the Field label does NOT link to the group.\n        <RadioGroup\n          id={id}\n          choices={fieldProps.choices}\n          disabled={disabled}\n          orientInline={orientInline}\n          label={fieldProps.label}\n          value={value === '' ? null : value}\n          onChange={(v, e) => handleChange(v, onChange, onBlur, e)}\n        />\n      )}\n    </FormField>\n  );\n}\n\nexport default RadioField;\n","import {useEffect} from 'react';\nimport styled from '@emotion/styled';\n\nimport {logout} from 'sentry/actionCreators/account';\nimport {IconSentry} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport useApi from 'sentry/utils/useApi';\n\ntype Props = {\n  children: React.ReactNode;\n  maxWidth?: string;\n  showLogout?: boolean;\n};\n\nfunction NarrowLayout({maxWidth, showLogout, children}: Props) {\n  const api = useApi();\n\n  useEffect(() => {\n    document.body.classList.add('narrow');\n\n    return () => document.body.classList.remove('narrow');\n  }, []);\n\n  async function handleLogout() {\n    await logout(api);\n    window.location.assign('/auth/login');\n  }\n\n  return (\n    <div className=\"app\">\n      <div className=\"pattern-bg\" />\n      <div className=\"container\" style={{maxWidth}}>\n        <div className=\"box box-modal\">\n          <div className=\"box-header\">\n            <a href=\"/\">\n              <IconSentry size=\"lg\" />\n            </a>\n            {showLogout && (\n              <a className=\"logout pull-right\" onClick={handleLogout}>\n                <Logout>{t('Sign out')}</Logout>\n              </a>\n            )}\n          </div>\n          <div className=\"box-content with-padding\">{children}</div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nconst Logout = styled('span')`\n  font-size: ${p => p.theme.fontSizeLarge};\n`;\n\nexport default NarrowLayout;\n","import {useEffect} from 'react';\n\nimport ApiForm from 'sentry/components/forms/apiForm';\nimport FieldWrapper from 'sentry/components/forms/fieldGroup/fieldWrapper';\nimport RadioField from 'sentry/components/forms/fields/radioField';\nimport ExternalLink from 'sentry/components/links/externalLink';\nimport NarrowLayout from 'sentry/components/narrowLayout';\nimport {t, tct} from 'sentry/locale';\n\ntype Props = {\n  onSubmitSuccess?: () => void;\n};\n\nfunction NewsletterConsent({onSubmitSuccess}: Props) {\n  useEffect(() => {\n    document.body.classList.add('auth');\n\n    return () => document.body.classList.remove('auth');\n  }, []);\n\n  // NOTE: the text here is duplicated within ``RegisterForm`` on the backend\n  return (\n    <NarrowLayout>\n      <ApiForm\n        apiMethod=\"POST\"\n        apiEndpoint=\"/users/me/subscriptions/\"\n        onSubmitSuccess={onSubmitSuccess}\n        submitLabel={t('Continue')}\n      >\n        <FieldWrapper stacked={false} hasControlState={false}>\n          {t('Pardon the interruption, we just need to get a quick answer from you.')}\n        </FieldWrapper>\n        <RadioField\n          name=\"subscribed\"\n          choices={[\n            ['true', t('Yes, I would like to receive updates via email')],\n            ['false', t(\"No, I'd prefer not to receive these updates\")],\n          ]}\n          label={t('Email Updates')}\n          required\n          inline={false}\n          help={tct(\n            `We'd love to keep you updated via email with product and feature\n               announcements, promotions, educational materials, and events. Our updates\n               focus on relevant information, and we'll never sell your data to third\n               parties. See our [link:Privacy Policy] for more details.\n               `,\n            {link: <ExternalLink href=\"https://sentry.io/privacy/\" />}\n          )}\n        />\n      </ApiForm>\n    </NarrowLayout>\n  );\n}\n\nexport default NewsletterConsent;\n"],"names":["ApiForm","_ref","onSubmit","apiMethod","apiEndpoint","otherProps","api","useApi","handleSubmit","useCallback","data","onSuccess","onError","transformed","addLoadingMessage","t","request","method","success","response","clearIndicators","error","_jsx","Form","displayName","RadioField","props","FormField","children","id","onChange","onBlur","value","disabled","orientInline","fieldProps","RadioGroup","choices","label","v","e","handleChange","NarrowLayout","maxWidth","showLogout","useEffect","document","body","classList","add","remove","_jsxs","className","style","href","IconSentry","size","onClick","async","logout","window","location","assign","Logout","_styled","target","p","theme","fontSizeLarge","NewsletterConsent","onSubmitSuccess","submitLabel","FieldWrapper","stacked","hasControlState","name","required","inline","help","tct","link","ExternalLink"],"sourceRoot":""}