{"version":3,"file":"chunks/app_views_sentryAppExternalInstallation_index_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"2RAiBO,SAASA,EACdC,EACAC,EACAC,IAEAC,EAAAA,EAAAA,MACA,MAAMC,EAAUJ,EAAOK,eACpB,kBAAiBJ,8BAClB,CACEK,OAAQ,OACRC,KAAM,CAACC,KAAMN,EAAIM,QAOrB,OAJAJ,EAAQK,MACN,KAAMC,EAAAA,EAAAA,QACN,KAAMC,EAAAA,EAAAA,KAAgBC,EAAAA,EAAAA,GAAE,uBAAwBV,EAAIW,SAE/CT,CACT,CAQO,SAASU,EACdd,EACAe,IAEAZ,EAAAA,EAAAA,MACA,MAAMC,EAAUJ,EAAOK,eAAgB,6BAA4BU,EAAQC,QAAS,CAClFV,OAAQ,WAEJW,EACJF,EAAQb,IAAIM,KAAKU,OAAO,GAAGC,cAAgBJ,EAAQb,IAAIM,KAAKY,MAAM,GAOpE,OANAhB,EAAQK,MACN,MACEY,EAAAA,EAAAA,KAAkBT,EAAAA,EAAAA,GAAE,+BAAgCK,GAAoB,IAE1E,KAAMP,EAAAA,EAAAA,QAEDN,CACT,C,uaC9CA,SAASkB,EAAYC,GAA0C,IAAzC,SAACC,EAAQ,WAAEC,EAAU,SAAEC,GAAgBH,EAC3D,MAAMI,GAAMC,EAAAA,EAAAA,KAaZ,OAXAC,EAAAA,EAAAA,YAAU,KACRC,SAASC,KAAKC,UAAUC,IAAI,UAErB,IAAMH,SAASC,KAAKC,UAAUE,OAAO,YAC3C,KAQDC,EAAAA,EAAAA,IAAA,OAAKC,UAAU,MAAKV,SAAA,EAClBW,EAAAA,EAAAA,IAAA,OAAKD,UAAU,gBACfC,EAAAA,EAAAA,IAAA,OAAKD,UAAU,YAAYE,MAAO,CAACd,YAAUE,UAC3CS,EAAAA,EAAAA,IAAA,OAAKC,UAAU,gBAAeV,SAAA,EAC5BS,EAAAA,EAAAA,IAAA,OAAKC,UAAU,aAAYV,SAAA,EACzBW,EAAAA,EAAAA,IAAA,KAAGE,KAAK,IAAGb,UACTW,EAAAA,EAAAA,IAACG,EAAAA,GAAU,CAACC,KAAK,SAElBhB,IACCY,EAAAA,EAAAA,IAAA,KAAGD,UAAU,oBAAoBM,QAf7CC,uBACQC,EAAAA,EAAAA,IAAOjB,GACbkB,OAAOC,SAASC,OAAO,cACzB,EAYmErB,UACrDW,EAAAA,EAAAA,IAACW,EAAM,CAAAtB,UAAEd,EAAAA,EAAAA,GAAE,oBAIjByB,EAAAA,EAAAA,IAAA,OAAKD,UAAU,2BAA0BV,SAAEA,WAKrD,CAlCSJ,EAAY2B,YAAA,eAoCrB,MAAMD,GAASE,EAAAA,EAAAA,GAAO,OAAM,CAAAC,OAAA,YAAbD,CAAc,cACdE,GAAKA,EAAEC,MAAMC,eAAa,KAGzC,G,sOC9CA,SAASC,EAAahC,GAA2B,IAA1B,UAACiC,EAAS,KAAEf,GAAYlB,EAC7C,OAAOc,EAAAA,EAAAA,IAACoB,EAAAA,EAAe,CAACD,UAAWA,EAAWf,KAAMA,EAAMiB,SAAO,GACnE,CAFSH,EAAaN,YAAA,gBAItB,S,+OCNA,MAAMU,EAAoB,CACxBC,KAAM,EACNC,MAAO,EACPC,MAAO,GAGHC,EAAuB,CAC3BC,QAAS,UACTC,KAAM,OACNC,QAAS,UACTC,MAAO,QACPC,IAAK,eACLC,OAAQ,UAGJC,EAA4C,CAChDC,QAAS,YACTC,KAAM,YACNC,QAAS,YACTC,MAAO,YACPC,aAAc,YACdC,OAAQ,aAGJC,EAAmB,mBAWnBC,EAAmBC,IACvB,MAAMC,EAAaD,EAAME,MAAM,KAAK,GACpC,OAAOtB,EAAkBqB,EAAW,EAGhCE,EAAgBA,CAACC,EAAWC,IAAcN,EAAgBK,GAAKL,EAAgBM,GAkCrF,SAASC,EAAsBC,GAC7B,MAAMC,EAAc,IAAIjB,GACxB,IAAIkB,EAAiB,IAAIF,GAxB3B,IAAmBG,EAwCjB,OAZIH,EAAOI,SAASb,KAClBU,EAAYd,QAAU,QACtBe,EAAiBF,EAAOK,QAAQZ,GAAkBA,IAAUF,MA9B7CY,EAiCPD,EAhCHI,OAAOC,OAAOC,IAAQL,GAAWV,GAASA,EAAME,MAAM,KAAK,MAC/Dc,KAAIT,GAAUA,EAAOU,KAAKd,KAC1Ba,KAAIT,GAAUA,EAAOW,SA8BEC,SAASnB,IACjC,GAAIA,EAAO,CACT,MAAOoB,EAAUnB,GAAcD,EAAME,MAAM,KAC3CM,EAAYxB,EAAqBoC,IAAanB,CAChD,KAGKO,CACT,CAmBA,SAASa,EAAcd,GACrB,MACMe,EAAsBhB,EAAsBC,GAIlD,MAAO,CALqB1B,KAAM,GAAIC,MAAO,GAAIC,MAAO,MAIpCwC,IAAKC,IAASF,GAAsB,CAAC,OAAQ,QAAS,UAE5E,C,yRChHe,MAAMG,UAGXC,EAAAA,EACRC,WACE,MAAO,EACT,CAEAC,SACE,OACEtE,EAAAA,EAAAA,IAACuE,EAAAA,EAAmB,CAACC,MAAOC,KAAKJ,WAAWhF,SACzCoF,KAAKC,mBAGZ,EAdmBP,EAAmBvD,YAAA,qB,krCCqBzB,MAAM+D,UAA8BP,EAAAA,EAIjDQ,mBAAmBC,GAEbJ,KAAKK,MAAMC,aAAaC,KAAOH,EAAUE,aAAaC,IACxDP,KAAKQ,aAET,CAEAC,oBACEC,MAAMD,oBACNT,KAAKQ,aACP,CAEAA,cACE,MAAM,UAAC9D,EAAS,aAAE4D,EAAY,YAAEK,GAAeX,KAAKK,OACpDO,EAAAA,EAAAA,GAAkBlE,EAAUhD,KAAM,sBAElCmH,EAAAA,EAAAA,IACE,oCACA,CACEC,iBAAkB,aAClBC,YAAarE,EAAUhD,KACvBsH,kBAAmBL,EACnBM,KAAM,mBACNC,mBAAoBxE,EAAUyE,OAC9Bb,gBAEF,CAACc,cAAc,GAEnB,CAEAC,eACE,MAAM,UAAC3E,GAAasD,KAAKK,MACzB,MAAO,CAAC,CAAC,cAAgB,gBAAe3D,EAAUhD,kBACpD,CAEA4H,YAAYC,GACV,OAAOA,EAAStC,KAAIuC,IAClB,MAAMC,EAAOD,EAAQE,YAAYC,QAAQ,gBAAiB,IAC1D,OAAOpG,EAAAA,EAAAA,IAACqG,EAAS,CAAAhH,SAAa6G,EAAKE,QAAQ,KAAM,MAA1BF,EAA2C,GAEtE,CAEIhD,kBACF,OAAOa,EAAAA,EAAAA,GAAcU,KAAKK,MAAM3D,UAAU8B,OAC5C,CAEA3C,kBACE,MAAM,UAACgG,GAAa7B,KAAKK,MAGzB,UACQwB,GACR,CAAE,MAAOC,GACP,CAEJ,CAEAC,oBACE,MAAMtD,EAAcuB,KAAKvB,YACzB,OACqF,IAAnFK,OAAOkD,KAAKvD,GAAaI,QAAOZ,GAASQ,EAAYR,GAAOgE,OAAS,IAAGA,OAEjE,MAIP5G,EAAAA,EAAAA,IAAC6G,EAAAA,SAAQ,CAAAtH,SAAA,EACPW,EAAAA,EAAAA,IAAC4G,EAAK,CAAAvH,SAAC,gBACN6D,EAAY3B,KAAKmF,OAAS,IACzB5G,EAAAA,EAAAA,IAAC+G,EAAU,CAAAxH,SAAA,EACTW,EAAAA,EAAAA,IAAC8G,EAAS,KACV9G,EAAAA,EAAAA,IAAC+G,EAAI,CAAA1H,UACF2H,EAAAA,EAAAA,IAAI,yCAA0C,CAC7CzF,MAAMvB,EAAAA,EAAAA,IAAA,UAAAX,SAAQ,SACd4H,UAAW/D,EAAY3B,KAAK2F,KAAK,SAH3B,WAQbhE,EAAY1B,MAAMkF,OAAS,IAC1B5G,EAAAA,EAAAA,IAAC+G,EAAU,CAAAxH,SAAA,EACTW,EAAAA,EAAAA,IAAC8G,EAAS,KACV9G,EAAAA,EAAAA,IAAC+G,EAAI,CAAA1H,UACF2H,EAAAA,EAAAA,IAAI,qDAAsD,CACzDzF,MAAMvB,EAAAA,EAAAA,IAAA,UAAAX,SAAQ,SACdmC,OAAOxB,EAAAA,EAAAA,IAAA,UAAAX,SAAQ,UACf4H,UAAW/D,EAAY1B,MAAM0F,KAAK,SAJ5B,YASbhE,EAAYzB,MAAMiF,OAAS,IAC1B5G,EAAAA,EAAAA,IAAC+G,EAAU,CAAAxH,SAAA,EACTW,EAAAA,EAAAA,IAAC8G,EAAS,KACV9G,EAAAA,EAAAA,IAAC+G,EAAI,CAAA1H,UACF2H,EAAAA,EAAAA,IAAI,0CAA2C,CAC9CvF,OAAOzB,EAAAA,EAAAA,IAAA,UAAAX,SAAQ,UACf4H,UAAW/D,EAAYzB,MAAMyF,KAAK,SAH5B,cAUpB,CAEAC,aACE,MAAM,UAAChG,EAAS,WAAEiG,EAAU,YAAEhC,EAAW,aAAEL,GAAgBN,KAAKK,OAC1D,YAACuC,GAAe5C,KAAK6C,MAErBtB,GAAYqB,GAAe,IAAI3D,KAAI6D,IAAK,CAC5CpB,YAAaoB,EAAEpB,YACfqB,aACExH,EAAAA,EAAAA,IAAA,QAAMyH,wBAAyB,CAACC,QAAQC,EAAAA,EAAAA,GAAmBJ,EAAEC,qBAI3D,YAACI,EAAW,oBAAEC,IAAuBC,EAAAA,EAAAA,MAErCC,EAAW5G,EAAU4G,UAAY,GACjCC,EAAe,CAACjD,eAAciB,YAEpC,OACElG,EAAAA,EAAAA,IAAC6G,EAAAA,SAAQ,CAAAtH,SAAA,EACPS,EAAAA,EAAAA,IAACmI,EAAO,CAAA5I,SAAA,EACNW,EAAAA,EAAAA,IAACkB,EAAAA,EAAa,CAACC,UAAWA,EAAWf,KAAM,MAC3CN,EAAAA,EAAAA,IAACoI,EAAW,CAAA7I,SAAA,EACVW,EAAAA,EAAAA,IAACmI,EAAI,CAAA9I,SAAE8B,EAAU3C,SACdwH,EAASU,SAAU1G,EAAAA,EAAAA,IAACoI,EAAQ,CAAA/I,SAAEoF,KAAKsB,YAAYC,YAGtDhG,EAAAA,EAAAA,IAACqI,EAAW,CAACZ,wBAAyB,CAACC,QAAQY,EAAAA,EAAAA,GAAOP,OACtD/H,EAAAA,EAAAA,IAAC4H,EAAW,IAAKI,EAAcO,SAAU,IAAIpH,EAAWqH,IAAKrH,EAAUhD,SACvE6B,EAAAA,EAAAA,IAAC6H,EAAmB,IAAKG,EAAY3I,SAClCH,IAAA,IAAC,SAACuJ,EAAQ,eAAEC,GAAexJ,EAAA,OAC1BY,EAAAA,EAAAA,IAAC6G,EAAAA,SAAQ,CAAAtH,SAAA,EACLoJ,GAAYhE,KAAK+B,qBACnB1G,EAAAA,EAAAA,IAAC6I,EAAM,CAAAtJ,SAAA,EACLW,EAAAA,EAAAA,IAAC4I,EAAM,CAAAvJ,UAAEd,EAAAA,EAAAA,GAAE,iBAAkB4C,EAAU0H,WACvC/I,EAAAA,EAAAA,IAAA,OAAAT,SAAA,CACGoJ,IAAYzI,EAAAA,EAAAA,IAAC8I,EAAc,CAACC,OAAQL,KACrC1I,EAAAA,EAAAA,IAACgJ,EAAAA,GAAM,CAAC5I,KAAK,KAAKC,QAAS+G,EAAW/H,UACnCd,EAAAA,EAAAA,GAAE,aAGLyB,EAAAA,EAAAA,IAACiJ,EAAAA,EAAM,CAACC,OAAQ,CAAC,oBAAqBnE,aAAcA,EAAa1F,SAC9D8J,IAAA,IAAC,UAACC,GAAUD,EAAA,OACXC,IACEpJ,EAAAA,EAAAA,IAACgJ,EAAAA,GAAM,CACL5I,KAAK,KACLiJ,SAAS,UACTZ,SAAUrD,GAAeqD,EACzBpI,QAASA,IAAMoE,KAAK6B,YACpBrG,MAAO,CAACqJ,YAAYC,EAAAA,EAAAA,GAAM,IAC1B,eAAa,UAASlK,UAErBd,EAAAA,EAAAA,GAAE,qBAEN,YAKA,MAKrB,EAGF,MAAM0J,GAAUpH,EAAAA,EAAAA,GAAO,MAAK,CAAAC,OAAA,cAAZD,CAAa,2DAGpB0I,EAAAA,EAAAA,GAAM,GAAE,sCAEEA,EAAAA,EAAAA,GAAM,GAAE,KAGrBrB,GAAcrH,EAAAA,EAAAA,GAAO,MAAK,CAAAC,OAAA,cAAZD,CAAa,CAAArC,KAAA,SAAAgL,OAAA,8EAM3BrB,GAAOtH,EAAAA,EAAAA,GAAO,MAAK,CAAAC,OAAA,cAAZD,CAAa,CAAArC,KAAA,UAAAgL,OAAA,qCAKpBnB,GAAcxH,EAAAA,EAAAA,GAAO,MAAK,CAAAC,OAAA,aAAZD,CAAa,kBACd0I,EAAAA,EAAAA,GAAM,GAAE,2BAOrBX,GAAS/H,EAAAA,EAAAA,GAAO,MAAK,CAAAC,OAAA,aAAZD,CAAa,UACjBE,GAAKA,EAAEC,MAAMyI,SAAO,KAGzBX,GAAiBjI,EAAAA,EAAAA,IAAO6I,IAAA,IAAC,OAACX,KAAWhI,GAA6B2I,EAAA,OACtE5J,EAAAA,EAAAA,IAAA,UAASiB,EAAC1B,SAAA,EACRW,EAAAA,EAAAA,IAAC2J,EAAAA,GAAQ,CAACC,MAAM,YAAYxJ,KAAK,OAChC2I,IACG,GACP,CAAAjI,OAAA,aALsBD,CAKrB,uFAKSE,GAAKA,EAAEC,MAAM6I,WAAS,qBAI3B9C,GAAOlG,EAAAA,EAAAA,GAAO,IAAG,CAAAC,OAAA,aAAVD,CAAW,CAAArC,KAAA,UAAAgL,OAAA,mBAIlB3C,GAAahG,EAAAA,EAAAA,GAAO,MAAK,CAAAC,OAAA,aAAZD,CAAa,CAAArC,KAAA,QAAAgL,OAAA,iBAI1Bb,GAAS9H,EAAAA,EAAAA,GAAO,MAAK,CAAAC,OAAA,aAAZD,CAAa,CAAArC,KAAA,UAAAgL,OAAA,sHAQtB5C,GAAQ/F,EAAAA,EAAAA,GAAO,IAAG,CAAAC,OAAA,aAAVD,CAAW,kBACN0I,EAAAA,EAAAA,GAAM,GAAE,sBAIrBzC,GAAYjG,EAAAA,EAAAA,IAAOE,IAAKf,EAAAA,EAAAA,IAAC8J,EAAAA,EAAe,CAAC1J,KAAM,KAAOW,KAAK,CAAAD,OAAA,aAA/CD,CAAgD,yBAEvDE,GAAKA,EAAEC,MAAM+I,SAAO,KAGzB3B,GAAWvH,EAAAA,EAAAA,GAAO,MAAK,CAAAC,OAAA,aAAZD,CAAa,YACjB0I,EAAAA,EAAAA,GAAM,IAAI,KAGjBlD,GAAYxF,EAAAA,EAAAA,GAAOmJ,EAAAA,EAAG,CAAAlJ,OAAA,aAAVD,CAAW,YAChB0I,EAAAA,EAAAA,GAAM,IAAI,K,6LC9PR,MAAMU,UAAsC9F,EAAAA,EAGzD+F,cAAA,SAAAC,YAAAC,EAAAA,EAAAA,GAAA,2BACqB,IAAKA,EAAAA,EAAAA,GAAA,sBACT,IAAIC,EAAAA,GAAO,CAACC,SAASC,EAAAA,EAAAA,MAA+B,aAAUH,EAAAA,EAAAA,GAAA,kBAoDlErI,GAAsBA,EAAImH,OAAO7F,SAAS,uBAAmB+G,EAAAA,EAAAA,GAAA,gBAEhE,KAER,MAAM,gBAACI,GAAmB/F,KAAK6C,MACzBmD,EAAShL,SAASiL,UAAa,aAAYF,kBACjDhK,OAAOC,SAASC,OAAO+J,EAAO,KAC/BL,EAAAA,EAAAA,GAAA,kBAEW9J,UACV,MAAM,aAACyE,EAAY,UAAE5D,GAAasD,KAAK6C,MACvC,IAAKvC,IAAiB5D,EACpB,QAEFmE,EAAAA,EAAAA,IAA0B,kCAAmC,CAC3DC,iBAAkB,aAClBC,YAAarE,EAAUhD,KACvBuH,KAAM,mBACNC,mBAAoBxE,EAAUyE,OAC9Bb,iBAGF,MAAMrG,QAAgBhB,EAAAA,EAAAA,GACpB+G,KAAKkG,eACL5F,EAAa5G,KACbgD,GAaF,GAVuB,cAAnBzC,EAAQkH,SACVN,EAAAA,EAAAA,IAA0B,qCAAsC,CAC9DC,iBAAkB,aAClBC,YAAarE,EAAUhD,KACvBuH,KAAM,mBACNC,mBAAoBxE,EAAUyE,OAC9Bb,iBAIA5D,EAAUyJ,YAAa,CACzB,MAAMC,EAAc,CAClBC,eAAgBpM,EAAQC,KACxBoM,KAAMrM,EAAQqM,KACdC,QAASjG,EAAa5G,MAElByM,GAAcK,EAAAA,EAAAA,IAA4B9J,EAAUyJ,YAAaC,GACvE,OAAOrK,OAAOC,SAASC,OAAOkK,EAChC,CACA,OAAOnG,KAAKyG,SAAS,KACtBd,EAAAA,EAAAA,GAAA,oBAEa9J,UACZmE,KAAK0G,SAAS,CAACX,gBAAiBQ,EAASI,WAAW,IAEpD,IACE,MAAOrG,EAAcsG,SACbC,QAAQC,IAAI,CAChB9G,KAAKkG,eAAe3M,eAAgB,kBAAiBgN,MACrDvG,KAAKkG,eAAe3M,eACjB,kBAAiBgN,iCAGlB5F,EAAciG,EACjB3H,KAAIhF,GAAWA,EAAQb,IAAIM,OAC3BkF,SAASoB,KAAK+G,eAEjB/G,KAAK0G,SAAS,CAACpG,eAAcK,cAAagG,WAAW,GACvD,CAAE,MAAOK,IACPnN,EAAAA,EAAAA,KAAgBC,EAAAA,EAAAA,GAAE,2DAClBkG,KAAK0G,SAAS,CAACC,WAAW,GAC5B,MACDhB,EAAAA,EAAAA,GAAA,yBAEkBlL,IAAsB,IAArB,SAACwM,EAAQ,KAAExN,GAAKgB,EAEjB,kBAAbwM,GAAgD,IAAhBxN,EAAKwI,QACvCjC,KAAKkH,YAAYzN,EAAK,GAAGC,KAC3B,GACD,CA/HDyN,kBAEE,MAAO,IADOzG,MAAMyG,kBAGlBpB,gBAAiB,KACjBzF,aAAc,KACd8G,cAAe,GACfT,WAAW,EAEf,CAEAtF,eACE,MAAO,CACL,CAAC,gBAAiB,mBAClB,CAAC,YAAc,gBAAerB,KAAK+G,kBAEvC,CAEAnH,WACE,OAAO9F,EAAAA,EAAAA,GAAE,mCACX,CAEIiN,oBACF,OAAO/G,KAAKK,MAAMgH,OAAON,aAC3B,CAEIO,kBACF,OAA2C,IAApCtH,KAAK6C,MAAMuE,cAAcnF,MAClC,CAEIsF,0BACF,MAAM,UAAC7K,GAAasD,KAAK6C,MACzB,OAAOnG,GAAkC,aAArBA,EAAUyE,MAChC,CAEIqG,mCACF,MAAM,UAAC9K,EAAS,gBAAEqJ,GAAmB/F,KAAK6C,MAE1C,OACEkD,GACArJ,GAAW+K,OAAO/N,OAASqM,GACN,gBAArBrJ,EAAUyE,MAEd,CAEIuG,qBACF,MAAM,UAACf,EAAS,YAAEhG,GAAeX,KAAK6C,MACtC,OAAOlC,GAAegG,GAAa3G,KAAKwH,4BAC1C,CAiFAG,aACE,OAAO3H,KAAK6C,MAAMuE,cAAcnI,KAAI3B,IAAO,CACzCsK,MAAOtK,EAAI5D,KACXmO,OACExM,EAAAA,EAAAA,IAAA,OAAAT,SAAA,EACEW,EAAAA,EAAAA,IAACuM,EAAAA,EAAkB,CAACxH,aAAchD,KAClC/B,EAAAA,EAAAA,IAACwM,EAAa,CAAAnN,SAAE0C,EAAI5D,SAFZ4D,EAAI5D,SAMpB,CAEAsO,yBACE,MAAM,UAACtL,GAAasD,KAAK6C,MACzB,OACEtH,EAAAA,EAAAA,IAAC0M,EAAAA,GAAK,CAACC,KAAK,QAAQC,UAAQ,EAAAvN,UACzB2H,EAAAA,EAAAA,IACC,4GACA,CACE6F,eAAe7M,EAAAA,EAAAA,IAAA,UAAAX,SAAS8B,EAAU3C,UAK5C,CAEAsO,sBACE,MAAM,aAAC/H,EAAY,gBAAEyF,EAAe,YAAEpF,EAAW,UAAEjE,GAAasD,KAAK6C,MACrE,GAAIkD,GAAmBzF,IAAiBN,KAAK2E,UAAUrE,GACrD,OACEjF,EAAAA,EAAAA,IAAC4M,EAAAA,GAAK,CAACC,KAAK,QAAQC,UAAQ,EAAAvN,SAAA,EAC1BW,EAAAA,EAAAA,IAAA,KAAAX,UACG2H,EAAAA,EAAAA,IACE,6LAGD,CAACjC,cAAc/E,EAAAA,EAAAA,IAAA,UAAAX,SAAS0F,EAAa5G,YAGzC6B,EAAAA,EAAAA,IAAC+M,EAAW,CAAA1N,SAAEmB,OAAOC,SAASP,UAIpC,GAAIkF,GAAeL,EACjB,OACE/E,EAAAA,EAAAA,IAAC0M,EAAAA,GAAK,CAACC,KAAK,QAAQC,UAAQ,EAAAvN,UACzB2H,EAAAA,EAAAA,IAAI,mEAAoE,CACvEjC,cAAc/E,EAAAA,EAAAA,IAAA,UAAAX,SAAS0F,EAAavG,OACpCqO,eAAe7M,EAAAA,EAAAA,IAAA,UAAAX,SAAS8B,EAAU3C,WAM1C,GAAIiG,KAAKwH,6BAA8B,CAErC,MAAMe,EAAY7L,GAAW+K,OAAO/N,MAAQ,uBAC5C,OACE6B,EAAAA,EAAAA,IAAC0M,EAAAA,GAAK,CAACC,KAAK,QAAQC,UAAQ,EAAAvN,UACzB2H,EAAAA,EAAAA,IACC,mKACA,CACE6F,eAAe7M,EAAAA,EAAAA,IAAA,UAAAX,SAAS8B,EAAU3C,OAClCyO,UAAUjN,EAAAA,EAAAA,IAAA,UAAAX,SAAS2N,OAK7B,CAEA,OAAO,IACT,CAEAE,qBACE,MAAM,gBAAC1C,EAAe,UAAErJ,GAAasD,KAAK6C,MAC1C,OACExH,EAAAA,EAAAA,IAAA,OAAAT,SAAA,EACEW,EAAAA,EAAAA,IAAA,KAAAX,UACG2H,EAAAA,EAAAA,IACC,gFACA,CACEjC,cAAc/E,EAAAA,EAAAA,IAAA,aACd6M,eAAe7M,EAAAA,EAAAA,IAAA,UAAAX,SAAS8B,EAAU3C,YAIxCwB,EAAAA,EAAAA,IAACmN,EAAAA,EAAU,CAACb,OAAO/N,EAAAA,EAAAA,GAAE,gBAAiB6O,QAAQ,EAAOC,SAAO,EAACC,UAAQ,EAAAjO,SAClEA,KACCW,EAAAA,EAAAA,IAACuN,EAAAA,EAAa,CACZC,SAAUrE,IAAA,IAAC,MAACkD,GAAMlD,EAAA,OAAK1E,KAAKkH,YAAYU,EAAM,EAC9CA,MAAO7B,EACPiD,aAAalP,EAAAA,EAAAA,GAAE,0BACfmP,QAASjJ,KAAK2H,mBAM1B,CAEAuB,sBACE,MAAM,cAAC9B,EAAa,UAAE1K,GAAasD,KAAK6C,MAElCsG,EAAmB/B,EAAc,GAAGrN,KAC1C,OACEwB,EAAAA,EAAAA,IAAA,OAAAX,UACEW,EAAAA,EAAAA,IAAA,KAAAX,UACG2H,EAAAA,EAAAA,IAAI,qEAAsE,CACzEjC,cAAc/E,EAAAA,EAAAA,IAAA,UAAAX,SAASuO,IACvBf,eAAe7M,EAAAA,EAAAA,IAAA,UAAAX,SAAS8B,EAAU3C,YAK5C,CAEAqP,oBACE,MAAM,aAAC9I,EAAY,UAAE5D,GAAasD,KAAK6C,MACvC,OACExH,EAAAA,EAAAA,IAAA,OAAAT,SAAA,EACEW,EAAAA,EAAAA,IAAC8N,EAAa,CAAAzO,SACXoF,KAAKsH,YAActH,KAAKkJ,sBAAwBlJ,KAAKyI,uBAEvDzI,KAAKqI,sBACL/H,IACC/E,EAAAA,EAAAA,IAAC+N,EAAAA,EAAoBC,SAAQ,CAAC3B,MAAOtH,EAAa1F,UAChDW,EAAAA,EAAAA,IAAC2E,EAAqB,CACpBxD,UAAWA,EACX4D,aAAcA,EACduB,UAAW7B,KAAK6B,UAChBc,WAAY3C,KAAKyG,QACjB9F,YAAaX,KAAK0H,qBAM9B,CAEAhF,aACE,OACEnH,EAAAA,EAAAA,IAACf,EAAAA,EAAY,CAAAI,UACXS,EAAAA,EAAAA,IAACmO,EAAO,CAAA5O,SAAA,EACNW,EAAAA,EAAAA,IAAA,MAAAX,UAAKd,EAAAA,EAAAA,GAAE,qCACNkG,KAAKuH,oBACFvH,KAAKgI,yBACLhI,KAAKoJ,wBAIjB,EAGF,MAAMd,GAAclM,EAAAA,EAAAA,GAAO,MAAK,CAAAC,OAAA,aAAZD,CAAa,CAAArC,KAAA,UAAAgL,OAAA,uCAK3BgD,GAAgB3L,EAAAA,EAAAA,GAAO,OAAM,CAAAC,OAAA,aAAbD,CAAc,CAAArC,KAAA,UAAAgL,OAAA,oBAI9ByE,GAAUpN,EAAAA,EAAAA,GAAO,MAAK,CAAAC,OAAA,aAAZD,CAAa,CAAArC,KAAA,SAAAgL,OAAA,uBAIvBsE,GAAgBjN,EAAAA,EAAAA,GAAO,MAAK,CAAAC,OAAA,aAAZD,CAAa,CAAArC,KAAA,UAAAgL,OAAA,sB,gDC7UnC,IAAI0E,EAAkB,EAAQ,8CAC1BC,EAAmB,EAAQ,+CAM3BC,EAHc7K,OAAO8K,UAGQD,eAyB7B3K,EAAU0K,GAAiB,SAASG,EAAQjC,EAAO7D,GACjD4F,EAAeG,KAAKD,EAAQ9F,GAC9B8F,EAAO9F,GAAKgG,KAAKnC,GAEjB6B,EAAgBI,EAAQ9F,EAAK,CAAC6D,GAElC,IAEAoC,EAAOC,QAAUjL,C,iDCxCjB,IAAIkL,EAAe,EAAQ,2CACvBC,EAAiB,EAAQ,6CAGzBC,EAActL,OAAO8K,UAGrBD,EAAiBS,EAAYT,eAO7BU,EAAuBD,EAAYE,SA4BnC7K,EAAW0K,GAAe,SAASN,EAAQjC,EAAO7D,GACvC,MAAT6D,GACyB,mBAAlBA,EAAM0C,WACf1C,EAAQyC,EAAqBP,KAAKlC,IAGhC+B,EAAeG,KAAKD,EAAQjC,GAC9BiC,EAAOjC,GAAOmC,KAAKhG,GAEnB8F,EAAOjC,GAAS,CAAC7D,EAErB,GAAGmG,GAEHF,EAAOC,QAAUxK,C","sources":["webpack:///./app/actionCreators/sentryAppInstallations.tsx","webpack:///./app/components/narrowLayout.tsx","webpack:///./app/components/sentryAppIcon.tsx","webpack:///./app/utils/consolidatedScopes.tsx","webpack:///./app/views/deprecatedAsyncView.tsx","webpack:///./app/components/modals/sentryAppDetailsModal.tsx","webpack:///./app/views/sentryAppExternalInstallation/index.tsx","webpack:///../node_modules/lodash/groupBy.js","webpack:///../node_modules/lodash/invertBy.js"],"sourcesContent":["import {\n  addErrorMessage,\n  addLoadingMessage,\n  addSuccessMessage,\n  clearIndicators,\n} from 'sentry/actionCreators/indicator';\nimport {Client} from 'sentry/api';\nimport {t} from 'sentry/locale';\nimport {SentryApp, SentryAppInstallation} from 'sentry/types';\n\n/**\n * Install a sentry application\n *\n * @param {Object} client ApiClient\n * @param {String} orgId Organization Slug\n * @param {Object} app SentryApp\n */\nexport function installSentryApp(\n  client: Client,\n  orgId: string,\n  app: SentryApp\n): Promise<SentryAppInstallation> {\n  addLoadingMessage();\n  const promise = client.requestPromise(\n    `/organizations/${orgId}/sentry-app-installations/`,\n    {\n      method: 'POST',\n      data: {slug: app.slug},\n    }\n  );\n  promise.then(\n    () => clearIndicators(),\n    () => addErrorMessage(t('Unable to install %s', app.name))\n  );\n  return promise;\n}\n\n/**\n * Uninstall a sentry application\n *\n * @param {Object} client ApiClient\n * @param {Object} install SentryAppInstallation\n */\nexport function uninstallSentryApp(\n  client: Client,\n  install: SentryAppInstallation\n): Promise<void> {\n  addLoadingMessage();\n  const promise = client.requestPromise(`/sentry-app-installations/${install.uuid}/`, {\n    method: 'DELETE',\n  });\n  const capitalizedAppSlug =\n    install.app.slug.charAt(0).toUpperCase() + install.app.slug.slice(1);\n  promise.then(\n    () => {\n      addSuccessMessage(t('%s successfully uninstalled.', capitalizedAppSlug));\n    },\n    () => clearIndicators()\n  );\n  return promise;\n}\n","import {useEffect} from 'react';\nimport styled from '@emotion/styled';\n\nimport {logout} from 'sentry/actionCreators/account';\nimport {IconSentry} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport useApi from 'sentry/utils/useApi';\n\ntype Props = {\n  children: React.ReactNode;\n  maxWidth?: string;\n  showLogout?: boolean;\n};\n\nfunction NarrowLayout({maxWidth, showLogout, children}: Props) {\n  const api = useApi();\n\n  useEffect(() => {\n    document.body.classList.add('narrow');\n\n    return () => document.body.classList.remove('narrow');\n  }, []);\n\n  async function handleLogout() {\n    await logout(api);\n    window.location.assign('/auth/login');\n  }\n\n  return (\n    <div className=\"app\">\n      <div className=\"pattern-bg\" />\n      <div className=\"container\" style={{maxWidth}}>\n        <div className=\"box box-modal\">\n          <div className=\"box-header\">\n            <a href=\"/\">\n              <IconSentry size=\"lg\" />\n            </a>\n            {showLogout && (\n              <a className=\"logout pull-right\" onClick={handleLogout}>\n                <Logout>{t('Sign out')}</Logout>\n              </a>\n            )}\n          </div>\n          <div className=\"box-content with-padding\">{children}</div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nconst Logout = styled('span')`\n  font-size: ${p => p.theme.fontSizeLarge};\n`;\n\nexport default NarrowLayout;\n","import SentryAppAvatar from 'sentry/components/avatar/sentryAppAvatar';\nimport {AvatarSentryApp} from 'sentry/types';\n\ntype Props = {\n  sentryApp: AvatarSentryApp;\n  size: number;\n};\n\nfunction SentryAppIcon({sentryApp, size}: Props) {\n  return <SentryAppAvatar sentryApp={sentryApp} size={size} isColor />;\n}\n\nexport default SentryAppIcon;\n","import groupBy from 'lodash/groupBy';\nimport invertBy from 'lodash/invertBy';\nimport pick from 'lodash/pick';\n\nimport {Permissions} from 'sentry/types';\n\nconst PERMISSION_LEVELS = {\n  read: 0,\n  write: 1,\n  admin: 2,\n};\n\nconst HUMAN_RESOURCE_NAMES = {\n  project: 'Project',\n  team: 'Team',\n  release: 'Release',\n  event: 'Event',\n  org: 'Organization',\n  member: 'Member',\n};\n\nconst DEFAULT_RESOURCE_PERMISSIONS: Permissions = {\n  Project: 'no-access',\n  Team: 'no-access',\n  Release: 'no-access',\n  Event: 'no-access',\n  Organization: 'no-access',\n  Member: 'no-access',\n};\n\nconst PROJECT_RELEASES = 'project:releases';\n\ntype PermissionLevelResources = {\n  admin: string[];\n  read: string[];\n  write: string[];\n};\n/**\n * Numerical value of the scope where Admin is higher than Write,\n * which is higher than Read. Used to sort scopes by access.\n */\nconst permissionLevel = (scope: string): number => {\n  const permission = scope.split(':')[1];\n  return PERMISSION_LEVELS[permission];\n};\n\nconst compareScopes = (a: string, b: string) => permissionLevel(a) - permissionLevel(b);\n\n/**\n * Return the most permissive scope for each resource.\n *\n * Example:\n *    Given the full list of scopes:\n *      ['project:read', 'project:write', 'team:read', 'team:write', 'team:admin']\n *\n *    this would return:\n *      ['project:write', 'team:admin']\n */\nfunction topScopes(scopeList: string[]) {\n  return Object.values(groupBy(scopeList, scope => scope.split(':')[0]))\n    .map(scopes => scopes.sort(compareScopes))\n    .map(scopes => scopes.pop());\n}\n\n/**\n * Convert into a list of Permissions, grouped by resource.\n *\n * This is used in the new/edit Sentry App form. That page displays permissions\n * in a per-Resource manner, meaning one row for Project, one for Organization, etc.\n *\n * This exposes scopes in a way that works for that UI.\n *\n * Example:\n *    {\n *      'Project': 'read',\n *      'Organization': 'write',\n *      'Team': 'no-access',\n *      ...\n *    }\n */\nfunction toResourcePermissions(scopes: string[]): Permissions {\n  const permissions = {...DEFAULT_RESOURCE_PERMISSIONS};\n  let filteredScopes = [...scopes];\n  // The scope for releases is `project:releases`, but instead of displaying\n  // it as a permission of Project, we want to separate it out into its own\n  // row for Releases.\n  if (scopes.includes(PROJECT_RELEASES)) {\n    permissions.Release = 'admin';\n    filteredScopes = scopes.filter((scope: string) => scope !== PROJECT_RELEASES); // remove project:releases\n  }\n\n  topScopes(filteredScopes).forEach((scope: string | undefined) => {\n    if (scope) {\n      const [resource, permission] = scope.split(':');\n      permissions[HUMAN_RESOURCE_NAMES[resource]] = permission;\n    }\n  });\n\n  return permissions;\n}\n\n/**\n * Convert into a list of Permissions, grouped by access and including a\n * list of resources per access level.\n *\n * This is used in the Permissions Modal when installing an App. It displays\n * scopes in a per-Permission way, meaning one row for Read, one for Write,\n * and one for Admin.\n *\n * This exposes scopes in a way that works for that UI.\n *\n * Example:\n *    {\n *      read:  ['Project', 'Organization'],\n *      write: ['Member'],\n *      admin: ['Release']\n *    }\n */\nfunction toPermissions(scopes: string[]): PermissionLevelResources {\n  const defaultPermissions = {read: [], write: [], admin: []};\n  const resourcePermissions = toResourcePermissions(scopes);\n\n  // Filter out the 'no-access' permissions\n  const permissions = pick(invertBy(resourcePermissions), ['read', 'write', 'admin']);\n  return {...defaultPermissions, ...permissions};\n}\n\nexport {toPermissions, toResourcePermissions};\n","import DeprecatedAsyncComponent from 'sentry/components/deprecatedAsyncComponent';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\n\nexport type AsyncViewState = DeprecatedAsyncComponent['state'];\nexport type AsyncViewProps = DeprecatedAsyncComponent['props'];\n\n/**\n * @deprecated use useApiQuery instead.\n *\n * Read the dev docs page on network requests for more information [1].\n *\n * [1]: https://develop.sentry.dev/frontend/network-requests/\n */\nexport default class DeprecatedAsyncView<\n  P extends AsyncViewProps = AsyncViewProps,\n  S extends AsyncViewState = AsyncViewState\n> extends DeprecatedAsyncComponent<P, S> {\n  getTitle() {\n    return '';\n  }\n\n  render() {\n    return (\n      <SentryDocumentTitle title={this.getTitle()}>\n        {this.renderComponent() as React.ReactChild}\n      </SentryDocumentTitle>\n    );\n  }\n}\n","import {Fragment} from 'react';\nimport styled from '@emotion/styled';\n\nimport Access from 'sentry/components/acl/access';\nimport {Button} from 'sentry/components/button';\nimport CircleIndicator from 'sentry/components/circleIndicator';\nimport DeprecatedAsyncComponent from 'sentry/components/deprecatedAsyncComponent';\nimport SentryAppIcon from 'sentry/components/sentryAppIcon';\nimport Tag from 'sentry/components/tag';\nimport {IconFlag} from 'sentry/icons';\nimport {t, tct} from 'sentry/locale';\nimport {space} from 'sentry/styles/space';\nimport {IntegrationFeature, Organization, SentryApp} from 'sentry/types';\nimport {toPermissions} from 'sentry/utils/consolidatedScopes';\nimport {\n  getIntegrationFeatureGate,\n  trackIntegrationAnalytics,\n} from 'sentry/utils/integrationUtil';\nimport marked, {singleLineRenderer} from 'sentry/utils/marked';\nimport {recordInteraction} from 'sentry/utils/recordSentryAppInteraction';\n\ntype Props = {\n  closeModal: () => void;\n  isInstalled: boolean;\n  onInstall: () => Promise<void>;\n  organization: Organization;\n  sentryApp: SentryApp;\n} & DeprecatedAsyncComponent['props'];\n\ntype State = {\n  featureData: IntegrationFeature[];\n} & DeprecatedAsyncComponent['state'];\n\n// No longer a modal anymore but yea :)\nexport default class SentryAppDetailsModal extends DeprecatedAsyncComponent<\n  Props,\n  State\n> {\n  componentDidUpdate(prevProps: Props) {\n    // if the user changes org, count this as a fresh event to track\n    if (this.props.organization.id !== prevProps.organization.id) {\n      this.trackOpened();\n    }\n  }\n\n  componentDidMount() {\n    super.componentDidMount();\n    this.trackOpened();\n  }\n\n  trackOpened() {\n    const {sentryApp, organization, isInstalled} = this.props;\n    recordInteraction(sentryApp.slug, 'sentry_app_viewed');\n\n    trackIntegrationAnalytics(\n      'integrations.install_modal_opened',\n      {\n        integration_type: 'sentry_app',\n        integration: sentryApp.slug,\n        already_installed: isInstalled,\n        view: 'external_install',\n        integration_status: sentryApp.status,\n        organization,\n      },\n      {startSession: true}\n    );\n  }\n\n  getEndpoints(): ReturnType<DeprecatedAsyncComponent['getEndpoints']> {\n    const {sentryApp} = this.props;\n    return [['featureData', `/sentry-apps/${sentryApp.slug}/features/`]];\n  }\n\n  featureTags(features: Pick<IntegrationFeature, 'featureGate'>[]) {\n    return features.map(feature => {\n      const feat = feature.featureGate.replace(/integrations/g, '');\n      return <StyledTag key={feat}>{feat.replace(/-/g, ' ')}</StyledTag>;\n    });\n  }\n\n  get permissions() {\n    return toPermissions(this.props.sentryApp.scopes);\n  }\n\n  async onInstall() {\n    const {onInstall} = this.props;\n    // we want to make sure install finishes before we close the modal\n    // and we should close the modal if there is an error as well\n    try {\n      await onInstall();\n    } catch (_err) {\n      /* stylelint-disable-next-line no-empty-block */\n    }\n  }\n\n  renderPermissions() {\n    const permissions = this.permissions;\n    if (\n      Object.keys(permissions).filter(scope => permissions[scope].length > 0).length === 0\n    ) {\n      return null;\n    }\n\n    return (\n      <Fragment>\n        <Title>Permissions</Title>\n        {permissions.read.length > 0 && (\n          <Permission>\n            <Indicator />\n            <Text key=\"read\">\n              {tct('[read] access to [resources] resources', {\n                read: <strong>Read</strong>,\n                resources: permissions.read.join(', '),\n              })}\n            </Text>\n          </Permission>\n        )}\n        {permissions.write.length > 0 && (\n          <Permission>\n            <Indicator />\n            <Text key=\"write\">\n              {tct('[read] and [write] access to [resources] resources', {\n                read: <strong>Read</strong>,\n                write: <strong>Write</strong>,\n                resources: permissions.write.join(', '),\n              })}\n            </Text>\n          </Permission>\n        )}\n        {permissions.admin.length > 0 && (\n          <Permission>\n            <Indicator />\n            <Text key=\"admin\">\n              {tct('[admin] access to [resources] resources', {\n                admin: <strong>Admin</strong>,\n                resources: permissions.admin.join(', '),\n              })}\n            </Text>\n          </Permission>\n        )}\n      </Fragment>\n    );\n  }\n\n  renderBody() {\n    const {sentryApp, closeModal, isInstalled, organization} = this.props;\n    const {featureData} = this.state;\n    // Prepare the features list\n    const features = (featureData || []).map(f => ({\n      featureGate: f.featureGate,\n      description: (\n        <span dangerouslySetInnerHTML={{__html: singleLineRenderer(f.description)}} />\n      ),\n    }));\n\n    const {FeatureList, IntegrationFeatures} = getIntegrationFeatureGate();\n\n    const overview = sentryApp.overview || '';\n    const featureProps = {organization, features};\n\n    return (\n      <Fragment>\n        <Heading>\n          <SentryAppIcon sentryApp={sentryApp} size={50} />\n          <HeadingInfo>\n            <Name>{sentryApp.name}</Name>\n            {!!features.length && <Features>{this.featureTags(features)}</Features>}\n          </HeadingInfo>\n        </Heading>\n        <Description dangerouslySetInnerHTML={{__html: marked(overview)}} />\n        <FeatureList {...featureProps} provider={{...sentryApp, key: sentryApp.slug}} />\n        <IntegrationFeatures {...featureProps}>\n          {({disabled, disabledReason}) => (\n            <Fragment>\n              {!disabled && this.renderPermissions()}\n              <Footer>\n                <Author>{t('Authored By %s', sentryApp.author)}</Author>\n                <div>\n                  {disabled && <DisabledNotice reason={disabledReason} />}\n                  <Button size=\"sm\" onClick={closeModal}>\n                    {t('Cancel')}\n                  </Button>\n\n                  <Access access={['org:integrations']} organization={organization}>\n                    {({hasAccess}) =>\n                      hasAccess && (\n                        <Button\n                          size=\"sm\"\n                          priority=\"primary\"\n                          disabled={isInstalled || disabled}\n                          onClick={() => this.onInstall()}\n                          style={{marginLeft: space(1)}}\n                          data-test-id=\"install\"\n                        >\n                          {t('Accept & Install')}\n                        </Button>\n                      )\n                    }\n                  </Access>\n                </div>\n              </Footer>\n            </Fragment>\n          )}\n        </IntegrationFeatures>\n      </Fragment>\n    );\n  }\n}\n\nconst Heading = styled('div')`\n  display: grid;\n  grid-template-columns: max-content 1fr;\n  gap: ${space(1)};\n  align-items: center;\n  margin-bottom: ${space(2)};\n`;\n\nconst HeadingInfo = styled('div')`\n  display: grid;\n  grid-template-rows: max-content max-content;\n  align-items: start;\n`;\n\nconst Name = styled('div')`\n  font-weight: bold;\n  font-size: 1.4em;\n`;\n\nconst Description = styled('div')`\n  margin-bottom: ${space(2)};\n\n  li {\n    margin-bottom: 6px;\n  }\n`;\n\nconst Author = styled('div')`\n  color: ${p => p.theme.gray300};\n`;\n\nconst DisabledNotice = styled(({reason, ...p}: {reason: React.ReactNode}) => (\n  <div {...p}>\n    <IconFlag color=\"errorText\" size=\"md\" />\n    {reason}\n  </div>\n))`\n  display: grid;\n  align-items: center;\n  flex: 1;\n  grid-template-columns: max-content 1fr;\n  color: ${p => p.theme.errorText};\n  font-size: 0.9em;\n`;\n\nconst Text = styled('p')`\n  margin: 0px 6px;\n`;\n\nconst Permission = styled('div')`\n  display: flex;\n`;\n\nconst Footer = styled('div')`\n  display: flex;\n  padding: 20px 30px;\n  border-top: 1px solid #e2dee6;\n  margin: 20px -30px -30px;\n  justify-content: space-between;\n`;\n\nconst Title = styled('p')`\n  margin-bottom: ${space(1)};\n  font-weight: bold;\n`;\n\nconst Indicator = styled(p => <CircleIndicator size={7} {...p} />)`\n  margin-top: 7px;\n  color: ${p => p.theme.success};\n`;\n\nconst Features = styled('div')`\n  margin: -${space(0.5)};\n`;\n\nconst StyledTag = styled(Tag)`\n  padding: ${space(0.5)};\n`;\n","import {RouteComponentProps} from 'react-router';\nimport styled from '@emotion/styled';\n\nimport {addErrorMessage} from 'sentry/actionCreators/indicator';\nimport {installSentryApp} from 'sentry/actionCreators/sentryAppInstallations';\nimport {Client} from 'sentry/api';\nimport {Alert} from 'sentry/components/alert';\nimport OrganizationAvatar from 'sentry/components/avatar/organizationAvatar';\nimport SelectControl from 'sentry/components/forms/controls/selectControl';\nimport FieldGroup from 'sentry/components/forms/fieldGroup';\nimport SentryAppDetailsModal from 'sentry/components/modals/sentryAppDetailsModal';\nimport NarrowLayout from 'sentry/components/narrowLayout';\nimport {t, tct} from 'sentry/locale';\nimport {Organization, SentryApp, SentryAppInstallation} from 'sentry/types';\nimport {generateBaseControlSiloUrl} from 'sentry/utils';\nimport {trackIntegrationAnalytics} from 'sentry/utils/integrationUtil';\nimport {addQueryParamsToExistingUrl} from 'sentry/utils/queryString';\nimport DeprecatedAsyncView from 'sentry/views/deprecatedAsyncView';\n\nimport {OrganizationContext} from '../organizationContext';\n\ntype Props = RouteComponentProps<{sentryAppSlug: string}, {}>;\n\ntype State = DeprecatedAsyncView['state'] & {\n  organization: Organization | null;\n  organizations: Organization[];\n  reloading: boolean;\n  selectedOrgSlug: string | null;\n  sentryApp: SentryApp;\n};\n\nexport default class SentryAppExternalInstallation extends DeprecatedAsyncView<\n  Props,\n  State\n> {\n  disableErrorReport = false;\n  controlSiloApi = new Client({baseUrl: generateBaseControlSiloUrl() + '/api/0'});\n\n  getDefaultState() {\n    const state = super.getDefaultState();\n    return {\n      ...state,\n      selectedOrgSlug: null,\n      organization: null,\n      organizations: [],\n      reloading: false,\n    };\n  }\n\n  getEndpoints(): ReturnType<DeprecatedAsyncView['getEndpoints']> {\n    return [\n      ['organizations', '/organizations/'],\n      ['sentryApp', `/sentry-apps/${this.sentryAppSlug}/`],\n    ];\n  }\n\n  getTitle() {\n    return t('Choose Installation Organization');\n  }\n\n  get sentryAppSlug() {\n    return this.props.params.sentryAppSlug;\n  }\n\n  get isSingleOrg() {\n    return this.state.organizations.length === 1;\n  }\n\n  get isSentryAppInternal() {\n    const {sentryApp} = this.state;\n    return sentryApp && sentryApp.status === 'internal';\n  }\n\n  get isSentryAppUnavailableForOrg() {\n    const {sentryApp, selectedOrgSlug} = this.state;\n    // if the app is unpublished for a different org\n    return (\n      selectedOrgSlug &&\n      sentryApp?.owner?.slug !== selectedOrgSlug &&\n      sentryApp.status === 'unpublished'\n    );\n  }\n\n  get disableInstall() {\n    const {reloading, isInstalled} = this.state;\n    return isInstalled || reloading || this.isSentryAppUnavailableForOrg;\n  }\n\n  hasAccess = (org: Organization) => org.access.includes('org:integrations');\n\n  onClose = () => {\n    // if we came from somewhere, go back there. Otherwise, back to the integrations page\n    const {selectedOrgSlug} = this.state;\n    const newUrl = document.referrer || `/settings/${selectedOrgSlug}/integrations/`;\n    window.location.assign(newUrl);\n  };\n\n  onInstall = async (): Promise<any | undefined> => {\n    const {organization, sentryApp} = this.state;\n    if (!organization || !sentryApp) {\n      return undefined;\n    }\n    trackIntegrationAnalytics('integrations.installation_start', {\n      integration_type: 'sentry_app',\n      integration: sentryApp.slug,\n      view: 'external_install',\n      integration_status: sentryApp.status,\n      organization,\n    });\n\n    const install = await installSentryApp(\n      this.controlSiloApi,\n      organization.slug,\n      sentryApp\n    );\n    // installation is complete if the status is installed\n    if (install.status === 'installed') {\n      trackIntegrationAnalytics('integrations.installation_complete', {\n        integration_type: 'sentry_app',\n        integration: sentryApp.slug,\n        view: 'external_install',\n        integration_status: sentryApp.status,\n        organization,\n      });\n    }\n\n    if (sentryApp.redirectUrl) {\n      const queryParams = {\n        installationId: install.uuid,\n        code: install.code,\n        orgSlug: organization.slug,\n      };\n      const redirectUrl = addQueryParamsToExistingUrl(sentryApp.redirectUrl, queryParams);\n      return window.location.assign(redirectUrl);\n    }\n    return this.onClose();\n  };\n\n  onSelectOrg = async (orgSlug: string) => {\n    this.setState({selectedOrgSlug: orgSlug, reloading: true});\n\n    try {\n      const [organization, installations]: [Organization, SentryAppInstallation[]] =\n        await Promise.all([\n          this.controlSiloApi.requestPromise(`/organizations/${orgSlug}/`),\n          this.controlSiloApi.requestPromise(\n            `/organizations/${orgSlug}/sentry-app-installations/`\n          ),\n        ]);\n      const isInstalled = installations\n        .map(install => install.app.slug)\n        .includes(this.sentryAppSlug);\n      // all state fields should be set at the same time so analytics in SentryAppDetailsModal works properly\n      this.setState({organization, isInstalled, reloading: false});\n    } catch (err) {\n      addErrorMessage(t('Failed to retrieve organization or integration details'));\n      this.setState({reloading: false});\n    }\n  };\n\n  onRequestSuccess = ({stateKey, data}) => {\n    // if only one org, we can immediately update our selected org\n    if (stateKey === 'organizations' && data.length === 1) {\n      this.onSelectOrg(data[0].slug);\n    }\n  };\n\n  getOptions() {\n    return this.state.organizations.map(org => ({\n      value: org.slug,\n      label: (\n        <div key={org.slug}>\n          <OrganizationAvatar organization={org} />\n          <OrgNameHolder>{org.slug}</OrgNameHolder>\n        </div>\n      ),\n    }));\n  }\n\n  renderInternalAppError() {\n    const {sentryApp} = this.state;\n    return (\n      <Alert type=\"error\" showIcon>\n        {tct(\n          'Integration [sentryAppName] is an internal integration. Internal integrations are automatically installed',\n          {\n            sentryAppName: <strong>{sentryApp.name}</strong>,\n          }\n        )}\n      </Alert>\n    );\n  }\n\n  checkAndRenderError() {\n    const {organization, selectedOrgSlug, isInstalled, sentryApp} = this.state;\n    if (selectedOrgSlug && organization && !this.hasAccess(organization)) {\n      return (\n        <Alert type=\"error\" showIcon>\n          <p>\n            {tct(\n              `You do not have permission to install integrations in\n          [organization]. Ask an organization owner or manager to\n          visit this page to finish installing this integration.`,\n              {organization: <strong>{organization.slug}</strong>}\n            )}\n          </p>\n          <InstallLink>{window.location.href}</InstallLink>\n        </Alert>\n      );\n    }\n    if (isInstalled && organization) {\n      return (\n        <Alert type=\"error\" showIcon>\n          {tct('Integration [sentryAppName] already installed for [organization]', {\n            organization: <strong>{organization.name}</strong>,\n            sentryAppName: <strong>{sentryApp.name}</strong>,\n          })}\n        </Alert>\n      );\n    }\n\n    if (this.isSentryAppUnavailableForOrg) {\n      // use the slug of the owner if we have it, otherwise use 'another organization'\n      const ownerSlug = sentryApp?.owner?.slug ?? 'another organization';\n      return (\n        <Alert type=\"error\" showIcon>\n          {tct(\n            'Integration [sentryAppName] is an unpublished integration for [otherOrg]. An unpublished integration can only be installed on the organization which created it.',\n            {\n              sentryAppName: <strong>{sentryApp.name}</strong>,\n              otherOrg: <strong>{ownerSlug}</strong>,\n            }\n          )}\n        </Alert>\n      );\n    }\n\n    return null;\n  }\n\n  renderMultiOrgView() {\n    const {selectedOrgSlug, sentryApp} = this.state;\n    return (\n      <div>\n        <p>\n          {tct(\n            'Please pick a specific [organization:organization] to install [sentryAppName]',\n            {\n              organization: <strong />,\n              sentryAppName: <strong>{sentryApp.name}</strong>,\n            }\n          )}\n        </p>\n        <FieldGroup label={t('Organization')} inline={false} stacked required>\n          {() => (\n            <SelectControl\n              onChange={({value}) => this.onSelectOrg(value)}\n              value={selectedOrgSlug}\n              placeholder={t('Select an organization')}\n              options={this.getOptions()}\n            />\n          )}\n        </FieldGroup>\n      </div>\n    );\n  }\n\n  renderSingleOrgView() {\n    const {organizations, sentryApp} = this.state;\n    // pull the name out of organizations since state.organization won't be loaded initially\n    const organizationName = organizations[0].name;\n    return (\n      <div>\n        <p>\n          {tct('You are installing [sentryAppName] for organization [organization]', {\n            organization: <strong>{organizationName}</strong>,\n            sentryAppName: <strong>{sentryApp.name}</strong>,\n          })}\n        </p>\n      </div>\n    );\n  }\n\n  renderMainContent() {\n    const {organization, sentryApp} = this.state;\n    return (\n      <div>\n        <OrgViewHolder>\n          {this.isSingleOrg ? this.renderSingleOrgView() : this.renderMultiOrgView()}\n        </OrgViewHolder>\n        {this.checkAndRenderError()}\n        {organization && (\n          <OrganizationContext.Provider value={organization}>\n            <SentryAppDetailsModal\n              sentryApp={sentryApp}\n              organization={organization}\n              onInstall={this.onInstall}\n              closeModal={this.onClose}\n              isInstalled={this.disableInstall}\n            />\n          </OrganizationContext.Provider>\n        )}\n      </div>\n    );\n  }\n\n  renderBody() {\n    return (\n      <NarrowLayout>\n        <Content>\n          <h3>{t('Finish integration installation')}</h3>\n          {this.isSentryAppInternal\n            ? this.renderInternalAppError()\n            : this.renderMainContent()}\n        </Content>\n      </NarrowLayout>\n    );\n  }\n}\n\nconst InstallLink = styled('pre')`\n  margin-bottom: 0;\n  background: #fbe3e1;\n`;\n\nconst OrgNameHolder = styled('span')`\n  margin-left: 5px;\n`;\n\nconst Content = styled('div')`\n  margin-bottom: 40px;\n`;\n\nconst OrgViewHolder = styled('div')`\n  margin-bottom: 20px;\n`;\n","var baseAssignValue = require('./_baseAssignValue'),\n    createAggregator = require('./_createAggregator');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an object composed of keys generated from the results of running\n * each element of `collection` thru `iteratee`. The order of grouped values\n * is determined by the order they occur in `collection`. The corresponding\n * value of each key is an array of elements responsible for generating the\n * key. The iteratee is invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n * @returns {Object} Returns the composed aggregate object.\n * @example\n *\n * _.groupBy([6.1, 4.2, 6.3], Math.floor);\n * // => { '4': [4.2], '6': [6.1, 6.3] }\n *\n * // The `_.property` iteratee shorthand.\n * _.groupBy(['one', 'two', 'three'], 'length');\n * // => { '3': ['one', 'two'], '5': ['three'] }\n */\nvar groupBy = createAggregator(function(result, value, key) {\n  if (hasOwnProperty.call(result, key)) {\n    result[key].push(value);\n  } else {\n    baseAssignValue(result, key, [value]);\n  }\n});\n\nmodule.exports = groupBy;\n","var baseIteratee = require('./_baseIteratee'),\n    createInverter = require('./_createInverter');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * This method is like `_.invert` except that the inverted object is generated\n * from the results of running each element of `object` thru `iteratee`. The\n * corresponding inverted value of each inverted key is an array of keys\n * responsible for generating the inverted value. The iteratee is invoked\n * with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 4.1.0\n * @category Object\n * @param {Object} object The object to invert.\n * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n * @returns {Object} Returns the new inverted object.\n * @example\n *\n * var object = { 'a': 1, 'b': 2, 'c': 1 };\n *\n * _.invertBy(object);\n * // => { '1': ['a', 'c'], '2': ['b'] }\n *\n * _.invertBy(object, function(value) {\n *   return 'group' + value;\n * });\n * // => { 'group1': ['a', 'c'], 'group2': ['b'] }\n */\nvar invertBy = createInverter(function(result, value, key) {\n  if (value != null &&\n      typeof value.toString != 'function') {\n    value = nativeObjectToString.call(value);\n  }\n\n  if (hasOwnProperty.call(result, value)) {\n    result[value].push(key);\n  } else {\n    result[value] = [key];\n  }\n}, baseIteratee);\n\nmodule.exports = invertBy;\n"],"names":["installSentryApp","client","orgId","app","addLoadingMessage","promise","requestPromise","method","data","slug","then","clearIndicators","addErrorMessage","t","name","uninstallSentryApp","install","uuid","capitalizedAppSlug","charAt","toUpperCase","slice","addSuccessMessage","NarrowLayout","_ref","maxWidth","showLogout","children","api","useApi","useEffect","document","body","classList","add","remove","_jsxs","className","_jsx","style","href","IconSentry","size","onClick","async","logout","window","location","assign","Logout","displayName","_styled","target","p","theme","fontSizeLarge","SentryAppIcon","sentryApp","SentryAppAvatar","isColor","PERMISSION_LEVELS","read","write","admin","HUMAN_RESOURCE_NAMES","project","team","release","event","org","member","DEFAULT_RESOURCE_PERMISSIONS","Project","Team","Release","Event","Organization","Member","PROJECT_RELEASES","permissionLevel","scope","permission","split","compareScopes","a","b","toResourcePermissions","scopes","permissions","filteredScopes","scopeList","includes","filter","Object","values","groupBy","map","sort","pop","forEach","resource","toPermissions","resourcePermissions","pick","invertBy","DeprecatedAsyncView","DeprecatedAsyncComponent","getTitle","render","SentryDocumentTitle","title","this","renderComponent","SentryAppDetailsModal","componentDidUpdate","prevProps","props","organization","id","trackOpened","componentDidMount","super","isInstalled","recordInteraction","trackIntegrationAnalytics","integration_type","integration","already_installed","view","integration_status","status","startSession","getEndpoints","featureTags","features","feature","feat","featureGate","replace","StyledTag","onInstall","_err","renderPermissions","keys","length","Fragment","Title","Permission","Indicator","Text","tct","resources","join","renderBody","closeModal","featureData","state","f","description","dangerouslySetInnerHTML","__html","singleLineRenderer","FeatureList","IntegrationFeatures","getIntegrationFeatureGate","overview","featureProps","Heading","HeadingInfo","Name","Features","Description","marked","provider","key","disabled","disabledReason","Footer","Author","author","DisabledNotice","reason","Button","Access","access","_ref2","hasAccess","priority","marginLeft","space","styles","gray300","_ref3","IconFlag","color","errorText","CircleIndicator","success","Tag","SentryAppExternalInstallation","constructor","arguments","_defineProperty","Client","baseUrl","generateBaseControlSiloUrl","selectedOrgSlug","newUrl","referrer","controlSiloApi","redirectUrl","queryParams","installationId","code","orgSlug","addQueryParamsToExistingUrl","onClose","setState","reloading","installations","Promise","all","sentryAppSlug","err","stateKey","onSelectOrg","getDefaultState","organizations","params","isSingleOrg","isSentryAppInternal","isSentryAppUnavailableForOrg","owner","disableInstall","getOptions","value","label","OrganizationAvatar","OrgNameHolder","renderInternalAppError","Alert","type","showIcon","sentryAppName","checkAndRenderError","InstallLink","ownerSlug","otherOrg","renderMultiOrgView","FieldGroup","inline","stacked","required","SelectControl","onChange","placeholder","options","renderSingleOrgView","organizationName","renderMainContent","OrgViewHolder","OrganizationContext","Provider","Content","baseAssignValue","createAggregator","hasOwnProperty","prototype","result","call","push","module","exports","baseIteratee","createInverter","objectProto","nativeObjectToString","toString"],"sourceRoot":""}