{"version":3,"file":"chunks/app_views_releases_detail_commitsAndFiles_commits_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"kiCAoCA,MAAMA,UAAgBC,EAAAA,EACpBC,WACE,MAAM,OAACC,EAAM,QAAEC,EAAO,YAAEC,GAAeC,KAAKC,MAE5C,OAAOC,EAAAA,EAAAA,IACLC,EAAAA,EAAAA,GAAE,wBAAwBC,EAAAA,EAAAA,IAAcP,EAAOQ,UAC/CP,GACA,EACAC,EAEJ,CAEAO,kBACE,MAAO,IACFC,MAAMD,kBACTE,QAAS,GAEb,CAEAC,mBAAmBC,EAAkBC,GAC/BD,EAAUE,mBAAmBC,OAASb,KAAKC,MAAMW,mBAAmBC,KAIxEN,MAAME,mBAAmBC,EAAWC,GAHlCX,KAAKc,kBAIT,CAEAC,eACE,MAAM,YACJhB,EACAa,kBAAmBI,EAAgB,SACnCC,EAAQ,QACRnB,EAAO,QACPO,GACEL,KAAKC,MAEHiB,GAAQC,EAAAA,EAAAA,IAAS,CAACF,WAAUD,qBAElC,MAAO,CACL,CACE,UACC,aAAYlB,KAAWC,cAAwBqB,mBAC9Cf,cAEF,CAACa,UAGP,CAEAG,gBACE,OAAOrB,KAAKsB,YACd,CAEAC,gBACE,MAAM,QAACf,EAAO,iBAAEgB,EAAgB,QAAEC,GAAWzB,KAAK0B,OAC5C,kBAACd,GAAqBZ,KAAKC,MAEjC,GAAIwB,EACF,OAAOE,EAAAA,EAAAA,IAACC,EAAAA,EAAgB,IAG1B,IAAKpB,EAAQqB,OACX,OACEF,EAAAA,EAAAA,IAACG,EAAAA,EAAU,CAAAC,SACPnB,GAEET,EAAAA,EAAAA,GACE,0EACAS,EAAkBC,OAHpBV,EAAAA,EAAAA,GAAE,wDASZ,MAAM6B,GAAsBC,EAAAA,EAAAA,IAAuBzB,GAC7C0B,GAAgBC,EAAAA,EAAAA,IAAiBC,OAAOC,KAAKL,IAEnD,OACEM,EAAAA,EAAAA,IAACC,EAAAA,SAAQ,CAAAR,SAAA,CACNG,EAAcM,KAAIC,IACjBH,EAAAA,EAAAA,IAACI,EAAAA,EAAK,CAAAX,SAAA,EACJJ,EAAAA,EAAAA,IAACgB,EAAAA,EAAW,CAAAZ,SAAEU,KACdd,EAAAA,EAAAA,IAACiB,EAAAA,EAAS,CAAAb,SACPC,EAAoBS,IAAWD,KAAIK,IAClClB,EAAAA,EAAAA,IAACmB,EAAAA,EAAS,CAAiBD,OAAQA,GAAnBA,EAAOE,UAJjBN,MASdd,EAAAA,EAAAA,IAACqB,EAAAA,EAAU,CAACC,UAAWzB,MAG7B,CAEAF,aACE,MAAM,SAACL,EAAQ,OAAEiC,EAAM,kBAAEtC,EAAiB,aAAEuC,GAAgBnD,KAAKC,MAEjE,OACEqC,EAAAA,EAAAA,IAACC,EAAAA,SAAQ,CAAAR,SAAA,CACNoB,EAAatB,OAAS,IACrBF,EAAAA,EAAAA,IAACyB,EAAAA,EAAkB,CACjBC,aAAcF,EACdnC,iBAAkBJ,EAClBK,SAAUA,EACViC,OAAQA,IAGXlD,KAAKuB,kBAGZ,CAEA+B,kBACE,OACE3B,EAAAA,EAAAA,IAAC4B,EAAAA,GAAW,CAAAxB,UACVJ,EAAAA,EAAAA,IAAC4B,EAAAA,GAAW,CAACC,WAAS,EAAAzB,SAAExB,MAAM+C,qBAGpC,EAGF,SAAeG,EAAAA,EAAAA,GAAiB/D,E","sources":["webpack:///./app/views/releases/detail/commitsAndFiles/commits.tsx"],"sourcesContent":["import {Fragment} from 'react';\nimport {RouteComponentProps} from 'react-router';\nimport {Location} from 'history';\n\nimport {CommitRow} from 'sentry/components/commitRow';\nimport * as Layout from 'sentry/components/layouts/thirds';\nimport LoadingIndicator from 'sentry/components/loadingIndicator';\nimport Pagination from 'sentry/components/pagination';\nimport Panel from 'sentry/components/panels/panel';\nimport PanelBody from 'sentry/components/panels/panelBody';\nimport PanelHeader from 'sentry/components/panels/panelHeader';\nimport {t} from 'sentry/locale';\nimport {Commit, Organization, Project, Repository} from 'sentry/types';\nimport {formatVersion} from 'sentry/utils/formatters';\nimport routeTitleGen from 'sentry/utils/routeTitle';\nimport DeprecatedAsyncView from 'sentry/views/deprecatedAsyncView';\n\nimport {getCommitsByRepository, getQuery, getReposToRender} from '../utils';\n\nimport EmptyState from './emptyState';\nimport RepositorySwitcher from './repositorySwitcher';\nimport withReleaseRepos from './withReleaseRepos';\n\ntype Props = RouteComponentProps<{release: string}, {}> & {\n  location: Location;\n  orgSlug: Organization['slug'];\n  projectSlug: Project['slug'];\n  release: string;\n  releaseRepos: Repository[];\n  activeReleaseRepo?: Repository;\n} & DeprecatedAsyncView['props'];\n\ntype State = {\n  commits: Commit[];\n} & DeprecatedAsyncView['state'];\n\nclass Commits extends DeprecatedAsyncView<Props, State> {\n  getTitle() {\n    const {params, orgSlug, projectSlug} = this.props;\n\n    return routeTitleGen(\n      t('Commits - Release %s', formatVersion(params.release)),\n      orgSlug,\n      false,\n      projectSlug\n    );\n  }\n\n  getDefaultState(): State {\n    return {\n      ...super.getDefaultState(),\n      commits: [],\n    };\n  }\n\n  componentDidUpdate(prevProps: Props, prevState: State) {\n    if (prevProps.activeReleaseRepo?.name !== this.props.activeReleaseRepo?.name) {\n      this.remountComponent();\n      return;\n    }\n    super.componentDidUpdate(prevProps, prevState);\n  }\n\n  getEndpoints(): ReturnType<DeprecatedAsyncView['getEndpoints']> {\n    const {\n      projectSlug,\n      activeReleaseRepo: activeRepository,\n      location,\n      orgSlug,\n      release,\n    } = this.props;\n\n    const query = getQuery({location, activeRepository});\n\n    return [\n      [\n        'commits',\n        `/projects/${orgSlug}/${projectSlug}/releases/${encodeURIComponent(\n          release\n        )}/commits/`,\n        {query},\n      ],\n    ];\n  }\n\n  renderLoading() {\n    return this.renderBody();\n  }\n\n  renderContent() {\n    const {commits, commitsPageLinks, loading} = this.state;\n    const {activeReleaseRepo} = this.props;\n\n    if (loading) {\n      return <LoadingIndicator />;\n    }\n\n    if (!commits.length) {\n      return (\n        <EmptyState>\n          {!activeReleaseRepo\n            ? t('There are no commits associated with this release.')\n            : t(\n                'There are no commits associated with this release in the %s repository.',\n                activeReleaseRepo.name\n              )}\n        </EmptyState>\n      );\n    }\n\n    const commitsByRepository = getCommitsByRepository(commits);\n    const reposToRender = getReposToRender(Object.keys(commitsByRepository));\n\n    return (\n      <Fragment>\n        {reposToRender.map(repoName => (\n          <Panel key={repoName}>\n            <PanelHeader>{repoName}</PanelHeader>\n            <PanelBody>\n              {commitsByRepository[repoName]?.map(commit => (\n                <CommitRow key={commit.id} commit={commit} />\n              ))}\n            </PanelBody>\n          </Panel>\n        ))}\n        <Pagination pageLinks={commitsPageLinks} />\n      </Fragment>\n    );\n  }\n\n  renderBody() {\n    const {location, router, activeReleaseRepo, releaseRepos} = this.props;\n\n    return (\n      <Fragment>\n        {releaseRepos.length > 1 && (\n          <RepositorySwitcher\n            repositories={releaseRepos}\n            activeRepository={activeReleaseRepo}\n            location={location}\n            router={router}\n          />\n        )}\n        {this.renderContent()}\n      </Fragment>\n    );\n  }\n\n  renderComponent() {\n    return (\n      <Layout.Body>\n        <Layout.Main fullWidth>{super.renderComponent()}</Layout.Main>\n      </Layout.Body>\n    );\n  }\n}\n\nexport default withReleaseRepos(Commits);\n"],"names":["Commits","DeprecatedAsyncView","getTitle","params","orgSlug","projectSlug","this","props","routeTitleGen","t","formatVersion","release","getDefaultState","super","commits","componentDidUpdate","prevProps","prevState","activeReleaseRepo","name","remountComponent","getEndpoints","activeRepository","location","query","getQuery","encodeURIComponent","renderLoading","renderBody","renderContent","commitsPageLinks","loading","state","_jsx","LoadingIndicator","length","EmptyState","children","commitsByRepository","getCommitsByRepository","reposToRender","getReposToRender","Object","keys","_jsxs","Fragment","map","repoName","Panel","PanelHeader","PanelBody","commit","CommitRow","id","Pagination","pageLinks","router","releaseRepos","RepositorySwitcher","repositories","renderComponent","Layout","fullWidth","withReleaseRepos"],"sourceRoot":""}