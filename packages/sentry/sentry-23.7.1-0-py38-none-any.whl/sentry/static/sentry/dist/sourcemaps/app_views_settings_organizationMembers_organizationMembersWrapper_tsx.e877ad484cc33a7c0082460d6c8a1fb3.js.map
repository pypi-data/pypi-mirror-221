{"version":3,"file":"chunks/app_views_settings_organizationMembers_organizationMembersWrapper_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/utils/routeTitle.tsx","webpack:///./app/views/deprecatedAsyncView.tsx","webpack:///./app/views/settings/organizationMembers/organizationMembersWrapper.tsx"],"sourcesContent":["function routeTitleGen(\n  routeName: string,\n  orgSlug: string,\n  withSentry: boolean = true,\n  projectSlug?: string\n): string {\n  const tmplBase = `${routeName} - ${orgSlug}`;\n  const tmpl = projectSlug ? `${tmplBase} - ${projectSlug}` : tmplBase;\n\n  return withSentry ? `${tmpl} - Sentry` : tmpl;\n}\n\nexport default routeTitleGen;\n","import DeprecatedAsyncComponent from 'sentry/components/deprecatedAsyncComponent';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\n\nexport type AsyncViewState = DeprecatedAsyncComponent['state'];\nexport type AsyncViewProps = DeprecatedAsyncComponent['props'];\n\n/**\n * @deprecated use useApiQuery instead.\n *\n * Read the dev docs page on network requests for more information [1].\n *\n * [1]: https://develop.sentry.dev/frontend/network-requests/\n */\nexport default class DeprecatedAsyncView<\n  P extends AsyncViewProps = AsyncViewProps,\n  S extends AsyncViewState = AsyncViewState\n> extends DeprecatedAsyncComponent<P, S> {\n  getTitle() {\n    return '';\n  }\n\n  render() {\n    return (\n      <SentryDocumentTitle title={this.getTitle()}>\n        {this.renderComponent() as React.ReactChild}\n      </SentryDocumentTitle>\n    );\n  }\n}\n","import {cloneElement, Fragment} from 'react';\nimport {RouteComponentProps} from 'react-router';\n\nimport {openInviteMembersModal} from 'sentry/actionCreators/modal';\nimport FeatureDisabled from 'sentry/components/acl/featureDisabled';\nimport {Button} from 'sentry/components/button';\nimport HookOrDefault from 'sentry/components/hookOrDefault';\nimport {Hovercard} from 'sentry/components/hovercard';\nimport {IconMail} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport {Member, Organization} from 'sentry/types';\nimport routeTitleGen from 'sentry/utils/routeTitle';\nimport withOrganization from 'sentry/utils/withOrganization';\nimport DeprecatedAsyncView from 'sentry/views/deprecatedAsyncView';\nimport SettingsPageHeader from 'sentry/views/settings/components/settingsPageHeader';\n\ntype Props = {\n  organization: Organization;\n  children?: any;\n} & RouteComponentProps<{}, {}>;\n\ntype State = DeprecatedAsyncView['state'] & {\n  inviteRequests: Member[];\n};\n\nconst InviteMembersButtonHook = HookOrDefault({\n  hookName: 'member-invite-button:customization',\n  defaultComponent: ({children, organization, onTriggerModal}) =>\n    children({\n      disabled: !organization.features.includes('invite-members'),\n      onTriggerModal,\n    }),\n});\n\nclass OrganizationMembersWrapper extends DeprecatedAsyncView<Props, State> {\n  getEndpoints(): ReturnType<DeprecatedAsyncView['getEndpoints']> {\n    const {organization} = this.props;\n\n    return [\n      ['inviteRequests', `/organizations/${organization.slug}/invite-requests/`],\n      ['requestList', `/organizations/${organization.slug}/access-requests/`],\n    ];\n  }\n\n  getTitle() {\n    const {organization} = this.props;\n    return routeTitleGen(t('Members'), organization.slug, false);\n  }\n\n  get onRequestsTab() {\n    return location.pathname.includes('/requests/');\n  }\n\n  get hasWriteAccess() {\n    const {organization} = this.props;\n    if (!organization || !organization.access) {\n      return false;\n    }\n    return organization.access.includes('member:write');\n  }\n\n  get showInviteRequests() {\n    return this.hasWriteAccess;\n  }\n\n  get showNavTabs() {\n    const {requestList} = this.state;\n\n    // show the requests tab if there are pending team requests,\n    // or if the user has access to approve or deny invite requests\n    return (requestList && requestList.length > 0) || this.showInviteRequests;\n  }\n\n  get requestCount() {\n    const {requestList, inviteRequests} = this.state;\n    let count = requestList.length;\n\n    // if the user can't see the invite requests panel,\n    // exclude those requests from the total count\n    if (this.showInviteRequests) {\n      count += inviteRequests.length;\n    }\n    return count ? count.toString() : null;\n  }\n\n  removeAccessRequest = (id: string) =>\n    this.setState(state => ({\n      requestList: state.requestList.filter(request => request.id !== id),\n    }));\n\n  removeInviteRequest = (id: string) =>\n    this.setState(state => ({\n      inviteRequests: state.inviteRequests.filter(request => request.id !== id),\n    }));\n\n  updateInviteRequest = (id: string, data: Partial<Member>) =>\n    this.setState(state => {\n      const inviteRequests = [...state.inviteRequests];\n      const inviteIndex = inviteRequests.findIndex(request => request.id === id);\n\n      inviteRequests[inviteIndex] = {...inviteRequests[inviteIndex], ...data};\n\n      return {inviteRequests};\n    });\n\n  renderBody() {\n    const {children, organization} = this.props;\n    const {requestList, inviteRequests} = this.state;\n\n    const action = (\n      <InviteMembersButtonHook\n        organization={organization}\n        onTriggerModal={() =>\n          openInviteMembersModal({\n            onClose: () => {\n              this.fetchData();\n            },\n            source: 'members_settings',\n          })\n        }\n      >\n        {renderInviteMembersButton}\n      </InviteMembersButtonHook>\n    );\n\n    return (\n      <Fragment>\n        <SettingsPageHeader title=\"Members\" action={action} />\n        {children &&\n          cloneElement(children, {\n            requestList,\n            inviteRequests,\n            onRemoveInviteRequest: this.removeInviteRequest,\n            onUpdateInviteRequest: this.updateInviteRequest,\n            onRemoveAccessRequest: this.removeAccessRequest,\n            showInviteRequests: this.showInviteRequests,\n          })}\n      </Fragment>\n    );\n  }\n}\n\nfunction renderInviteMembersButton({\n  disabled,\n  onTriggerModal,\n}: {\n  onTriggerModal: () => void;\n  disabled?: boolean;\n}) {\n  const action = (\n    <Button\n      priority=\"primary\"\n      size=\"sm\"\n      onClick={onTriggerModal}\n      data-test-id=\"email-invite\"\n      icon={<IconMail />}\n      disabled={disabled}\n    >\n      {t('Invite Members')}\n    </Button>\n  );\n\n  return disabled ? (\n    <Hovercard\n      body={\n        <FeatureDisabled\n          featureName={t('Invite Members')}\n          features={['organizations:invite-members']}\n          hideHelpToggle\n        />\n      }\n    >\n      {action}\n    </Hovercard>\n  ) : (\n    action\n  );\n}\n\nexport default withOrganization(OrganizationMembersWrapper);\n"],"names":["routeName","orgSlug","projectSlug","arguments","length","undefined","tmplBase","tmpl","DeprecatedAsyncView","DeprecatedAsyncComponent","getTitle","render","_jsx","SentryDocumentTitle","title","this","children","renderComponent","displayName","InviteMembersButtonHook","HookOrDefault","hookName","defaultComponent","_ref","organization","onTriggerModal","disabled","features","includes","OrganizationMembersWrapper","constructor","_defineProperty","id","setState","state","requestList","filter","request","inviteRequests","data","inviteIndex","findIndex","getEndpoints","props","slug","routeTitleGen","t","onRequestsTab","location","pathname","hasWriteAccess","access","showInviteRequests","showNavTabs","requestCount","count","toString","renderBody","action","openInviteMembersModal","onClose","fetchData","source","renderInviteMembersButton","_jsxs","Fragment","SettingsPageHeader","cloneElement","onRemoveInviteRequest","removeInviteRequest","onUpdateInviteRequest","updateInviteRequest","onRemoveAccessRequest","removeAccessRequest","_ref2","Button","priority","size","onClick","icon","IconMail","Hovercard","body","FeatureDisabled","featureName","hideHelpToggle","withOrganization"],"sourceRoot":""}