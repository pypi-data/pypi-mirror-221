{"version":3,"file":"chunks/app_views_settings_projectSecurityHeaders_hpkp_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/panels/panelHeader.tsx","webpack:///./app/components/previewFeature.tsx","webpack:///./app/utils/routeTitle.tsx","webpack:///./app/views/deprecatedAsyncView.tsx","webpack:///./app/views/settings/projectSecurityHeaders/hpkp.tsx","webpack:///./app/views/settings/projectSecurityHeaders/reportUri.tsx"],"sourcesContent":["import {css} from '@emotion/react';\nimport styled from '@emotion/styled';\n\nimport {space} from 'sentry/styles/space';\n\ntype Props = {\n  /**\n   * Do not add padding to left and right of the header\n   */\n  disablePadding?: boolean;\n  /**\n   * Usually we place controls at the right of a panel header, to make the\n   * spacing between the edges correct we will want less padding on the right.\n   * Use this when the panel has something such as buttons living there.\n   */\n  hasButtons?: boolean;\n  /**\n   * Use light text\n   */\n  lightText?: boolean;\n};\n\nconst getPadding = ({disablePadding, hasButtons}: Props) => css`\n  padding: ${hasButtons ? space(1) : space(2)} ${disablePadding ? 0 : space(2)};\n`;\n\nconst PanelHeader = styled('div')<Props>`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  color: ${p => (p.lightText ? p.theme.gray300 : p.theme.gray400)};\n  font-size: ${p => p.theme.fontSizeSmall};\n  font-weight: 600;\n  text-transform: uppercase;\n  border-bottom: 1px solid ${p => p.theme.border};\n  border-radius: calc(${p => p.theme.panelBorderRadius} - 1px)\n    calc(${p => p.theme.panelBorderRadius} - 1px) 0 0;\n  background: ${p => p.theme.backgroundSecondary};\n  line-height: 1;\n  position: relative;\n  ${getPadding};\n`;\n\nexport default PanelHeader;\n","import type {AlertProps} from 'sentry/components/alert';\nimport {Alert} from 'sentry/components/alert';\nimport {t} from 'sentry/locale';\n\ntype Props = {\n  type?: AlertProps['type'];\n};\n\nfunction PreviewFeature({type = 'info'}: Props) {\n  return (\n    <Alert type={type} showIcon>\n      {t(\n        'This feature is a preview and may change in the future. Thanks for being an early adopter!'\n      )}\n    </Alert>\n  );\n}\n\nexport default PreviewFeature;\n","function routeTitleGen(\n  routeName: string,\n  orgSlug: string,\n  withSentry: boolean = true,\n  projectSlug?: string\n): string {\n  const tmplBase = `${routeName} - ${orgSlug}`;\n  const tmpl = projectSlug ? `${tmplBase} - ${projectSlug}` : tmplBase;\n\n  return withSentry ? `${tmpl} - Sentry` : tmpl;\n}\n\nexport default routeTitleGen;\n","import DeprecatedAsyncComponent from 'sentry/components/deprecatedAsyncComponent';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\n\nexport type AsyncViewState = DeprecatedAsyncComponent['state'];\nexport type AsyncViewProps = DeprecatedAsyncComponent['props'];\n\n/**\n * @deprecated use useApiQuery instead.\n *\n * Read the dev docs page on network requests for more information [1].\n *\n * [1]: https://develop.sentry.dev/frontend/network-requests/\n */\nexport default class DeprecatedAsyncView<\n  P extends AsyncViewProps = AsyncViewProps,\n  S extends AsyncViewState = AsyncViewState\n> extends DeprecatedAsyncComponent<P, S> {\n  getTitle() {\n    return '';\n  }\n\n  render() {\n    return (\n      <SentryDocumentTitle title={this.getTitle()}>\n        {this.renderComponent() as React.ReactChild}\n      </SentryDocumentTitle>\n    );\n  }\n}\n","import {RouteComponentProps} from 'react-router';\n\nimport ExternalLink from 'sentry/components/links/externalLink';\nimport Panel from 'sentry/components/panels/panel';\nimport PanelBody from 'sentry/components/panels/panelBody';\nimport PanelHeader from 'sentry/components/panels/panelHeader';\nimport PreviewFeature from 'sentry/components/previewFeature';\nimport {t, tct} from 'sentry/locale';\nimport {Organization, ProjectKey} from 'sentry/types';\nimport routeTitleGen from 'sentry/utils/routeTitle';\nimport withOrganization from 'sentry/utils/withOrganization';\nimport DeprecatedAsyncView from 'sentry/views/deprecatedAsyncView';\nimport SettingsPageHeader from 'sentry/views/settings/components/settingsPageHeader';\nimport ReportUri, {\n  getSecurityDsn,\n} from 'sentry/views/settings/projectSecurityHeaders/reportUri';\n\ntype Props = RouteComponentProps<{projectId: string}, {}> & {\n  organization: Organization;\n};\n\ntype State = {\n  keyList: null | ProjectKey[];\n} & DeprecatedAsyncView['state'];\n\nclass ProjectHpkpReports extends DeprecatedAsyncView<Props, State> {\n  getEndpoints(): ReturnType<DeprecatedAsyncView['getEndpoints']> {\n    const {organization} = this.props;\n    const {projectId} = this.props.params;\n    return [['keyList', `/projects/${organization.slug}/${projectId}/keys/`]];\n  }\n\n  getTitle() {\n    const {projectId} = this.props.params;\n    return routeTitleGen(t('HTTP Public Key Pinning (HPKP)'), projectId, false);\n  }\n\n  getInstructions(keyList: ProjectKey[]) {\n    return (\n      'def middleware(request, response):\\n' +\n      \"    response['Public-Key-Pins'] = \\\\\\n\" +\n      '        \\'pin-sha256=\"cUPcTAZWKaASuYWhhneDttWpY3oBAkE3h2+soZS7sWs=\"; \\' \\\\\\n' +\n      '        \\'pin-sha256=\"M8HztCzM3elUxkcjR2S5P4hhyBNf6lHkmjAHKhpGPWE=\"; \\' \\\\\\n' +\n      \"        'max-age=5184000; includeSubDomains; ' \\\\\\n\" +\n      `        \\'report-uri=\"${getSecurityDsn(keyList)}\"\\' \\n` +\n      '    return response\\n'\n    );\n  }\n\n  getReportOnlyInstructions(keyList: ProjectKey[]) {\n    return (\n      'def middleware(request, response):\\n' +\n      \"    response['Public-Key-Pins-Report-Only'] = \\\\\\n\" +\n      '        \\'pin-sha256=\"cUPcTAZWKaASuYWhhneDttWpY3oBAkE3h2+soZS7sWs=\"; \\' \\\\\\n' +\n      '        \\'pin-sha256=\"M8HztCzM3elUxkcjR2S5P4hhyBNf6lHkmjAHKhpGPWE=\"; \\' \\\\\\n' +\n      \"        'max-age=5184000; includeSubDomains; ' \\\\\\n\" +\n      `        \\'report-uri=\"${getSecurityDsn(keyList)}\"\\' \\n` +\n      '    return response\\n'\n    );\n  }\n\n  renderBody() {\n    const {organization, params} = this.props;\n    const {keyList} = this.state;\n    if (!keyList) {\n      return null;\n    }\n\n    return (\n      <div>\n        <SettingsPageHeader title={t('HTTP Public Key Pinning')} />\n\n        <PreviewFeature />\n\n        <ReportUri\n          keyList={keyList}\n          orgId={organization.slug}\n          projectId={params.projectId}\n        />\n\n        <Panel>\n          <PanelHeader>{t('About')}</PanelHeader>\n\n          <PanelBody withPadding>\n            <p>\n              {tct(\n                `[link:HTTP Public Key Pinning]\n              (HPKP) is a security feature that tells a web client to associate a specific\n              cryptographic public key with a certain web server to decrease the risk of MITM\n              attacks with forged certificates. It's enforced by browser vendors, and Sentry\n              supports capturing violations using the standard reporting hooks.`,\n                {\n                  link: (\n                    <ExternalLink href=\"https://en.wikipedia.org/wiki/HTTP_Public_Key_Pinning\" />\n                  ),\n                }\n              )}\n            </p>\n\n            <p>\n              {t(\n                `To configure HPKP reports\n              in Sentry, you'll need to send a header from your server describing your\n              policy, as well specifying the authenticated Sentry endpoint.`\n              )}\n            </p>\n\n            <p>\n              {t(\n                'For example, in Python you might achieve this via a simple web middleware'\n              )}\n            </p>\n            <pre>{this.getInstructions(keyList)}</pre>\n\n            <p>\n              {t(`Alternatively you can setup HPKP reports to simply send reports rather than\n              actually enforcing the policy`)}\n            </p>\n            <pre>{this.getReportOnlyInstructions(keyList)}</pre>\n\n            <p>\n              {tct(\n                `We recommend setting this up to only run on a percentage of requests, as\n              otherwise you may find that you've quickly exhausted your quota. For more\n              information, take a look at [link:the documentation on MDN].`,\n                {\n                  link: (\n                    <ExternalLink href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Public_Key_Pinning\" />\n                  ),\n                }\n              )}\n            </p>\n          </PanelBody>\n        </Panel>\n      </div>\n    );\n  }\n}\n\nexport default withOrganization(ProjectHpkpReports);\n","import FieldGroup from 'sentry/components/forms/fieldGroup';\nimport Link from 'sentry/components/links/link';\nimport Panel from 'sentry/components/panels/panel';\nimport PanelAlert from 'sentry/components/panels/panelAlert';\nimport PanelBody from 'sentry/components/panels/panelBody';\nimport PanelHeader from 'sentry/components/panels/panelHeader';\nimport TextCopyInput from 'sentry/components/textCopyInput';\nimport {t, tct} from 'sentry/locale';\nimport {ProjectKey} from 'sentry/types';\nimport getDynamicText from 'sentry/utils/getDynamicText';\n\nconst DEFAULT_ENDPOINT = 'https://sentry.example.com/api/security-report/';\n\nexport function getSecurityDsn(keyList: ProjectKey[]) {\n  const endpoint = keyList.length ? keyList[0].dsn.security : DEFAULT_ENDPOINT;\n  return getDynamicText({\n    value: endpoint,\n    fixed: DEFAULT_ENDPOINT,\n  });\n}\n\ntype Props = {\n  keyList: ProjectKey[];\n  orgId: string;\n  projectId: string;\n};\n\nexport default function ReportUri({keyList, orgId, projectId}: Props) {\n  return (\n    <Panel>\n      <PanelHeader>{t('Report URI')}</PanelHeader>\n      <PanelBody>\n        <PanelAlert type=\"info\">\n          {tct(\n            \"We've automatically pulled these credentials from your available [link:Client Keys]\",\n            {\n              link: <Link to={`/settings/${orgId}/projects/${projectId}/keys/`} />,\n            }\n          )}\n        </PanelAlert>\n        <FieldGroup inline={false} flexibleControlStateSize>\n          <TextCopyInput>{getSecurityDsn(keyList)}</TextCopyInput>\n        </FieldGroup>\n      </PanelBody>\n    </Panel>\n  );\n}\n"],"names":["getPadding","_ref","disablePadding","hasButtons","css","space","_styled","target","p","lightText","theme","gray300","gray400","fontSizeSmall","border","panelBorderRadius","backgroundSecondary","PreviewFeature","type","_jsx","Alert","showIcon","children","t","displayName","routeName","orgSlug","projectSlug","arguments","length","undefined","tmplBase","tmpl","DeprecatedAsyncView","DeprecatedAsyncComponent","getTitle","render","SentryDocumentTitle","title","this","renderComponent","ProjectHpkpReports","getEndpoints","organization","props","projectId","params","slug","routeTitleGen","getInstructions","keyList","getSecurityDsn","getReportOnlyInstructions","renderBody","state","_jsxs","SettingsPageHeader","ReportUri","orgId","Panel","PanelHeader","PanelBody","withPadding","tct","link","ExternalLink","href","withOrganization","DEFAULT_ENDPOINT","endpoint","dsn","security","getDynamicText","value","fixed","PanelAlert","Link","to","FieldGroup","inline","flexibleControlStateSize","TextCopyInput"],"sourceRoot":""}