"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_replays_replayPlayer_tsx-app_utils_replays_hooks_useReplayReader_tsx-app_views-15e39a"],{"./app/components/replays/replayPlayer.tsx":(e,t,r)=>{r.d(t,{Z:()=>z});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=r("../node_modules/react/index.js"),i=r("../node_modules/@react-aria/utils/dist/import.mjs"),n=r("./app/components/loadingIndicator.tsx"),o=r("./app/icons/index.tsx"),l=r("./app/locale.tsx"),d=r("./app/styles/space.tsx"),c=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e){let{className:t}=e;return(0,c.tZ)(p,{className:t,children:(0,c.BX)(u,{children:[(0,c.tZ)(o.jo,{size:"sm"}),(0,l.t)("Buffering...")]})})}m.displayName="BufferingOverlay";const p=(0,s.Z)("div",{target:"e1339gql1"})({name:"1p9eycc",styles:"user-select:none;display:grid;place-items:center"}),u=(0,s.Z)("div",{target:"e1339gql0"})("display:grid;grid-template-columns:max-content max-content;gap:",(0,d.D)(.75),";place-items:center;padding:",(0,d.D)(3),";background:",(e=>e.theme.gray300),";border-radius:",(e=>e.theme.borderRadius),";color:",(e=>e.theme.white),";z-index:",(e=>e.theme.zIndex.initial),";"),h=m;var g=r("./app/components/tooltip.tsx");function y(e){let{speed:t,className:r}=e;return(0,c.tZ)(f,{className:r,children:(0,c.BX)(b,{title:(0,l.t)("Fast forwarding at %sx",t),children:[(0,l.t)("Fast forwarding through inactivity"),(0,c.tZ)(o.CC,{size:"sm",direction:"right"})]})})}y.displayName="FastForwardBadge";const f=(0,s.Z)("div",{target:"e1a5fqdb1"})({name:"8y7axy",styles:"user-select:none;display:grid;align-items:end;justify-items:start"}),b=(0,s.Z)(g.u,{target:"e1a5fqdb0"})("display:grid;grid-template-columns:max-content max-content;gap:",(0,d.D)(.5),";align-items:center;background:",(e=>e.theme.gray300),";color:",(e=>e.theme.white),";padding:",(0,d.D)(1.5)," ",(0,d.D)(2),";border-top-right-radius:",(e=>e.theme.borderRadius),";z-index:",(e=>e.theme.zIndex.initial),";"),x=y;var w=r("./app/components/replays/replayContext.tsx"),v=r("./app/utils/analytics.tsx"),Z=r("./app/utils/useOrganization.tsx"),_=r("./app/components/button.tsx"),S=r("./app/utils/useDismissAlert.tsx");function k(){const{dismiss:e,isDismissed:t}=(0,S.Z)({key:"replay-player-dom-alert-dismissed"});return t?null:(0,c.tZ)(F,{"data-test-id":"player-dom-alert",children:(0,c.BX)(T,{children:[(0,c.tZ)(D,{size:"xs"}),(0,c.tZ)("div",{children:(0,l.t)("Right click & inspect your appâ€™s DOM with your browser")}),(0,c.tZ)(R,{priority:"link",size:"sm",icon:(0,c.tZ)(o.bM,{size:"xs"}),"aria-label":(0,l.t)("Close Alert"),onClick:e})]})})}k.displayName="PlayerDOMAlert";const M=k,F=(0,s.Z)("div",{target:"e138qk33"})("position:absolute;bottom:",(0,d.D)(1),";left:0;width:100%;text-align:center;font-size:",(e=>e.theme.fontSizeMedium),";pointer-events:none;"),T=(0,s.Z)("div",{target:"e138qk32"})("display:inline-flex;align-items:flex-start;justify-items:center;padding:",(0,d.D)(1)," ",(0,d.D)(2),";margin:0 ",(0,d.D)(1),";color:",(e=>e.theme.white),";background-color:",(e=>e.theme.blue400),";border-radius:",(e=>e.theme.borderRadius),";gap:0 ",(0,d.D)(1),";line-height:1em;"),D=(0,s.Z)(o.aU,{target:"e138qk31"})({name:"n27fom",styles:"margin-top:1px;min-width:12px"}),R=(0,s.Z)(_.zx,{target:"e138qk30"})("color:",(e=>e.theme.white),";pointer-events:all;&:hover{color:",(e=>e.theme.white),";opacity:0.5;}");function I(e){let{className:t,isPreview:r=!1}=e;const{dimensions:s,fastForwardSpeed:n,initRoot:o,isBuffering:l,isFetching:d}=(0,w.M)(),m=(0,a.useRef)(null),p=(0,a.useRef)(null),[u,h]=(0,a.useState)({width:0,height:0});!function(e){let{videoDimensions:t,windowDimensions:r}=e;const s=(0,Z.Z)(),[i,n]=(0,a.useState)(!1);(0,a.useEffect)((()=>{if(i||0===t.width&&0===t.height)return;const e=t.width>t.height?"landscape":"portrait",a=Math.min(r.width/t.width,r.height/t.height,1),o=10*Math.floor(10*a);(0,v.Gi)("replay.render-player",{organization:s,aspect_ratio:e,scale_bucket:o}),n(!0)}),[s,r,t,i])}({videoDimensions:s,windowDimensions:u}),(0,a.useEffect)((()=>o(p.current)),[o]);const g=(0,a.useCallback)((()=>h({width:m.current?.clientWidth||0,height:m.current?.clientHeight||0})),[h]);return(0,i.yU)({ref:m,onResize:g}),(0,a.useEffect)((()=>{void 0===window.ResizeObserver&&g()}),[g]),(0,a.useEffect)((()=>{if(p.current){const e=Math.min(u.width/s.width,u.height/s.height,1);e&&(p.current.style["transform-origin"]="top left",p.current.style.transform=`scale(${e})`,p.current.style.width=s.width*e+"px",p.current.style.height=s.height*e+"px")}}),[u,s]),(0,c.BX)(E,{ref:m,className:"sentry-block",children:[(0,c.tZ)("div",{ref:p,className:t}),n?(0,c.tZ)(N,{speed:n}):null,l?(0,c.tZ)(j,{}):null,r?null:(0,c.tZ)(M,{}),d?(0,c.tZ)(C,{}):null]})}I.displayName="BasePlayerRoot";const E=(0,s.Z)("div",{target:"egqkti35"})("width:100%;display:flex;flex-grow:1;justify-content:center;align-items:center;position:relative;overflow:hidden;background-color:",(e=>e.theme.backgroundSecondary),";background-image:repeating-linear-gradient(\n      -145deg,\n      transparent,\n      transparent 8px,\n      ",(e=>e.theme.backgroundSecondary)," 8px,\n      ",(e=>e.theme.backgroundSecondary)," 11px\n    ),repeating-linear-gradient(\n      -45deg,\n      transparent,\n      transparent 15px,\n      ",(e=>e.theme.gray100)," 15px,\n      ",(e=>e.theme.gray100)," 16px\n    );"),N=(0,s.Z)(x,{target:"egqkti34"})({name:"m4y3yb",styles:"position:absolute;left:0;bottom:0"}),j=(0,s.Z)(h,{target:"egqkti33"})({name:"j2pfbl",styles:"position:absolute;top:0;left:0;right:0;bottom:0"}),C=(0,s.Z)(n.Z,{target:"egqkti32"})({name:"a4hmbt",styles:"position:absolute"}),A=(0,s.Z)(I,{target:"egqkti31"})({name:"1ak6w60",styles:".replayer-wrapper{user-select:none;}.replayer-wrapper>.replayer-mouse{pointer-events:none;}.replayer-wrapper>.replayer-mouse-tail{position:absolute;pointer-events:none;}.replayer-wrapper>iframe{border:none;background:white;pointer-events:initial!important;}"}),z=(0,s.Z)(A,{target:"egqkti30"})(".replayer-mouse{position:absolute;width:32px;height:32px;transition:left 0.05s linear,top 0.05s linear;background-size:contain;background-repeat:no-repeat;background-image:url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTkiIHZpZXdCb3g9IjAgMCAxMiAxOSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTAgMTZWMEwxMS42IDExLjZINC44TDQuNCAxMS43TDAgMTZaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNOS4xIDE2LjdMNS41IDE4LjJMMC43OTk5OTkgNy4xTDQuNSA1LjZMOS4xIDE2LjdaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNC42NzQ1MSA4LjYxODUxTDIuODMwMzEgOS4zOTI3MUw1LjkyNzExIDE2Ljc2OTVMNy43NzEzMSAxNS45OTUzTDQuNjc0NTEgOC42MTg1MVoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik0xIDIuNFYxMy42TDQgMTAuN0w0LjQgMTAuNkg5LjJMMSAyLjRaIiBmaWxsPSJibGFjayIvPgo8L3N2Zz4K');border-color:transparent;}.replayer-mouse:after{content:'';display:inline-block;width:32px;height:32px;background:",(e=>e.theme.purple300),";border-radius:100%;transform:translate(-50%, -50%);opacity:0.3;}.replayer-mouse.active:after{animation:click 0.2s ease-in-out 1;}.replayer-mouse.touch-device{background-image:none;width:70px;height:70px;border-radius:100%;margin-left:-37px;margin-top:-37px;border:4px solid rgba(73, 80, 246, 0);transition:left 0s linear,top 0s linear,border-color 0.2s ease-in-out;}.replayer-mouse.touch-device.touch-active{border-color:",(e=>e.theme.purple200),";transition:left 0.25s linear,top 0.25s linear,border-color 0.2s ease-in-out;}.replayer-mouse.touch-device:after{opacity:0;}.replayer-mouse.touch-device.active:after{animation:touch-click 0.2s ease-in-out 1;}@keyframes click{0%{opacity:0.3;width:20px;height:20px;}50%{opacity:0.5;width:10px;height:10px;}}@keyframes touch-click{0%{opacity:0;width:20px;height:20px;}50%{opacity:0.5;width:10px;height:10px;}}")},"./app/utils/replays/hooks/useReplayReader.tsx":(e,t,r)=>{r.d(t,{Z:()=>I});var s=r("../node_modules/react/index.js"),a=r("../node_modules/@sentry/browser/node_modules/@sentry/core/esm/exports.js"),i=r("./app/utils/parseLinkHeader.tsx"),n=r("./app/utils/replays/replayDataUtils.tsx"),o=r("./app/utils/useApi.tsx"),l=r("./app/utils/useProjects.tsx");const d=Object.freeze({fetchError:void 0,fetchingAttachments:!0,fetchingErrors:!0,fetchingReplay:!0}),c=function(e){let{replayId:t,orgSlug:r,errorsPerPage:c=50,segmentsPerPage:m=100}=e;const p=(0,l.Z)(),u=(0,o.Z)(),[h,g]=(0,s.useState)(d),[y,f]=(0,s.useState)([]),b=(0,s.useRef)(new Map),[x,w]=(0,s.useState)([]),[v,Z]=(0,s.useState)(),_=(0,s.useMemo)((()=>v?p.projects.find((e=>e.id===v.project_id))?.slug??null:null),[v,p.projects]),S=(0,s.useCallback)((async()=>{const e=await u.requestPromise(function(e,t){return`/organizations/${e}/replays/${t}/`}(r,t)),s=(0,n.qC)(e.data);Z(s),g((e=>({...e,fetchingReplay:!1})))}),[u,r,t]),k=(0,s.useCallback)((async()=>{if(!v||!_)return;if(!v.count_segments)return void g((e=>({...e,fetchingAttachments:!1})));const e=Math.ceil(v.count_segments/m),t=new Array(e).fill(0).map(((e,t)=>`0:${m*t}:0`));t.forEach((e=>b.current.set(e,[]))),await Promise.allSettled(t.map((e=>{const t=u.requestPromise(`/projects/${r}/${_}/replays/${v.id}/recording-segments/`,{query:{download:!0,per_page:m,cursor:e}});return t.then((t=>{b.current.set(e,t);const r=Array.from(b.current.values()).flat(2);f(r)})),t}))),g((e=>({...e,fetchingAttachments:!1})))}),[m,u,r,v,_]),M=(0,s.useCallback)((async()=>{if(!v)return;const e=new Date(v.finished_at);e.setSeconds(e.getSeconds()+1);const t=function(e,t){try{let{orgSlug:r,start:s,end:a,replayId:n,limit:o=50}=t;return async function*(){let t={cursor:"0:0:0",results:!0,href:""};for(;t&&t.results;){const[{data:d},,c]=await(l=t.cursor,async function(e,t){let{orgSlug:r,start:s,end:a,replayId:i,limit:n=50,cursor:o="0:0:0"}=t;return await e.requestPromise(`/organizations/${r}/replays-events-meta/`,{includeAllArgs:!0,query:{start:s.toISOString(),end:a.toISOString(),query:`replayId:[${i}]`,per_page:n,cursor:o}})}(e,{orgSlug:r,replayId:n,start:s,end:a,limit:o,cursor:l})),m=c?.getResponseHeader("Link")??null;t=(0,i.Z)(m)?.next,yield d}var l}()}catch(e){return Promise.reject(e)}}(u,{orgSlug:r,replayId:v.id,start:v.started_at,end:e,limit:c});for await(const e of t)w((t=>[...t,...e||[]]));g((e=>({...e,fetchingErrors:!1})))}),[u,r,v,c]),F=(0,s.useCallback)((e=>{a.Tb(e),g((t=>({...t,fetchError:e})))}),[]),T=(0,s.useCallback)((()=>S().catch(F)),[S,F]);return(0,s.useEffect)((()=>{T()}),[T]),(0,s.useEffect)((()=>{h.fetchError||M().catch(F)}),[h.fetchError,M,F]),(0,s.useEffect)((()=>{h.fetchError||k().catch(F)}),[h.fetchError,k,F]),{attachments:y,errors:x,fetchError:h.fetchError,fetching:h.fetchingAttachments||h.fetchingErrors||h.fetchingReplay,onRetry:T,projectSlug:_,replayRecord:v}};var m=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),p=(r("../node_modules/core-js/modules/es.array.push.js"),r("../node_modules/core-js/modules/es.array.unshift.js"),r("../node_modules/lodash/memoize.js")),u=r.n(p),h=r("../node_modules/moment/moment.js"),g=r("./app/utils/domId.tsx"),y=r("./app/utils/localStorage.tsx"),f=r("../node_modules/@sentry-internal/rrweb/es/rrweb/packages/rrweb/src/replay/index.js"),b=r("../node_modules/lodash/first.js"),x=r.n(b),w=r("./app/utils/replays/types.tsx");const v=window.requestIdleCallback||function(e){const t=Date.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})}),1)};class Z{constructor(e){let{frames:t,isFinished:r,onFinish:s}=e;(0,m.Z)(this,"frames",void 0),(0,m.Z)(this,"isFinished",void 0),(0,m.Z)(this,"onFinish",void 0),(0,m.Z)(this,"nextExtract",null),(0,m.Z)(this,"activities",[]),this.frames=t,this.isFinished=r,this.onFinish=s}handler(e,t,r){let{replayer:s}=r;e.type===w.tw.FullSnapshot?this.extractNextFrame({replayer:s}):e.type===w.tw.IncrementalSnapshot&&(this.extractCurrentFrame(e,{replayer:s}),this.extractNextFrame({replayer:s})),this.isFinished(e)&&this.onFinish(this.activities)}extractCurrentFrame(e,t){let{replayer:r}=t;const s=x()(this.frames);if(!s||!s?.timestampMs||s.timestampMs>e.timestamp)return;const a=_(s,r)||this.nextExtract;a&&this.activities.push({frame:s,html:a,timestamp:s.timestampMs}),this.nextExtract=null,this.frames.shift()}extractNextFrame(e){let{replayer:t}=e;const r=x()(this.frames);r&&r?.timestampMs&&(this.nextExtract=_(r,t))}}function _(e,t){const r=t.getMirror(),s=e.data?.nodeId??-1,a=r.getNode(s);let i=function(e,t){const r=new DOMParser;try{const t=r.parseFromString(e,"text/html");return S(2,t.body.children),t.body.innerHTML}catch(t){return e}}(a?.outerHTML||a?.textContent||"");return i.length>1500&&(i=i.substring(0,1500)),i}function S(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(let s=0;s<t.length;s++){const a=t[s];"STYLE"===a.nodeName&&(a.textContent="/* Inline CSS */"),"svg"===a.nodeName&&(a.innerHTML="\x3c!-- SVG --\x3e"),e<=r?a.childElementCount>0&&(a.innerHTML=`\x3c!-- ${a.childElementCount} descendents --\x3e`):S(e,a.children,r+1)}}var k=r("../node_modules/invariant/browser.js"),M=r.n(k),F=r("./app/types/breadcrumbs.tsx"),T=r("./app/utils/date/isValidDate.tsx");const D=(e,t)=>e.timestampMs-t.timestampMs;class R{static factory(e){let{attachments:t,errors:r,replayRecord:s}=e;if(!t||!s||!r)return null;try{return new R({attachments:t,errors:r,replayRecord:s})}catch(e){return a.Tb(e),new R({attachments:[],errors:[],replayRecord:s})}}constructor(e){let{attachments:t,errors:r,replayRecord:s}=e;(0,m.Z)(this,"timestampDeltas",{startedAtDelta:0,finishedAtDelta:0}),(0,m.Z)(this,"_cacheKey",void 0),(0,m.Z)(this,"_errors",void 0),(0,m.Z)(this,"_optionFrame",void 0),(0,m.Z)(this,"_sortedBreadcrumbFrames",void 0),(0,m.Z)(this,"_sortedRRWebEvents",void 0),(0,m.Z)(this,"_sortedSpanFrames",void 0),(0,m.Z)(this,"sortedSpans",void 0),(0,m.Z)(this,"replayRecord",void 0),(0,m.Z)(this,"breadcrumbs",void 0),(0,m.Z)(this,"toJSON",(()=>this._cacheKey)),(0,m.Z)(this,"getDurationMs",(()=>this.replayRecord.duration.asMilliseconds())),(0,m.Z)(this,"getReplay",(()=>this.replayRecord)),(0,m.Z)(this,"getRRWebFrames",(()=>this._sortedRRWebEvents)),(0,m.Z)(this,"getErrorFrames",(()=>this._errors)),(0,m.Z)(this,"getConsoleFrames",u()((()=>this._sortedBreadcrumbFrames.filter((e=>"console"===e.category))))),(0,m.Z)(this,"getNavigationFrames",u()((()=>[...this._sortedBreadcrumbFrames.filter((e=>"replay.init"===e.category)),...this._sortedSpanFrames.filter((e=>e.op.startsWith("navigation.")))].sort(D)))),(0,m.Z)(this,"getNetworkFrames",u()((()=>this._sortedSpanFrames.filter((e=>e.op.startsWith("navigation.")||e.op.startsWith("resource.")))))),(0,m.Z)(this,"getDOMFrames",u()((()=>[...this._sortedBreadcrumbFrames.filter((e=>"nodeId"in(e.data??{}))),...this._sortedSpanFrames.filter((e=>"nodeId"in(e.data??{})))]))),(0,m.Z)(this,"getDomNodes",u()((()=>{return e={frames:this.getDOMFrames(),rrwebEvents:this.getRRWebFrames(),finishedAt:this.replayRecord.finished_at},new Promise(((t,r)=>{v((()=>{(function(e){let{frames:t,rrwebEvents:r,finishedAt:s}=e;return!t||!r||r.length<2||!s?Promise.reject():new Promise(((e,i)=>{const n=document.createElement("div");n.className="sentry-block";const{style:o}=n;o.position="fixed",o.inset="0",o.width="0",o.height="0",o.overflow="hidden",document.body.appendChild(n);const l=r[r.length-2],d=new f.x(r,{root:n,loadTimeout:1,showWarning:!1,blockClass:"sentry-block",speed:99999,skipInactive:!0,triggerFocus:!1,plugins:[new Z({frames:t,isFinished:e=>l===e,onFinish:t=>{e(t),setTimeout((()=>{document.body.contains(n)&&document.body.removeChild(n)}),0)}})],mouseTail:!1});try{d.pause(s.getTime())}catch(e){a.Tb(e),i(e)}}))})(e).then(t).catch(r)}),{timeout:2500})}));var e}))),(0,m.Z)(this,"getMemoryFrames",u()((()=>this._sortedSpanFrames.filter((e=>"memory"===e.op))))),(0,m.Z)(this,"getChapterFrames",u()((()=>[...this._sortedBreadcrumbFrames.filter((e=>["navigation","replay.init","replay.mutations","ui.click"].includes(e.category)||"ui.slowClickDetected"===e.category&&((0,w.cq)(e)||(0,w.qY)(e)))),...this._sortedSpanFrames.filter((e=>["navigation.navigate","navigation.reload","navigation.back_forward"].includes(e.op))),...this._errors].sort(D)))),(0,m.Z)(this,"getTimelineFrames",u()((()=>[...this._sortedBreadcrumbFrames.filter((e=>["replay.init","ui.click"].includes(e.category))),...this._sortedSpanFrames.filter((e=>["navigation.navigate","navigation.reload"].includes(e.op))),...this._errors].sort(D)))),(0,m.Z)(this,"getSDKOptions",(()=>this._optionFrame)),(0,m.Z)(this,"isNetworkDetailsSetup",u()((()=>{const e=this.getSDKOptions();return e?e.networkDetailHasUrls:this.getNetworkFrames().some((e=>Object.keys(e?.data?.request?.headers??{}).length||Object.keys(e?.data?.response?.headers??{}).length))}))),(0,m.Z)(this,"getConsoleCrumbs",u()((()=>this.breadcrumbs.filter((e=>"console"===e.category))))),(0,m.Z)(this,"getNonConsoleCrumbs",u()((()=>this.breadcrumbs.filter((e=>"console"!==e.category))))),this._cacheKey=(0,g.Z)("replayReader-");const{breadcrumbFrames:i,optionFrame:o,rrwebFrames:l,spanFrames:d}=function(e){const t=[],r=[],s=[];let a;return e.forEach((e=>{e&&((0,w.UI)(e)?r.push(e.data.payload):(0,w.HY)(e)?s.push(e.data.payload):(0,w.lp)(e)?a=e.data.payload:(0,w.tk)(e)&&t.push(e))})),{breadcrumbFrames:r,optionFrame:a,rrwebFrames:t,spanFrames:s}}(t);if("1"!==y.Z.getItem("REPLAY-BACKEND-TIMESTAMPS")){const{startTimestampMs:e,endTimestampMs:t}=(0,n.iz)(s,l,i,d);this.timestampDeltas={startedAtDelta:e-s.started_at.getTime(),finishedAtDelta:t-s.finished_at.getTime()},s.started_at=new Date(e),s.finished_at=new Date(t),s.duration=(0,h.duration)(s.finished_at.getTime()-s.started_at.getTime())}this.replayRecord=s,this._errors=function(e,t){const r=e.started_at.getTime();return t.map((e=>{try{const t=new Date(e.timestamp);return M()((0,T.Z)(t),"errorFrame.timestamp is invalid"),{category:"issue",data:{eventId:e.id,groupId:e["issue.id"],groupShortId:e.issue,label:(Array.isArray(e["error.type"])?e["error.type"][0]:e["error.type"])??"",labels:e["error.type"],projectSlug:e["project.name"]},message:e.title,offsetMs:Math.abs(t.getTime()-r),timestamp:t,timestampMs:t.getTime(),type:"error"}}catch{return}})).filter(w.rN)}(s,r).sort(D),this._sortedRRWebEvents=l,this._sortedBreadcrumbFrames=function(e,t){const r=e.started_at.getTime();return t.map((e=>{try{const t=new Date(1e3*e.timestamp);return M()((0,T.Z)(t),"breadcrumbFrame.timestamp is invalid"),{...e,offsetMs:Math.abs(t.getTime()-r),timestamp:t,timestampMs:t.getTime()}}catch{return}})).filter(w.zp)}(s,i).sort(D),this._sortedSpanFrames=function(e,t){const r=e.started_at.getTime();return t.map((e=>{try{const t=new Date(1e3*e.startTimestamp),s=new Date(1e3*e.endTimestamp);return M()((0,T.Z)(t),"spanFrame.startTimestamp is invalid"),M()((0,T.Z)(s),"spanFrame.endTimestamp is invalid"),{...e,endTimestamp:s,endTimestampMs:s.getTime(),offsetMs:Math.abs(t.getTime()-r),startTimestamp:t,timestampMs:t.getTime()}}catch{return}})).filter(w.h5)}(s,d).sort(D),this._optionFrame=o,this._sortedBreadcrumbFrames.push(function(e){return{category:"replay.init",message:e.urls?.[0]??e.tags.url?.join(", "),offsetMs:0,timestamp:e.started_at,timestampMs:e.started_at.getTime(),type:F.kS.INIT}}(s)),this._sortedRRWebEvents.unshift(function(e){return{type:w.tw.Custom,timestamp:e.started_at.getTime(),data:{tag:"replay.start",payload:{}}}}(s)),this._sortedRRWebEvents.push(function(e){return{type:w.tw.Custom,timestamp:e.finished_at.getTime(),data:{tag:"replay.end",payload:{}}}}(s));const{rawBreadcrumbs:c,rawRRWebEvents:p,rawNetworkSpans:b,rawMemorySpans:x}=function(e){const t=[],r=[],s=[],a=[];return e.forEach((e=>{if("performanceSpan"===e.data?.tag){const t=e.data?.payload;"memory"===t.op&&a.push(t),(t.op?.startsWith("navigation.")||t.op?.startsWith("resource."))&&s.push(t)}else"breadcrumb"===e.data?.tag?t.push(e?.data?.payload):r.push(e)})),{rawBreadcrumbs:t,rawRRWebEvents:r,rawNetworkSpans:s,rawMemorySpans:a}}(t),_=[...x,...b],{startTimestampMs:S,endTimestampMs:k}=(0,n.iz)(s,p,c,_);s.started_at=new Date(S),s.finished_at=new Date(k),s.duration=(0,h.duration)(s.finished_at.getTime()-s.started_at.getTime()),this.sortedSpans=(0,n._O)(_),this.breadcrumbs=(0,n.so)(s,r,c,this.sortedSpans),this.replayRecord=s}}function I(e){let{orgSlug:t,replaySlug:r}=e;const a=function(e){const t=e.split(":");return 2===t.length?t[1]:t[0]}(r),{attachments:i,errors:n,replayRecord:o,...l}=c({orgSlug:t,replayId:a}),d=(0,s.useMemo)((()=>R.factory({attachments:i,errors:n,replayRecord:o})),[i,n,o]);return{...l,attachments:i,errors:n,replay:d,replayId:a,replayRecord:o}}},"./app/utils/useDismissAlert.tsx":(e,t,r)=>{r.d(t,{Z:()=>i});var s=r("../node_modules/react/index.js"),a=r("./app/utils/useLocalStorageState.ts");const i=function(e){let{expirationDays:t=Number.MAX_SAFE_INTEGER,key:r}=e;const[i,n]=(0,a.R)(r,(e=>e?String(e):void 0));return{isDismissed:t===Number.MAX_SAFE_INTEGER?Boolean(i):function(e,t){return!(!e||isNaN(e))&&(Date.now()-e)/864e5<t}(Number(i),t),dismiss:(0,s.useCallback)((()=>{n(Date.now().toString())}),[n])}}},"./app/views/replays/detail/layout/fluidHeight.tsx":(e,t,r)=>{r.d(t,{Z:()=>s});const s=(0,r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"eu9w9ak0"})({name:"1i32vcf",styles:"display:flex;flex-direction:column;flex-wrap:nowrap;flex-grow:1;overflow:hidden;height:100%"})}}]);
//# sourceMappingURL=../sourcemaps/app_components_replays_replayPlayer_tsx-app_utils_replays_hooks_useReplayReader_tsx-app_views-15e39a.3de691b58305c023285c701119f59a36.js.map