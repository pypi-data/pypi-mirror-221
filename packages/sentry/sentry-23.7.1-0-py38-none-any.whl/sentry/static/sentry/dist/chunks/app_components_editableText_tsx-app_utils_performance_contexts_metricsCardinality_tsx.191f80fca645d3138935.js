"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_editableText_tsx-app_utils_performance_contexts_metricsCardinality_tsx"],{"./app/components/editableText.tsx":(e,t,n)=>{n.d(t,{Z:()=>b});var a=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=n("../node_modules/react/index.js"),r=n("./app/actionCreators/indicator.tsx"),i=n("./app/components/input.tsx"),s=n("./app/components/textOverflow.tsx"),c=n("./app/icons/iconEdit.tsx"),l=n("./app/styles/space.tsx"),u=n("./app/utils.tsx"),d=n("./app/utils/useKeyPress.tsx"),m=n("./app/utils/useOnClickOutside.tsx"),p=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function f(e){let{value:t,onChange:n,name:a,errorMessage:i,successMessage:s,maxLength:l,isDisabled:f=!1,autoSelect:b=!1,className:Z,"aria-label":_}=e;const[D,j]=(0,o.useState)(!1),[w,P]=(0,o.useState)(t),k=!w.trim(),E=(0,o.useRef)(null),T=(0,o.useRef)(null),L=(0,o.useRef)(null),O=(0,d.Z)("Enter"),N=(0,d.Z)("Escape");function S(){t!==w&&P(t),D&&j(!1)}(0,m.Z)(E,(()=>{D&&(k?M("error"):(w!==t&&(n(w),M("success")),j(!1)))}));const z=(0,o.useCallback)((()=>{if(O){if(k)return void M("error");w!==t&&(n(w),M("success")),j(!1)}}),[O,w,n]),A=(0,o.useCallback)((()=>{N&&S()}),[N]);function M(e){"error"!==e?s&&(0,r.S9)(s):i&&(0,r.Iw)(i)}return(0,o.useEffect)((()=>{S()}),[f,t]),(0,o.useEffect)((()=>{if(D){const e=L.current;(0,u.ri)(e)&&e.focus()}}),[D]),(0,o.useEffect)((()=>{D&&(z(),A())}),[z,A,D]),(0,p.tZ)(C,{isDisabled:f,isEditing:D,className:Z,children:D?(0,p.BX)(h,{ref:E,isEmpty:k,"data-test-id":"editable-text-input",children:[(0,p.tZ)(v,{"aria-label":_,name:a,ref:L,value:w,onChange:function(e){P(e.target.value)},onFocus:e=>b&&e.target.select(),maxLength:l}),(0,p.tZ)(x,{children:w})]}):(0,p.BX)(g,{onClick:f?void 0:function(){j(!0)},ref:T,isDisabled:f,"data-test-id":"editable-text-label",children:[(0,p.tZ)(y,{children:w}),!f&&(0,p.tZ)(c.y,{})]})})}f.displayName="EditableText";const b=f,g=(0,a.Z)("div",{target:"e1jnr83o5"})("display:grid;grid-auto-flow:column;align-items:center;gap:",(0,l.D)(1),";cursor:",(e=>e.isDisabled?"default":"pointer"),";"),y=(0,a.Z)(s.Z,{target:"e1jnr83o4"})("border-top:1px solid transparent;border-bottom:1px dotted ",(e=>e.theme.gray200),";line-height:38px;"),h=(0,a.Z)("div",{target:"e1jnr83o3"})("display:inline-block;background:",(e=>e.theme.gray100),";border-radius:",(e=>e.theme.borderRadius),";margin:-",(0,l.D)(.5)," -",(0,l.D)(1),";padding:",(0,l.D)(.5)," ",(0,l.D)(1),";max-width:calc(100% + ",(0,l.D)(2),");"),v=(0,a.Z)(i.Z,{target:"e1jnr83o2"})({name:"1wplbud",styles:"border:none!important;background:transparent;height:auto;min-height:40px;padding:0;font-size:inherit;&,&:focus,&:active,&:hover{box-shadow:none;}"}),x=(0,a.Z)("div",{target:"e1jnr83o1"})("height:0;opacity:0;white-space:pre;padding:0 ",(0,l.D)(1),";"),C=(0,a.Z)("div",{target:"e1jnr83o0"})("display:flex;",(e=>e.isDisabled&&`\n      ${y} {\n        border-bottom-color: transparent;\n      }\n    `),";")},"./app/utils/performance/contexts/metricsCardinality.tsx":(e,t,n)=>{n.d(t,{BT:()=>Z,e0:()=>D});var a=n("../node_modules/react/index.js"),o=n("./app/utils/analytics.tsx"),r=n("./app/utils/dates.tsx"),i=n("./app/utils/discover/eventView.tsx"),s=n("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),c=n("../node_modules/lodash/omit.js"),l=n.n(c),u=n("./app/utils/discover/genericDiscoverQuery.tsx"),d=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e){let{eventView:t,location:n}=e;return l()(t.getEventsAPIPayload(n),["field","sort","per_page","query"])}function p(e){let{children:t,...n}=e;return(0,d.tZ)(u.ZP,{route:"metrics-compatibility-sums",getRequestPayload:m,...n,children:e=>{let{tableData:n,...a}=e;return t({tableData:n,...a})}})}function f(e){let{eventView:t,location:n}=e;return l()(t.getEventsAPIPayload(n),["field","sort","per_page","query"])}function b(e){let{children:t,...n}=e;return(0,d.tZ)(u.ZP,{route:"metrics-compatibility",getRequestPayload:f,...n,children:e=>{let{tableData:n,...a}=e;return t({tableData:n,...a})}})}p.displayName="MetricsCompatibilityQuery",b.displayName="MetricsCompatibilitySumsQuery";var g=n("./app/utils/performance/contexts/utils.tsx");const y=.01,h=.01,[v,x,C]=(0,g.n)({name:"MetricsCardinalityContext",strict:!1});function Z(e){if(!(0,s.gp)(e.organization))return(0,d.tZ)(v,{value:{isLoading:!1,outcome:{forceTransactionsOnly:!0}},children:e.children});const t={location:e.location,orgSlug:e.organization.slug,cursor:"0:0:0"},n=i.ZP.fromLocation(e.location);n.fields=[{field:"tpm()"}];const o=function(e){const t=e.clone();return t.start||t.end||(t.statsPeriod?(0,r.YJ)(t.statsPeriod)>1&&(t.statsPeriod="1h",t.start=void 0,t.end=void 0):(t.statsPeriod="1h",t.start=void 0,t.end=void 0)),t}(n);return(0,d.tZ)(a.Fragment,{children:(0,d.tZ)(p,{eventView:o,...t,children:n=>(0,d.tZ)(b,{eventView:o,...t,children:t=>{const a=n.isLoading||t.isLoading,o=n.isLoading||t.isLoading?void 0:function(e,t,n){const a={forceTransactionsOnly:!0},o=n.features.includes("performance-mep-bannerless-ui");if(!e)return a;const r=e.compatible_projects;return t?a:e?function(e){return!j(e).metricsCount}(e)?a:function(e,t){const n=j(e);return t?n.nullCount/n.metricsCount>h:n.nullCount>0}(e,o)?{shouldWarnIncompatibleSDK:!0,forceTransactionsOnly:!0,compatibleProjects:r}:function(e){const t=j(e);return t.unparamCount>=t.metricsCount}(e)?{shouldNotifyUnnamedTransactions:!0,forceTransactionsOnly:!0,compatibleProjects:r}:function(e,t){const n=j(e);return t?n.unparamCount/n.metricsCount>y:n.unparamCount>0}(e,o)?{shouldNotifyUnnamedTransactions:!0,compatibleProjects:r,forceTransactionsOnly:!1}:{forceTransactionsOnly:!1}:a}(n.tableData&&t.tableData?{...n.tableData,...t.tableData}:null,!!n.error&&!!t.error,e.organization);return(0,d.tZ)(_,{sendOutcomeAnalytics:e.sendOutcomeAnalytics,organization:e.organization,value:{isLoading:a,outcome:o},children:e.children})}})})})}function _(e){const t=e.value.outcome?.shouldWarnIncompatibleSDK??!1,n=e.value.outcome?.shouldNotifyUnnamedTransactions??!1,r=!e.value.outcome?.forceTransactionsOnly;return(0,a.useEffect)((()=>{!e.value.isLoading&&e.sendOutcomeAnalytics&&(0,o.Gi)("performance_views.mep.metrics_outcome",{organization:e.organization,is_on_metrics:r,fallback_from_null:t,fallback_from_unparam:n})}),[e.organization,e.value.isLoading,r,n,t,e.sendOutcomeAnalytics]),(0,d.tZ)(v,{...e,children:e.children})}Z.displayName="MetricsCardinalityProvider",_.displayName="Provider",C.Consumer;const D=x;function j(e){let{sum:t}=e;try{const e=Number(t.metrics);return{metricsCount:e,unparamCount:Number(t.metrics_unparam),nullCount:Number(t.metrics_null)}}catch(e){return{metricsCount:0,unparamCount:0,nullCount:0}}}},"./app/utils/useKeyPress.tsx":(e,t,n)=>{n.d(t,{Z:()=>o});var a=n("../node_modules/react/index.js");const o=(e,t)=>{const[n,o]=(0,a.useState)(!1),r=t??document.body;return(0,a.useEffect)((()=>{const t=t=>{let{key:n}=t;n===e&&o(!0)},n=t=>{let{key:n}=t;n===e&&o(!1)};return r.addEventListener("keydown",t),r.addEventListener("keyup",n),()=>{r.removeEventListener("keydown",t),r.removeEventListener("keyup",n)}}),[e,r]),n}}}]);
//# sourceMappingURL=../sourcemaps/app_components_editableText_tsx-app_utils_performance_contexts_metricsCardinality_tsx.6a00fd05403b87326d840c6df7ea5cb9.js.map