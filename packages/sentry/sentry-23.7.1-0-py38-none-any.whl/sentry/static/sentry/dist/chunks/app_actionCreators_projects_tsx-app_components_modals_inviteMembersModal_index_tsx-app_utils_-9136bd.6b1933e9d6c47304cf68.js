(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_actionCreators_projects_tsx-app_components_modals_inviteMembersModal_index_tsx-app_utils_-9136bd"],{"./app/actionCreators/projects.tsx":(e,t,s)=>{"use strict";s.d(t,{$L:()=>j,$P:()=>v,M9:()=>b,Nh:()=>p,Oe:()=>S,TA:()=>Z,Vx:()=>m,bL:()=>x,iC:()=>I,mf:()=>w,pK:()=>f,rR:()=>y,xV:()=>_});var n=s("../node_modules/lodash/chunk.js"),o=s.n(n),i=s("../node_modules/lodash/debounce.js"),r=s.n(i),a=s("./app/actionCreators/indicator.tsx"),l=s("./app/locale.tsx"),d=s("./app/stores/latestContextStore.tsx"),u=s("./app/stores/projectsStatsStore.tsx"),c=s("./app/stores/projectsStore.tsx");function m(e,t){u.Z.onUpdate(t.projectId,t.data);const s=`/projects/${t.orgId}/${t.projectId}/`;return e.requestPromise(s,{method:"PUT",data:t.data}).then((e=>(c.Z.onUpdateSuccess(e),e)),(e=>{throw u.Z.onUpdateError(e,t.projectId),e}))}function p(e,t){const s=`/organizations/${t.orgId}/stats/`;e.request(s,{query:t.query,success:e=>c.Z.onStatsLoadSuccess(e)})}const h=new Set,g=r()(((e,t,s)=>{const n=u.Z.getAll(),i=Object.values(n).map((e=>{let{id:t}=e;return t})),r=Array.from(t).filter((e=>!i.includes(e)));if(!r.length)return void h.clear();const d=o()(r,10).map((t=>((e,t,s,n)=>{const o=`/organizations/${s}/projects/`,i={statsPeriod:"24h",query:t.map((e=>`id:${e}`)).join(" "),...n};return e.requestPromise(o,{query:i})})(e,t,s.orgId,s.query)));Promise.all(d).then((e=>{u.Z.onStatsLoadSuccess(e.reduce(((e,t)=>e.concat(t)),[]))})).catch((()=>{(0,a.Iw)((0,l.t)("Unable to fetch all project stats"))})),h.clear()}),50);function v(e,t,s){h.add(t),g(e,h,s)}function f(e){d.Z.onSetActiveProject(e)}function x(e,t,s,n){const o=`/projects/${t}/${s.slug}/transfer/`;return e.requestPromise(o,{method:"POST",data:{email:n}}).then((()=>{(0,a.S9)((0,l._N)("A request was sent to move [project] to a different organization",{project:s.slug}))}),(e=>{let t="";throw e.status>=400&&e.status<500&&e.responseJSON&&(t=e.responseJSON?.detail),t?(0,a.Iw)((0,l._N)("Error transferring [project]. [message]",{project:s.slug,message:t})):(0,a.Iw)((0,l._N)("Error transferring [project]",{project:s.slug})),e}))}function S(e,t,s,n){const o=`/projects/${t}/${s}/teams/${n.slug}/`;return(0,a.E3)(),e.requestPromise(o,{method:"POST"}).then((e=>{(0,a.S9)((0,l._N)("[team] has been added to the [project] project",{team:`#${n.slug}`,project:s})),c.Z.onAddTeam(n,s),c.Z.onUpdateSuccess(e)}),(e=>{throw(0,a.Iw)((0,l._N)("Unable to add [team] to the [project] project",{team:`#${n.slug}`,project:s})),e}))}function b(e,t,s,n){const o=`/projects/${t}/${s}/teams/${n}/`;return(0,a.E3)(),e.requestPromise(o,{method:"DELETE"}).then((e=>{(0,a.S9)((0,l._N)("[team] has been removed from the [project] project",{team:`#${n}`,project:s})),c.Z.onRemoveTeam(n,s),c.Z.onUpdateSuccess(e)}),(e=>{throw(0,a.Iw)((0,l._N)("Unable to remove [team] from the [project] project",{team:`#${n}`,project:s})),e}))}function Z(e,t){c.Z.onChangeSlug(e,t)}function j(e){let{api:t,name:s,options:n={},orgSlug:o,platform:i,team:r}=e;return t.requestPromise(`/teams/${o}/${r}/projects/`,{method:"POST",data:{name:s,platform:i,default_rules:n.defaultRules}})}function y(e){let{api:t,orgSlug:s,projectSlug:n,origin:o}=e;return t.requestPromise(`/projects/${s}/${n}/`,{method:"DELETE",data:{origin:o}})}function I(e){let{api:t,orgSlug:s,projectSlug:n,platform:o}=e;return t.requestPromise(`/projects/${s}/${n}/docs/${o}/`)}function _(e,t){return e.requestPromise(`/organizations/${t}/projects-count/`)}async function w(e,t,s){return(await e.requestPromise(`/organizations/${t}/releases/stats/`,{method:"GET",query:{statsPeriod:"90d",project:s,per_page:1}})).length>0}},"./app/actionCreators/teams.tsx":(e,t,s)=>{"use strict";s.d(t,{Cm:()=>c,PX:()=>a,s:()=>u,tT:()=>m,um:()=>d,z_:()=>l});var n=s("./app/actionCreators/indicator.tsx"),o=s("./app/locale.tsx"),i=s("./app/stores/teamStore.tsx");const r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;for(var s=arguments.length,n=new Array(s>2?s-2:0),o=2;o<s;o++)n[o-2]=arguments[o];return e[t]?.(...n)};async function a(e,t){const s=await e.requestPromise(`/organizations/${t.orgId}/user-teams/`);i.Z.loadUserTeams(s)}function l(e,t){i.Z.onUpdateSuccess(e,t)}function d(e,t,s){const n=`/organizations/${t.orgId}/members/${t.memberId??"me"}/teams/${t.teamId}/`;return e.request(n,{method:"POST",success:e=>{i.Z.onUpdateSuccess(t.teamId,e),r(s,"success",e)},error:e=>{r(s,"error",e)}})}function u(e,t,s){const n=`/organizations/${t.orgId}/members/${t.memberId||"me"}/teams/${t.teamId}/`;return e.request(n,{method:"DELETE",success:e=>{i.Z.onUpdateSuccess(t.teamId,e),r(s,"success",e)},error:e=>{r(s,"error",e)}})}function c(e,t,s){return e.requestPromise(`/organizations/${s.orgId}/teams/`,{method:"POST",data:t}).then((e=>(i.Z.onCreateSuccess(e),(0,n.S9)((0,o._N)("[team] has been added to the [organization] organization",{team:`#${e.slug}`,organization:s.orgId})),e)),(e=>{throw(0,n.Iw)((0,o._N)("Unable to create [team] in the [organization] organization",{team:`#${t.slug}`,organization:s.orgId})),e}))}function m(e,t){return e.requestPromise(`/teams/${t.orgId}/${t.teamId}/`,{method:"DELETE"}).then((e=>(i.Z.onRemoveSuccess(t.teamId),(0,n.S9)((0,o._N)("[team] has been removed from the [organization] organization",{team:`#${t.teamId}`,organization:t.orgId})),e)),(e=>{throw(0,n.Iw)((0,o._N)("Unable to remove [team] from the [organization] organization",{team:`#${t.teamId}`,organization:t.orgId})),e}))}},"./app/components/hookOrDefault.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/react/index.js"),i=s("./app/stores/hookStore.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=function(e){let{hookName:t,defaultComponent:s,defaultComponentPromise:a}=e;class l extends o.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{hooks:i.Z.get(t)}),(0,n.Z)(this,"unlistener",i.Z.listen(((e,s)=>e===t&&this.setState({hooks:s})),void 0))}componentWillUnmount(){this.unlistener?.()}get defaultComponent(){if(a){const e=(0,o.lazy)(a);return function(t){return(0,r.tZ)(o.Suspense,{fallback:null,children:(0,r.tZ)(e,{...t})})}}return s}render(){const e=this.state.hooks&&this.state.hooks.length,t=this.state.hooks[0]?.(),s=e&&t?t:this.defaultComponent;return s?(0,r.tZ)(s,{...this.props}):null}}return l.displayName="HookOrDefaultComponent",(0,n.Z)(l,"displayName",`HookOrDefaultComponent(${t})`),l}},"./app/components/modals/inviteMembersModal/index.tsx":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>G,modalCss:()=>W});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("../node_modules/react/index.js"),r=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),a=s("./app/components/alert.tsx"),l=s("./app/components/button.tsx"),d=s("./app/components/buttonBar.tsx"),u=s("./app/components/deprecatedAsyncComponent.tsx"),c=s("./app/components/hookOrDefault.tsx"),m=s("./app/components/loadingIndicator.tsx"),p=s("./app/constants/index.tsx"),h=s("./app/icons/index.tsx"),g=s("./app/locale.tsx"),v=s("./app/styles/space.tsx"),f=s("./app/utils/analytics.tsx"),x=s("./app/utils/guid.tsx"),S=s("./app/utils/withLatestContext.tsx"),b=s("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),Z=s("./app/components/forms/controls/selectControl.tsx"),j=s("./app/components/roleSelectControl.tsx"),y=s("./app/components/teamSelector.tsx"),I=s("./app/icons/iconClose.tsx"),_=s("../node_modules/react-select/dist/index-4bd03571.esm.js"),w=s("./app/components/tooltip.tsx"),z=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function C(e,t){const{children:s,...n}=t,o=e&&e.error,i=void 0===e?s:(0,z.tZ)(w.u,{disabled:!o,title:o,children:(0,z.BX)($,{children:[s,!e.sent&&!e.error&&(0,z.tZ)(M,{}),e.error&&(0,z.tZ)(h.FC,{legacySize:"10px"}),e.sent&&(0,z.tZ)(h.DL,{legacySize:"10px",color:"success"})]})});return(0,z.tZ)(_.c.MultiValue,{...n,children:i})}C.displayName="renderEmailValue";const $=(0,o.Z)("div",{target:"e1ikvpuq1"})("display:inline-grid;grid-auto-flow:column;gap:",(0,v.D)(.5),";align-items:center;"),M=(0,o.Z)(m.Z,{target:"e1ikvpuq0"})({name:"440peb",styles:"margin:0;.loading-indicator{border-width:2px;}"});M.defaultProps={hideMessage:!0,size:14};const q=C;function k(e){return e.map((e=>({value:e,label:e})))}function E(e){let{className:t,disabled:s,emails:n,role:o,teams:r,roleOptions:a,roleDisabledUnallowed:d,inviteStatus:u,onRemove:c,onChangeEmails:m,onChangeRole:p,onChangeTeams:h,disableRemove:v}=e;const[f,x]=(0,i.useState)(""),S=(0,b.u)();return(0,z.BX)("li",{className:t,children:[(0,z.tZ)(Z.Z,{"aria-label":(0,g.t)("Email Addresses"),"data-test-id":"select-emails",disabled:s,placeholder:(0,g.t)("Enter one or more emails"),inputValue:f,value:n,components:{MultiValue:e=>function(e,t){return q(t[e.data.value],e)}(e,u),DropdownIndicator:()=>null},options:k(n),onBlur:e=>e.target.value&&m([...k(n),{label:e.target.value,value:e.target.value}]),styles:D(S,u),onInputChange:x,onKeyDown:e=>{switch(e.key){case"Enter":case",":case" ":m([...k(n),{label:f,value:f}]),x(""),e.preventDefault()}},onChange:m,multiple:!0,creatable:!0,clearable:!0,menuIsOpen:!1}),(0,z.tZ)(j.Z,{"aria-label":(0,g.t)("Role"),"data-test-id":"select-role",disabled:s,value:o,roles:a,disableUnallowed:d,onChange:p}),(0,z.tZ)(y.Z,{"aria-label":(0,g.t)("Add to Team"),"data-test-id":"select-teams",disabled:s,placeholder:(0,g.t)("Add to teamsâ€¦"),value:r,onChange:h,multiple:!0,clearable:!0}),(0,z.tZ)(l.zx,{borderless:!0,icon:(0,z.tZ)(I.b,{}),onClick:c,disabled:v,"aria-label":(0,g.t)("Remove")})]})}function D(e,t){return{multiValue:(s,n)=>{let{data:o}=n;const i=t[o.value];return{...s,...i?.error?{color:e.red400,border:`1px solid ${e.red300}`,backgroundColor:e.red100}:{}}},multiValueLabel:(s,n)=>{let{data:o}=n;const i=t[o.value];return{...s,pointerEvents:"all",...i?.error?{color:e.red400}:{}}},multiValueRemove:(s,n)=>{let{data:o}=n;const i=t[o.value];return{...s,...i?.error?{borderLeft:`1px solid ${e.red300}`,":hover":{backgroundColor:e.red100,color:e.red400}}:{}}}}}E.displayName="InviteRowControl";const P=E,N=(0,c.Z)({hookName:"member-invite-modal:customization",defaultComponent:e=>{let{onSendInvites:t,children:s}=e;return s({sendInvites:t,canSend:!0})}});class T extends u.Z{constructor(){super(...arguments),(0,n.Z)(this,"sessionId",""),(0,n.Z)(this,"reset",(()=>{this.setState({pendingInvites:[this.inviteTemplate],inviteStatus:{},complete:!1,sendingInvites:!1}),(0,f.Gi)("invite_modal.add_more",{organization:this.props.organization,modal_session:this.sessionId})})),(0,n.Z)(this,"sendInvite",(async e=>{const{slug:t}=this.props.organization,s={email:e.email,teams:[...e.teams],role:e.role};this.setState((t=>({inviteStatus:{...t.inviteStatus,[e.email]:{sent:!1}}})));const n=this.willInvite?`/organizations/${t}/members/`:`/organizations/${t}/invite-requests/`;try{await this.api.requestPromise(n,{method:"POST",data:s})}catch(t){const s=t.responseJSON,n=!(!s||!s.email)&&(Array.isArray(s.email)?s.email[0]:s.email)||(0,g.t)("Could not invite user");return void this.setState((t=>({inviteStatus:{...t.inviteStatus,[e.email]:{sent:!1,error:n}}})))}this.setState((t=>({inviteStatus:{...t.inviteStatus,[e.email]:{sent:!0}}})))})),(0,n.Z)(this,"sendInvites",(async()=>{this.setState({sendingInvites:!0}),await Promise.all(this.invites.map(this.sendInvite)),this.setState({sendingInvites:!1,complete:!0}),(0,f.Gi)(this.willInvite?"invite_modal.invites_sent":"invite_modal.requests_sent",{organization:this.props.organization,modal_session:this.sessionId})})),(0,n.Z)(this,"addInviteRow",(()=>this.setState((e=>({pendingInvites:[...e.pendingInvites,this.inviteTemplate]})))))}get inviteTemplate(){return{emails:new Set,teams:new Set,role:"member"}}componentDidMount(){super.componentDidMount(),this.sessionId=(0,x.E)();const{organization:e,source:t}=this.props;(0,f.Gi)("invite_modal.opened",{organization:e,modal_session:this.sessionId,can_invite:this.willInvite,source:t})}getEndpoints(){return[["member",`/organizations/${this.props.organization.slug}/members/me/`]]}getDefaultState(){const e=super.getDefaultState(),{initialData:t}=this.props;return{...e,pendingInvites:t?t.map((e=>({...this.inviteTemplate,...e}))):[this.inviteTemplate],inviteStatus:{},complete:!1,sendingInvites:!1}}setEmails(e,t){this.setState((s=>{const n=[...s.pendingInvites];return n[t]={...n[t],emails:new Set(e)},{pendingInvites:n}}))}setTeams(e,t){this.setState((s=>{const n=[...s.pendingInvites];return n[t]={...n[t],teams:new Set(e)},{pendingInvites:n}}))}setRole(e,t){this.setState((s=>{const n=[...s.pendingInvites];return n[t]={...n[t],role:e},{pendingInvites:n}}))}removeInviteRow(e){this.setState((t=>{const s=[...t.pendingInvites];return s.splice(e,1),{pendingInvites:s}}))}get invites(){return this.state.pendingInvites.reduce(((e,t)=>[...e,...[...t.emails].map((e=>({email:e,teams:t.teams,role:t.role})))]),[])}get hasDuplicateEmails(){const e=this.invites.map((e=>e.email));return e.length!==new Set(e).size}get isValidInvites(){return this.invites.length>0&&!this.hasDuplicateEmails}get statusMessage(){const{sendingInvites:e,complete:t,inviteStatus:s}=this.state;if(e)return(0,z.BX)(F,{children:[(0,z.tZ)(m.Z,{mini:!0,relative:!0,hideMessage:!0,size:16}),this.willInvite?(0,g.t)("Sending organization invitationsâ€¦"):(0,g.t)("Sending invite requestsâ€¦")]});if(t){const e=Object.values(s),t=e.filter((e=>e.sent)).length,n=e.filter((e=>e.error)).length;if(this.willInvite){const e={invites:(0,z.tZ)("strong",{children:(0,g.tn)("%s invite","%s invites",t)}),failed:n};return(0,z.BX)(F,{status:"success",children:[(0,z.tZ)(h.DL,{size:"sm"}),n>0?(0,g._N)("Sent [invites], [failed] failed to send.",e):(0,g._N)("Sent [invites]",e)]})}const o={inviteRequests:(0,z.tZ)("strong",{children:(0,g.tn)("%s invite request","%s invite requests",t)}),failed:n};return(0,z.BX)(F,{status:"success",children:[(0,z.tZ)(h.DL,{size:"sm"}),n>0?(0,g._N)("[inviteRequests] pending approval, [failed] failed to send.",o):(0,g._N)("[inviteRequests] pending approval",o)]})}return this.hasDuplicateEmails?(0,z.BX)(F,{status:"error",children:[(0,z.tZ)(h.FC,{size:"sm"}),(0,g.t)("Duplicate emails between invite rows.")]}):null}get willInvite(){return this.props.organization.access?.includes("member:write")}get inviteButtonLabel(){if(this.invites.length>0){const e=this.invites.length,t=1===e?(0,g.t)("Send invite"):(0,g.t)("Send invites (%s)",e),s=1===e?(0,g.t)("Send invite request"):(0,g.t)("Send invite requests (%s)",e);return this.willInvite?t:s}return this.willInvite?(0,g.t)("Send invite"):(0,g.t)("Send invite request")}render(){const{Footer:e,closeModal:t,organization:s}=this.props,{pendingInvites:n,sendingInvites:o,complete:r,inviteStatus:u,member:c}=this.state,m=o||r;return(0,z.tZ)(N,{organization:s,willInvite:this.willInvite,onSendInvites:this.sendInvites,children:s=>{let{sendInvites:o,canSend:v,headerInfo:x}=s;return(0,z.BX)(i.Fragment,{children:[(0,z.tZ)(L,{children:(0,g.t)("Invite New Members")}),this.willInvite?(0,z.tZ)(U,{children:(0,g.t)("Invite new members by email to join your organization.")}):(0,z.tZ)(a.ZP,{type:"warning",showIcon:!0,children:(0,g.t)("You canâ€™t invite users directly, but weâ€™ll forward your request to an org owner or manager for approval.")}),x,(0,z.BX)(R,{children:[(0,z.tZ)("div",{children:(0,g.t)("Email addresses")}),(0,z.tZ)("div",{children:(0,g.t)("Role")}),(0,z.tZ)("div",{children:(0,g.t)("Add to team")})]}),(0,z.tZ)(A,{children:n.map(((e,t)=>{let{emails:s,role:o,teams:i}=e;return(0,z.tZ)(O,{disabled:m,emails:[...s],role:o,teams:[...i],roleOptions:c?c.roles:p.Gh,roleDisabledUnallowed:this.willInvite,inviteStatus:u,onRemove:()=>this.removeInviteRow(t),onChangeEmails:e=>this.setEmails(e?.map((e=>e.value))??[],t),onChangeRole:e=>this.setRole(e?.value,t),onChangeTeams:e=>this.setTeams(e?e.map((e=>e.value)):[],t),disableRemove:m||1===n.length},t)}))}),(0,z.tZ)(X,{disabled:m,size:"sm",borderless:!0,onClick:this.addInviteRow,icon:(0,z.tZ)(h.N_,{size:"xs",isCircled:!0}),children:(0,g.t)("Add another")}),(0,z.tZ)(e,{children:(0,z.BX)(V,{children:[(0,z.tZ)("div",{children:this.statusMessage}),(0,z.tZ)(d.ZP,{gap:1,children:r?(0,z.BX)(i.Fragment,{children:[(0,z.tZ)(l.zx,{"data-test-id":"send-more",size:"sm",onClick:this.reset,children:(0,g.t)("Send more invites")}),(0,z.tZ)(l.zx,{"data-test-id":"close",priority:"primary",size:"sm",onClick:()=>{(0,f.Gi)("invite_modal.closed",{organization:this.props.organization,modal_session:this.sessionId}),t()},children:(0,g.t)("Close")})]}):(0,z.BX)(i.Fragment,{children:[(0,z.tZ)(l.zx,{"data-test-id":"cancel",size:"sm",onClick:t,disabled:m,children:(0,g.t)("Cancel")}),(0,z.tZ)(l.zx,{size:"sm","data-test-id":"send-invites",priority:"primary",disabled:!v||!this.isValidInvites||m,onClick:o,children:this.inviteButtonLabel})]})})]})})]})}})}}T.displayName="InviteMembersModal";const L=(0,o.Z)("h1",{target:"edt9x2z7"})("font-weight:400;font-size:",(e=>e.theme.headerFontSize),";margin-top:0;margin-bottom:",(0,v.D)(.75),";"),U=(0,o.Z)("p",{target:"edt9x2z6"})("color:",(e=>e.theme.subText),";margin-bottom:",(0,v.D)(3),";"),B=(0,r.iv)("display:grid;gap:",(0,v.D)(1.5),";grid-template-columns:3fr 180px 2fr max-content;align-items:start;",""),R=(0,o.Z)("div",{target:"edt9x2z5"})(B,";margin-bottom:",(0,v.D)(1),";font-weight:600;text-transform:uppercase;font-size:",(e=>e.theme.fontSizeSmall),";"),A=(0,o.Z)("ul",{target:"edt9x2z4"})({name:"v5al3",styles:"list-style:none;padding:0;margin:0"}),O=(0,o.Z)(P,{target:"edt9x2z3"})(B,";margin-bottom:",(0,v.D)(1.5),";"),X=(0,o.Z)(l.zx,{target:"edt9x2z2"})("margin-top:",(0,v.D)(3),";"),V=(0,o.Z)("div",{target:"edt9x2z1"})("display:flex;gap:",(0,v.D)(1),";align-items:center;justify-content:space-between;flex:1;"),F=(0,o.Z)("div",{target:"edt9x2z0"})("display:flex;gap:",(0,v.D)(1),";align-items:center;font-size:",(e=>e.theme.fontSizeMedium),";color:",(e=>"error"===e.status?e.theme.errorText:e.theme.textColor),";>:first-child{",(e=>"success"===e.status&&`color: ${e.theme.successText}`),";}"),W={name:"16gyilg",styles:"width:100%;max-width:900px;margin:50px auto"},G=(0,S.Z)(T)},"./app/components/roleSelectControl.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=s("./app/components/forms/controls/selectControl.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function r(e){let{roles:t,disableUnallowed:s,...n}=e;return(0,i.tZ)(o.Z,{options:t?.map((e=>({value:e.id,label:e.name,disabled:s&&!e.allowed||e.isRetired,details:(0,i.tZ)(l,{children:e.desc})}))),showDividers:!0,...n})}r.displayName="RoleSelectControl";const a=r,l=(0,n.Z)("span",{target:"eu9y8de0"})({name:"vad6xm",styles:"display:inline-block;width:20rem"})},"./app/stores/projectsStatsStore.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});const n={itemsBySlug:{},init(){this.reset()},getInitialState(){return this.itemsBySlug},reset(){this.itemsBySlug={},this.updatingItems=new Map},onStatsLoadSuccess(e){e.forEach((e=>{this.itemsBySlug[e.slug]=e})),this.trigger(this.itemsBySlug)},onUpdate(e,t){const s=this.getBySlug(e);if(this.updatingItems.set(e,s),!s)return;const n={...s,...t};this.itemsBySlug={...this.itemsBySlug,[s.slug]:n},this.trigger(this.itemsBySlug)},onUpdateSuccess(e){this.updatingItems.delete(e.slug)},onUpdateError(e,t){const s=this.updatingItems.get(t);s&&(this.updatingItems.delete(t),this.itemsBySlug={...this.itemsBySlug,[s.slug]:{...s}},this.trigger(this.itemsBySlug))},getAll(){return this.itemsBySlug},getBySlug(e){return this.itemsBySlug[e]}},o=(0,s("../node_modules/reflux/src/index.js").createStore)(n)},"./app/utils/getRouteStringFromRoutes.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var n=s("../node_modules/lodash/findLastIndex.js"),o=s.n(n);function i(e){if(!Array.isArray(e))return"";const t=e.filter((e=>!!e.path)),s=o()(t,(e=>{let{path:t}=e;return t.startsWith("/")}));return t.slice(s).filter((e=>{let{path:t}=e;return!!t})).map((e=>{let{path:t}=e;return t})).join("")}},"./app/utils/isActiveSuperuser.tsx":(e,t,s)=>{"use strict";s.d(t,{M:()=>a});var n=s("../node_modules/js-cookie/dist/js.cookie.mjs"),o=s("./app/stores/configStore.tsx");const i=window.superUserCookieName??"su",r=window.superUserCookieDomain;function a(){const{isSuperuser:e}=o.Z.get("user")||{};if(e){const e=o.Z.get("superUserCookieName")||i,t=o.Z.get("superUserCookieDomain")||r;if(n.Z.set(e,"set-in-isActiveSuperuser",{domain:t}),void 0===n.Z.get(e))return!0}return!1}},"./app/utils/useApi.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var n=s("../node_modules/react/index.js"),o=s("./app/api.tsx");const i=function(){let{persistInFlight:e,api:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=(0,n.useRef)();void 0===s.current&&void 0===t&&(s.current=new o.KU);const i=t??s.current,r=(0,n.useCallback)((()=>{e||i.clear()}),[i,e]);return(0,n.useEffect)((()=>r),[r]),i}},"./app/utils/useTeams.tsx":(e,t,s)=>{"use strict";s.d(t,{y:()=>h});var n=s("../node_modules/react/index.js"),o=s("../node_modules/lodash/uniqBy.js"),i=s.n(o),r=s("./app/actionCreators/teams.tsx"),a=s("./app/stores/organizationStore.tsx"),l=s("./app/stores/teamStore.tsx"),d=s("./app/stores/useLegacyStore.tsx"),u=s("./app/utils/isActiveSuperuser.tsx"),c=s("./app/utils/parseLinkHeader.tsx"),m=s("./app/utils/useApi.tsx");async function p(e,t){let{slugs:s,ids:n,search:o,limit:i,lastSearch:r,cursor:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const l={};void 0!==s&&s.length>0&&(l.query=s.map((e=>`slug:${e}`)).join(" ")),void 0!==n&&n.length>0&&(l.query=n.map((e=>`id:${e}`)).join(" ")),o&&(l.query=`${l.query??""} ${o}`.trim()),(r===o||!r&&!o)&&a&&(l.cursor=a),void 0!==i&&(l.per_page=i);let d=!1,u=null;const[m,,p]=await e.requestPromise(`/organizations/${t}/teams/`,{includeAllArgs:!0,query:l}),h=p?.getResponseHeader("Link");if(h){const e=(0,c.Z)(h);d=e?.next?.results,u=e?.next?.cursor}return{results:m,hasMore:d,nextCursor:u}}function h(){let{limit:e,slugs:t,ids:s,provideUserTeams:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const c=(0,m.Z)(),{organization:h}=(0,d.X)(a.Z),g=(0,d.X)(l.Z),v=h?.slug,f=(0,n.useMemo)((()=>new Set(g.teams.map((e=>e.slug)))),[g.teams]),x=(0,n.useMemo)((()=>new Set(g.teams.map((e=>e.id)))),[g.teams]),S=(0,n.useMemo)((()=>t?.filter((e=>!f.has(e)))??[]),[t,f]),b=(0,n.useMemo)((()=>s?.filter((e=>!x.has(e)))??[]),[s,x]),Z=S.length>0||b.length>0,j=o&&!g.loadedUserTeams,y=!j&&!Z,[I,_]=(0,n.useState)({initiallyLoaded:y,fetching:!1,hasMore:g.hasMore,lastSearch:null,nextCursor:g.cursor,fetchError:null}),w=(0,n.useCallback)((async function(){if(void 0!==v){_((e=>({...e,fetching:!0})));try{await(0,r.PX)(c,{orgId:v}),_((e=>({...e,fetching:!1,initiallyLoaded:!0})))}catch(e){console.error(e),_((t=>({...t,fetching:!1,initiallyLoaded:!0,fetchError:e})))}}}),[c,v]),z=(0,n.useCallback)((async function(){if(void 0!==v){_((e=>({...e,fetching:!0})));try{const{results:t,hasMore:s,nextCursor:n}=await p(c,v,{slugs:S,ids:b,limit:e}),o=i()([...t,...g.teams],(e=>{let{id:t}=e;return t}));l.Z.loadInitialData(o),_((e=>({...e,hasMore:s,fetching:!1,initiallyLoaded:!0,nextCursor:n})))}catch(e){console.error(e),_((t=>({...t,fetching:!1,initiallyLoaded:!0,fetchError:e})))}}}),[c,b,e,v,S,g.teams]),C=(0,n.useCallback)((async function(t){const s=I.lastSearch,n=t?I.nextCursor:g.cursor;if(void 0!==v){_((e=>({...e,fetching:!0})));try{c.clear();const{results:o,hasMore:r,nextCursor:a}=await p(c,v,{search:t,limit:e,lastSearch:s,cursor:n}),d=i()([...g.teams,...o],(e=>{let{slug:t}=e;return t}));t?d.length>g.teams.length&&l.Z.loadInitialData(d):l.Z.loadInitialData(d,r,a),_((e=>({...e,hasMore:r&&g.hasMore,fetching:!1,lastSearch:t??null,nextCursor:a})))}catch(e){console.error(e),_((t=>({...t,fetching:!1,fetchError:e})))}}else console.error("Cannot fetch teams without an organization in context")}),[c,e,v,I.lastSearch,I.nextCursor,g.cursor,g.hasMore,g.teams]),$=(0,n.useCallback)((function(e){return""!==e?C(e):(I.hasMore===g.hasMore&&I.nextCursor===g.cursor||_((t=>({...t,lastSearch:e,hasMore:g.hasMore,nextCursor:g.cursor}))),Promise.resolve())}),[C,I.hasMore,I.nextCursor,g.cursor,g.hasMore]);(0,n.useEffect)((()=>{Z&&z()}),[Z,z]),(0,n.useEffect)((()=>{j&&w()}),[j,w]);const M=(0,u.M)();return{teams:(0,n.useMemo)((()=>t?g.teams.filter((e=>t.includes(e.slug))):s?g.teams.filter((e=>s.includes(e.id))):o&&!M?g.teams.filter((e=>e.isMember)):g.teams),[g.teams,s,t,o,M]),fetching:I.fetching||g.loading,initiallyLoaded:I.initiallyLoaded,fetchError:I.fetchError,hasMore:I.hasMore??g.hasMore,onSearch:$,loadMore:C}}},"./app/utils/withLatestContext.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/react/index.js"),i=s("./app/stores/configStore.tsx"),r=s("./app/stores/latestContextStore.tsx"),a=s("./app/utils/getDisplayName.tsx"),l=s("./app/utils/withOrganizations.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const u={organization:null,project:null},c=function(e){class t extends o.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{latestContext:r.Z.get()}),(0,n.Z)(this,"unsubscribe",r.Z.listen((e=>this.setState({latestContext:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{organizations:t}=this.props,{latestContext:s}=this.state,{organization:n,project:o}=s||u,r=n||(t&&t.length?t.find((e=>{let{slug:t}=e;return t===i.Z.get("lastOrganization")}))||t[0]:null);return(0,d.tZ)(e,{project:o,...this.props,organization:this.props.organization||r})}}return t.displayName="WithLatestContext",(0,n.Z)(t,"displayName",`withLatestContext(${(0,a.Z)(e)})`),(0,l.Z)(t)}},"./app/utils/withOrganizations.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/react/index.js"),i=s("./app/stores/organizationsStore.tsx"),r=s("./app/utils/getDisplayName.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends o.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{organizations:i.Z.getAll()}),(0,n.Z)(this,"unsubscribe",i.Z.listen((e=>this.setState({organizations:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{organizationsLoading:t,organizations:s,...n}=this.props;return(0,a.tZ)(e,{organizationsLoading:t??!i.Z.loaded,organizations:s??this.state.organizations,...n})}}return t.displayName="WithOrganizations",(0,n.Z)(t,"displayName",`withOrganizations(${(0,r.Z)(e)})`),t}},"./app/utils/withProject.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/react/index.js"),i=s("./app/sentryTypes.tsx"),r=s("./app/utils/getDisplayName.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=e=>{var t;return t=class extends o.Component{render(){const{project:t,...s}=this.props;return(0,a.tZ)(e,{project:t??this.context.project,...s})}},(0,n.Z)(t,"displayName",`withProject(${(0,r.Z)(e)})`),(0,n.Z)(t,"contextTypes",{project:i.Z.Project}),t}},"../node_modules/lodash/_arrayIncludes.js":(e,t,s)=>{var n=s("../node_modules/lodash/_baseIndexOf.js");e.exports=function(e,t){return!(null==e||!e.length)&&n(e,t,0)>-1}},"../node_modules/lodash/_arrayIncludesWith.js":e=>{e.exports=function(e,t,s){for(var n=-1,o=null==e?0:e.length;++n<o;)if(s(t,e[n]))return!0;return!1}},"../node_modules/lodash/_baseUniq.js":(e,t,s)=>{var n=s("../node_modules/lodash/_SetCache.js"),o=s("../node_modules/lodash/_arrayIncludes.js"),i=s("../node_modules/lodash/_arrayIncludesWith.js"),r=s("../node_modules/lodash/_cacheHas.js"),a=s("../node_modules/lodash/_createSet.js"),l=s("../node_modules/lodash/_setToArray.js");e.exports=function(e,t,s){var d=-1,u=o,c=e.length,m=!0,p=[],h=p;if(s)m=!1,u=i;else if(c>=200){var g=t?null:a(e);if(g)return l(g);m=!1,u=r,h=new n}else h=t?[]:p;e:for(;++d<c;){var v=e[d],f=t?t(v):v;if(v=s||0!==v?v:0,m&&f==f){for(var x=h.length;x--;)if(h[x]===f)continue e;t&&h.push(f),p.push(v)}else u(h,f,s)||(h!==p&&h.push(f),p.push(v))}return p}},"../node_modules/lodash/_createSet.js":(e,t,s)=>{var n=s("../node_modules/lodash/_Set.js"),o=s("../node_modules/lodash/noop.js"),i=s("../node_modules/lodash/_setToArray.js"),r=n&&1/i(new n([,-0]))[1]==1/0?function(e){return new n(e)}:o;e.exports=r},"../node_modules/lodash/chunk.js":(e,t,s)=>{var n=s("../node_modules/lodash/_baseSlice.js"),o=s("../node_modules/lodash/_isIterateeCall.js"),i=s("../node_modules/lodash/toInteger.js"),r=Math.ceil,a=Math.max;e.exports=function(e,t,s){t=(s?o(e,t,s):void 0===t)?1:a(i(t),0);var l=null==e?0:e.length;if(!l||t<1)return[];for(var d=0,u=0,c=Array(r(l/t));d<l;)c[u++]=n(e,d,d+=t);return c}},"../node_modules/lodash/findLastIndex.js":(e,t,s)=>{var n=s("../node_modules/lodash/_baseFindIndex.js"),o=s("../node_modules/lodash/_baseIteratee.js"),i=s("../node_modules/lodash/toInteger.js"),r=Math.max,a=Math.min;e.exports=function(e,t,s){var l=null==e?0:e.length;if(!l)return-1;var d=l-1;return void 0!==s&&(d=i(s),d=s<0?r(l+d,0):a(d,l-1)),n(e,o(t,3),d,!0)}},"../node_modules/lodash/noop.js":e=>{e.exports=function(){}},"../node_modules/lodash/uniqBy.js":(e,t,s)=>{var n=s("../node_modules/lodash/_baseIteratee.js"),o=s("../node_modules/lodash/_baseUniq.js");e.exports=function(e,t){return e&&e.length?o(e,n(t,2)):[]}}}]);
//# sourceMappingURL=../sourcemaps/app_actionCreators_projects_tsx-app_components_modals_inviteMembersModal_index_tsx-app_utils_-9136bd.fd06b2f8f5dce4afa278894e236ca69c.js.map