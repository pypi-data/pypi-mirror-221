"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_organizationStats_teamInsights_issues_tsx"],{"./app/views/organizationStats/teamInsights/issues.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>pe});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("../node_modules/react/index.js"),i=s("./app/components/layouts/thirds.tsx"),a=s("./app/components/loadingIndicator.tsx"),o=s("./app/components/noProjectMessage.tsx"),d=s("./app/components/sentryDocumentTitle.tsx"),l=s("./app/locale.tsx"),u=s("./app/utils/localStorage.tsx"),c=s("./app/utils/routeAnalytics/useRouteAnalyticsEventNames.tsx"),m=s("./app/utils/useOrganization.tsx"),p=s("./app/utils/useTeams.tsx"),g=s("./app/views/organizationStats/header.tsx"),h=s("./app/views/organizationStats/teamInsights/controls.tsx"),Z=s("./app/views/organizationStats/teamInsights/descriptionCard.tsx"),v=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),y=s("../node_modules/moment/moment.js"),x=s.n(y),f=s("./app/components/charts/barChart.tsx"),b=s("./app/components/count.tsx"),w=s("./app/components/idBadge/projectBadge.tsx"),j=s("./app/components/links/link.tsx"),S=s("./app/components/loadingError.tsx"),T=s("./app/components/panels/panelTable.tsx"),z=s("./app/components/placeholder.tsx"),I=s("./app/components/timeSince.tsx"),D=s("./app/icons/index.tsx"),B=s("./app/styles/space.tsx"),N=s("./app/utils/events.tsx"),C=s("./app/utils/queryClient.tsx"),E=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function k(e){if("> 1 year"===e)return x()().subtract(1,"y").subtract(1,"d").valueOf();const[t,s,n]=e.split(" ");return x()().subtract(s,n).valueOf()}const A={"< 1 hour":(0,l.t)("1 hour"),"< 4 hour":(0,l.t)("4 hours"),"< 12 hour":(0,l.t)("12 hours"),"< 1 day":(0,l.t)("1 day"),"< 1 week":(0,l.t)("1 week"),"< 4 week":(0,l.t)("1 month"),"< 24 week":(0,l.t)("6 months"),"< 1 year":(0,l.t)("1 year"),"> 1 year":(0,l.t)("> 1 year")};function X(e){let{organization:t,teamSlug:s}=e;const{data:n,isLoading:i,isError:a,refetch:o}=(0,C.WE)([`/teams/${t.slug}/${s}/issues/old/`,{query:{limit:7}}],{staleTime:5e3}),{data:d,isLoading:u,isError:c,refetch:m}=(0,C.WE)([`/teams/${t.slug}/${s}/unresolved-issue-age/`],{staleTime:5e3}),p=i||u;if(a||c)return(0,E.tZ)(S.Z,{onRetry:()=>{o(),m()}});const g=Object.entries(d??{}).map((e=>{let[t,s]=e;return{name:t,value:s}})).sort(((e,t)=>k(t.name)-k(e.name)));return(0,E.BX)("div",{children:[(0,E.BX)(L,{children:[p&&(0,E.tZ)(z.Z,{height:"200px"}),!p&&(0,E.tZ)(f.v,{style:{height:190},legend:{right:3,top:0},yAxis:{minInterval:1},xAxis:{type:"category",min:0,axisLabel:{showMaxLabel:!0,showMinLabel:!0,formatter:e=>A[e]??e}},series:[{seriesName:(0,l.t)("Unresolved Issues"),silent:!0,data:g,barCategoryGap:"5%"}]})]}),(0,E.tZ)(O,{isEmpty:!n||0===n?.length,emptyMessage:(0,l.t)("No unresolved issues for this teamâ€™s projects"),headers:[(0,l.t)("Oldest Issues"),(0,E.tZ)($,{children:(0,l.t)("Events")},"events"),(0,E.tZ)($,{children:(0,l.t)("Users")},"users"),(0,E.BX)($,{children:[(0,l.t)("Age")," ",(0,E.tZ)(D.CC,{direction:"down",size:"xs",color:"gray300"})]},"age")],isLoading:p,children:n?.map((e=>{const{title:s}=(0,N.YQ)(e,t?.features,!1);return(0,E.BX)(r.Fragment,{children:[(0,E.BX)(M,{children:[(0,E.tZ)(R,{disableLink:!0,hideName:!0,avatarSize:18,project:e.project}),(0,E.tZ)(_,{children:(0,E.tZ)(j.Z,{to:{pathname:`/organizations/${t.slug}/issues/${e.id}/`},children:s})})]}),(0,E.tZ)($,{children:(0,E.tZ)(b.Z,{value:e.count})}),(0,E.tZ)($,{children:(0,E.tZ)(b.Z,{value:e.userCount})}),(0,E.tZ)($,{children:(0,E.tZ)(I.Z,{date:e.firstSeen})})]},e.id)}))})]})}X.displayName="TeamIssuesAge";const q=X,L=(0,n.Z)("div",{target:"eq9p07m5"})("padding:",(0,B.D)(2)," ",(0,B.D)(2)," 0 ",(0,B.D)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),O=(0,n.Z)(T.Z,{target:"eq9p07m4"})("grid-template-columns:1fr 0.15fr 0.15fr 0.25fr;white-space:nowrap;margin-bottom:0;border:0;font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:unset;>*{padding:",(0,B.D)(1)," ",(0,B.D)(2),";}",(e=>e.isEmpty&&(0,v.iv)("&>div:last-child{padding:48px ",(0,B.D)(2),";}","")),";"),$=(0,n.Z)("span",{target:"eq9p07m3"})({name:"19mh0x6",styles:"display:flex;align-items:center;justify-content:flex-end"}),M=(0,n.Z)("div",{target:"eq9p07m2"})((e=>e.theme.overflowEllipsis),";display:flex;align-items:center;"),_=(0,n.Z)("div",{target:"eq9p07m1"})((e=>e.theme.overflowEllipsis),";"),R=(0,n.Z)(w.Z,{target:"eq9p07m0"})("display:inline-flex;align-items:center;margin-right:",(0,B.D)(1),";*>img{box-shadow:none;}");var G=s("./app/components/collapsePanel.tsx"),F=s("./app/components/organizations/pageFilters/parse.tsx"),W=s("./app/stores/projectsStore.tsx"),P=s("./app/views/organizationStats/teamInsights/styles.tsx"),U=s("./app/views/organizationStats/teamInsights/utils.tsx");const K=["deleted","ignored","resolved","unignored","regressed","new","total"];function H(e){let{organization:t,projects:s,start:n,end:i,period:a,utc:o,teamSlug:d,statuses:u,environment:c}=e;const{data:m={},isLoading:p,isError:g,refetch:h}=(0,C.WE)([`/teams/${t.slug}/${d}/issue-breakdown/`,{query:{...(0,F.fK)({start:n,end:i,period:a,utc:o}),statuses:u,environment:c}}],{staleTime:5e3}),Z=t.features.includes("escalating-issues"),v={},y={};for(const[e,t]of Object.entries(m))for(const[s,n]of Object.entries(t)){y[e]||(y[e]={deleted:0,ignored:0,resolved:0,unignored:0,regressed:0,new:0,total:0});for(const t of K)y[e][t]+=n[t];v[e]||(v[e]={}),void 0===v[e][s]?v[e][s]=n.total:v[e][s]+=n.total}const x=Object.entries(y).map((e=>{let[t,{total:s}]=e;return{projectId:t,total:s}})).sort(((e,t)=>t.total-e.total)),b=Object.keys(v).map(((e,t)=>({seriesName:W.Z.getById(e)?.slug??e,data:(0,U.Gs)((0,U.E7)(v[e])),animationDuration:500,animationDelay:500*t,silent:!0,barCategoryGap:"5%"})));return g?(0,E.tZ)(S.Z,{onRetry:h}):(0,E.BX)(r.Fragment,{children:[(0,E.BX)(Y,{children:[p&&(0,E.tZ)(z.Z,{height:"200px"}),!p&&(0,E.tZ)(f.v,{style:{height:200},stacked:!0,isGroupedByDate:!0,useShortDate:!0,legend:{right:0,top:0},xAxis:(0,U.tP)(),yAxis:{minInterval:1},series:b})]}),(0,E.tZ)(G.Z,{items:x.length,children:e=>{let{isExpanded:t,showMoreButton:n}=e;return(0,E.BX)(r.Fragment,{children:[(0,E.tZ)(J,{numActions:u.length,headers:[(0,l.t)("Project"),...u.map((e=>Z?e.replace("ignore","archive"):e)).map((e=>(0,E.tZ)(ee,{children:e},e))),(0,E.BX)(ee,{children:[(0,l.t)("total")," ",(0,E.tZ)(D.CC,{direction:"down",size:"xs",color:"gray300"})]},"total")],isLoading:p,children:x.map(((e,n)=>{let{projectId:i}=e;const a=s.find((e=>e.id===i));return n>=G.$&&!t?null:(0,E.BX)(r.Fragment,{children:[(0,E.tZ)(P.R,{children:a&&(0,E.tZ)(P.W,{avatarSize:18,project:a})}),u.map((e=>(0,E.tZ)(ee,{children:y[i][e]},e))),(0,E.tZ)(ee,{children:y[i].total})]},i)}))}),!p&&n]})}})]})}H.displayName="TeamIssuesBreakdown";const Q=H,V=(0,n.Z)("div",{target:"e1hoqdvl3"})("padding:",(0,B.D)(2)," ",(0,B.D)(2)," 0 ",(0,B.D)(2),";"),Y=(0,n.Z)(V,{target:"e1hoqdvl2"})("border-bottom:1px solid ",(e=>e.theme.border),";"),J=(0,n.Z)(T.Z,{target:"e1hoqdvl1"})("grid-template-columns:1fr ",(e=>" 0.2fr".repeat(e.numActions))," 0.2fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,B.D)(1)," ",(0,B.D)(2),";}"),ee=(0,n.Z)("div",{target:"e1hoqdvl0"})({name:"mnwtso",styles:"text-align:right;font-variant-numeric:tabular-nums"});var te=s("./app/utils/formatters.tsx");function se(e){let{organization:t,teamSlug:s,environment:n,start:r,end:i,period:o,utc:d}=e;const u={start:r,end:i,period:o,utc:d},{data:c,isLoading:m,isError:p,refetch:g}=(0,C.WE)([`/teams/${t.slug}/${s}/time-to-resolution/`,{query:{...(0,F.fK)(u),environment:n}}],{staleTime:5e3});if(m)return(0,E.tZ)(re,{children:(0,E.tZ)(a.Z,{})});if(p)return(0,E.tZ)(S.Z,{onRetry:g});const h=Object.entries(c??{}).map((e=>{let[t,{avg:s}]=e;return{value:s,name:new Date(t).getTime()}})),Z=(0,U.Gs)(h);return(0,E.tZ)(re,{children:(0,E.tZ)(f.v,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",tooltip:{valueFormatter:e=>(0,te.g9)(e,1)},yAxis:{minInterval:86400,axisLabel:{formatter:e=>0===e?"":(0,te.g9)(e,0,!0,!0)}},legend:{right:0,top:0},xAxis:(0,U.tP)(),series:[{seriesName:(0,l.t)("Time to Resolution"),data:Z,silent:!0,barCategoryGap:"5%"}]})})}se.displayName="TeamResolutionTime";const ne=se,re=(0,n.Z)("div",{target:"ew4ocpl0"})("padding:",(0,B.D)(2)," ",(0,B.D)(2)," 0 ",(0,B.D)(2),";");function ie(e){let{organization:t,teamSlug:s,projects:n,start:i,end:a,period:o,utc:d,environment:u}=e;const{data:c={},isLoading:m,isError:p,refetch:g}=(0,C.WE)([`/teams/${t.slug}/${s}/all-unresolved-issues/`,{query:{...(0,F.fK)({start:i,end:a,period:o,utc:d}),environment:u}}],{staleTime:0});function h(e){const t=Object.values(c?.[e]??{}),s=t.reduce(((e,t)=>e+t.unresolved),0);return Math.round(s/t.length)}const Z={};for(const e of Object.keys(c)){const t=h(Number(e)),s=Object.values(c?.[e]??{}),n=s[s.length-1]?.unresolved??0,r=(n-t)/t;Z[e]={projectId:e,periodAvg:t,today:n,percentChange:Number.isNaN(r)?0:r}}const v=n.map((e=>({project:e,trend:Z[e.id]?.percentChange??0}))).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))),y=(0,U.NW)(v),x=Object.values(c).flatMap((e=>Object.entries(e).map((e=>{let[t,{unresolved:s}]=e;return[t,s]})))).reduce(((e,t)=>{let[s,n]=t;return void 0===e[s]&&(e[s]=0),e[s]+=n,e}),{}),b=(0,U.Gs)((0,U.E7)(x));return p?(0,E.tZ)(S.Z,{onRetry:g}):(0,E.BX)("div",{children:[(0,E.BX)(ae,{children:[m&&(0,E.tZ)(z.Z,{height:"200px"}),!m&&(0,E.tZ)(f.v,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,legend:{right:3,top:0},yAxis:{minInterval:1},xAxis:(0,U.tP)(),series:[{seriesName:(0,l.t)("Unresolved Issues"),silent:!0,data:b,barCategoryGap:"6%"}]})]}),(0,E.tZ)(G.Z,{items:y.length,children:e=>{let{isExpanded:t,showMoreButton:s}=e;return(0,E.BX)(r.Fragment,{children:[(0,E.tZ)(oe,{isEmpty:0===n.length,isLoading:m,headers:[(0,l.t)("Project"),(0,E.tZ)(de,{children:(0,l._N)("Last [period] Average",{period:o})},"last"),(0,E.tZ)(de,{children:(0,l.t)("Today")},"curr"),(0,E.tZ)(de,{children:(0,l.t)("Change")},"diff")],children:y.map(((e,s)=>{let{project:n}=e;const i=Z[n.id]??{};return s>=G.$&&!t?null:(0,E.BX)(r.Fragment,{children:[(0,E.tZ)(P.R,{children:(0,E.tZ)(P.W,{avatarSize:18,project:n})}),(0,E.tZ)(le,{children:i.periodAvg}),(0,E.tZ)(le,{children:i.today}),(0,E.tZ)(le,{children:(0,E.BX)(ce,{color:0===i.percentChange?"subText":i.percentChange>0?"errorText":"successText",children:[(0,te.rl)(Number.isNaN(i.percentChange)?0:i.percentChange,0),(0,E.tZ)(ue,{direction:i.percentChange>0?"up":"down",size:"xs"})]})})]},n.id)}))}),!m&&s]})}})]})}ie.displayName="TeamUnresolvedIssues";const ae=(0,n.Z)("div",{target:"e4muyu35"})("padding:",(0,B.D)(2)," ",(0,B.D)(2)," 0 ",(0,B.D)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),oe=(0,n.Z)(T.Z,{target:"e4muyu34"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;white-space:nowrap;margin-bottom:0;border:0;font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:unset;&>div{padding:",(0,B.D)(1)," ",(0,B.D)(2),";}"),de=(0,n.Z)("span",{target:"e4muyu33"})({name:"2qga7i",styles:"text-align:right"}),le=(0,n.Z)("div",{target:"e4muyu32"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),ue=(0,n.Z)(D.CC,{target:"e4muyu31"})("margin:0 ",(0,B.D)(.5),";"),ce=(0,n.Z)("div",{target:"e4muyu30"})("color:",(e=>e.theme[e.color]),";");function me(e){let{location:t,router:s}=e;const n=(0,m.Z)(),{teams:v,initiallyLoaded:y}=(0,p.y)({provideUserTeams:!0});(0,c.Z)("team_insights.viewed","Team Insights: Viewed");const x=t?.query??{},f=`teamInsightsSelectedTeamId:${n.slug}`;let b=x.team??u.Z.getItem(f);b&&!v.find((e=>e.id===b))&&(b=null);const w=b??v[0]?.id,j=v.find((e=>e.id===w)),S=j?.projects??[],T=x.environment,{period:z,start:I,end:D,utc:B}=(0,U.lI)(x),N=n.features.includes("escalating-issues");return 0===v.length?(0,E.tZ)(o.Z,{organization:n,superuserNeedsToBeProjectMember:!0}):(0,E.BX)(r.Fragment,{children:[(0,E.tZ)(d.Z,{title:(0,l.t)("Team Issues"),orgSlug:n.slug}),(0,E.tZ)(g.Z,{organization:n,activeTab:"issues"}),(0,E.BX)(ge,{children:[(0,E.tZ)(h.Z,{showEnvironment:!0,location:t,router:s,currentTeam:j,currentEnvironment:T}),!y&&(0,E.tZ)(a.Z,{}),y&&(0,E.BX)(i.or,{fullWidth:!0,children:[(0,E.tZ)(Z.Z,{title:(0,l.t)("All Unresolved Issues"),description:(0,l._N)("This includes New and Returning issues in the last 7 days as well as those that havenâ€™t been resolved or [status] in the past.",{status:N?"archived":"ignored"}),children:(0,E.tZ)(ie,{projects:S,organization:n,teamSlug:j.slug,environment:T,period:z,start:I,end:D,utc:B})}),(0,E.tZ)(Z.Z,{title:(0,l.t)("New and Returning Issues"),description:(0,l._N)("The new, regressed, and [status] issues that were assigned to your team.",{status:N?"escalating":"unignored"}),children:(0,E.tZ)(Q,{organization:n,projects:S,teamSlug:j.slug,environment:T,period:z,start:I?.toString(),end:D?.toString(),statuses:["new","regressed","unignored"]})}),(0,E.tZ)(Z.Z,{title:(0,l.t)("Issues Triaged"),description:(0,l.t)("How many new and returning issues were reviewed by your team each week. Reviewing an issue includes marking as reviewed, resolving, assigning to another team, or deleting."),children:(0,E.tZ)(Q,{organization:n,projects:S,teamSlug:j.slug,environment:T,period:z,start:I?.toString(),end:D?.toString(),statuses:["resolved","ignored","deleted"]})}),(0,E.tZ)(Z.Z,{title:(0,l.t)("Age of Unresolved Issues"),description:(0,l.t)("How long ago since unresolved issues were first created."),children:(0,E.tZ)(q,{organization:n,teamSlug:j.slug})}),(0,E.tZ)(Z.Z,{title:(0,l.t)("Time to Resolution"),description:(0,l.t)("The mean time it took for issues to be resolved by your team."),children:(0,E.tZ)(ne,{organization:n,environment:T,teamSlug:j.slug,period:z,start:I?.toString(),end:D?.toString()})})]})]})]})}me.displayName="TeamStatsIssues";const pe=me,ge=(0,n.Z)(i.uT,{target:"e1bncyea0"})("@media (min-width: ",(e=>e.theme.breakpoints.medium),"){display:block;}")}}]);
//# sourceMappingURL=../sourcemaps/app_views_organizationStats_teamInsights_issues_tsx.eac84a80bed0ebf479ba6e61628c0271.js.map