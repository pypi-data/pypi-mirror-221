(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_discover_tags_tsx-node_modules_lodash_assign_js"],{"./app/views/discover/tags.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>V});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("../node_modules/react/index.js"),n=s("../node_modules/@sentry/browser/node_modules/@sentry/core/esm/exports.js"),i=s("./app/actionCreators/events.tsx"),d=s("./app/components/button.tsx"),l=s("./app/components/charts/errorPanel.tsx"),c=s("./app/components/charts/styles.tsx"),p=s("./app/components/emptyStateWarning.tsx"),h=s("./app/components/group/tagFacets/index.tsx"),u=s("./app/components/group/tagFacets/tagFacetsDistributionMeter.tsx"),g=s("./app/components/placeholder.tsx"),m=s("./app/icons/index.tsx"),x=s("./app/locale.tsx"),y=s("./app/styles/space.tsx"),Z=s("./app/utils/analytics.tsx"),v=s("./app/utils/discover/eventView.tsx"),b=s("./app/utils/parseLinkHeader.tsx"),_=s("./app/utils/withApi.tsx"),f=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class j extends r.Component{constructor(){var e;super(...arguments),e=this,(0,a.Z)(this,"state",{loading:!0,tags:[],totalValues:null,error:"",hasMore:!1,hasLoaded:!1}),(0,a.Z)(this,"shouldRefetchData",(e=>{const t=this.props.eventView.getFacetsAPIPayload(this.props.location),s=e.eventView.getFacetsAPIPayload(e.location);return!(0,v.ze)(t,s)})),(0,a.Z)(this,"fetchData",(async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;const{api:o,organization:r,eventView:d,location:l,confirmedQuery:c}=e.props;if(e.setState({loading:!0,error:""}),a||e.setState({hasLoaded:!1,tags:[]}),t||!1!==c)try{const[t,,n]=await(0,i.eV)(o,r.slug,{...d.getFacetsAPIPayload(l),cursor:s}),c=n?.getResponseHeader("Link")??void 0;let p,h=!1;if(c){const e=(0,b.Z)(c);h=e?.next?.results??!1,p=e.next?.cursor}let u=t;r.features.includes("device-classification")||(u=u.filter((e=>"device.class"!==e.key))),a&&(u=[...e.state.tags,...u]),e.setState({loading:!1,hasLoaded:!0,tags:u,hasMore:h,nextCursor:p})}catch(t){400!==t.status&&"Invalid date range. Please try a more recent date range."!==t.responseJSON?.detail&&n.Tb(t),e.setState({loading:!1,error:t})}})),(0,a.Z)(this,"handleTagClick",(e=>{const{organization:t}=this.props;(0,Z.Gi)("discover_v2.facet_map.clicked",{organization:t,tag:e})})),(0,a.Z)(this,"renderBody",(()=>{const{loading:e,hasLoaded:t,error:s,tags:a,hasMore:o,nextCursor:n}=this.state;return e&&!t?this.renderPlaceholders():s?(0,f.tZ)(l.Z,{height:"132px",children:(0,f.tZ)(m.FC,{color:"gray300",size:"lg"})}):a.length>0?(0,f.BX)(r.Fragment,{children:[(0,f.tZ)(D,{children:a.map(((e,t)=>this.renderTag(e,t)))}),o&&(e?this.renderPlaceholders():(0,f.tZ)(F,{children:(0,f.tZ)(d.zx,{size:"xs",priority:"primary",disabled:e,"aria-label":(0,x.t)("Show More"),onClick:()=>{this.fetchData(!0,n,!0)},children:(0,x.t)("Show More")})}))]}):(0,f.tZ)(w,{small:!0,children:(0,x.t)("No tags found")})}))}componentDidMount(){this.fetchData(!0)}componentDidUpdate(e){(this.shouldRefetchData(e)||e.confirmedQuery!==this.props.confirmedQuery)&&this.fetchData()}renderTag(e,t){const{generateUrl:s,totalValues:a}=this.props,o=e.topValues.map((t=>(t.url=s(e.key,t.value),t))),r=o.length>0?Math.max(Number(a),o[0].count):a;return(0,f.tZ)("li",{"aria-label":e.key,children:(0,f.tZ)(u.Z,{title:e.key,segments:o,totalValues:Number(r),expandByDefault:0===t})},e.key)}renderPlaceholders(){return(0,f.BX)(r.Fragment,{children:[(0,f.tZ)(P,{},"title-1"),(0,f.tZ)(k,{},"bar-1"),(0,f.tZ)(P,{},"title-2"),(0,f.tZ)(k,{},"bar-2"),(0,f.tZ)(P,{},"title-3"),(0,f.tZ)(k,{},"bar-3")]})}render(){return(0,f.BX)(r.Fragment,{children:[(0,f.tZ)(c.OT,{children:(0,x.t)("Tag Summary")}),this.renderBody()]})}}j.displayName="Tags";const w=(0,o.Z)(p.Z,{target:"edev7d54"})({name:"rtpdsm",styles:"height:132px;padding:54px 15%"}),k=(0,o.Z)(g.Z,{target:"edev7d53"})("border-radius:",(e=>e.theme.borderRadius),";height:16px;margin-bottom:",(0,y.D)(1.5),";"),P=(0,o.Z)(g.Z,{target:"edev7d52"})("width:100px;height:12px;margin-bottom:",(0,y.D)(.5),";"),D=(0,o.Z)(h.WN,{target:"edev7d51"})({name:"13jhhqe",styles:"margin-bottom:0;width:100%"}),F=(0,o.Z)("div",{target:"edev7d50"})({name:"zigog8",styles:"display:flex;flex-direction:column;align-items:center"}),V=(0,_.Z)(j)},"../node_modules/lodash/assign.js":(e,t,s)=>{var a=s("../node_modules/lodash/_assignValue.js"),o=s("../node_modules/lodash/_copyObject.js"),r=s("../node_modules/lodash/_createAssigner.js"),n=s("../node_modules/lodash/isArrayLike.js"),i=s("../node_modules/lodash/_isPrototype.js"),d=s("../node_modules/lodash/keys.js"),l=Object.prototype.hasOwnProperty,c=r((function(e,t){if(i(t)||n(t))o(t,d(t),e);else for(var s in t)l.call(t,s)&&a(e,s,t[s])}));e.exports=c}}]);
//# sourceMappingURL=../sourcemaps/app_views_discover_tags_tsx-node_modules_lodash_assign_js.bf8ddc11f8c305b136046028665756c6.js.map