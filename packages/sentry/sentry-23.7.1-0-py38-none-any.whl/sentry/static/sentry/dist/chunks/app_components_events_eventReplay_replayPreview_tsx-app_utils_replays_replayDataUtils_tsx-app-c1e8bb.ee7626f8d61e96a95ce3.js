"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_events_eventReplay_replayPreview_tsx-app_utils_replays_replayDataUtils_tsx-app-c1e8bb"],{"./app/components/events/eventReplay/replayPreview.tsx":(e,t,a)=>{a.r(t),a.d(t,{default:()=>M});var r=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=a("../node_modules/react/index.js"),s=a("./app/components/alert.tsx"),i=a("./app/components/button.tsx"),o=a("./app/components/links/externalLink.tsx"),p=a("./app/components/list/index.tsx"),l=a("./app/components/list/listItem.tsx"),m=a("./app/components/placeholder.tsx"),d=a("./app/components/replays/replayContext.tsx"),c=a("./app/components/replays/replayPlayer.tsx"),u=a("./app/components/replays/utils.tsx"),y=a("./app/icons/index.tsx"),f=a("./app/locale.tsx"),g=a("./app/styles/space.tsx"),h=a("./app/utils/getRouteStringFromRoutes.tsx"),b=a("./app/utils/replays/hooks/useReplayReader.tsx"),v=a("./app/utils/useRoutes.tsx"),x=a("./app/utils/withDomainRequired.tsx"),T=a("./app/views/replays/detail/layout/fluidHeight.tsx"),w=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function k(e){let{orgSlug:t,replaySlug:a,event:r,onClickOpenReplay:m}=e;const g=(0,v.V)(),{fetching:T,replay:k,replayRecord:M,fetchError:I,replayId:j}=(0,b.Z)({orgSlug:t,replaySlug:a}),O=r.dateCreated??r.dateReceived,C=O?1e3*Math.floor(new Date(O).getTime()/1e3):0,U=M?.started_at.getTime()??0,q=(0,n.useMemo)((()=>C&&U?(0,u.NH)(C,U):0),[C,U]);if(I){const e=[(0,f.t)("The replay was rate-limited and could not be accepted."),(0,f.t)("The replay has been deleted by a member in your organization."),(0,f.t)("There were network errors and the replay was not saved."),(0,f._N)("[link:Read the docs] to understand why.",{link:(0,w.tZ)(o.Z,{href:"https://docs.sentry.io/platforms/javascript/session-replay/#error-linking"})})];return(0,w.BX)(s.bZ,{type:"info",showIcon:!0,"data-test-id":"replay-error",trailingItems:(0,w.tZ)(i.zx,{external:!0,href:"https://docs.sentry.io/platforms/javascript/session-replay/#error-linking",size:"xs",children:(0,f.t)("Read Docs")}),children:[(0,w.tZ)("p",{children:(0,f.t)("The replay for this event cannot be found. This could be due to these reasons:")}),(0,w.tZ)(p.Z,{symbol:"bullet",children:e.map(((e,t)=>(0,w.tZ)(l.Z,{children:e},t)))})]})}if(T||!M)return(0,w.tZ)(N,{testId:"replay-loading-placeholder",height:"400px",width:"100%"});const B={pathname:(0,x.D)(`/organizations/${t}/replays/${j}/`),query:{referrer:(0,h.Z)(g),t_main:"console",t:q/1e3}};return(0,w.tZ)(d.z,{isFetching:T,replay:k,initialTimeOffsetMs:{offsetMs:q},children:(0,w.BX)(_,{"data-test-id":"player-container",children:[(0,w.tZ)(Z,{children:(0,w.tZ)(c.Z,{isPreview:!0})}),(0,w.tZ)(D,{children:(0,w.tZ)(i.zx,{onClick:m,icon:(0,w.tZ)(y.JF,{}),priority:"primary",to:B,children:(0,f.t)("Open Replay")})}),(0,w.tZ)(R,{children:(0,w.tZ)(S,{children:(0,f.t)("Replays")})})]})})}k.displayName="ReplayPreview";const _=(0,r.Z)(T.Z,{target:"e7frq835"})("position:relative;margin-bottom:",(0,g.D)(2),";background:",(e=>e.theme.background),";gap:",(0,g.D)(1),";max-height:448px;"),Z=(0,r.Z)(T.Z,{target:"e7frq834"})("border:1px solid ",(e=>e.theme.border),";border-radius:",(e=>e.theme.borderRadius),";"),D=(0,r.Z)("div",{target:"e7frq833"})({name:"pw760u",styles:"position:absolute;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background:rgba(255, 255, 255, 0.5)"}),R=(0,r.Z)("div",{target:"e7frq832"})("display:flex;align-items:center;position:absolute;top:",(0,g.D)(1),";right:",(0,g.D)(1),";background:",(e=>e.theme.background),";border-radius:2.25rem;padding:",(0,g.D)(.75)," ",(0,g.D)(.75)," ",(0,g.D)(.75)," ",(0,g.D)(1),";box-shadow:",(e=>e.theme.dropShadowLight),";gap:0 ",(0,g.D)(.25),";"),S=(0,r.Z)("div",{target:"e7frq831"})("font-size:",(e=>e.theme.fontSizeSmall),";line-height:0;color:",(e=>e.theme.text),";"),N=(0,r.Z)(m.Z,{target:"e7frq830"})("margin-bottom:",(0,g.D)(2),";"),M=k},"./app/components/replays/utils.tsx":(e,t,a)=>{a.d(t,{DF:()=>m,NH:()=>o,Nu:()=>d,UJ:()=>u,Ul:()=>p,cs:()=>y,mr:()=>l}),a("../node_modules/core-js/modules/es.array.push.js");var r=a("./app/utils/formatters.tsx");const n=1e3,s=60*n,i=60*s;function o(e,t){return Math.abs(new Date(e).getTime()-t)}function p(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return l(o(e,t),a)}function l(e,t){if(e<=0||isNaN(e))return t?"00:00.000":"00:00";const a=e/1e3;return(0,r.HE)(t?a:Math.floor(a))}function m(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=Math.floor(t/a);r-=e-r*t>0?1:0;const o=[1*i,30*s,20*s,15*s,10*s,5*s,2*s,1*s,30*n,10*n,5*n,1*n].reduce(((t,a)=>(t.set(a,Math.floor(e/a)),t)),new Map),[p,l]=Array.from(o.entries()).filter((e=>{let[t,a]=e;return a<=r})).reduce(((e,t)=>t[1]>e[1]?t:e),[0,0]);return{timespan:p,cols:l,remaining:(e-p*l)/p}}function d(e,t,a){const r=isNaN(e)?1:e;return t.map((e=>{const t=Math.floor(e.offsetMs/r*(a-1))+1;return[Math.max(1,t),e]})).reduce(((e,t)=>{let[a,r]=t;return e.has(a)?e.get(a)?.push(r):e.set(a,[r]),e}),new Map)}function c(e,t){const a=e.startTimestamp<=t.startTimestamp&&t.startTimestamp<=e.endTimestamp,r=e.startTimestamp<=t.endTimestamp&&t.endTimestamp<=e.endTimestamp;return a||r}function u(e){if(!e.length)return[];const[t,...a]=e.map((e=>({frameCount:1,startTimestamp:e.timestampMs,endTimestamp:e.endTimestampMs,duration:e.endTimestampMs-e.timestampMs}))),r=[t];for(const e of a){let t=!1;for(const a of r)if(c(a,e)){t=!0,a.frameCount+=1,a.startTimestamp=Math.min(a.startTimestamp,e.startTimestamp),a.endTimestamp=Math.max(a.endTimestamp,e.endTimestamp),a.duration=a.endTimestamp-a.startTimestamp;break}t||r.push(e)}return r}function y(e,t){return void 0===t||isNaN(t)||0===t?0:e/t}},"./app/utils/date/isValidDate.tsx":(e,t,a)=>{function r(e){return e instanceof Date&&!isNaN(e.getTime())}a.d(t,{Z:()=>r})},"./app/utils/replays/replayDataUtils.tsx":(e,t,a)=>{a.d(t,{so:()=>c,qC:()=>d,iz:()=>y,_O:()=>u});var r=a("../node_modules/invariant/browser.js"),n=a.n(r),s=a("../node_modules/moment/moment.js"),i=a("./app/components/events/interfaces/breadcrumbs/utils.tsx"),o=a("./app/locale.tsx"),p=a("./app/types/breadcrumbs.tsx"),l=a("./app/utils/date/isValidDate.tsx");function m(e){let t=e.length,a=1/0,r=-1/0;for(;t--;)a=e[t]<a?e[t]:a,r=e[t]>r?e[t]:r;return{min:a,max:r}}function d(e){const t=Object.fromEntries(Object.entries(e.user).filter((e=>{let[t,a]=e;return"display_name"!==t&&a})).map((e=>{let[t,a]=e;return[`user.${t}`,[a]]}))),a={...e.tags,...e.browser?.name?{"browser.name":[e.browser.name]}:{},...e.browser?.version?{"browser.version":[e.browser.version]}:{},...e.device?.brand?{"device.brand":[e.device.brand]}:{},...e.device?.family?{"device.family":[e.device.family]}:{},...e.device?.model_id?{"device.model_id":[e.device.model_id]}:{},...e.device?.name?{"device.name":[e.device.name]}:{},...e.platform?{platform:[e.platform]}:{},...e.releases?{releases:[...e.releases]}:{},...e.replay_type?{replayType:[e.replay_type]}:{},...e.os?.name?{"os.name":[e.os.name]}:{},...e.os?.version?{"os.version":[e.os.version]}:{},...e.sdk?.name?{"sdk.name":[e.sdk.name]}:{},...e.sdk?.version?{"sdk.version":[e.sdk.version]}:{},...t},r=Object.keys(a).sort().reduce(((e,t)=>(e[t]=a[t],e)),{}),i=new Date(e.started_at);n()((0,l.Z)(i),"replay.started_at is invalid");const o=new Date(e.finished_at);return n()((0,l.Z)(o),"replay.finished_at is invalid"),{...e,...e.started_at?{started_at:i}:{},...e.finished_at?{finished_at:o}:{},...void 0!==e.duration?{duration:(0,s.duration)(1e3*e.duration)}:{},tags:r}}function c(e,t,a,r){const n=["ui.focus","ui.blur"],s=e.urls?.[0]??e.tags.url?.join(", "),l={type:p.kS.INIT,timestamp:e.started_at.toISOString(),level:p.nU.INFO,message:s,data:{action:"replay-init",label:(0,o.t)("Start recording"),url:s}},m=t.map((e=>({type:p.kS.ERROR,level:p.nU.ERROR,category:"issue",message:e.title,data:{label:e["error.type"].join(""),eventId:e.id,groupId:e["issue.id"]||1,groupShortId:e.issue,project:e["project.name"]},timestamp:e.timestamp}))),d=r.filter((e=>["navigation.navigate","navigation.reload","largest-contentful-paint"].includes(e.op))).sort(((e,t)=>e.startTimestamp-t.startTimestamp)).map((e=>{if(e.op.startsWith("navigation")){const[,t]=e.op.split(".");try{return{category:"default",type:p.kS.NAVIGATION,timestamp:new Date(1e3*e.startTimestamp).toISOString(),level:p.nU.INFO,message:e.description,action:t,data:{to:e.description,label:"reload"===t?(0,o.t)("Reload"):"navigate"===t?(0,o.t)("Page load"):(0,o.t)("Navigation"),...e.data}}}catch{return null}}try{return{type:p.kS.DEBUG,timestamp:new Date(1e3*e.startTimestamp).toISOString(),level:p.nU.INFO,category:"default",data:{action:e.op,...e.data,label:"largest-contentful-paint"===e.op?(0,o.t)("LCP"):e.op}}}catch{return null}})).filter(Boolean),c=r.find((e=>"navigation.navigate"===e.op)),u=a.filter((e=>!n.includes(e.category||"")&&(!e.category?.startsWith("replay")||"replay.mutations"===e.category)&&("ui.slowClickDetected"!==e.category||e.data?.timeAfterClickMs>=3e3))).map((e=>{if("replay.mutations"===e.category){const t=e.data;try{return{...e,type:t.limit?p.kS.ERROR:p.kS.WARNING,level:t.limit?p.nU.FATAL:p.nU.WARNING,timestamp:new Date(1e3*e.timestamp).toISOString()}}catch{return null}}try{return{...e,type:p.kS.DEFAULT,timestamp:new Date(1e3*e.timestamp).toISOString()}}catch{return null}})).filter(Boolean);return(0,i.LP)([...r.length&&!c?[l]:[],...u,...m,...d]).sort(((e,t)=>+new Date(e.timestamp||0)-+new Date(t.timestamp||0)))}function u(e){return e.sort(((e,t)=>e.startTimestamp-t.startTimestamp)).map((e=>({...e,id:`${e.description??e.op}-${e.startTimestamp}-${e.endTimestamp}`,timestamp:1e3*e.startTimestamp})))}function y(e,t,a,r){const n=t.map((e=>e.timestamp)).filter(Boolean),s=a.map((e=>e.timestamp)).filter(Boolean),i=r.filter((e=>{let{op:t}=e;return"largest-contentful-paint"!==t})),o=i.map((e=>e.startTimestamp)),p=i.map((e=>e.endTimestamp)),{min:l,max:d}=m(n),{min:c,max:u}=m(s),{min:y}=m(o),{max:f}=m(p);return{startTimestampMs:Math.min(e.started_at.getTime(),l,1e3*c,1e3*y),endTimestampMs:Math.max(e.finished_at.getTime(),d,1e3*u,1e3*f)}}},"./app/utils/replays/types.tsx":(e,t,a)=>{a.d(t,{HY:()=>p,Nw:()=>g,TG:()=>u,UI:()=>o,cq:()=>y,h5:()=>d,lp:()=>l,qY:()=>f,rN:()=>c,tk:()=>i,tw:()=>r.tw,zp:()=>m}),a("../node_modules/@sentry-internal/rrweb-snapshot/es/rrweb-snapshot.js");var r=a("../node_modules/@sentry-internal/rrweb/es/rrweb/packages/rrweb/src/types.js"),n=a("../node_modules/invariant/browser.js"),s=a.n(n);function i(e){return"type"in e&&"timestamp"in e}function o(e){return"breadcrumb"===e.data?.tag}function p(e){return"performanceSpan"===e.data?.tag}function l(e){return"options"===e.data?.tag}function m(e){return Boolean(e&&"category"in e&&"issue"!==e.category)}function d(e){return Boolean(e&&"op"in e)}function c(e){return Boolean(e&&"category"in e&&"issue"===e.category)}function u(e){const t="op"in e&&e.op||"category"in e&&e.category;return s()(t,"Frame has no category or op"),t}function y(e){return"timeout"===e.data.endReason}function f(e){return Boolean(y(e)&&e.data.clickCount&&e.data.clickCount>=5)}function g(e){return e.data.clickCount>=5}}}]);
//# sourceMappingURL=../sourcemaps/app_components_events_eventReplay_replayPreview_tsx-app_utils_replays_replayDataUtils_tsx-app-c1e8bb.449ad2d988c981aa8dc4e85067705483.js.map