"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_modals_widgetViewerModal_tsx"],{"./app/components/modals/widgetViewerModal.tsx":(e,t,i)=>{i.r(t),i.d(t,{default:()=>ke,modalCss:()=>Te});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(i("../node_modules/core-js/modules/es.array.push.js"),i("../node_modules/core-js/modules/es.array.unshift.js"),i("../node_modules/react/index.js")),a=i("../node_modules/react-select/dist/index-4bd03571.esm.js"),o=i("../node_modules/@sentry/browser/node_modules/@sentry/core/esm/exports.js"),r=i("../node_modules/@sentry/utils/esm/string.js"),l=i("../node_modules/lodash/cloneDeep.js"),d=i.n(l),c=i("../node_modules/lodash/isEqual.js"),u=i.n(c),p=i("../node_modules/lodash/trimStart.js"),m=i.n(p),g=i("../node_modules/moment/moment.js"),y=i.n(g),h=i("./app/actionCreators/events.tsx"),w=i("./app/components/alert.tsx"),f=i("./app/components/button.tsx"),b=i("./app/components/buttonBar.tsx"),v=i("./app/components/forms/controls/selectControl.tsx"),x=i("./app/components/forms/controls/selectOption.tsx"),Z=i("./app/components/gridEditable/index.tsx"),T=i("./app/components/pagination.tsx"),R=i("./app/components/questionTooltip.tsx"),_=i("./app/components/searchSyntax/parser.tsx"),O=i("./app/components/searchSyntax/renderer.tsx"),C=i("./app/locale.tsx"),E=i("./app/styles/space.tsx"),S=i("./app/utils.tsx"),q=i("./app/utils/analytics.tsx"),k=i("./app/utils/dates.tsx"),L=i("./app/utils/discover/fields.tsx"),D=i("./app/utils/parseLinkHeader.tsx"),z=i("./app/utils/performance/contexts/metricsCardinality.tsx"),P=i("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),F=i("./app/utils/queryString.tsx"),j=i("./app/utils/useApi.tsx"),A=i("./app/utils/useLocation.tsx"),I=i("./app/utils/useProjects.tsx"),B=i("./app/utils/useRouter.tsx"),N=i("./app/utils/withPageFilters.tsx"),V=i("./app/views/dashboards/types.tsx"),G=i("./app/views/dashboards/utils.tsx"),M=i("./app/views/dashboards/widgetCard/index.tsx"),U=i("./app/views/dashboards/widgetCard/chart.tsx"),H=i("./app/views/dashboards/widgetCard/dashboardsMEPContext.tsx"),Q=i("./app/views/dashboards/widgetCard/issueWidgetQueries.tsx"),W=i("./app/views/dashboards/widgetCard/releaseWidgetQueries.tsx"),X=i("./app/views/dashboards/widgetCard/widgetCardChartContainer.tsx"),$=i("./app/views/dashboards/widgetCard/widgetQueries.tsx"),Y=i("./app/views/discover/utils.tsx"),J=i("./app/views/organizationContext.tsx"),K=i("./app/views/performance/landing/metricsDataSwitcher.tsx"),ee=i("./app/components/modals/widgetViewerModal/utils.tsx"),te=i("./app/components/gridEditable/sortLink.tsx"),ie=(i("./app/components/links/link.tsx"),i("./app/components/tooltip.tsx")),ne=i("./app/utils/dashboards/issueFieldRenderers.tsx"),se=i("./app/utils/discover/eventView.tsx"),ae=i("./app/utils/discover/fieldRenderers.tsx"),oe=i("./app/views/dashboards/widgetBuilder/issueWidget/fields.tsx"),re=i("./app/views/discover/table/tableView.tsx"),le=i("./app/views/discover/table/topResultsIndicator.tsx"),de=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const ce=e=>{let{location:t,widget:i,tableData:n,organization:s,onHeaderClick:a}=e;return function(e,o){const r=n?.meta,l=(0,L.qG)(e.name,e.type,r),d=(0,ne.N)(String(e.key));return(0,de.tZ)(te.Z,{align:l,title:(0,de.tZ)(ge,{title:e.name,children:e.name}),direction:i.queries[0].orderby===d?"desc":void 0,canSort:!!d,generateSortLink:()=>({...t,query:{...t.query,[ee.R.SORT]:d,[ee.R.PAGE]:void 0,[ee.R.CURSOR]:void 0}}),onClick:()=>{a?.(),(0,q.Gi)("dashboards_views.widget_viewer.sort",{organization:s,widget_type:V.l9.ISSUE,display_type:i.displayType,column:e.name,order:"desc"})}})}},ue=e=>{let{location:t,selection:i,widget:n,tableData:s,organization:a,onHeaderClick:o,isMetricsData:r}=e;return function(e,l){const{orderby:d}=n.queries[0],c=`${d.startsWith("-")?"-":""}${(0,L.LY)(m()(d,"-"))}`,u=(0,G.tT)(n.title,{...n.queries[0],orderby:c},i,n.displayType),p=s?.meta,g=(0,L.qG)(e.name,e.type,p),y={field:String(e.key),width:e.width},h=u.sortForField(y,p),w=!(r&&"title"===y.field)&&(0,se.M3)(y,p),f=(0,L.uI)(e.name)?u.getEquations()[(0,L.G5)(e.name)]:e.name;return(0,de.tZ)(te.Z,{align:g,title:(0,de.tZ)(ge,{title:f,children:f}),direction:h?h.kind:void 0,canSort:w,generateSortLink:function(){if(!p)return;const e=u.sortOnField(y,p,void 0,!0).generateQueryStringObject();return{...t,query:{...t.query,[ee.R.SORT]:e.sort,[ee.R.PAGE]:void 0,[ee.R.CURSOR]:void 0}}},onClick:()=>{o?.(),(0,q.Gi)("dashboards_views.widget_viewer.sort",{organization:a,widget_type:V.l9.DISCOVER,display_type:n.displayType,column:e.name,order:"desc"===h?.kind?"asc":"desc"})}})}},pe=e=>{let{location:t,organization:i,widget:n,tableData:a,isFirstPage:o,projects:r,eventView:l}=e;return function(e,d,c,u){const p=String(e.key),m=n.displayType===V.FO.TOP_N;let g;switch(n.widgetType){case V.l9.ISSUE:g=((0,ne.O)(p)??(0,ae.Js)(p,oe.$L))(d,{organization:i,location:t});break;case V.l9.DISCOVER:default:if(!a||!a.meta)return d[e.key];const n=a.meta.units?.[e.key];g=(0,ae.Js)(p,a.meta,!1)(d,{organization:i,location:t,unit:n});const s=(0,L.LY)(p),o=d[s];if("integer"===a.meta[s]&&(0,S.ri)(o)&&o>999)return(0,de.tZ)(ie.u,{title:o.toLocaleString(),containerDisplayMode:"block",position:"right",children:g})}"transaction"===p&&d.transaction&&(g=(0,de.tZ)(re.Oj,{"data-test-id":"widget-viewer-transaction-link",to:(0,Y.vT)(d,i,r,l),children:g}));const y=a?Math.min(a?.data.length,5):5;return(0,de.BX)(s.Fragment,{children:[m&&o&&c<5&&0===u?(0,de.tZ)(le.C,{count:y,index:c}):null,g]})}},me=e=>{let{location:t,widget:i,tableData:n,organization:s,onHeaderClick:a}=e;return function(e,o){const r=n?.meta,l=(0,L.qG)(e.name,e.type,r),d=i.queries[0].orderby,c={kind:d.startsWith("-")?"desc":"asc",field:d.startsWith("-")?d.slice(1):d},u=(0,L.h1)(e.name),p=e.name;return(0,de.tZ)(te.Z,{align:l,title:(0,de.tZ)(ge,{title:p,children:p}),direction:c.field===e.name?c.kind:void 0,canSort:u,generateSortLink:function(){const i=e.name===c.field?{...c,kind:"desc"===c.kind?"asc":"desc"}:{kind:"desc",field:e.name};return{...t,query:{...t.query,[ee.R.SORT]:"desc"===i.kind?`-${i.field}`:i.field,[ee.R.PAGE]:void 0,[ee.R.CURSOR]:void 0}}},onClick:()=>{a?.(),(0,q.Gi)("dashboards_views.widget_viewer.sort",{organization:s,widget_type:V.l9.RELEASE,display_type:i.displayType,column:e.name,order:"desc"===c?.kind?"asc":"desc"})}})}},ge=(0,n.Z)(ie.u,{target:"e17t3rbx1"})({name:"168giuu",styles:"display:initial"}),ye="geo.country_code",he="(Empty Query Condition)",we=(e,t)=>{const i=t.selection===e.selection,n=t.location.query[ee.R.SORT]===e.location.query[ee.R.SORT],s=u()(t.chartZoomOptions,e.chartZoomOptions),a=t.widget.displayType!==V.FO.TOP_N&&!(0,S.ri)(t.widget.limit);return i&&s&&(n||a)},fe=(0,s.memo)(X.b,we),be=(0,s.memo)(U.Z,we);function ve(e){const{organization:t,widget:i,selection:n,Footer:l,Body:c,Header:u,closeModal:p,onEdit:g,seriesData:R,tableData:N,totalIssuesCount:X,pageLinks:te,seriesResultsType:ie,dashboardFilters:ne}=e,se=(0,A.T)(),{projects:ae}=(0,I.Z)(),oe=(0,B.Z)(),re=t.features.includes("widget-viewer-modal-minimap"),le=(0,F.ro)(se.query[ee.R.START]),ge=(0,F.ro)(se.query[ee.R.END]),we=i.displayType===V.FO.TABLE,ve=i.queries.some((e=>e.aggregates.some((e=>e.includes("session.duration"))))),Te=(0,s.useMemo)((()=>le&&ge?{...n,datetime:{start:le,end:ge,period:null,utc:null}}:n),[le,ge,n]),[ke,Le]=(0,s.useState)(!0),[De,ze]=(0,s.useState)({start:0,end:100}),[Pe,Fe]=(0,s.useState)(Te),je=(0,s.useRef)(Pe);(0,s.useEffect)((()=>{"POP"===se.action&&(Fe(Te),ze(le&&ge?{startValue:1e3*y().utc(le).unix(),endValue:1e3*y().utc(ge).unix()}:{start:0,end:100}))}),[ge,se,Te,le]);const[Ae,Ie]=(0,s.useState)((0,F.qP)(se.query[ee.R.LEGEND]).reduce(((e,t)=>(e[t]=!1,e)),{})),[Be,Ne]=(0,s.useState)(),Ve=(0,F._q)(se.query[ee.R.QUERY])??0,Ge=(0,F._q)(se.query[ee.R.PAGE])??0,Me=(0,F.ro)(se.query[ee.R.CURSOR]),Ue=(0,F.qP)(se.query[ee.R.WIDTH]),He=(0,F.ro)(se.query[ee.R.SORT]),Qe=d()(He?i.queries.map((e=>({...e,orderby:He}))):i.queries),We=i.displayType===V.FO.TOP_N||void 0!==i.limit?{...i,queries:Qe}:i,Xe=(0,j.Z)(),$e={...d()({...i,queries:[Qe[Ve]]}),displayType:V.FO.TABLE},{aggregates:Ye,columns:Je}=$e.queries[0],{orderby:Ke}=i.queries[0],et=Ke.startsWith("-"),tt=m()(Ke,"-"),it=(0,S.ri)($e.queries[0].fields)?$e.queries[0].fields:[...Je,...Ye];i.widgetType!==V.l9.DISCOVER||!Ke||(0,L.uI)(tt)||it.includes(tt)||(it.push(tt),[$e,We].forEach((e=>{(0,L.h1)(tt)||(0,L.GO)(tt)?e.queries.forEach((e=>{e.aggregates.includes(tt)||e.aggregates.push(tt)})):e.queries.forEach((e=>{e.columns.includes(tt)||e.columns.push(tt)}))}))),(0,L.GO)(tt)&&$e.queries[0].orderby===Ke&&($e.queries[0].orderby=`${et?"-":""}equation[${(0,G.yd)(it)-1}]`),i.displayType!==V.FO.WORLD_MAP||Je.includes(ye)||(it.unshift(ye),Je.unshift(ye));const nt=[V.FO.AREA,V.FO.LINE,V.FO.BIG_NUMBER,V.FO.BAR].includes(i.displayType)&&i.widgetType&&[V.l9.DISCOVER,V.l9.RELEASE].includes(i.widgetType)&&!(0,S.ri)(i.limit);if(we||(0,G.Mf)(it).forEach((e=>{(0,L.h1)(e)&&!Ye.includes(e)&&Ye.unshift(e),(0,L.h1)(e)||Je.includes(e)||Je.unshift(e)})),Je.forEach((e=>{it.includes(e)||it.unshift(e)})),nt)switch(i.widgetType){case V.l9.DISCOVER:1===it.length&&($e.queries[0].orderby=$e.queries[0].orderby||`-${it[0]}`),it.unshift("title"),Je.unshift("title");break;case V.l9.RELEASE:it.unshift("release"),Je.unshift("release")}const st=(0,G.tT)($e.title,$e.queries[0],Pe,$e.displayType);let at=(0,Y.Hg)(it.map((e=>({field:e}))));const ot=st.getSorts();at=at.map(((e,t)=>({...e,width:parseInt(Ue[t],10)||-1})));const rt=Qe.map(((e,t)=>{let{name:i,conditions:n}=e;const s=(0,G.DF)(ne),a=!i&&n?(0,_.UG)(n+(""===s?"":` ${s}`)):null;return{label:(0,r.$G)(i||n,120),value:t,getHighlightedQuery:e=>null!==a?(0,de.tZ)(Ce,{...e,children:(0,de.tZ)(O.Z,{parsedQuery:a})}):void 0}})),lt=(e,t)=>{const i=t.width?Number(t.width):Z.z7,n=new Array(Math.max(e,Ue.length)).fill(Z.z7);Ue.forEach(((e,t)=>n[t]=parseInt(e,10))),n[e]=i,oe.replace({pathname:se.pathname,query:{...se.query,[ee.R.WIDTH]:n}})};function dt(e){let{selected:n}=e;Ie(n),oe.replace({pathname:se.pathname,query:{...se.query,[ee.R.LEGEND]:Object.keys(n).filter((e=>!n[e]))}}),(0,q.Gi)("dashboards_views.widget_viewer.toggle_legend",{organization:t,widget_type:i.widgetType??V.l9.DISCOVER,display_type:i.displayType})}function ct(n){let{tableResults:a,loading:o,pageLinks:r}=n;const{isMetricsData:l}=(0,H.XA)(),d=(0,D.Z)(r??null),c=!1===d.previous?.results;return(0,de.BX)(s.Fragment,{children:[(0,de.tZ)(Z.ZP,{isLoading:o,data:a?.[0]?.data??[],columnOrder:at,columnSortBy:ot,grid:{renderHeadCell:ue({...e,location:se,widget:$e,tableData:a?.[0],onHeaderClick:()=>{([V.FO.TOP_N,V.FO.TABLE].includes(i.displayType)||(0,S.ri)(i.limit))&&Le(!1)},isMetricsData:l}),renderBodyCell:pe({...e,location:se,tableData:a?.[0],isFirstPage:c,projects:ae,eventView:st}),onResizeColumn:lt},location:se}),(d?.previous?.results||d?.next?.results)&&(0,de.tZ)(T.Z,{pageLinks:r,onCursor:e=>{oe.replace({pathname:se.pathname,query:{...se.query,[ee.R.CURSOR]:e}}),i.displayType===V.FO.TABLE&&Le(!1),(0,q.Gi)("dashboards_views.widget_viewer.paginate",{organization:t,widget_type:V.l9.DISCOVER,display_type:i.displayType})}})]})}(0,s.useEffect)((()=>{(async()=>{i.widgetType===V.l9.DISCOVER&&Ne(await async function(e,t,i,n){if(n.isValid())try{return(await(0,h.JE)(e,t.slug,n.getEventsAPIPayload(i))).toLocaleString()}catch(e){return void o.Tb(e)}}(Xe,t,se,st))})()}),[Ve]);const ut=e=>{let{tableResults:a,loading:o,pageLinks:r,totalCount:l}=e;void 0===Be&&l&&Ne(l);const d=(0,D.Z)(r??null);return(0,de.BX)(s.Fragment,{children:[(0,de.tZ)(Z.ZP,{isLoading:o,data:a?.[0]?.data??[],columnOrder:at,columnSortBy:ot,grid:{renderHeadCell:ce({location:se,organization:t,selection:n,widget:$e,onHeaderClick:()=>{Le(!1)}}),renderBodyCell:pe({location:se,organization:t,selection:n,widget:$e}),onResizeColumn:lt},location:se}),(d?.previous?.results||d?.next?.results)&&(0,de.tZ)(T.Z,{pageLinks:r,onCursor:(e,n,s,a)=>{let o=isNaN(Ge)?a:Ge+a,r=e;o<=0&&(r=void 0,o=0),oe.replace({pathname:se.pathname,query:{...se.query,[ee.R.CURSOR]:r,[ee.R.PAGE]:o}}),i.displayType===V.FO.TABLE&&Le(!1),(0,q.Gi)("dashboards_views.widget_viewer.paginate",{organization:t,widget_type:V.l9.ISSUE,display_type:i.displayType})}})]})},pt=n=>{let{tableResults:a,loading:o,pageLinks:r}=n;const l=(0,D.Z)(r??null),d=!1===l.previous?.results;return(0,de.BX)(s.Fragment,{children:[(0,de.tZ)(Z.ZP,{isLoading:o,data:a?.[0]?.data??[],columnOrder:at,columnSortBy:ot,grid:{renderHeadCell:me({...e,location:se,widget:$e,tableData:a?.[0],onHeaderClick:()=>{([V.FO.TOP_N,V.FO.TABLE].includes(i.displayType)||(0,S.ri)(i.limit))&&Le(!1)}}),renderBodyCell:pe({...e,location:se,tableData:a?.[0],isFirstPage:d}),onResizeColumn:lt},location:se}),!$e.queries[0].orderby.match(/^-?release$/)&&(l?.previous?.results||l?.next?.results)&&(0,de.tZ)(T.Z,{pageLinks:r,onCursor:e=>{oe.replace({pathname:se.pathname,query:{...se.query,[ee.R.CURSOR]:e}}),(0,q.Gi)("dashboards_views.widget_viewer.paginate",{organization:t,widget_type:V.l9.RELEASE,display_type:i.displayType})}})]})},mt=(e,n)=>{const s=n.getModel(),{seriesStart:a,seriesEnd:o}=e;let r,l;r=s._payload.batch?.[0].startValue,l=s._payload.batch?.[0].endValue;const d=a?new Date(a).getTime():void 0,c=o?new Date(o).getTime():void 0;if(void 0===r||void 0===l){if(!d||!c)return;{const e=c-d;r=e*s._payload.start*.01+d,l=e*s._payload.end*.01+d}}ze({startValue:r,endValue:l});const u=(0,k.v5)(y().utc(r)),p=(0,k.v5)(y().utc(l));Fe({...Pe,datetime:{...Pe.datetime,start:u,end:p,period:null}}),oe.push({pathname:se.pathname,query:{...se.query,[ee.R.START]:u,[ee.R.END]:p}}),(0,q.Gi)("dashboards_views.widget_viewer.zoom",{organization:t,widget_type:i.widgetType??V.l9.DISCOVER,display_type:i.displayType})};function gt(){switch(i.widgetType){case V.l9.ISSUE:return N&&ke&&i.displayType===V.FO.TABLE?ut({tableResults:N,loading:!1,errorMessage:void 0,pageLinks:te,totalCount:X}):(0,de.tZ)(Q.Z,{api:Xe,organization:t,widget:$e,selection:Pe,limit:i.displayType===V.FO.TABLE?20:10,cursor:Me,dashboardFilters:ne,children:ut});case V.l9.RELEASE:return N&&ke&&i.displayType===V.FO.TABLE?pt({tableResults:N,loading:!1,pageLinks:te}):(0,de.tZ)(W.ZP,{api:Xe,organization:t,widget:$e,selection:Pe,limit:i.displayType===V.FO.TABLE?20:10,cursor:Me,dashboardFilters:ne,children:pt});case V.l9.DISCOVER:default:return N&&ke&&i.displayType===V.FO.TABLE?(0,de.tZ)(ct,{tableResults:N,loading:!1,pageLinks:te}):(0,de.tZ)($.ZP,{api:Xe,organization:t,widget:$e,selection:Pe,limit:i.displayType===V.FO.TABLE?20:10,cursor:Me,dashboardFilters:ne,children:e=>{let{tableResults:t,loading:i,pageLinks:n}=e;return(0,de.tZ)(ct,{tableResults:t,loading:i,pageLinks:n})}})}}return(0,de.tZ)(s.Fragment,{children:(0,de.tZ)(J.g.Provider,{value:t,children:(0,de.tZ)(H.KC,{children:(0,de.tZ)(z.BT,{organization:t,location:se,children:(0,de.tZ)(K.d,{organization:t,eventView:st,location:se,hideLoadingIndicator:!0,children:e=>(0,de.BX)(P.kP,{location:se,forceTransactions:e.forceTransactionsOnly,children:[(0,de.tZ)(u,{closeButton:!0,children:(0,de.BX)(qe,{children:[(0,de.tZ)("h3",{children:i.title}),i.description&&(0,de.tZ)(M.EG,{children:i.description}),(0,de.tZ)(H.k,{children:e=>{let{}=e;return null}})]})}),(0,de.tZ)(c,{children:(0,de.BX)(s.Fragment,{children:[ve&&M.f0,i.displayType!==V.FO.TABLE&&(0,de.tZ)(Re,{height:i.displayType!==V.FO.BIG_NUMBER?300+(re&&[V.FO.AREA,V.FO.LINE,V.FO.BAR,V.FO.TOP_N].includes(i.displayType)?U.R:0):null,children:(R||N)&&ke?(0,de.tZ)(be,{timeseriesResults:R,timeseriesResultsTypes:ie,tableResults:N,errorMessage:void 0,loading:!1,location:se,widget:i,selection:n,router:oe,organization:t,onZoom:mt,onLegendSelectChanged:dt,legendOptions:{selected:Ae},expandNumbers:!0,showSlider:re,noPadding:!0,chartZoomOptions:De}):(0,de.tZ)(fe,{location:se,api:Xe,organization:t,selection:je.current,dashboardFilters:ne,widget:We,onZoom:mt,onLegendSelectChanged:dt,legendOptions:{selected:Ae},expandNumbers:!0,showSlider:re,noPadding:!0,chartZoomOptions:De})}),i.queries.length>1&&(0,de.tZ)(w.bZ,{type:"info",showIcon:!0,children:(0,C.t)("This widget was built with multiple queries. Table data can only be displayed for one query at a time. To edit any of the queries, edit the widget.")}),(i.queries.length>1||i.queries[0].conditions)&&(0,de.BX)(_e,{children:[(0,de.tZ)(v.Z,{value:Ve,options:rt,onChange:e=>{oe.replace({pathname:se.pathname,query:{...se.query,[ee.R.QUERY]:e.value,[ee.R.PAGE]:void 0,[ee.R.CURSOR]:void 0}}),(0,q.Gi)("dashboards_views.widget_viewer.select_query",{organization:t,widget_type:i.widgetType??V.l9.DISCOVER,display_type:i.displayType})},components:{SingleValue:e=>(0,de.tZ)(a.c.SingleValue,{...e,getStyles:()=>({wordBreak:"break-word",flex:1,display:"flex",padding:`0 ${(0,E.D)(.5)}`}),children:rt[Ve].getHighlightedQuery({display:"block"})??(rt[Ve].label||(0,de.tZ)(Se,{children:he}))}),Option:e=>{const t=e.data.getHighlightedQuery({display:"flex"});return(0,de.tZ)(x.Z,{...t?{...e,label:t}:e.label?e:{...e,label:(0,de.tZ)(Se,{children:he})}})},...i.queries.length<2?{IndicatorsContainer:e=>null}:{}},isSearchable:!1,isDisabled:i.queries.length<2}),1===i.queries.length&&(0,de.tZ)(Oe,{title:(0,C.t)("To edit this query, you must edit the widget."),size:"sm"})]}),gt()]})}),(0,de.tZ)(l,{children:(0,de.BX)(Ee,{children:[Ze(Be,i.widgetType),(0,de.BX)(b.ZP,{gap:1,children:[g&&i.id&&(0,de.tZ)(f.zx,{onClick:()=>{p(),g(),(0,q.Gi)("dashboards_views.widget_viewer.edit",{organization:t,widget_type:i.widgetType??V.l9.DISCOVER,display_type:i.displayType})},children:(0,C.t)("Edit Widget")}),i.widgetType&&(0,de.tZ)(xe,{widget:We,organization:t,selection:Pe,selectedQueryIndex:Ve})]})]})})]})})})})})})}function xe(e){let t,i,{widget:n,selection:s,organization:a,selectedQueryIndex:o}=e;const{isMetricsData:r}=(0,H.XA)();switch(n.widgetType){case V.l9.ISSUE:t=(0,C.t)("Open in Issues"),i=(0,G.hS)(n,s,a);break;case V.l9.RELEASE:t=(0,C.t)("Open in Releases"),i=(0,G.Cg)(n,s,a);break;case V.l9.DISCOVER:default:t=(0,C.t)("Open in Discover"),i=(0,G.z1)({...n,queries:[n.queries[o]]},s,a,0,r)}return(0,de.tZ)(f.zx,{to:i,priority:"primary",onClick:()=>{(0,q.Gi)("dashboards_views.widget_viewer.open_source",{organization:a,widget_type:n.widgetType??V.l9.DISCOVER,display_type:n.displayType})},children:t})}function Ze(e,t){if(void 0===e)return(0,de.tZ)("span",{});switch(t){case V.l9.ISSUE:return(0,de.tZ)("span",{children:(0,C._N)("[description:Total Issues:] [total]",{description:(0,de.tZ)("strong",{}),total:"1000"===e?"1000+":e})});case V.l9.DISCOVER:return(0,de.tZ)("span",{children:(0,C._N)("[description:Total Events:] [total]",{description:(0,de.tZ)("strong",{}),total:e})});default:return(0,de.tZ)("span",{})}}ve.displayName="WidgetViewerModal",xe.displayName="OpenButton";const Te={name:"zhkibu",styles:"width:100%;max-width:1200px"},Re=(0,n.Z)("div",{target:"empe4o66"})("height:",(e=>e.height?`${e.height}px`:"auto"),";position:relative;padding-bottom:",(0,E.D)(3),";"),_e=(0,n.Z)("div",{target:"empe4o65"})("margin-bottom:",(0,E.D)(2),";position:relative;"),Oe=(0,n.Z)(R.Z,{target:"empe4o64"})("position:absolute;top:",(0,E.D)(1.5),";right:",(0,E.D)(2),";"),Ce=(0,n.Z)("span",{target:"empe4o63"})("display:",(e=>e.display),";gap:",(0,E.D)(1),";font-family:",(e=>e.theme.text.familyMono),";font-size:",(e=>e.theme.fontSizeSmall),";line-height:2;flex:1;"),Ee=(0,n.Z)("div",{target:"empe4o62"})("display:flex;flex-grow:1;flex-direction:column;gap:",(0,E.D)(1),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){align-items:center;flex-direction:row;justify-content:space-between;}"),Se=(0,n.Z)("span",{target:"empe4o61"})("color:",(e=>e.theme.disabled),";"),qe=(0,n.Z)("div",{target:"empe4o60"})("display:flex;flex-direction:column;gap:",(0,E.D)(1),";"),ke=(0,N.Z)(ve)},"./app/components/pagination.tsx":(e,t,i)=>{i.d(t,{Z:()=>w});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(i("../node_modules/core-js/modules/es.array.push.js"),i("../node_modules/react-router/es/index.js")),a=i("./app/components/button.tsx"),o=i("./app/components/buttonBar.tsx"),r=i("./app/icons/index.tsx"),l=i("./app/locale.tsx"),d=i("./app/styles/space.tsx"),c=i("./app/utils/parseLinkHeader.tsx"),u=i("./app/utils/useLocation.tsx"),p=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const m=(e,t,i,n)=>s.browserHistory.push({pathname:t,query:{...i,cursor:e}});function g(e){let{to:t,className:i,onCursor:n=m,paginationAnalyticsEvent:s,pageLinks:d,size:g="sm",caption:w,disabled:f=!1}=e;const b=(0,u.T)();if(!d)return null;const v=t??b.pathname,x=b.query,Z=(0,c.Z)(d),T=f||!1===Z.previous?.results,R=f||!1===Z.next?.results;return(0,p.BX)(y,{className:i,"data-test-id":"pagination",children:[w&&(0,p.tZ)(h,{children:w}),(0,p.BX)(o.ZP,{merged:!0,children:[(0,p.tZ)(a.zx,{icon:(0,p.tZ)(r.g6,{direction:"left",size:"sm"}),"aria-label":(0,l.t)("Previous"),size:g,disabled:T,onClick:()=>{n?.(Z.previous?.cursor,v,x,-1),s?.("Previous")}}),(0,p.tZ)(a.zx,{icon:(0,p.tZ)(r.g6,{direction:"right",size:"sm"}),"aria-label":(0,l.t)("Next"),size:g,disabled:R,onClick:()=>{n?.(Z.next?.cursor,v,x,1),s?.("Next")}})]})]})}g.displayName="Pagination";const y=(0,n.Z)("div",{target:"e1yybcqw1"})("display:flex;align-items:center;justify-content:flex-end;margin:",(0,d.D)(3)," 0 0 0;"),h=(0,n.Z)("span",{target:"e1yybcqw0"})("color:",(e=>e.theme.subText),";font-size:",(e=>e.theme.fontSizeMedium),";margin-right:",(0,d.D)(2),";"),w=g},"./app/utils/performance/contexts/metricsCardinality.tsx":(e,t,i)=>{i.d(t,{BT:()=>Z,e0:()=>R});var n=i("../node_modules/react/index.js"),s=i("./app/utils/analytics.tsx"),a=i("./app/utils/dates.tsx"),o=i("./app/utils/discover/eventView.tsx"),r=i("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),l=i("../node_modules/lodash/omit.js"),d=i.n(l),c=i("./app/utils/discover/genericDiscoverQuery.tsx"),u=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{eventView:t,location:i}=e;return d()(t.getEventsAPIPayload(i),["field","sort","per_page","query"])}function m(e){let{children:t,...i}=e;return(0,u.tZ)(c.ZP,{route:"metrics-compatibility-sums",getRequestPayload:p,...i,children:e=>{let{tableData:i,...n}=e;return t({tableData:i,...n})}})}function g(e){let{eventView:t,location:i}=e;return d()(t.getEventsAPIPayload(i),["field","sort","per_page","query"])}function y(e){let{children:t,...i}=e;return(0,u.tZ)(c.ZP,{route:"metrics-compatibility",getRequestPayload:g,...i,children:e=>{let{tableData:i,...n}=e;return t({tableData:i,...n})}})}m.displayName="MetricsCompatibilityQuery",y.displayName="MetricsCompatibilitySumsQuery";var h=i("./app/utils/performance/contexts/utils.tsx");const w=.01,f=.01,[b,v,x]=(0,h.n)({name:"MetricsCardinalityContext",strict:!1});function Z(e){if(!(0,r.gp)(e.organization))return(0,u.tZ)(b,{value:{isLoading:!1,outcome:{forceTransactionsOnly:!0}},children:e.children});const t={location:e.location,orgSlug:e.organization.slug,cursor:"0:0:0"},i=o.ZP.fromLocation(e.location);i.fields=[{field:"tpm()"}];const s=function(e){const t=e.clone();return t.start||t.end||(t.statsPeriod?(0,a.YJ)(t.statsPeriod)>1&&(t.statsPeriod="1h",t.start=void 0,t.end=void 0):(t.statsPeriod="1h",t.start=void 0,t.end=void 0)),t}(i);return(0,u.tZ)(n.Fragment,{children:(0,u.tZ)(m,{eventView:s,...t,children:i=>(0,u.tZ)(y,{eventView:s,...t,children:t=>{const n=i.isLoading||t.isLoading,s=i.isLoading||t.isLoading?void 0:function(e,t,i){const n={forceTransactionsOnly:!0},s=i.features.includes("performance-mep-bannerless-ui");if(!e)return n;const a=e.compatible_projects;return t?n:e?function(e){return!_(e).metricsCount}(e)?n:function(e,t){const i=_(e);return t?i.nullCount/i.metricsCount>f:i.nullCount>0}(e,s)?{shouldWarnIncompatibleSDK:!0,forceTransactionsOnly:!0,compatibleProjects:a}:function(e){const t=_(e);return t.unparamCount>=t.metricsCount}(e)?{shouldNotifyUnnamedTransactions:!0,forceTransactionsOnly:!0,compatibleProjects:a}:function(e,t){const i=_(e);return t?i.unparamCount/i.metricsCount>w:i.unparamCount>0}(e,s)?{shouldNotifyUnnamedTransactions:!0,compatibleProjects:a,forceTransactionsOnly:!1}:{forceTransactionsOnly:!1}:n}(i.tableData&&t.tableData?{...i.tableData,...t.tableData}:null,!!i.error&&!!t.error,e.organization);return(0,u.tZ)(T,{sendOutcomeAnalytics:e.sendOutcomeAnalytics,organization:e.organization,value:{isLoading:n,outcome:s},children:e.children})}})})})}function T(e){const t=e.value.outcome?.shouldWarnIncompatibleSDK??!1,i=e.value.outcome?.shouldNotifyUnnamedTransactions??!1,a=!e.value.outcome?.forceTransactionsOnly;return(0,n.useEffect)((()=>{!e.value.isLoading&&e.sendOutcomeAnalytics&&(0,s.Gi)("performance_views.mep.metrics_outcome",{organization:e.organization,is_on_metrics:a,fallback_from_null:t,fallback_from_unparam:i})}),[e.organization,e.value.isLoading,a,i,t,e.sendOutcomeAnalytics]),(0,u.tZ)(b,{...e,children:e.children})}Z.displayName="MetricsCardinalityProvider",T.displayName="Provider",x.Consumer;const R=v;function _(e){let{sum:t}=e;try{const e=Number(t.metrics);return{metricsCount:e,unparamCount:Number(t.metrics_unparam),nullCount:Number(t.metrics_null)}}catch(e){return{metricsCount:0,unparamCount:0,nullCount:0}}}},"./app/views/performance/landing/metricsDataSwitcher.tsx":(e,t,i)=>{i.d(t,{d:()=>u});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(i("../node_modules/core-js/modules/es.array.push.js"),i("../node_modules/react/index.js")),a=i("../node_modules/react-router/es/index.js"),o=i("./app/components/loadingIndicator.tsx"),r=i("./app/utils/performance/contexts/metricsCardinality.tsx"),l=i("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),d=i("./app/utils/queryString.tsx"),c=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function u(e){const t=(0,l.gp)(e.organization),i=(0,r.e0)();return t?i.isLoading&&!e.hideLoadingIndicator?(0,c.tZ)(s.Fragment,{children:(0,c.tZ)(m,{children:(0,c.tZ)(o.Z,{})})}):i.outcome?(0,c.tZ)(s.Fragment,{children:(0,c.tZ)(p,{eventView:e.eventView,location:e.location,outcome:i.outcome,switcherChildren:e.children})}):(0,c.tZ)(s.Fragment,{children:e.children({forceTransactionsOnly:!0})}):(0,c.tZ)(s.Fragment,{children:e.children({forceTransactionsOnly:!0})})}function p(e){let{switcherChildren:t,outcome:i,location:n,eventView:o}=e;const{query:r}=n,u=(0,d.ro)(r[l.tm],""),p=(0,d.ro)(r.query,""),m=u===l.oR.TRANSACTIONS_ONLY,g=p&&m&&!i.forceTransactionsOnly;return(0,s.useEffect)((()=>{g&&a.browserHistory.push({pathname:n.pathname,query:{...n.query,cursor:void 0,query:void 0,[l.tm]:void 0}})}),[g,n]),p&&m&&!i.forceTransactionsOnly&&(o.query=""),(0,c.tZ)(s.Fragment,{children:t(i)})}u.displayName="MetricsDataSwitcher",p.displayName="MetricsSwitchHandler";const m=(0,n.Z)("div",{target:"e11vcqhu0"})({name:"zl1inp",styles:"display:flex;justify-content:center"})}}]);
//# sourceMappingURL=../sourcemaps/app_components_modals_widgetViewerModal_tsx.7aa64ed577560ac2e2c4ed5e1c18e876.js.map