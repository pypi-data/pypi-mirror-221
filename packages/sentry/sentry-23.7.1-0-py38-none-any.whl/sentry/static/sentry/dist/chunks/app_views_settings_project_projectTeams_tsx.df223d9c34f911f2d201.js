"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_project_projectTeams_tsx"],{"./app/utils/routeTitle.tsx":(e,t,s)=>{s.d(t,{Z:()=>a});const a=function(e,t){let s=arguments.length>3?arguments[3]:void 0;const a=`${e} - ${t}`,n=s?`${a} - ${s}`:a;return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?n:`${n} - Sentry`}},"./app/views/settings/project/permissionAlert.tsx":(e,t,s)=>{s.d(t,{Z:()=>p});var a=s("./app/components/acl/access.tsx"),n=s("./app/components/alert.tsx"),o=s("./app/locale.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const r=(0,o.t)("These settings can only be edited by users with the organization-level owner, manager, or team-level admin roles.");function c(e){let{access:t=["project:write"],project:s,team:o,...c}=e;return(0,i.tZ)(a.Z,{access:t,project:s,team:o,children:e=>{let{hasAccess:t}=e;return!t&&(0,i.tZ)(n.bZ,{"data-test-id":"project-permission-alert",type:"warning",...c,children:r})}})}c.displayName="PermissionAlert";const p=c},"./app/views/settings/project/projectTeams.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>X});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("./app/actionCreators/indicator.tsx"),o=s("./app/actionCreators/modal.tsx"),i=s("./app/actionCreators/projects.tsx"),r=s("./app/components/acl/access.tsx"),c=s("./app/locale.tsx"),p=s("./app/stores/teamStore.tsx"),m=s("./app/utils/routeTitle.tsx"),l=s("./app/views/deprecatedAsyncView.tsx"),d=s("./app/views/settings/components/settingsPageHeader.tsx"),h=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),g=s("../node_modules/react/index.js"),u=s("./app/components/button.tsx"),T=s("./app/components/confirm.tsx"),j=s("./app/components/emptyMessage.tsx"),x=s("./app/components/idBadge/teamBadge/index.tsx"),Z=s("./app/components/links/link.tsx"),w=s("./app/components/loadingIndicator.tsx"),v=s("./app/components/panels/panel.tsx"),b=s("./app/components/panels/panelBody.tsx"),f=s("./app/components/panels/panelHeader.tsx"),y=s("./app/components/panels/panelItem.tsx"),C=s("./app/icons/index.tsx"),z=s("./app/styles/space.tsx"),A=s("./app/utils/useTeams.tsx"),S=s("./app/views/settings/components/teamSelect/utils.tsx"),B=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function _(e){let{disabled:t,canCreateTeam:s,project:a,selectedTeams:n,organization:o,onAddTeam:i,onRemoveTeam:r,onCreateTeam:p}=e;const{teams:m,onSearch:l,fetching:d}=(0,A.y)();return(0,B.BX)(v.Z,{children:[(0,B.BX)(f.Z,{hasButtons:!0,children:[(0,c.t)("Team"),(0,B.tZ)(S.w,{disabled:t,isLoadingTeams:d,isAddingTeamToProject:!0,canCreateTeam:s,onSearch:l,onSelect:i,onCreateTeam:p,organization:o,selectedTeams:n.map((e=>e.slug)),teams:m,project:a})]}),(0,B.tZ)(b.Z,{children:d?(0,B.tZ)(w.Z,{}):(()=>{const e=n.length;if(0===e)return(0,B.tZ)(j.Z,{children:(0,c.t)("No Teams assigned")});const s=1===e,a=1===n.reduce(((e,t)=>t.access.includes("team:write")?e+1:e),0)?(0,c.t)("This is the last team that grants Team Admin access to you for this project. After removing this team, you will not be able to edit this project's configuration."):s?(0,c.t)("This is the last team with access to this project. After removing this team, only organization owners and managers will be able to access the project pages."):null;return(0,B.tZ)(g.Fragment,{children:n.map((e=>(0,B.tZ)(R,{disabled:t||!e.access.includes("team:write"),confirmMessage:a,organization:o,team:e,onRemoveTeam:e=>r(e)},e.slug)))})})()})]})}function R(e){let{organization:t,team:s,onRemoveTeam:a,disabled:n,confirmMessage:o}=e;return(0,B.BX)($,{"data-test-id":"team-row-for-project",children:[(0,B.tZ)(k,{children:(0,B.tZ)(Z.Z,{to:`/settings/${t.slug}/teams/${s.slug}/`,children:(0,B.tZ)(x.a,{team:s})})}),(0,B.tZ)(T.Z,{message:o,bypass:!o,onConfirm:()=>a(s.slug),disabled:n,children:(0,B.tZ)(u.zx,{size:"xs",icon:(0,B.tZ)(C.JZ,{isCircled:!0,size:"xs"}),disabled:n,children:(0,c.t)("Remove")})})]})}_.displayName="TeamSelect",R.displayName="TeamRow";const $=(0,h.Z)(y.Z,{target:"e1m4yfxs1"})("padding:",(0,z.D)(2),";align-items:center;justify-content:space-between;"),k=(0,h.Z)("div",{target:"e1m4yfxs0"})({name:"aco78w",styles:"flex-grow:4"}),P=_;var I=s("./app/views/settings/components/text/textBlock.tsx"),M=s("./app/views/settings/project/permissionAlert.tsx");class N extends l.Z{constructor(){super(...arguments),(0,a.Z)(this,"canCreateTeam",(()=>{const e=this.props.organization.access;return e.includes("org:write")&&e.includes("team:write")&&e.includes("project:write")})),(0,a.Z)(this,"handleRemove",(e=>{if(this.state.loading)return;const{organization:t,project:s}=this.props;(0,i.M9)(this.api,t.slug,s.slug,e).then((()=>this.handleRemovedTeam(e))).catch((()=>{(0,n.Iw)((0,c.t)("Could not remove the %s team",e)),this.setState({loading:!1})}))})),(0,a.Z)(this,"handleRemovedTeam",(e=>{this.setState((t=>({projectTeams:[...(t.projectTeams||[]).filter((t=>t.slug!==e))]})))})),(0,a.Z)(this,"handleAddedTeam",(e=>{this.setState((t=>({projectTeams:[...t.projectTeams||[],e]})))})),(0,a.Z)(this,"handleAdd",(e=>{if(this.state.loading)return;const t=p.Z.getBySlug(e);if(!t)return(0,n.Iw)((0,c._N)('Unable to find "[teamSlug]"',{teamSlug:e})),void this.setState({error:!0});const{organization:s,project:a}=this.props;(0,i.Oe)(this.api,s.slug,a.slug,t).then((()=>{this.handleAddedTeam(t)}),(()=>{this.setState({error:!0,loading:!1})}))})),(0,a.Z)(this,"handleCreateTeam",(e=>{e.stopPropagation(),e.preventDefault();const{project:t,organization:s}=this.props;this.canCreateTeam()&&(0,o.openCreateTeamModal)({project:t,organization:s,onClose:e=>{(0,i.Oe)(this.api,s.slug,t.slug,e).then(this.remountComponent,this.remountComponent)}})}))}getEndpoints(){const{organization:e,project:t}=this.props;return[["projectTeams",`/projects/${e.slug}/${t.slug}/teams/`]]}getTitle(){const{projectId:e}=this.props.params;return(0,m.Z)((0,c.t)("Project Teams"),e,!1)}renderBody(){const{project:e,organization:t}=this.props,{projectTeams:s}=this.state,a=this.canCreateTeam(),n=(0,r.d)(["project:write"],{organization:t,project:e});return(0,B.BX)("div",{children:[(0,B.tZ)(d.Z,{title:(0,c.t)("Project Teams for %s",e.slug)}),(0,B.tZ)(I.Z,{children:(0,c.t)("These teams and their members have access to this project. They can be assigned to issues and alerts created in it.")}),(0,B.tZ)(I.Z,{children:(0,c.t)("Team Admins can grant other teams access to this project. However, they cannot revoke access unless they are admins for the other teams too.")}),(0,B.tZ)(M.Z,{project:e}),(0,B.tZ)(P,{disabled:!n,canCreateTeam:a,organization:t,project:e,selectedTeams:s??[],onAddTeam:this.handleAdd,onRemoveTeam:this.handleRemove,onCreateTeam:s=>{(0,i.Oe)(this.api,t.slug,e.slug,s).then(this.remountComponent,this.remountComponent)}})]})}}const X=N}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_projectTeams_tsx.9eaa9a93767be0cc357d0a8f62383e91.js.map