"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_starfish_colours_tsx-app_views_starfish_components_datePicker_tsx-app_views_starfis-07794e"],{"./app/components/gridEditable/sortLink.tsx":(e,t,s)=>{s.d(t,{Z:()=>p});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("../node_modules/react-router/es/index.js"),i=s("./app/components/links/link.tsx"),a=s("./app/icons/index.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){let{align:t,title:s,canSort:r,generateSortLink:i,onClick:a,direction:l,replace:p}=e;const m=i();if(!m||!r)return(0,o.tZ)(u,{align:t,children:s});const f=l?(0,o.tZ)(d,{size:"xs",direction:"desc"===l?"down":"up"}):null;return(0,o.BX)(c,{align:t,to:m,onClick:e=>{p&&(e.preventDefault(),n.browserHistory.replace(m)),a?.(e)},children:[s," ",f]})}l.displayName="SortLink";const c=(0,r.Z)((e=>{const{align:t,css:s,...r}=e;return(0,o.tZ)(i.Z,{...r})}),{target:"esdhr0u2"})("display:block;width:100%;white-space:nowrap;color:inherit;&:hover,&:active,&:focus,&:visited{color:inherit;}",(e=>e.align?`text-align: ${e.align};`:""),";"),u=(0,r.Z)("div",{target:"esdhr0u1"})("display:block;width:100%;white-space:nowrap;",(e=>e.align?`text-align: ${e.align};`:""),";"),d=(0,r.Z)(a.CC,{target:"esdhr0u0"})({name:"40f4ru",styles:"vertical-align:top"}),p=l},"./app/utils/discover/discoverQuery.tsx":(e,t,s)=>{s.d(t,{Z:()=>l,_:()=>o});var r=s("./app/utils/discover/genericDiscoverQuery.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function a(e){return(0,n.tZ)(r.ZP,{route:"events",shouldRefetchData:i,afterFetch:(e,t)=>{const{fields:s,...r}=e.meta??{};return{...e,meta:{...s,...r}}},...e})}function o(e){const t=(0,r.JC)({route:"events",shouldRefetchData:i,afterFetch:(e,t)=>{const{fields:s,...r}=e.meta??{};return{...e,meta:{...s,...r}}},...e}),s=t.response?.getResponseHeader("Link")??void 0;return{...t,pageLinks:s}}a.displayName="DiscoverQuery";const l=a},"./app/views/starfish/colours.tsx":(e,t,s)=>{s.d(t,{SQ:()=>n,Tn:()=>i,VG:()=>a,eO:()=>o});var r=s("./app/constants/chartPalette.tsx");const n=r.$[3][3],i=(r.$[3][1],r.$[0][0]),a=r.$[0][0],o=r.$[5][3]},"./app/views/starfish/components/datePicker.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var r=s("./app/components/datePageFilter.tsx"),n=s("./app/utils/analytics.tsx"),i=s("./app/utils/useOrganization.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(){const e=(0,i.Z)();return(0,a.tZ)(r.Z,{defaultPeriod:"24h",alignDropdown:"left",onChange:t=>{let{start:s,end:r,relative:i}=t;(0,n.Gi)("starfish.page_filter.data_change",{organization:e,start:s,end:r,relative:i})}})}o.displayName="StarfishDatePicker";const l=o},"./app/views/starfish/components/starfishPageFiltersContainer.tsx":(e,t,s)=>{s.d(t,{M:()=>i});var r=s("./app/components/organizations/pageFilters/container.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{children:t}=e;return(0,n.tZ)(r.Z,{skipLoadLastUsedEnvironment:!0,children:t})}i.displayName="StarfishPageFiltersContainer"},"./app/views/starfish/components/tableCells/renderHeadCell.tsx":(e,t,s)=>{s.d(t,{WJ:()=>u,hp:()=>d,qF:()=>c});var r=s("./app/components/gridEditable/sortLink.tsx"),n=s("./app/utils/discover/fields.tsx"),i=s("./app/views/starfish/types.tsx"),a=s("./app/views/starfish/views/queryParameters.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const{SPAN_SELF_TIME:l}=i.SpanMetricsFields,c=new Set([`avg(${l})`,`p95(${l})`,"sps()","time_spent_percentage()","http_error_count()"]),u=e=>{let{column:t,location:s,sort:n}=e;const{key:i,name:l}=t,u=d(i);let p="desc";n?.field===t.key&&"desc"===n.kind&&(p="asc");const m=`${"desc"===p?"-":""}${i}`;return(0,o.tZ)(r.Z,{align:u,canSort:Boolean(s&&n&&c.has(i)),direction:n?.field===t.key?n.kind:void 0,title:l,generateSortLink:()=>({...s,query:{...s?.query,[a.o.SORT]:m}})})};u.displayName="renderHeadCell";const d=e=>{const t=(0,n.dL)(e);if(t){const s=(0,n._4)(t.name,t.arguments[0]);if(s)return(0,n.qG)(e,s)}return"left"}},"./app/views/starfish/utils/chartValueFormatters/formatThroughput.ts":(e,t,s)=>{s.d(t,{Z:()=>n});var r=s("./app/locale.tsx");const n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return`${-1===e?"--":e.toFixed(2)} / ${(0,r.t)("s")}`}},"./app/views/starfish/utils/constants.tsx":(e,t,s)=>{s.d(t,{R:()=>r});const r="metrics"},"./app/views/starfish/utils/retryHandlers.tsx":(e,t,s)=>{function r(e,t){return e<3&&t.message.includes("429")}function n(e){return 1e3*Math.pow(3,e)}s.d(t,{P:()=>n,V:()=>r})},"./app/views/starfish/utils/useSpansQuery.tsx":(e,t,s)=>{s.d(t,{zT:()=>h,bB:()=>v,RX:()=>x}),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/core-js/modules/es.array.push.js");var r=s("../node_modules/moment/moment.js"),n=s.n(r),i=s("./app/utils/discover/discoverQuery.tsx"),a=s("./app/utils/discover/eventView.tsx"),o=s("./app/utils/discover/genericDiscoverQuery.tsx"),l=s("./app/utils/useLocation.tsx"),c=s("./app/utils/useOrganization.tsx"),u=s("./app/utils/usePageFilters.tsx"),d=s("./app/views/starfish/types.tsx"),p=s("./app/views/starfish/utils/retryHandlers.tsx"),m=s("../node_modules/react/index.js"),f=s("./app/utils/analytics.tsx");const h="YYYY-MM-DDTHH:mm:ssZ";function v(e){let{eventView:t,initialData:s,limit:r,enabled:n,referrer:i="use-spans-query",cursor:a,view:o=d.Nx.BACKEND}=e;const l=(t?.yAxis?.length??0)>0?g:x,{isReady:p}=(0,u.Z)();if(t){const e=t.clone();o===d.Nx.BACKEND&&(e.query=`${t.query} transaction.op:http.server`);const u=l({eventView:e,initialData:s,limit:r,enabled:(n||void 0===n)&&p,referrer:i,cursor:a});return function(e,t){let{isLoading:s,statusCode:r}=t;const[n,i]=(0,m.useState)(null),[a,o]=(0,m.useState)(!1),l=(0,c.Z)();(0,m.useEffect)((()=>{if(s)null===n&&(i(Date.now()),o(!1));else if(!a&&(o(!0),n)){const e=Date.now();(0,f.Gi)("starfish.request",{organization:l,duration:e-n,statusCode:r}),i(null)}}),[a,e,n,l,s,r])}(t,u),u}throw new Error("eventView argument must be defined when Starfish useDiscover is true")}function g(e){let{eventView:t,enabled:s,initialData:r,referrer:i,cursor:d}=e;const m=(0,l.T)(),f=(0,c.Z)(),{isReady:v}=(0,u.Z)(),g=(0,o.JC)({route:"events-stats",eventView:t,location:m,orgSlug:f.slug,getRequestPayload:()=>({...t.getEventsAPIPayload(m),yAxis:t.yAxis,topEvents:t.topEvents,excludeOther:0,partial:1,orderby:t.sorts?.[0]?(0,a.uZ)(t.sorts?.[0]):void 0,interval:t.interval,cursor:d}),options:{enabled:s&&v,refetchOnWindowFocus:!1,retry:p.V,retryDelay:p.P,staleTime:1/0},referrer:i}),x=g.isLoading||g.isFetching?r??void 0:function(e,t){if(!e)return;if(!t.yAxis)return[];let s=[];const r=t.yAxis&&("string"==typeof t.yAxis||1===t.yAxis.length),i="string"==typeof t.yAxis?t.yAxis:t.yAxis[0];if(e.data){const t=y(e,r?i:"count").map((e=>({interval:n()(1e3*parseInt(e.interval,10)).format(h),[i]:e[i],group:e.group})));return t}return Object.keys(e).forEach((t=>{e[t].data?s=w(s,y(e[t],r?i:t)):Object.keys(e[t]).forEach((r=>{"order"!==r&&(s=w(s,y(e[t][r],r,t)))}))})),s.map((e=>({...e,interval:n()(1e3*parseInt(e.interval,10)).format(h)})))}(g.data,t);return{...g,data:x,meta:g.data?.meta}}function x(e){let{eventView:t,initialData:s,enabled:r,referrer:n,limit:a,cursor:o}=e;const d=(0,l.T)(),m=(0,c.Z)(),{isReady:f}=(0,u.Z)(),h=(0,i._)({eventView:t,orgSlug:m.slug,location:d,referrer:n,cursor:o,limit:a,options:{enabled:r&&f,refetchOnWindowFocus:!1,retry:p.V,retryDelay:p.P,staleTime:1/0}}),v=h.data?.meta,g=h.isLoading&&s?s:h.data?.data;return{...h,data:g,meta:v}}function y(e,t,s){const r=[];return e.data.forEach((e=>{let[n,[{count:i}]]=e;const a=r.find((e=>e.interval===n&&(!s||e.group===s)));a?a[t]=i:r.push({interval:n,[t]:i,group:s})})),r}function w(e,t){const s=JSON.parse(JSON.stringify(e));return t.forEach((e=>{let{interval:t,group:r,...n}=e;const i=s.find((e=>e.interval===t&&(!r||e.group===r)));i?Object.keys(n).forEach((e=>{i[e]=n[e]})):s.push({interval:t,group:r,...n})})),s}},"./app/views/starfish/views/queryParameters.tsx":(e,t,s)=>{let r;s.d(t,{o:()=>r}),function(e){e.CURSOR="spansCursor",e.SORT="spansSort"}(r||(r={}))}}]);
//# sourceMappingURL=../sourcemaps/app_views_starfish_colours_tsx-app_views_starfish_components_datePicker_tsx-app_views_starfis-07794e.df218a211e2d737e301549e788ed251c.js.map