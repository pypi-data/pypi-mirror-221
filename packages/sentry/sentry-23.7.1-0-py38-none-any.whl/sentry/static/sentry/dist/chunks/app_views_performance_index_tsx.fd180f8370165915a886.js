"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_index_tsx"],{"./app/utils/performance/contexts/metricsCardinality.tsx":(t,e,n)=>{n.d(e,{BT:()=>P,e0:()=>_});var o=n("../node_modules/react/index.js"),a=n("./app/utils/analytics.tsx"),i=n("./app/utils/dates.tsx"),r=n("./app/utils/discover/eventView.tsx"),s=n("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),c=n("../node_modules/lodash/omit.js"),l=n.n(c),u=n("./app/utils/discover/genericDiscoverQuery.tsx"),d=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(t){let{eventView:e,location:n}=t;return l()(e.getEventsAPIPayload(n),["field","sort","per_page","query"])}function p(t){let{children:e,...n}=t;return(0,d.tZ)(u.ZP,{route:"metrics-compatibility-sums",getRequestPayload:m,...n,children:t=>{let{tableData:n,...o}=t;return e({tableData:n,...o})}})}function f(t){let{eventView:e,location:n}=t;return l()(e.getEventsAPIPayload(n),["field","sort","per_page","query"])}function h(t){let{children:e,...n}=t;return(0,d.tZ)(u.ZP,{route:"metrics-compatibility",getRequestPayload:f,...n,children:t=>{let{tableData:n,...o}=t;return e({tableData:n,...o})}})}p.displayName="MetricsCompatibilityQuery",h.displayName="MetricsCompatibilitySumsQuery";var g=n("./app/utils/performance/contexts/utils.tsx");const y=.01,b=.01,[v,x,C]=(0,g.n)({name:"MetricsCardinalityContext",strict:!1});function P(t){if(!(0,s.gp)(t.organization))return(0,d.tZ)(v,{value:{isLoading:!1,outcome:{forceTransactionsOnly:!0}},children:t.children});const e={location:t.location,orgSlug:t.organization.slug,cursor:"0:0:0"},n=r.ZP.fromLocation(t.location);n.fields=[{field:"tpm()"}];const a=function(t){const e=t.clone();return e.start||e.end||(e.statsPeriod?(0,i.YJ)(e.statsPeriod)>1&&(e.statsPeriod="1h",e.start=void 0,e.end=void 0):(e.statsPeriod="1h",e.start=void 0,e.end=void 0)),e}(n);return(0,d.tZ)(o.Fragment,{children:(0,d.tZ)(p,{eventView:a,...e,children:n=>(0,d.tZ)(h,{eventView:a,...e,children:e=>{const o=n.isLoading||e.isLoading,a=n.isLoading||e.isLoading?void 0:function(t,e,n){const o={forceTransactionsOnly:!0},a=n.features.includes("performance-mep-bannerless-ui");if(!t)return o;const i=t.compatible_projects;return e?o:t?function(t){return!w(t).metricsCount}(t)?o:function(t,e){const n=w(t);return e?n.nullCount/n.metricsCount>b:n.nullCount>0}(t,a)?{shouldWarnIncompatibleSDK:!0,forceTransactionsOnly:!0,compatibleProjects:i}:function(t){const e=w(t);return e.unparamCount>=e.metricsCount}(t)?{shouldNotifyUnnamedTransactions:!0,forceTransactionsOnly:!0,compatibleProjects:i}:function(t,e){const n=w(t);return e?n.unparamCount/n.metricsCount>y:n.unparamCount>0}(t,a)?{shouldNotifyUnnamedTransactions:!0,compatibleProjects:i,forceTransactionsOnly:!1}:{forceTransactionsOnly:!1}:o}(n.tableData&&e.tableData?{...n.tableData,...e.tableData}:null,!!n.error&&!!e.error,t.organization);return(0,d.tZ)(Z,{sendOutcomeAnalytics:t.sendOutcomeAnalytics,organization:t.organization,value:{isLoading:o,outcome:a},children:t.children})}})})})}function Z(t){const e=t.value.outcome?.shouldWarnIncompatibleSDK??!1,n=t.value.outcome?.shouldNotifyUnnamedTransactions??!1,i=!t.value.outcome?.forceTransactionsOnly;return(0,o.useEffect)((()=>{!t.value.isLoading&&t.sendOutcomeAnalytics&&(0,a.Gi)("performance_views.mep.metrics_outcome",{organization:t.organization,is_on_metrics:i,fallback_from_null:e,fallback_from_unparam:n})}),[t.organization,t.value.isLoading,i,n,e,t.sendOutcomeAnalytics]),(0,d.tZ)(v,{...t,children:t.children})}P.displayName="MetricsCardinalityProvider",Z.displayName="Provider",C.Consumer;const _=x;function w(t){let{sum:e}=t;try{const t=Number(e.metrics);return{metricsCount:t,unparamCount:Number(e.metrics_unparam),nullCount:Number(e.metrics_null)}}catch(t){return{metricsCount:0,unparamCount:0,nullCount:0}}}},"./app/views/performance/index.tsx":(t,e,n)=>{n.r(e),n.d(e,{default:()=>h});var o=n("./app/components/acl/feature.tsx"),a=n("./app/components/alert.tsx"),i=n("./app/components/layouts/thirds.tsx"),r=n("./app/components/noProjectMessage.tsx"),s=n("./app/locale.tsx"),c=n("./app/utils/performance/contexts/metricsCardinality.tsx"),l=n("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),u=n("./app/utils/queryClient.tsx"),d=n("./app/utils/withOrganization.tsx"),m=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const p=new u.Su;function f(t){let{organization:e,location:n,children:d}=t;return(0,m.tZ)(o.Z,{hookName:"feature-disabled:performance-page",features:["performance-view"],organization:e,renderDisabled:function(){return(0,m.tZ)(i.T3,{withPadding:!0,children:(0,m.tZ)(a.bZ,{type:"warning",children:(0,s.t)("You don't have access to this feature")})})},children:(0,m.tZ)(r.Z,{organization:e,children:(0,m.tZ)(u.aH,{client:p,children:(0,m.tZ)(c.BT,{location:n,organization:e,children:(0,m.tZ)(l.kP,{children:d})})})})})}f.displayName="PerformanceContainer";const h=(0,d.Z)(f)}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_index_tsx.c4928aee4839f8b2c8bf37723e6e542d.js.map