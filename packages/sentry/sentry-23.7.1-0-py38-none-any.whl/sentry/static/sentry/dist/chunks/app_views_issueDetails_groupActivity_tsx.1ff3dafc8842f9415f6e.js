"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_issueDetails_groupActivity_tsx"],{"./app/components/pullRequestLink.tsx":(e,t,s)=>{s.d(t,{Z:()=>c});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("./app/components/button.tsx"),o=s("./app/components/links/externalLink.tsx"),i=s("./app/icons/index.tsx"),a=s("./app/styles/space.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){if(!e.provider)return null;const{id:t}=e.provider;switch(t.includes(":")?t.split(":").pop():t){case"github":return(0,u.tZ)(i.Uv,{size:"xs","data-test-id":"pull-request-github"});case"gitlab":return(0,u.tZ)(i.Et,{size:"xs","data-test-id":"pull-request-gitlab"});case"bitbucket":return(0,u.tZ)(i.Ub,{size:"xs"});default:return null}}const l=(0,r.Z)(o.Z,{target:"e1fk87ze0"})("display:inline-flex;align-items:center;gap:",(0,a.D)(.5),";"),c=function(e){let{pullRequest:t,repository:s,inline:r}=e;const o=`${s.name} #${t.id}: ${t.title}`;return t.externalUrl?r?(0,u.BX)(l,{href:t.externalUrl,children:[d(s),o]}):(0,u.tZ)(n.zx,{external:!0,href:t.externalUrl,size:"sm",icon:d(s),children:o}):(0,u.tZ)("span",{children:o})}},"./app/utils/useMembers.tsx":(e,t,s)=>{s.d(t,{L:()=>p});var r=s("../node_modules/react/index.js"),n=s("../node_modules/lodash/uniqBy.js"),o=s.n(n),i=s("./app/stores/memberListStore.tsx"),a=s("./app/stores/organizationStore.tsx"),u=s("./app/stores/useLegacyStore.tsx"),d=s("./app/utils/parseLinkHeader.tsx"),l=s("./app/utils/useApi.tsx");async function c(e,t){let{emails:s,ids:r,search:n,limit:o,lastSearch:i,cursor:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const u={};void 0!==r&&r.length>0&&(u.query=r.map((e=>`user.id:${e}`)).join(" ")),void 0!==s&&s.length>0&&(u.query=s.map((e=>`email:${e}`)).join(" ")),n&&(u.query=`${u.query??""} ${n}`.trim()),(i===n||!i&&!n)&&a&&(u.cursor=a),void 0!==o&&(u.per_page=o);let l=!1,c=null;const[p,,h]=await e.requestPromise(`/organizations/${t}/members/`,{includeAllArgs:!0,query:u}),m=h?.getResponseHeader("Link");if(m){const e=(0,d.Z)(m);l=e?.next?.results,c=e?.next?.cursor}return{results:p,hasMore:l,nextCursor:c}}function p(){let{ids:e,emails:t,limit:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=(0,l.Z)(),{organization:d}=(0,u.X)(a.Z),p=(0,u.X)(i.Z),h=d?.slug,[m,g]=(0,r.useState)(new Set),[f,v]=(0,r.useState)(new Set),x=(0,r.useMemo)((()=>new Set(p.members.map((e=>e.id)))),[p.members]),y=(0,r.useMemo)((()=>e?.filter((e=>!x.has(e)&&!m.has(e)))??[]),[e,m,x]),_=(0,r.useMemo)((()=>new Set(p.members.map((e=>e.email)))),[p.members]),b=(0,r.useMemo)((()=>t?.filter((e=>!_.has(e)&&!f.has(e)))??[]),[t,f,_]),Z=b.length>0||y.length>0,S=!Z&&p.members.length>0,[w,N]=(0,r.useState)({initiallyLoaded:S,fetching:!1,hasMore:p.hasMore,lastSearch:null,nextCursor:p.cursor,fetchError:null}),E=(0,r.useCallback)((async function(){if(void 0!==h){N((e=>({...e,fetching:!0})));try{const{results:e,hasMore:t,nextCursor:r}=await c(n,h,{ids:y,emails:b,limit:s}),a=e.map((e=>e.user)).filter((e=>null!==e)),u=o()([...a,...p.members],(e=>{let{id:t}=e;return t})),d=y.filter((t=>!e.some((e=>e.user?.id===t))));d.length>0&&g((e=>new Set([...e,...d])));const l=b.filter((t=>!e.some((e=>e.user?.email===t))));l.length>0&&v((e=>new Set([...e,...l]))),i.Z.loadInitialData(u),N((e=>({...e,hasMore:t,fetching:!1,initiallyLoaded:!0,nextCursor:r})))}catch(e){console.error(e),N((t=>({...t,fetching:!1,initiallyLoaded:!0,fetchError:e})))}}}),[n,b,y,s,h,p.members]),C=(0,r.useCallback)((async function(e){const t=w.lastSearch,r=e?w.nextCursor:p.cursor;if(void 0!==h){N((e=>({...e,fetching:!0})));try{n.clear();const{results:a,hasMore:u,nextCursor:d}=await c(n,h,{search:e,limit:s,lastSearch:t,cursor:r}),l=a.map((e=>e.user)).filter((e=>null!==e)),m=o()([...p.members,...l],(e=>{let{email:t}=e;return t}));e?m.length>p.members.length&&i.Z.loadInitialData(m):i.Z.loadInitialData(m,u,d),N((t=>({...t,hasMore:u&&p.hasMore,fetching:!1,lastSearch:e??null,nextCursor:d})))}catch(e){console.error(e),N((t=>({...t,fetching:!1,fetchError:e})))}}else console.error("Cannot fetch members without an organization in context")}),[n,s,h,w.lastSearch,w.nextCursor,p.cursor,p.hasMore,p.members]),k=(0,r.useCallback)((function(e){return""!==e?C(e):(w.hasMore===p.hasMore&&w.nextCursor===p.cursor||N((t=>({...t,lastSearch:e,hasMore:p.hasMore,nextCursor:p.cursor}))),Promise.resolve())}),[C,w.hasMore,w.nextCursor,p.cursor,p.hasMore]);return(0,r.useEffect)((()=>{Z&&E()}),[Z,E]),{members:(0,r.useMemo)((()=>t||e?p.members.filter((s=>t?.includes(s.email)||e?.includes(s.id))):p.members),[t,p.members,e]),fetching:w.fetching||p.loading,initiallyLoaded:w.initiallyLoaded,fetchError:w.fetchError,hasMore:w.hasMore??p.hasMore,onSearch:k,loadMore:C}}},"./app/views/issueDetails/groupActivity.tsx":(e,t,s)=>{s.r(t),s.d(t,{GroupActivity:()=>Ee,default:()=>Ce});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/react/index.js"),o=s("../node_modules/lodash/uniq.js"),i=s.n(o),a=s("./app/actionCreators/group.tsx"),u=s("./app/actionCreators/indicator.tsx"),d=s("./app/components/activity/author.tsx"),l=s("./app/components/activity/item/index.tsx"),c=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),p=s("./app/styles/space.tsx"),h=s("./app/utils/marked.tsx"),m=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function g(e){let{text:t}=e;return(0,m.tZ)(f,{"data-test-id":"activity-note-body",dangerouslySetInnerHTML:{__html:(0,h.Z)(t)}})}g.displayName="NoteBody";const f=(0,c.Z)("div",{target:"ea2901t0"})("ul{list-style:disc;}h1,h2,h3,h4,p,ul:not(.nav),ol,pre,hr,blockquote{margin-bottom:",(0,p.D)(2),";}ul,ol{padding-left:20px;}p{a{word-wrap:break-word;}}blockquote{font-size:15px;border-left:5px solid ",(e=>e.theme.innerBorder),";padding-left:",(0,p.D)(1),";margin-left:0;}");var v=s("./app/components/confirm.tsx"),x=s("./app/components/dropdownMenu/index.tsx"),y=s("./app/icons/index.tsx"),_=s("./app/locale.tsx"),b=s("./app/stores/configStore.tsx");function Z(e){let{authorName:t,user:s,onEdit:r,onDelete:n}=e;const o=b.Z.get("user"),i=o&&(o.isSuperuser||s?.id===o.id);return(0,m.BX)(S,{children:[(0,m.tZ)(d.n,{children:t}),i&&(0,m.tZ)(x.h,{offset:4,size:"sm",triggerProps:{size:"xs",showChevron:!1,borderless:!0,icon:(0,m.tZ)(y.YR,{size:"xs"}),"aria-label":(0,_.t)("Comment Actions")},items:[{key:"edit",label:(0,_.t)("Edit"),onAction:r,tooltip:o.isSuperuser?(0,_.t)("You can edit this comment due to your superuser status"):void 0},{key:"delete",label:(0,_.t)("Remove"),priority:"danger",onAction:()=>(0,v._)({header:(0,_.t)("Remove"),message:(0,_.t)("Are you sure you wish to delete this comment?"),onConfirm:n}),tooltip:o.isSuperuser?(0,_.t)("You can delete this comment due to your superuser status"):void 0}]})]})}Z.displayName="NoteHeader";const S=(0,c.Z)("div",{target:"e1h0y5t70"})("display:flex;align-items:center;gap:",(0,p.D)(1),";");var w=s("../node_modules/react-mentions/dist/react-mentions.esm.js"),N=s("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),E=s("./app/components/button.tsx"),C=s("./app/components/tabs/index.tsx"),k=s("./app/styles/text.tsx"),I=s("./app/utils/domId.tsx"),$=s("./app/utils/useMembers.tsx"),R=s("./app/utils/useTeams.tsx");function D(e){let{theme:t,minHeight:s}=e;const r={fontSize:t.fontSizeMedium,padding:`${(0,p.D)(1.5)} ${(0,p.D)(2)}`,outline:0,border:0,minHeight:s,overflow:"auto"};return{control:{backgroundColor:`${t.background}`,fontSize:15,fontWeight:"normal"},input:{margin:0},"&singleLine":{control:{display:"inline-block",width:130},highlighter:{padding:1,border:"2px inset transparent"},input:{padding:1,border:"2px inset"}},"&multiLine":{control:{fontFamily:t.text.family,minHeight:s},highlighter:r,input:r},suggestions:{list:{maxHeight:142,minWidth:220,overflow:"auto",backgroundColor:`${t.background}`,border:"1px solid rgba(0,0,0,0.15)",borderRadius:t.borderRadius,fontSize:t.fontSizeSmall,padding:(0,p.D)(.5)},item:{padding:(0,p.D)(.5),borderRadius:t.borderRadius,"&focused":{backgroundColor:t.hover}}}}}function T(e){let{text:t,onCreate:s,onChange:r,onUpdate:o,onEditFinish:i,noteId:a,errorJSON:u,busy:d=!1,placeholder:l=(0,_.t)("Add a comment.\nTag users with @, or teams with #"),minHeight:c=140}=e;const p=(0,N.u)(),{members:g}=(0,$.L)(),{teams:f}=(0,R.y)(),v=g.map((e=>({id:`user:${e.id}`,display:e.name}))),x=f.map((e=>({id:`team:${e.id}`,display:`#${e.slug}`}))),[b,Z]=(0,n.useState)(t??""),[S,E]=(0,n.useState)([]),[k,T]=(0,n.useState)([]),q=""!==b.trim(),P=b.replace(/\[sentry\.strip:member\]/g,"@").replace(/\[sentry\.strip:team\]/g,""),H=!!a,G=[...S,...k].filter((e=>b.includes(e[1]))).map((e=>e[0])),X=(0,n.useCallback)((()=>H?o?.({text:P,mentions:G}):s?.({text:P,mentions:G})),[H,o,P,G,s]),V=(0,n.useCallback)((e=>{e.preventDefault(),i?.()}),[i]),F=(0,n.useCallback)((e=>{e.preventDefault(),X()}),[X]),J=(0,n.useCallback)(((e,t)=>E((s=>[...s,[`${e}`,t]]))),[]),W=(0,n.useCallback)(((e,t)=>T((s=>[...s,[`${e}`,t]]))),[]),K=(0,n.useCallback)((e=>{Z(e.target.value),r?.(e,{updating:H})}),[H,r]),Y=(0,n.useCallback)((e=>{"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&q&&X()}),[q,X]),Q=(0,n.useMemo)((()=>(0,I.Z)("note-error-")),[]),ee=u&&("string"==typeof u.detail?u.detail:u.detail&&u.detail.message||(0,_.t)("Unable to post comment"))||null;return(0,m.BX)(M,{"data-test-id":"note-input-form",noValidate:!0,onSubmit:F,children:[(0,m.BX)(C.mQ,{children:[(0,m.BX)(z,{children:[(0,m.tZ)(C.td.Item,{children:H?(0,_.t)("Edit"):(0,_.t)("Write")},"edit"),(0,m.tZ)(C.td.Item,{children:(0,_.t)("Preview")},"preview")]}),(0,m.BX)(A,{children:[(0,m.tZ)(C.nP.Item,{children:(0,m.BX)(w.r,{"aria-errormessage":ee?Q:void 0,style:D({theme:p,minHeight:c}),placeholder:l,onChange:K,onKeyDown:Y,value:b,required:!0,autoFocus:!0,children:[(0,m.tZ)(w.p,{trigger:"@",data:v,onAdd:J,displayTransform:(e,t)=>`@${t}`,markup:"**[sentry.strip:member]__display__**",appendSpaceOnAdd:!0}),(0,m.tZ)(w.p,{trigger:"#",data:x,onAdd:W,markup:"**[sentry.strip:team]__display__**",appendSpaceOnAdd:!0})]})},"edit"),(0,m.tZ)(C.nP.Item,{children:(0,m.tZ)(L,{minHeight:c,dangerouslySetInnerHTML:{__html:(0,h.Z)(P)}})},"preview")]})]}),(0,m.BX)(B,{children:[ee?(0,m.tZ)("div",{id:Q,children:ee&&(0,m.tZ)(U,{children:ee})}):(0,m.BX)(j,{children:[(0,m.tZ)(y.kh,{})," ",(0,_.t)("Markdown supported")]}),(0,m.BX)("div",{children:[H&&(0,m.tZ)(O,{priority:"danger",onClick:V,children:(0,_.t)("Cancel")}),(0,m.tZ)(O,{error:!!ee,type:"submit",disabled:d||!q,children:H?(0,_.t)("Save Comment"):(0,_.t)("Post Comment")})]})]})]})}T.displayName="NoteInput";const z=(0,c.Z)(C.td,{target:"e1f315cu7"})("padding:0 ",(0,p.D)(2),";padding-top:",(0,p.D)(.5),";"),M=(0,c.Z)("form",{target:"e1f315cu6"})("transition:padding 0.2s ease-in-out;",(e=>(e=>e.error?`\n  color: ${e.theme.error};\n  margin: -1px;\n  border: 1px solid ${e.theme.error};\n  border-radius: ${e.theme.borderRadius};\n\n    &:before {\n      display: block;\n      content: '';\n      width: 0;\n      height: 0;\n      border-top: 7px solid transparent;\n      border-bottom: 7px solid transparent;\n      border-right: 7px solid ${e.theme.red300};\n      position: absolute;\n      left: -7px;\n      top: 12px;\n    }\n\n    &:after {\n      display: block;\n      content: '';\n      width: 0;\n      height: 0;\n      border-top: 6px solid transparent;\n      border-bottom: 6px solid transparent;\n      border-right: 6px solid #fff;\n      position: absolute;\n      left: -5px;\n      top: 12px;\n    }\n  `:"")(e)),";"),A=(0,c.Z)(C.nP,{target:"e1f315cu5"})(k.Z,";"),B=(0,c.Z)("div",{target:"e1f315cu4"})("display:flex;border-top:1px solid ",(e=>e.theme.border),";justify-content:space-between;padding-left:",(0,p.D)(1.5),";"),O=(0,c.Z)(E.zx,{target:"e1f315cu3"})("margin:-1px -1px -1px;border-radius:0 0 ",(e=>e.theme.borderRadius),";",(e=>e.error&&`\n  &, &:active, &:focus, &:hover {\n  border-bottom-color: ${e.theme.error};\n  border-right-color: ${e.theme.error};\n  }\n  `),";"),U=(0,c.Z)("span",{target:"e1f315cu2"})("display:flex;align-items:center;height:100%;color:",(e=>e.theme.error),";font-size:0.9em;"),j=(0,c.Z)("div",{target:"e1f315cu1"})("display:flex;align-items:center;gap:",(0,p.D)(1),";color:",(e=>e.theme.subText),";"),L=(0,c.Z)("div",{target:"e1f315cu0"})((e=>(e=>{const{minHeight:t,padding:s,overflow:r,border:n}=D(e)["&multiLine"].input;return`\n  max-height: 1000px;\n  max-width: 100%;\n  ${t&&`min-height: ${t}px`||""};\n  padding: ${s};\n  overflow: ${r};\n  border: ${n};\n`})(e)),";");function q(e){const[t,s]=(0,n.useState)(!1),{noteId:r,user:o,dateCreated:i,text:a,authorName:u,hideDate:d,minHeight:c,showTime:p,projectSlugs:h,onDelete:f,onCreate:v,onUpdate:x}=e,y={hideDate:d,showTime:p,id:`activity-item-${r}`,author:{type:"user",user:o},date:i};if(t)return(0,m.tZ)(l.l,{noPadding:!0,...y,children:(0,m.tZ)(T,{noteId:r,minHeight:c,text:a,projectSlugs:h,onEditFinish:()=>s(!1),onUpdate:t=>{x(t,e),s(!1)},onCreate:e=>v?.(e)})});const _=(0,m.tZ)(Z,{user:o,authorName:u,onEdit:()=>s(!0),onDelete:()=>f(e)});return(0,m.tZ)(l.l,{...y,header:_,children:(0,m.tZ)(g,{text:a})})}q.displayName="Note";var P=s("../node_modules/@sentry/browser/node_modules/@sentry/core/esm/exports.js"),H=s("../node_modules/lodash/debounce.js"),G=s.n(H),X=s("./app/utils/localStorage.tsx");function V(e){const t=X.Z.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch(e){return P.$e((s=>{s.setExtra("storage",t),P.Tb(e)})),null}}function F(e,t){try{X.Z.setItem(e,JSON.stringify(t))}catch(e){P.Tb(e),P.$e((s=>{s.setExtra("storage",t),P.Tb(e)}))}}function J(e){let{itemKey:t,storageKey:s,onChange:r,onCreate:o,onLoad:i,onSave:a,text:u,...d}=e;const l=(0,n.useMemo)((()=>{if(u)return u;const e=V(s);return e&&e.hasOwnProperty(t)?i?i(e[t]):e[t]:""}),[t,i,s,u]),c=(0,n.useMemo)((()=>G()((e=>{const r={...V(s)??{},[t]:a?.(e)??e};F(s,r)}),150)),[t,a,s]),p=(0,n.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r?.(e,t),t.updating||c(e.target.value)}),[r,c]),h=(0,n.useCallback)((e=>{o?.(e);const r=V(s)??{};if(!r.hasOwnProperty(t))return;const{[t]:n,...i}=r;F(s,i)}),[t,o,s]);return(0,m.tZ)(T,{...d,text:l,onCreate:h,onChange:p})}J.displayName="NoteInputWithStorage";var W=s("./app/components/errorBoundary.tsx"),K=s("./app/components/layouts/thirds.tsx"),Y=s("./app/components/loadingIndicator.tsx"),Q=s("./app/components/events/styles.tsx"),ee=s("./app/components/links/link.tsx");class te extends n.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{isBannerHidden:"true"===X.Z.getItem(this.getBannerUniqueId())}),(0,r.Z)(this,"handleBannerDismiss",(()=>{X.Z.setItem(this.getBannerUniqueId(),"true"),this.setState({isBannerHidden:!0})}))}getBannerUniqueId(){const{reprocessActivity:e}=this.props,{id:t}=e;return`reprocessed-activity-${t}-banner-dismissed`}renderMessage(){const{orgSlug:e,reprocessActivity:t,groupCount:s,groupId:r}=this.props,{data:n}=t,{eventCount:o,oldGroupId:i,newGroupId:a}=n,u=`/organizations/${e}/issues/?query=reprocessing.original_issue_id:${i}&referrer=reprocessed-activity`;return 0===s?(0,_._N)("All events in this issue were moved during reprocessing. [link]",{link:(0,m.tZ)(ee.Z,{to:u,children:(0,_.tn)("See %s new event","See %s new events",o)})}):(0,_._N)("Events in this issue were successfully reprocessed. [link]",{link:(0,m.tZ)(ee.Z,{to:u,children:a===Number(r)?(0,_.tn)("See %s reprocessed event","See %s reprocessed events",o):(0,_.tn)("See %s new event","See %s new events",o)})})}render(){const{isBannerHidden:e}=this.state;if(e)return null;const{className:t}=this.props;return(0,m.tZ)(Q.UP,{priority:"success",className:t,children:(0,m.BX)(re,{children:[(0,m.tZ)(y.DL,{color:"successText",isCircled:!0}),(0,m.tZ)("span",{children:this.renderMessage()}),(0,m.tZ)(ne,{color:"successText","aria-label":(0,_.t)("Dismiss"),isCircled:!0,onClick:this.handleBannerDismiss})]})})}}te.displayName="ReprocessedBox";const se=te,re=(0,c.Z)(Q._B,{target:"e1cozms61"})("&>svg:last-child{margin-right:0;margin-left:",(0,p.D)(1),";}"),ne=(0,c.Z)(y.bM,{target:"e1cozms60"})({name:"e0dnmk",styles:"cursor:pointer"});var oe=s("./app/constants/index.tsx"),ie=s("./app/types/index.tsx"),ae=s("./app/utils/guid.tsx"),ue=s("./app/utils/teams.tsx"),de=s("./app/utils/withApi.tsx"),le=s("./app/utils/withOrganization.tsx"),ce=s("../node_modules/moment/moment.js"),pe=s.n(ce),he=s("./app/components/commitLink.tsx"),me=s("./app/components/dateTime.tsx"),ge=s("./app/components/duration.tsx"),fe=s("./app/components/links/externalLink.tsx"),ve=s("./app/components/pullRequestLink.tsx"),xe=s("./app/components/version.tsx"),ye=s("./app/stores/teamStore.tsx"),_e=s("./app/utils/formatters.tsx");function be(e){let{activity:t,organization:s,projectId:r,author:o}=e;const i=`/organizations/${s.slug}/issues/`,a=s.features.includes("escalating-issues");return(0,m.tZ)(n.Fragment,{children:function(){switch(t.type){case ie.fc.NOTE:return(0,_._N)("[author] left a comment",{author:o});case ie.fc.SET_RESOLVED:return(0,_._N)("[author] marked this issue as resolved",{author:o});case ie.fc.SET_RESOLVED_BY_AGE:return(0,_._N)("[author] marked this issue as resolved due to inactivity",{author:o});case ie.fc.SET_RESOLVED_IN_RELEASE:if("current_release_version"in t.data){const e=t.data.current_release_version;return(0,_._N)("[author] marked this issue as resolved in releases greater than [version] [semver]",{author:o,version:(0,m.tZ)(xe.Z,{version:e,projectId:r,tooltipRawVersion:!0}),semver:s.features.includes("issue-release-semver")?(0,_e.A6)(e)?(0,_.t)("(semver)"):(0,_.t)("(non-semver)"):""})}const e=t.data.version;return e?(0,_._N)("[author] marked this issue as resolved in [version] [semver]",{author:o,version:(0,m.tZ)(xe.Z,{version:e,projectId:r,tooltipRawVersion:!0}),semver:s.features.includes("issue-release-semver")?(0,_e.A6)(e)?(0,_.t)("(semver)"):(0,_.t)("(non-semver)"):""}):(0,_._N)("[author] marked this issue as resolved in the upcoming release",{author:o});case ie.fc.SET_RESOLVED_IN_COMMIT:const u=(t.data.commit?.releases||[]).filter((e=>null!==e.dateReleased)).sort(((e,t)=>pe()(e.dateReleased).valueOf()-pe()(t.dateReleased).valueOf()));return 1===u.length&&t.data.commit?(0,_._N)("[author] marked this issue as resolved in [version] [break]This commit was released in [release]",{author:o,version:(0,m.tZ)(he.Z,{inline:!0,commitId:t.data.commit.id,repository:t.data.commit.repository}),break:(0,m.tZ)("br",{}),release:(0,m.tZ)(xe.Z,{version:u[0].version,projectId:r,tooltipRawVersion:!0})}):u.length>1&&t.data.commit?(0,_._N)("[author] marked this issue as resolved in [version] [break]This commit was released in [release] and [otherCount] others",{author:o,otherCount:u.length-1,version:(0,m.tZ)(he.Z,{inline:!0,commitId:t.data.commit.id,repository:t.data.commit.repository}),break:(0,m.tZ)("br",{}),release:(0,m.tZ)(xe.Z,{version:u[0].version,projectId:r,tooltipRawVersion:!0})}):t.data.commit?(0,_._N)("[author] marked this issue as resolved in [commit]",{author:o,commit:(0,m.tZ)(he.Z,{inline:!0,commitId:t.data.commit.id,repository:t.data.commit.repository})}):(0,_._N)("[author] marked this issue as resolved in a commit",{author:o});case ie.fc.SET_RESOLVED_IN_PULL_REQUEST:{const{data:e}=t,{pullRequest:s}=e;return(0,_._N)("[author] has created a PR for this issue: [pullRequest]",{author:o,pullRequest:s?(0,m.tZ)(ve.Z,{inline:!0,pullRequest:s,repository:s.repository}):(0,_.t)("PR not available")})}case ie.fc.SET_UNRESOLVED:{const{data:e}=t;return e.forecast?(0,_._N)("[author] flagged this issue as escalating because over [forecast] [event] happened in an hour",{author:o,forecast:e.forecast,event:1===e.forecast?"event":"events"}):(0,_._N)("[author] marked this issue as unresolved",{author:o})}case ie.fc.SET_IGNORED:{const{data:e}=t;return function(e){const t=a?(0,_.t)("archived"):(0,_.t)("ignored");return e.ignoreDuration?(0,_._N)("[author] [action] this issue for [duration]",{author:o,action:t,duration:(0,m.tZ)(ge.Z,{seconds:60*e.ignoreDuration})}):e.ignoreCount&&e.ignoreWindow?(0,_._N)("[author] [action] this issue until it happens [count] time(s) in [duration]",{author:o,action:t,count:e.ignoreCount,duration:(0,m.tZ)(ge.Z,{seconds:60*e.ignoreWindow})}):e.ignoreCount?(0,_._N)("[author] [action] this issue until it happens [count] time(s)",{author:o,action:t,count:e.ignoreCount}):e.ignoreUserCount&&e.ignoreUserWindow?(0,_._N)("[author] [action] this issue until it affects [count] user(s) in [duration]",{author:o,action:t,count:e.ignoreUserCount,duration:(0,m.tZ)(ge.Z,{seconds:60*e.ignoreUserWindow})}):e.ignoreUserCount?(0,_._N)("[author] [action] this issue until it affects [count] user(s)",{author:o,action:t,count:e.ignoreUserCount}):e.ignoreUntil?(0,_._N)("[author] [action] this issue until [date]",{author:o,action:t,date:(0,m.tZ)(me.Z,{date:e.ignoreUntil})}):a&&e.ignoreUntilEscalating?(0,_._N)("[author] archived this issue until it escalates",{author:o}):(0,_._N)("[author] [action] this issue forever",{author:o,action:t})}(e)}case ie.fc.SET_PUBLIC:return(0,_._N)("[author] made this issue public",{author:o});case ie.fc.SET_PRIVATE:return(0,_._N)("[author] made this issue private",{author:o});case ie.fc.SET_REGRESSION:{const{data:e}=t;return e.version?(0,_._N)("[author] marked this issue as a regression in [version]",{author:o,version:(0,m.tZ)(xe.Z,{version:e.version,projectId:r,tooltipRawVersion:!0})}):(0,_._N)("[author] marked this issue as a regression",{author:o})}case ie.fc.CREATE_ISSUE:{const{data:e}=t;return(0,_._N)("[author] created an issue on [provider] titled [title]",{author:o,provider:e.provider,title:(0,m.tZ)(fe.Z,{href:e.location,children:e.title})})}case ie.fc.UNMERGE_SOURCE:{const{data:e}=t,{destination:s,fingerprints:r}=e;return(0,_.tn)("%2$s migrated %1$s fingerprint to %3$s","%2$s migrated %1$s fingerprints to %3$s",r.length,o,s?(0,m.tZ)(ee.Z,{to:`${i}${s.id}?referrer=group-activity-unmerged-source`,children:s.shortId}):(0,_.t)("a group"))}case ie.fc.UNMERGE_DESTINATION:{const{data:e}=t,{source:s,fingerprints:r}=e;return(0,_.tn)("%2$s migrated %1$s fingerprint from %3$s","%2$s migrated %1$s fingerprints from %3$s",r.length,o,s?(0,m.tZ)(ee.Z,{to:`${i}${s.id}?referrer=group-activity-unmerged-destination`,children:s.shortId}):(0,_.t)("a group"))}case ie.fc.FIRST_SEEN:return(0,_._N)("[author] first saw this issue",{author:o});case ie.fc.ASSIGNED:{const{data:e}=t;return function(e){let s;if("team"===e.assigneeType){const t=ye.Z.getById(e.assignee);s=t?`#${t.slug}`:"<unknown-team>"}else s=t.user&&e.assignee===t.user.id?(0,_.t)("themselves"):"user"===e.assigneeType&&e.assigneeEmail?e.assigneeEmail:(0,_.t)("an unknown user");const r=["projectOwnership","codeowners"].includes(e.integration),i={msteams:(0,_.t)("Microsoft Teams"),slack:(0,_.t)("Slack"),projectOwnership:(0,_.t)("Ownership Rule"),codeowners:(0,_.t)("Codeowners Rule")};return(0,m.BX)(n.Fragment,{children:[(0,m.tZ)("div",{children:(0,_._N)("[author] [action] this issue to [assignee]",{action:r?(0,_.t)("auto-assigned"):(0,_.t)("assigned"),author:o,assignee:s})}),e.integration&&(0,m.BX)(Se,{children:[(0,_.t)("Assigned via %s",i[e.integration]),e.rule&&(0,m.BX)(n.Fragment,{children:[": ",(0,m.tZ)(we,{children:e.rule})]})]})]})}(e)}case ie.fc.UNASSIGNED:return(0,_._N)("[author] unassigned this issue",{author:o});case ie.fc.MERGE:return(0,_.tn)("%2$s merged %1$s issue into this issue","%2$s merged %1$s issues into this issue",t.data.issues.length,o);case ie.fc.REPROCESS:{const{data:e}=t,{oldGroupId:r,eventCount:n}=e;return(0,_._N)("[author] reprocessed the events in this issue. [new-events]",{author:o,"new-events":(0,m.tZ)(ee.Z,{to:`/organizations/${s.slug}/issues/?query=reprocessing.original_issue_id:${r}&referrer=group-activity-reprocesses`,children:(0,_.tn)("See %s new event","See %s new events",n)})})}case ie.fc.MARK_REVIEWED:return(0,_._N)("[author] marked this issue as reviewed",{author:o});case ie.fc.AUTO_SET_ONGOING:return t.data?.afterDays?(0,_._N)("[author] automatically marked this issue as ongoing after [afterDays] days",{author:o,afterDays:t.data.afterDays}):(0,_._N)("[author] automatically marked this issue as ongoing",{author:o});case ie.fc.SET_ESCALATING:return function(e){if(e.forecast)return(0,_._N)("[author] flagged this issue as escalating because over [forecast] [event] happened in an hour",{author:o,forecast:e.forecast,event:1===e.forecast?"event":"events"});if(e.expired_snooze){if(e.expired_snooze.count&&e.expired_snooze.window)return(0,_._N)("[author] flagged this issue as escalating because [count] [event] happened in [duration]",{author:o,count:e.expired_snooze.count,event:1===e.expired_snooze.count?"event":"events",duration:(0,m.tZ)(ge.Z,{seconds:60*e.expired_snooze.window})});if(e.expired_snooze.count)return(0,_._N)("[author] flagged this issue as escalating because [count] [event] happened",{author:o,count:e.expired_snooze.count,event:1===e.expired_snooze.count?"event":"events"});if(e.expired_snooze.user_count&&e.expired_snooze.user_window)return(0,_._N)("[author] flagged this issue as escalating because [count] [user] affected in [duration]",{author:o,count:e.expired_snooze.user_count,user:1===e.expired_snooze.user_count?"user was":"users were",duration:(0,m.tZ)(ge.Z,{seconds:60*e.expired_snooze.user_window})});if(e.expired_snooze.user_count)return(0,_._N)("[author] flagged this issue as escalating because [count] [user] affected",{author:o,count:e.expired_snooze.user_count,user:1===e.expired_snooze.user_count?"user was":"users were"});if(e.expired_snooze.until)return(0,_._N)("[author] flagged this issue as escalating because [date] passed",{author:o,date:(0,m.tZ)(me.Z,{date:e.expired_snooze.until})})}return(0,_._N)("[author] flagged this issue as escalating",{author:o})}(t.data);default:return""}}()})}be.displayName="GroupActivityItem";const Ze=be,Se=(0,c.Z)("div",{target:"e22iax21"})("overflow-wrap:anywhere;font-size:",(e=>e.theme.fontSizeSmall),";"),we=(0,c.Z)("span",{target:"e22iax20"})("font-family:",(e=>e.theme.text.familyMono),";");var Ne=s("./app/views/issueDetails/utils.tsx");class Ee extends n.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{createBusy:!1,error:!1,errorJSON:null,inputId:(0,ae.E)()}),(0,r.Z)(this,"handleNoteDelete",(async e=>{let{noteId:t,text:s}=e;const{api:r,group:n}=this.props;(0,u.E3)((0,_.t)("Removing comment..."));try{await(0,a.f_)(r,n,t,s),(0,u.B8)()}catch(e){(0,u.Iw)((0,_.t)("Failed to delete comment"))}})),(0,r.Z)(this,"handleNoteCreate",(async e=>{const{api:t,group:s}=this.props;this.setState({createBusy:!0}),(0,u.E3)((0,_.t)("Posting comment..."));try{await(0,a.kT)(t,s,e),this.setState({createBusy:!1,inputId:(0,ae.E)()}),(0,u.B8)()}catch(e){this.setState({createBusy:!1,error:!0,errorJSON:e.responseJSON||oe.N7}),(0,u.Iw)((0,_.t)("Unable to post comment"))}})),(0,r.Z)(this,"handleNoteUpdate",(async(e,t)=>{let{noteId:s,text:r}=t;const{api:n,group:o}=this.props;(0,u.E3)((0,_.t)("Updating comment..."));try{await(0,a.Qk)(n,o,e,s,r),(0,u.B8)()}catch(e){this.setState({error:!0,errorJSON:e.responseJSON||oe.N7}),(0,u.Iw)((0,_.t)("Unable to update comment"))}}))}render(){const{group:e,organization:t}=this.props,{activity:s,count:r,id:o}=e,a=Number(r),u=(0,Ne.Ad)(s),c=(0,Ne.M3)(e,u),p=b.Z.get("user"),h=e&&e.project?[e.project.slug]:[],g={minHeight:140,group:e,projectSlugs:h,placeholder:(0,_.t)("Add details or updates to this event. \nTag users with @, or teams with #")};return(0,m.BX)(n.Fragment,{children:[(c===Ne.m7.REPROCESSED_AND_HASNT_EVENT||c===Ne.m7.REPROCESSED_AND_HAS_EVENT)&&(0,m.tZ)(se,{reprocessActivity:u,groupCount:a,orgSlug:t.slug,groupId:o}),(0,m.tZ)(K.uT,{children:(0,m.BX)(K.or,{children:[(0,m.tZ)(l.l,{noPadding:!0,author:{type:"user",user:p},children:(0,m.tZ)(J,{storageKey:"groupinput:latest",itemKey:e.id,onCreate:this.handleNoteCreate,busy:this.state.createBusy,error:this.state.error,errorJSON:this.state.errorJSON,...g},this.state.inputId)}),(0,m.tZ)(ue.Z,{ids:i()(e.activity.filter((e=>e.type===ie.fc.ASSIGNED&&"team"===e.data.assigneeType&&e.data.assignee?.length>0)).map((e=>e.data.assignee))),children:s=>{let{initiallyLoaded:r}=s;return r?e.activity.map((s=>{const r=s.user?s.user.name:"Sentry";return s.type===ie.fc.NOTE?(0,m.tZ)(W.Z,{mini:!0,children:(0,m.tZ)(q,{showTime:!1,text:s.data.text,noteId:s.id,user:s.user,dateCreated:s.dateCreated,authorName:r,onDelete:this.handleNoteDelete,onUpdate:this.handleNoteUpdate,...g})},`note-${s.id}`):(0,m.tZ)(W.Z,{mini:!0,children:(0,m.tZ)(l.l,{author:{type:s.user?"user":"system",user:s.user??void 0},date:s.dateCreated,header:(0,m.tZ)(Ze,{author:(0,m.tZ)(d.n,{children:r}),activity:s,organization:t,projectId:e.project.id})})},`item-${s.id}`)})):(0,m.tZ)(Y.Z,{})}})]})})]})}}Ee.displayName="GroupActivity";const Ce=(0,de.Z)((0,le.Z)(Ee))}}]);
//# sourceMappingURL=../sourcemaps/app_views_issueDetails_groupActivity_tsx.292ac7436a168fab7df98b07f8b73f0e.js.map