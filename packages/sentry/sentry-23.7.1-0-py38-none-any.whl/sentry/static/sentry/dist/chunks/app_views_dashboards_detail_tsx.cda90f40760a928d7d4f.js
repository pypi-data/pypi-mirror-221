"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_dashboards_detail_tsx"],{"./app/views/dashboards/detail.tsx":(t,e,a)=>{a.d(e,{R:()=>xt,Z:()=>Wt});var i=a("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(a("../node_modules/core-js/modules/es.array.push.js"),a("../node_modules/react/index.js")),d=a("../node_modules/react-router/es/index.js"),n=a("../node_modules/lodash/isEqual.js"),r=a.n(n),l=a("../node_modules/lodash/isEqualWith.js"),h=a.n(l),c=a("../node_modules/lodash/omit.js"),p=a.n(c),u=a("./app/actionCreators/dashboards.tsx"),g=a("./app/actionCreators/indicator.tsx"),m=a("./app/actionCreators/modal.tsx"),b=a("./app/components/breadcrumbs.tsx"),w=a("./app/components/hookOrDefault.tsx"),f=a("./app/components/layouts/thirds.tsx"),D=a("./app/components/modals/widgetViewerModal/utils.tsx"),v=a("./app/components/noProjectMessage.tsx"),y=a("./app/components/organizations/pageFilters/container.tsx"),Z=a("./app/components/sentryDocumentTitle.tsx"),E=a("./app/constants/index.tsx"),x=a("./app/locale.tsx"),S=a("./app/styles/space.tsx"),z=a("./app/utils.tsx"),C=a("./app/utils/analytics.tsx"),W=a("./app/utils/discover/eventView.tsx"),I=a("./app/utils/performance/contexts/metricsCardinality.tsx"),j=a("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),k=a("./app/utils/withApi.tsx"),P=a("./app/utils/withDomainRequired.tsx"),R=a("./app/utils/withOrganization.tsx"),T=a("./app/utils/withProjects.tsx"),q=a("./app/views/dashboards/utils.tsx"),A=a("./app/views/performance/landing/metricsDataSwitcherAlert.tsx"),_=a("./app/views/performance/data.tsx"),U=a("./app/views/performance/landing/metricsDataSwitcher.tsx"),$=a("./app/views/performance/utils.tsx"),L=a("./app/views/dashboards/widgetViewer/widgetViewerContext.tsx"),N=a("./app/components/acl/feature.tsx"),V=a("./app/components/acl/featureDisabled.tsx"),B=a("./app/components/button.tsx"),F=a("./app/components/buttonBar.tsx"),M=a("./app/components/confirm.tsx"),G=a("./app/components/hovercard.tsx"),O=a("./app/components/tooltip.tsx"),Y=a("./app/icons/index.tsx"),X=a("../node_modules/lodash/cloneDeep.js"),K=a.n(X);function H(t,e){const a=[];for(const i in t){const s=K()(e);for(const a in e)if(a in t[i]){let e=[];if(["queries"].includes(a)){const s=J(a);e=H(t[i][a],s)}else e=t[i][a];s[a]=e}a.push(s)}return a}function J(t){let e={};switch(t){case"widgets":e={title:"",description:"",interval:"",queries:[],displayType:"",widgetType:""};break;case"queries":e={aggregates:[],columns:[],conditions:[],name:"",orderby:"",fieldAliases:[],fields:[]};break;default:e={}}return e}var Q=a("./app/views/dashboards/types.tsx"),tt=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function et(t){let{organization:e,dashboardState:a,dashboards:i,hasUnsavedFilters:s,widgetLimitReached:d,onEdit:n,onCommit:r,onDelete:l,onCancel:h,onAddWidget:c}=t;function p(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,x.t)("Cancel");return(0,tt.tZ)(B.zx,{"data-test-id":"dashboard-cancel",size:"sm",onClick:t=>{t.preventDefault(),h()},children:t})}return[Q.n3.EDIT,Q.n3.PENDING_DELETE].includes(a)?(0,tt.BX)(it,{gap:1,children:[p(),(0,tt.tZ)(M.Z,{priority:"danger",message:(0,x.t)("Are you sure you want to delete this dashboard?"),onConfirm:l,disabled:i.length<=1,children:(0,tt.tZ)(B.zx,{size:"sm","data-test-id":"dashboard-delete",priority:"danger",children:(0,x.t)("Delete")})}),(0,tt.tZ)(B.zx,{"data-test-id":"dashboard-commit",size:"sm",onClick:t=>{t.preventDefault(),r()},priority:"primary",children:(0,x.t)("Save and Finish")})]},"edit-controls"):a===Q.n3.CREATE?(0,tt.BX)(it,{gap:1,children:[p(),(0,tt.tZ)(B.zx,{"data-test-id":"dashboard-commit",size:"sm",onClick:t=>{t.preventDefault(),r()},priority:"primary",children:(0,x.t)("Save and Finish")})]},"create-controls"):a===Q.n3.PREVIEW?(0,tt.BX)(it,{gap:1,children:[p((0,x.t)("Go Back")),(0,tt.tZ)(B.zx,{"data-test-id":"dashboard-commit",size:"sm",onClick:t=>{t.preventDefault(),r()},priority:"primary",children:(0,x.t)("Add Dashboard")})]},"preview-controls"):(0,tt.tZ)(it,{gap:1,children:(0,tt.tZ)(at,{children:t=>(0,tt.BX)(o.Fragment,{children:[(0,tt.tZ)(N.Z,{features:["dashboards-import"],children:(0,tt.tZ)(B.zx,{"data-test-id":"dashboard-export",onClick:t=>{t.preventDefault(),async function(){try{const t=function(t){const e=window.location.href,a={base_url:/(\/\/)(.*?)(\/)/,dashboard_id:/(dashboard\/)(.*?)(\/)/};for(const i in a){const s=e.match(a[i]);s?.length&&(t[i]=s.length>=3?s[2]:null)}return t}({base_url:null,dashboard_id:null}),e=`https://${t.base_url}/api/0/organizations/testorg-az/dashboards/${t.dashboard_id}/`,a=await fetch(e),i=function(t){const e={title:"",filters:{},projects:[],widgets:[],environment:[]};for(const a in e)if(a in t){let i=[];if(["widgets"].includes(a)){const e=J(a);i=H(t[a],e)}else i=t[a];e[a]=i}return e}(await a.json());i.projects=[],function(t,e){const a=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(t))}`,i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download",`${e}.json`),document.body.appendChild(i),i.click(),i.remove()}(i,function(t){return`${t.replace(/[^a-z0-9]/gi,"-")}-${(new Date).toISOString()}`}(i.title))}catch(t){(0,g.Iw)("Could not export dashboard. Please wait or try again with a different dashboard")}}()},icon:(0,tt.tZ)(Y.Dj,{}),priority:"default",size:"sm",children:(0,x.t)("Export Dashboard")})}),(0,tt.tZ)(B.zx,{"data-test-id":"dashboard-edit",onClick:t=>{t.preventDefault(),n()},icon:(0,tt.tZ)(Y.yl,{}),disabled:!t||s,title:s&&xt,priority:"default",size:"sm",children:(0,x.t)("Edit Dashboard")}),t?(0,tt.tZ)(O.u,{title:(0,x._N)("Max widgets ([maxWidgets]) per dashboard reached.",{maxWidgets:Q.ZU}),disabled:!d,children:(0,tt.tZ)(B.zx,{"data-test-id":"add-widget-library",priority:"primary",size:"sm",disabled:d,icon:(0,tt.tZ)(Y.N_,{isCircled:!0}),onClick:()=>{(0,C.Gi)("dashboards_views.widget_library.opened",{organization:e}),c()},children:(0,x.t)("Add Widget")})}):null]})})},"controls")}function at(t){let{children:e}=t;return(0,tt.tZ)(N.Z,{hookName:"feature-disabled:dashboards-edit",features:["organizations:dashboards-edit"],renderDisabled:t=>(0,tt.tZ)(G.uI,{body:(0,tt.tZ)(V.Z,{features:t.features,hideHelpToggle:!0,featureName:(0,x.t)("Dashboard Editing")}),children:t.children(t)}),children:t=>{let{hasFeature:a}=t;return e(a)}})}et.displayName="Controls",at.displayName="DashboardEditFeature";const it=(0,s.Z)(F.ZP,{target:"e16ktpyk0"})("@media (max-width: ",(t=>t.theme.breakpoints.small),"){grid-auto-flow:row;grid-row-gap:",(0,S.D)(1),";width:100%;}"),st=et;var ot=a("./app/views/dashboards/dashboard.tsx"),dt=a("./app/views/dashboards/data.tsx"),nt=a("./app/components/datePageFilter.tsx"),rt=a("./app/components/environmentPageFilter.tsx"),lt=a("./app/components/organizations/pageFilterBar.tsx"),ht=a("./app/components/projectPageFilter.tsx"),ct=a("./app/utils/queryString.tsx"),pt=a("./app/utils/releases/releasesProvider.tsx"),ut=a("./app/utils/useOrganization.tsx"),gt=a("./app/utils/usePageFilters.tsx"),mt=a("./app/views/dashboards/releasesSelectControl.tsx");function bt(t){let{filters:e,hasUnsavedChanges:a,isEditingDashboard:i,isPreview:s,location:d,onCancel:n,onDashboardFilterChange:r,onSave:l}=t;const{selection:h}=(0,gt.Z)(),c=(0,ut.Z)(),p=((0,z.ri)(d.query?.[Q.qA.RELEASE])?(0,ct.qP)(d.query[Q.qA.RELEASE]):e?.[Q.qA.RELEASE])??[];return(0,tt.BX)(wt,{children:[(0,tt.BX)(lt.Z,{condensed:!0,children:[(0,tt.tZ)(ht.Z,{disabled:i}),(0,tt.tZ)(rt.Z,{disabled:i}),(0,tt.tZ)(nt.Z,{alignDropdown:"left",disabled:i})]}),(0,tt.BX)(o.Fragment,{children:[(0,tt.tZ)(ft,{children:(0,tt.tZ)(pt.lR,{organization:c,selection:h,children:(0,tt.tZ)(mt.Z,{handleChangeFilter:r,selectedReleases:p,isDisabled:i})})}),a&&!i&&!s&&(0,tt.BX)(ft,{children:[(0,tt.tZ)(B.zx,{priority:"primary",onClick:l,children:(0,x.t)("Save")}),(0,tt.tZ)(B.zx,{onClick:n,children:(0,x.t)("Cancel")})]})]})]})}bt.displayName="FiltersBar";const wt=(0,s.Z)("div",{target:"edjvro81"})("display:flex;flex-direction:row;gap:",(0,S.D)(1.5),";margin-bottom:",(0,S.D)(2),";@media (max-width: ",(t=>t.theme.breakpoints.small),"){display:grid;grid-auto-flow:row;}"),ft=(0,s.Z)(F.ZP,{target:"edjvro80"})("display:grid;gap:",(0,S.D)(1.5),";@media (min-width: ",(t=>t.theme.breakpoints.small),"){display:flex;align-items:flex-start;gap:",(0,S.D)(1.5),";}");var Dt=a("./app/views/dashboards/layoutUtils.tsx"),vt=a("./app/components/editableText.tsx");function yt(t){let{dashboard:e,isEditing:a,onUpdate:i}=t;return(0,tt.tZ)(o.Fragment,{children:e?(0,tt.tZ)(vt.Z,{isDisabled:!a,value:e.title,onChange:t=>i({...e,title:t}),errorMessage:(0,x.t)("Please set a title for this dashboard"),autoSelect:!0}):(0,x.t)("Dashboards")})}yt.displayName="DashboardTitle";const Zt=yt,Et=(0,x.t)("You have unsaved changes, are you sure you want to leave?"),xt=(0,x.t)("You have unsaved dashboard filters. You can save or discard them."),St=(0,w.Z)({hookName:"component:dashboards-header"});class zt extends o.Component{constructor(){super(...arguments),(0,i.Z)(this,"state",{dashboardState:this.props.initialState,modifiedDashboard:this.updateModifiedDashboard(this.props.initialState),widgetLimitReached:this.props.dashboard.widgets.length>=Q.ZU,setData:t=>{this.setState(t)}}),(0,i.Z)(this,"onEdit",(()=>{const{dashboard:t,organization:e}=this.props;(0,C.Gi)("dashboards2.edit.start",{organization:e}),this.setState({dashboardState:Q.n3.EDIT,modifiedDashboard:(0,q.qk)(t)})})),(0,i.Z)(this,"onRouteLeave",(()=>{const{dashboard:t}=this.props,{modifiedDashboard:e}=this.state;if(![Q.n3.VIEW,Q.n3.PENDING_DELETE,Q.n3.PREVIEW].includes(this.state.dashboardState)&&!r()(e,t))return Et})),(0,i.Z)(this,"onUnload",(t=>{const{dashboard:e}=this.props,{modifiedDashboard:a}=this.state;[Q.n3.VIEW,Q.n3.PENDING_DELETE,Q.n3.PREVIEW].includes(this.state.dashboardState)||r()(a,e)||(t.preventDefault(),t.returnValue=Et)})),(0,i.Z)(this,"onDelete",(t=>()=>{const{api:e,organization:a,location:i}=this.props;if(!t?.id)return;const s=this.state.dashboardState;this.setState({dashboardState:Q.n3.PENDING_DELETE},(()=>{(0,u.iM)(e,a.slug,t.id).then((()=>{(0,g.S9)((0,x.t)("Dashboard deleted")),(0,C.Gi)("dashboards2.delete",{organization:a}),d.browserHistory.replace({pathname:`/organizations/${a.slug}/dashboards/`,query:i.query})})).catch((()=>{this.setState({dashboardState:s})}))}))})),(0,i.Z)(this,"onCancel",(()=>{const{organization:t,dashboard:e,location:a,params:i}=this.props,{modifiedDashboard:s}=this.state;let o=!r()(s,e);if(e.widgets.every((t=>{let{layout:e}=t;return!(0,z.ri)(e)}))&&(o=!r()({...s,widgets:s?.widgets.map((t=>p()(t,"layout")))},{...e,widgets:e.widgets.map((t=>p()(t,"layout")))})),!o||this.isPreview||confirm(Et)){if(i.dashboardId)return(0,C.Gi)("dashboards2.edit.cancel",{organization:t}),void this.setState({dashboardState:Q.n3.VIEW,modifiedDashboard:null});(0,C.Gi)("dashboards2.create.cancel",{organization:t}),d.browserHistory.replace((0,P.D)({pathname:`/organizations/${t.slug}/dashboards/`,query:a.query}))}})),(0,i.Z)(this,"handleChangeFilter",(t=>{const{dashboard:e,location:a}=this.props,{modifiedDashboard:i}=this.state,s=i||e;if(Object.keys(t).every((e=>!s.filters?.[e]&&0===t[e].length)))return;const o={};Object.keys(t).forEach((e=>{o[e]=t[e].length?t[e]:""})),h()(t,e.filters,((t,e)=>{if(0===t.length&&0===e.length)return t===e}))||d.browserHistory.push({...a,query:{...a.query,...o}})})),(0,i.Z)(this,"handleUpdateWidgetList",(t=>{const{organization:e,dashboard:a,api:i,onDashboardUpdate:s,location:o}=this.props,{modifiedDashboard:n}=this.state,r=(0,Dt.RI)(t),l=(0,Dt.Sp)(r),h={...(0,q.qk)(n||a),widgets:(0,Dt._F)(t,l)};this.setState({modifiedDashboard:h,widgetLimitReached:t.length>=Q.ZU}),this.isEditing||this.isPreview||(0,u.Y)(i,e.slug,h).then((t=>{s&&(s(t),this.setState({modifiedDashboard:null})),(0,g.S9)((0,x.t)("Dashboard updated")),a&&t.id!==a.id&&d.browserHistory.replace((0,P.D)({pathname:`/organizations/${e.slug}/dashboard/${t.id}/`,query:{...o.query}}))}),(()=>{}))})),(0,i.Z)(this,"handleAddCustomWidget",(t=>{const{dashboard:e}=this.props,{modifiedDashboard:a}=this.state,i=a||e;this.onUpdateWidget([...i.widgets,t])})),(0,i.Z)(this,"onAddWidget",(()=>{const{organization:t,dashboard:e,router:a,location:i,params:{dashboardId:s}}=this.props;this.setState({modifiedDashboard:(0,q.qk)(e)}),s&&a.push((0,P.D)({pathname:`/organizations/${t.slug}/dashboard/${s}/widget/new/`,query:{...i.query,source:Q.EN.DASHBOARDS}}))})),(0,i.Z)(this,"onCommit",(()=>{const{api:t,organization:e,location:a,dashboard:i,onDashboardUpdate:s}=this.props,{modifiedDashboard:o,dashboardState:n}=this.state;switch(n){case Q.n3.PREVIEW:case Q.n3.CREATE:if(o){this.isPreview&&(0,C.Gi)("dashboards_manage.templates.add",{organization:e,dashboard_id:i.id,dashboard_title:i.title,was_previewed:!0});const s={...(0,q.qk)(o),...(0,q.EK)(a),filters:(0,q.lM)(a)??o.filters};(0,u.JR)(t,e.slug,s,this.isPreview).then((t=>{(0,g.S9)((0,x.t)("Dashboard created")),(0,C.Gi)("dashboards2.create.complete",{organization:e}),this.setState({dashboardState:Q.n3.VIEW}),d.browserHistory.replace((0,P.D)({pathname:`/organizations/${e.slug}/dashboard/${t.id}/`,query:{query:p()(a.query,Object.values(Q.qA))}}))}),(()=>{}))}break;case Q.n3.EDIT:if(o)return r()(i,o)?void this.setState({dashboardState:Q.n3.VIEW,modifiedDashboard:null}):void(0,u.Y)(t,e.slug,o).then((t=>{s&&s(t),(0,g.S9)((0,x.t)("Dashboard updated")),(0,C.Gi)("dashboards2.edit.complete",{organization:e}),this.setState({dashboardState:Q.n3.VIEW,modifiedDashboard:null}),i&&t.id!==i.id&&d.browserHistory.replace((0,P.D)({pathname:`/organizations/${e.slug}/dashboard/${t.id}/`,query:{...a.query}}))}),(()=>{}));this.setState({dashboardState:Q.n3.VIEW,modifiedDashboard:null});break;case Q.n3.VIEW:default:this.setState({dashboardState:Q.n3.VIEW,modifiedDashboard:null})}})),(0,i.Z)(this,"setModifiedDashboard",(t=>{this.setState({modifiedDashboard:t})})),(0,i.Z)(this,"onUpdateWidget",(t=>{this.setState((e=>({...e,widgetLimitReached:t.length>=Q.ZU,modifiedDashboard:{...e.modifiedDashboard||this.props.dashboard,widgets:t}})))}))}componentDidMount(){const{route:t,router:e}=this.props;e.setRouteLeaveHook(t,this.onRouteLeave),window.addEventListener("beforeunload",this.onUnload),this.checkIfShouldMountWidgetViewerModal()}componentDidUpdate(t){this.checkIfShouldMountWidgetViewerModal(),t.initialState!==this.props.initialState&&this.setState({dashboardState:this.props.initialState})}componentWillUnmount(){window.removeEventListener("beforeunload",this.onUnload)}checkIfShouldMountWidgetViewerModal(){const{params:{widgetId:t,dashboardId:e},organization:a,dashboard:i,location:s,router:o}=this.props,{seriesData:d,tableData:n,pageLinks:r,totalIssuesCount:l,seriesResultsType:h}=this.state;if((0,D.X)(s.pathname)){const c=(0,z.ri)(t)&&(i.widgets.find((e=>{let{id:a}=e;return"number"==typeof t?a===String(t):a===t}))??i.widgets[t]);c?((0,m.openWidgetViewerModal)({organization:a,widget:c,seriesData:d,seriesResultsType:h,tableData:n,pageLinks:r,totalIssuesCount:l,dashboardFilters:(0,q.lM)(s)??i.filters,onClose:()=>{const t=p()(s.query,Object.values(D.R));o.push({pathname:s.pathname.replace(/widget\/[0-9]+\/$/,""),query:t})},onEdit:()=>{const t=i.widgets.indexOf(c);e&&o.push((0,P.D)({pathname:`/organizations/${a.slug}/dashboard/${e}/widget/${t}/edit/`,query:{...s.query,source:Q.EN.DASHBOARDS}}))}}),(0,C.Gi)("dashboards_views.widget_viewer.open",{organization:a,widget_type:c.widgetType??Q.l9.DISCOVER,display_type:c.displayType})):(o.replace((0,P.D)({pathname:`/organizations/${a.slug}/dashboard/${i.id}/`,query:s.query})),(0,g.Iw)((0,x.t)("Widget not found")))}}updateModifiedDashboard(t){const{dashboard:e}=this.props;switch(t){case Q.n3.PREVIEW:case Q.n3.CREATE:case Q.n3.EDIT:return(0,q.qk)(e);default:return null}}get isPreview(){const{dashboardState:t}=this.state;return Q.n3.PREVIEW===t}get isEditing(){const{dashboardState:t}=this.state;return[Q.n3.EDIT,Q.n3.CREATE,Q.n3.PENDING_DELETE].includes(t)}get isWidgetBuilderRouter(){const{location:t,params:e,organization:a}=this.props,{dashboardId:i,widgetIndex:s}=e,o=[`/organizations/${a.slug}/dashboards/new/widget/new/`,`/organizations/${a.slug}/dashboard/${i}/widget/new/`,`/organizations/${a.slug}/dashboards/new/widget/${s}/edit/`,`/organizations/${a.slug}/dashboard/${i}/widget/${s}/edit/`];return E.Yj&&o.push("/dashboards/new/widget/new/",`/dashboard/${i}/widget/new/`,`/dashboards/new/widget/${s}/edit/`,`/dashboard/${i}/widget/${s}/edit/`),o.includes(t.pathname)}get dashboardTitle(){const{dashboard:t}=this.props,{modifiedDashboard:e}=this.state;return e?e.title:t.title}renderWidgetBuilder(){const{children:t,dashboard:e}=this.props,{modifiedDashboard:a}=this.state;return(0,o.isValidElement)(t)?(0,o.cloneElement)(t,{dashboard:a??e,onSave:this.isEditing?this.onUpdateWidget:this.handleUpdateWidgetList}):t}renderDefaultDashboardDetail(){const{organization:t,dashboard:e,dashboards:a,params:i,router:s,location:o}=this.props,{modifiedDashboard:d,dashboardState:n,widgetLimitReached:r}=this.state,{dashboardId:l}=i;return(0,tt.tZ)(y.Z,{desyncedAlertMessage:'Using filter values saved to this dashboard. To edit saved filters, click "Edit Dashboard".',hideDesyncRevertButton:!0,disablePersistence:!0,defaultSelection:{datetime:{start:null,end:null,utc:!1,period:dt.GY}},children:(0,tt.tZ)(f.T3,{withPadding:!0,children:(0,tt.BX)(v.Z,{organization:t,children:[(0,tt.BX)(Ct,{children:[(0,tt.tZ)(f.Dx,{children:(0,tt.tZ)(Zt,{dashboard:d??e,onUpdate:this.setModifiedDashboard,isEditing:this.isEditing})}),(0,tt.tZ)(st,{organization:t,dashboards:a,onEdit:this.onEdit,onCancel:this.onCancel,onCommit:this.onCommit,onAddWidget:this.onAddWidget,onDelete:this.onDelete(e),dashboardState:n,widgetLimitReached:r})]}),(0,tt.tZ)(St,{organization:t}),(0,tt.tZ)(bt,{filters:{},location:o,hasUnsavedChanges:!1,isEditingDashboard:!1,isPreview:!1,onDashboardFilterChange:this.handleChangeFilter}),(0,tt.tZ)(I.BT,{organization:t,location:o,children:(0,tt.tZ)(U.d,{organization:t,eventView:W.ZP.fromLocation(o),location:o,hideLoadingIndicator:!0,children:a=>(0,tt.tZ)(j.kP,{location:o,forceTransactions:a.forceTransactionsOnly,children:(0,tt.tZ)(ot.ZP,{paramDashboardId:l,dashboard:d??e,organization:t,isEditing:this.isEditing,widgetLimitReached:r,onUpdate:this.onUpdateWidget,handleUpdateWidgetList:this.handleUpdateWidgetList,handleAddCustomWidget:this.handleAddCustomWidget,isPreview:this.isPreview,router:s,location:o})})})})]})})})}getBreadcrumbLabel(){const{dashboardState:t}=this.state;let e=this.dashboardTitle;return t===Q.n3.CREATE?e=(0,x.t)("Create Dashboard"):this.isPreview&&(e=(0,x.t)("Preview Dashboard")),e}renderDashboardDetail(){const{api:t,organization:e,dashboard:a,dashboards:i,params:s,router:o,location:n,newWidget:r,onSetNewWidget:l,onDashboardUpdate:h,projects:c}=this.props,{modifiedDashboard:m,dashboardState:w,widgetLimitReached:D,seriesData:E,setData:S}=this.state,{dashboardId:z}=s,C="default-overview"!==a.id&&w!==Q.n3.CREATE&&(0,q.S$)(a,n),W=(0,_.C)(n,c,{},e),k=a.widgets.some(q.Gx);return(0,tt.tZ)(Z.Z,{title:a.title,orgSlug:e.slug,children:(0,tt.tZ)(y.Z,{desyncedAlertMessage:'Using filter values saved to this dashboard. To edit saved filters, click "Edit Dashboard".',hideDesyncRevertButton:!0,disablePersistence:!0,defaultSelection:{datetime:{start:null,end:null,utc:!1,period:dt.GY}},children:(0,tt.tZ)(f.T3,{children:(0,tt.BX)(v.Z,{organization:e,children:[(0,tt.BX)(f.h4,{children:[(0,tt.BX)(f.oB,{children:[(0,tt.tZ)(b.Z,{crumbs:[{label:(0,x.t)("Dashboards"),to:`/organizations/${e.slug}/dashboards/`},{label:this.getBreadcrumbLabel()}]}),(0,tt.tZ)(f.Dx,{children:(0,tt.tZ)(Zt,{dashboard:m??a,onUpdate:this.setModifiedDashboard,isEditing:this.isEditing})})]}),(0,tt.tZ)(f.kP,{children:(0,tt.tZ)(st,{organization:e,dashboards:i,hasUnsavedFilters:C,onEdit:this.onEdit,onCancel:this.onCancel,onCommit:this.onCommit,onAddWidget:this.onAddWidget,onDelete:this.onDelete(a),dashboardState:w,widgetLimitReached:D})})]}),(0,tt.tZ)(f.uT,{children:(0,tt.tZ)(f.or,{fullWidth:!0,children:(0,tt.tZ)(I.BT,{organization:e,location:n,children:(0,tt.tZ)(U.d,{organization:e,eventView:W,location:n,hideLoadingIndicator:!0,children:i=>(0,tt.BX)(j.kP,{location:n,forceTransactions:i.forceTransactionsOnly,children:[k?(0,tt.tZ)(A.v,{organization:e,eventView:W,projects:c,location:n,router:o,source:$.Pv.DISCOVER,...i}):null,(0,tt.tZ)(bt,{filters:(m??a).filters,location:n,hasUnsavedChanges:C,isEditingDashboard:w!==Q.n3.CREATE&&this.isEditing,isPreview:this.isPreview,onDashboardFilterChange:this.handleChangeFilter,onCancel:()=>{(0,q.Z5)(a,n),this.setState({modifiedDashboard:{...m??a,filters:a.filters}})},onSave:()=>{const i={...(0,q.qk)(m??a),...(0,q.EK)(n),filters:(0,q.lM)(n)??(m??a).filters};(0,u.Y)(t,e.slug,i).then((t=>{h&&(h(t),this.setState({modifiedDashboard:null})),(0,g.S9)((0,x.t)("Dashboard filters updated")),d.browserHistory.replace((0,P.D)({pathname:`/organizations/${e.slug}/dashboard/${t.id}/`,query:p()(n.query,Object.values(Q.qA))}))}),(()=>{}))}}),(0,tt.tZ)(L.M.Provider,{value:{seriesData:E,setData:S},children:(0,tt.tZ)(ot.ZP,{paramDashboardId:z,dashboard:m??a,organization:e,isEditing:this.isEditing,widgetLimitReached:D,onUpdate:this.onUpdateWidget,handleUpdateWidgetList:this.handleUpdateWidgetList,handleAddCustomWidget:this.handleAddCustomWidget,router:o,location:n,newWidget:r,onSetNewWidget:l,isPreview:this.isPreview})})]})})})})})]})})})})}render(){const{organization:t}=this.props;return this.isWidgetBuilderRouter?this.renderWidgetBuilder():t.features.includes("dashboards-edit")?this.renderDashboardDetail():this.renderDefaultDashboardDetail()}}zt.displayName="DashboardDetail";const Ct=(0,s.Z)("div",{target:"e1ji5rzx0"})("display:grid;grid-template-columns:minmax(0, 1fr);grid-row-gap:",(0,S.D)(2),";align-items:center;margin-bottom:",(0,S.D)(2),";@media (min-width: ",(t=>t.theme.breakpoints.medium),"){grid-template-columns:minmax(0, 1fr) max-content;grid-column-gap:",(0,S.D)(2),";height:40px;}"),Wt=(0,T.Z)((0,k.Z)((0,R.Z)(zt)))},"./app/views/performance/landing/metricsDataSwitcherAlert.tsx":(t,e,a)=>{a.d(e,{v:()=>m});var i=a("../node_modules/react/index.js"),s=a("./app/actionCreators/pageFilters.tsx"),o=a("./app/components/alert.tsx"),d=a("./app/components/links/externalLink.tsx"),n=a("./app/components/links/link.tsx"),r=a("./app/components/sidebar/types.tsx"),l=a("./app/locale.tsx"),h=a("./app/stores/sidebarPanelStore.tsx"),c=a("./app/views/performance/utils.tsx"),p=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const u=["javascript","node","python","ruby","native","react-native","dotnet","unity","flutter","dart","java","android"],g=["javascript.cordova","javascript.nextjs","native.minidumps"];function m(t){const e=t.organization.features.includes("performance-mep-bannerless-ui"),a=(0,i.useCallback)((()=>{h.Z.activatePanel(r.z.BROADCASTS)}),[]),m=(0,i.useMemo)((()=>{const e=(0,c.bY)(t.location,t.projects);if(e.length<1)return null;const a=e[0];if(g.includes(a))return null;const i=u.find((t=>a.includes(t)));return i?`https://docs.sentry.io/platforms/${i}/enriching-events/transaction-name/`:null}),[t.location,t.projects]),b=(0,i.useCallback)((()=>{(0,s.id)(t.compatibleProjects||[],t.router)}),[t.compatibleProjects,t.router]);if(!t.shouldNotifyUnnamedTransactions&&!t.shouldWarnIncompatibleSDK)return null;const w=(0,c.uq)(t);if(e)return null;if(t.shouldWarnIncompatibleSDK){const e=(0,p.tZ)(n.Z,{to:"",onClick:a,children:(0,l.t)("update your SDK version")});return(0,c.Y9)(t.eventView.project)?0===(t.compatibleProjects??[]).length?(0,p.tZ)(o.bZ,{type:"warning",showIcon:!0,"data-test-id":"landing-mep-alert-multi-project-all-incompatible",children:(0,l._N)("A few projects are incompatible with dynamic sampling. To enable this feature [updateSDK].",{updateSDK:e})}):(0,p.tZ)(o.bZ,{type:"warning",showIcon:!0,"data-test-id":"landing-mep-alert-multi-project-incompatible",children:(0,l._N)("A few projects are incompatible with dynamic sampling. You can either [updateSDK] or [onlyViewCompatible]",{updateSDK:e,onlyViewCompatible:(0,p.tZ)(n.Z,{to:"",onClick:b,children:(0,l.t)("only view compatible projects.")})})}):(0,p.tZ)(o.bZ,{type:"warning",showIcon:!0,"data-test-id":"landing-mep-alert-single-project-incompatible",children:(0,l._N)("Your project has an outdated SDK which is incompatible with dynamic sampling. To enable this feature [updateSDK].",{updateSDK:e})})}if(t.shouldNotifyUnnamedTransactions){const t=(0,p.tZ)(n.Z,{to:w,children:(0,l.t)("open them in Discover.")});return m?(0,p.tZ)(o.bZ,{type:"warning",showIcon:!0,"data-test-id":"landing-mep-alert-unnamed-discover-or-set",children:(0,l._N)("You have some unparameterized transactions which are incompatible with dynamic sampling. You can either [setNames] or [discover]",{setNames:(0,p.tZ)(d.Z,{href:m,children:(0,l.t)("set names manually")}),discover:t})}):(0,p.tZ)(o.bZ,{type:"warning",showIcon:!0,"data-test-id":"landing-mep-alert-unnamed-discover",children:(0,l._N)("You have some unparameterized transactions which are incompatible with dynamic sampling. You can [discover]",{discover:t})})}return null}}}]);
//# sourceMappingURL=../sourcemaps/app_views_dashboards_detail_tsx.fcfefc3731656263a5f66e91ac92eb05.js.map