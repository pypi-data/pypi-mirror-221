"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_actionCreators_navigation_tsx-app_utils_useParams_tsx-app_utils_withOrganizations_tsx"],{"./app/actionCreators/navigation.tsx":(t,e,o)=>{o.d(e,{T:()=>c}),o("../node_modules/core-js/modules/es.array.push.js");var n=o("./app/actionCreators/modal.tsx"),s=o("./app/components/contextPickerModal.tsx"),i=o("./app/stores/projectsStore.tsx"),r=o("./app/utils/replaceRouterParams.tsx"),a=o("./app/utils/withDomainRequired.tsx"),l=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c(t,e,o){const c=t.includes(":orgId"),p=t.includes(":projectId")||t.includes(":project"),d=e?.location?.query?.project,u=!d||Array.isArray(d),g=i.Z.getById(d);c||p&&(u||!g)||o?(0,n.openModal)((n=>(0,l.tZ)(s.Z,{...n,nextPath:t,needOrg:c,needProject:p,configUrl:o,onFinish:t=>(n.closeModal(),window.setTimeout((()=>e.push((0,a.D)(t))),0))})),{}):(g&&(t=(0,r.Z)(t,{projectId:g.slug,project:g.id})),e.push((0,a.D)(t)))}},"./app/components/contextPickerModal.tsx":(t,e,o)=>{o.d(e,{Z:()=>P});var n=o("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=o("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(o("../node_modules/core-js/modules/es.array.push.js"),o("../node_modules/react/index.js")),r=o("../node_modules/react-dom/profiling.js"),a=o("../node_modules/react-select/dist/index-4bd03571.esm.js"),l=o("./app/components/deprecatedAsyncComponent.tsx"),c=o("./app/components/forms/controls/selectControl.tsx"),p=o("./app/components/idBadge/index.tsx"),d=o("./app/components/links/link.tsx"),u=o("./app/components/loadingIndicator.tsx"),g=o("./app/locale.tsx"),h=o("./app/stores/configStore.tsx"),m=o("./app/stores/organizationsStore.tsx"),j=o("./app/stores/organizationStore.tsx"),Z=o("./app/styles/space.tsx"),x=o("./app/utils/projects.tsx"),f=o("./app/utils/replaceRouterParams.tsx"),z=o("./app/views/settings/organizationIntegrations/integrationIcon.tsx"),S=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const b={menu:t=>({...t,position:"initial",boxShadow:"none",marginBottom:0}),option:(t,e)=>({...t,opacity:e.isDisabled?.6:1,cursor:e.isDisabled?"not-allowed":"pointer",pointerEvents:e.isDisabled?"none":"auto"})};class v extends i.Component{constructor(){var t;super(...arguments),t=this,(0,n.Z)(this,"onFinishTimeout",void 0),(0,n.Z)(this,"orgSelect",null),(0,n.Z)(this,"projectSelect",null),(0,n.Z)(this,"configSelect",null),(0,n.Z)(this,"navigateIfFinish",(function(e,o){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.props.organization;const{needProject:s,onFinish:i,nextPath:r,integrationConfigs:a}=t.props,{isSuperuser:l}=h.Z.get("user")||{};if(!s&&1!==e.length||s&&1!==o.length||a.length&&l)return;if(window.clearTimeout(t.onFinishTimeout),!s)return void(t.onFinishTimeout=i((0,f.Z)(r,{orgId:e[0].slug}))??void 0);let c=n;c||1!==e.length||(c=e[0].slug),t.onFinishTimeout=i((0,f.Z)(r,{orgId:c,projectId:o[0].slug,project:t.props.projects.find((t=>t.slug===o[0].slug))?.id}))??void 0})),(0,n.Z)(this,"doFocus",(t=>{if(!t||this.props.loading)return;const e=(0,r.findDOMNode)(t);if(null!==e){const t=e.querySelector("input");t&&t.focus()}})),(0,n.Z)(this,"handleSelectOrganization",(t=>{let{value:e}=t;this.props.needProject?this.props.onSelectOrganization(e):this.navigateIfFinish([{slug:e}],[])})),(0,n.Z)(this,"handleSelectProject",(t=>{let{value:e}=t;const{organization:o}=this.props;e&&o&&this.navigateIfFinish([{slug:o}],[{slug:e}])})),(0,n.Z)(this,"handleSelectConfiguration",(t=>{let{value:e}=t;const{onFinish:o,nextPath:n}=this.props;e&&o(`${n}${e}/`)})),(0,n.Z)(this,"getMemberProjects",(()=>{const{projects:t}=this.props,e=[],o=[];return t.forEach((t=>t.isMember?o.push(t):e.push(t))),[o,e]})),(0,n.Z)(this,"customOptionProject",(t=>{let{label:e,...o}=t;const n=this.props.projects.find((t=>{let{slug:e}=t;return o.value===e}));return n?(0,S.tZ)(a.c.Option,{label:e,...o,children:(0,S.tZ)(C,{project:n,avatarSize:20,displayName:e,avatarProps:{consistentWidth:!0},disableLink:!0})}):null}))}componentDidMount(){const{organization:t,projects:e,organizations:o}=this.props;1===o.length&&t&&this.navigateIfFinish([{slug:t}],e)}componentDidUpdate(t){JSON.stringify(t.projects)!==JSON.stringify(this.props.projects)&&this.navigateIfFinish(this.props.organizations,this.props.projects)}componentWillUnmount(){window.clearTimeout(this.onFinishTimeout)}get headerText(){const{needOrg:t,needProject:e,integrationConfigs:o}=this.props;return t&&e?(0,g.t)("Select an organization and a project to continue"):t?(0,g.t)("Select an organization to continue"):e?(0,g.t)("Select a project to continue"):o.length?(0,g.t)("Select a configuration to continue"):""}renderProjectSelectOrMessage(){const{organization:t,projects:e,allowAllProjectsSelection:o}=this.props,[n,s]=this.getMemberProjects(),{isSuperuser:i}=h.Z.get("user")||{},r=[{label:(0,g.t)("My Projects"),options:n.map((t=>({value:t.slug,label:t.slug,disabled:!1})))},{label:(0,g.t)("All Projects"),options:s.map((t=>({value:t.slug,label:t.slug,disabled:!o&&!i})))}];return e.length?(0,S.tZ)(w,{ref:t=>{this.projectSelect=t,this.doFocus(this.projectSelect)},placeholder:(0,g.t)("Select a Project to continue"),name:"project",options:r,onChange:this.handleSelectProject,components:{Option:this.customOptionProject,DropdownIndicator:null},styles:b,menuIsOpen:!0}):(0,S.tZ)("div",{children:(0,g._N)("You have no projects. Click [link] to make one.",{link:(0,S.tZ)(d.Z,{to:`/organizations/${t}/projects/new/`,children:(0,g.t)("here")})})})}renderIntegrationConfigs(){const{integrationConfigs:t}=this.props,{isSuperuser:e}=h.Z.get("user")||{},o=[{label:(0,g._N)("[providerName] Configurations",{providerName:t[0].provider.name}),options:t.map((t=>({value:t.id,label:(0,S.BX)(O,{children:[(0,S.tZ)(z.Z,{size:22,integration:t}),(0,S.tZ)("span",{children:t.domainName})]}),disabled:!e})))}];return(0,S.tZ)(w,{ref:t=>{this.configSelect=t,this.doFocus(this.configSelect)},placeholder:(0,g.t)("Select a configuration to continue"),name:"configurations",options:o,onChange:this.handleSelectConfiguration,components:{DropdownIndicator:null},styles:b,menuIsOpen:!0})}render(){const{needOrg:t,needProject:e,organization:o,organizations:n,loading:s,Header:r,Body:a,integrationConfigs:l}=this.props,{isSuperuser:c}=h.Z.get("user")||{},p=o&&e&&!s,d=l.length>0&&c,u=n.filter((t=>{let{status:e}=t;return"pending_deletion"!==e.id})).map((t=>{let{slug:e}=t;return{label:e,value:e}}));return t||e||d?(0,S.BX)(i.Fragment,{children:[(0,S.tZ)(r,{closeButton:!0,children:this.headerText}),(0,S.BX)(a,{children:[s&&(0,S.tZ)(I,{overlay:!0}),t&&(0,S.tZ)(w,{ref:t=>{this.orgSelect=t,p||this.doFocus(this.orgSelect)},placeholder:(0,g.t)("Select an Organization"),name:"organization",options:u,value:o,onChange:this.handleSelectOrganization,components:{DropdownIndicator:null},styles:b,menuIsOpen:!0}),p&&this.renderProjectSelectOrMessage(),d&&this.renderIntegrationConfigs()]})]}):null}}v.displayName="ContextPickerModal";class y extends l.Z{constructor(){super(...arguments),(0,n.Z)(this,"unlistener",m.Z.listen((t=>this.setState({organizations:t})),void 0)),(0,n.Z)(this,"handleSelectOrganization",(t=>{this.setState({selectedOrganization:t})}))}getDefaultState(){const t=j.Z.get();return{...super.getDefaultState(),organizations:m.Z.getAll(),selectedOrganization:t.organization?.slug}}getEndpoints(){const{configUrl:t}=this.props;return t?[["integrationConfigs",t]]:[]}componentWillUnmount(){this.unlistener?.()}renderModal(t){let{projects:e,initiallyLoaded:o,integrationConfigs:n}=t;return(0,S.tZ)(v,{...this.props,projects:e||[],loading:!o,organizations:this.state.organizations,organization:this.state.selectedOrganization,onSelectOrganization:this.handleSelectOrganization,integrationConfigs:n||[],allowAllProjectsSelection:this.props.allowAllProjectsSelection})}render(){const{projectSlugs:t,configUrl:e}=this.props;return e&&this.state.loading?(0,S.tZ)(u.Z,{}):this.state.integrationConfigs?.length?this.renderModal({integrationConfigs:this.state.integrationConfigs,initiallyLoaded:!this.state.loading}):this.state.selectedOrganization?(0,S.tZ)(x.Z,{orgId:this.state.selectedOrganization,allProjects:!t?.length,slugs:t,children:t=>{let{projects:e,initiallyLoaded:o}=t;return this.renderModal({projects:e,initiallyLoaded:o})}}):this.renderModal({})}}y.displayName="ContextPickerModalContainer";const P=y,w=(0,s.Z)(c.Z,{target:"e10w9lcp3"})("margin-top:",(0,Z.D)(1),";"),C=(0,s.Z)(p.Z,{target:"e10w9lcp2"})("margin:",(0,Z.D)(1),";"),I=(0,s.Z)(u.Z,{target:"e10w9lcp1"})({name:"1739oy8",styles:"z-index:1"}),O=(0,s.Z)("div",{target:"e10w9lcp0"})("display:grid;grid-template-columns:",(0,Z.D)(4)," auto;grid-template-rows:1fr;")},"./app/utils/replaceRouterParams.tsx":(t,e,o)=>{function n(t,e){const o=t.match(/:\w+/g);return o&&o.length?(o.forEach((o=>{const n=o.slice(1);void 0!==e[n]&&(t=t.replace(o,String(e[n])))})),t):t}o.d(e,{Z:()=>n})},"./app/utils/useParams.tsx":(t,e,o)=>{o.d(e,{U:()=>r});var n=o("../node_modules/react/index.js"),s=o("./app/constants/index.tsx"),i=o("./app/utils/useRouteContext.tsx");function r(){const t=(0,i.s)().params;return(0,n.useMemo)((()=>s.Yj&&s.QI&&void 0===t.orgId?{...t,orgId:s.QI}:t),[t])}},"./app/utils/withOrganizations.tsx":(t,e,o)=>{o.d(e,{Z:()=>l});var n=o("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=o("../node_modules/react/index.js"),i=o("./app/stores/organizationsStore.tsx"),r=o("./app/utils/getDisplayName.tsx"),a=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(t){class e extends s.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{organizations:i.Z.getAll()}),(0,n.Z)(this,"unsubscribe",i.Z.listen((t=>this.setState({organizations:t})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{organizationsLoading:e,organizations:o,...n}=this.props;return(0,a.tZ)(t,{organizationsLoading:e??!i.Z.loaded,organizations:o??this.state.organizations,...n})}}return e.displayName="WithOrganizations",(0,n.Z)(e,"displayName",`withOrganizations(${(0,r.Z)(t)})`),e}},"./app/views/settings/organizationIntegrations/integrationIcon.tsx":(t,e,o)=>{o.d(e,{Z:()=>p});var n=o("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=o("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=o("../node_modules/react/index.js"),r=o("./app/plugins/components/pluginIcon.tsx"),a=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=(0,s.Z)("img",{target:"eidhfci0"})("height:",(t=>t.size),"px;width:",(t=>t.size),"px;border-radius:2px;display:block;");class c extends i.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{imgSrc:this.props.integration.icon})}render(){const{integration:t,size:e}=this.props;return(0,a.tZ)(l,{size:e,src:this.state.imgSrc,onError:()=>{this.setState({imgSrc:r.kg[t.provider.key]||r.jp})}})}}c.displayName="Icon";const p=function(t){let{integration:e,size:o=32}=t;return e.icon?(0,a.tZ)(c,{size:o,integration:e}):(0,a.tZ)(r.ZP,{size:o,pluginId:e.provider.key})}}}]);
//# sourceMappingURL=../sourcemaps/app_actionCreators_navigation_tsx-app_utils_useParams_tsx-app_utils_withOrganizations_tsx.655725c20fc41086effaae23ae3b8b57.js.map