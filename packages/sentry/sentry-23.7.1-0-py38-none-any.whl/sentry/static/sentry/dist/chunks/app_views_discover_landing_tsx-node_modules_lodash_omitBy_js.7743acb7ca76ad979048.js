(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_discover_landing_tsx-node_modules_lodash_omitBy_js"],{"./app/components/activity/item/avatar.tsx":(e,t,r)=>{"use strict";r.d(t,{q:()=>d});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=r("./app/components/avatar/userAvatar.tsx"),a=r("./app/components/placeholder.tsx"),i=r("./app/icons/index.tsx"),n=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){let{className:t,type:r,user:s,size:i=38}=e;return s?(0,n.tZ)(o.Z,{user:s,size:i,className:t}):"system"===r?(0,n.tZ)(l,{className:t,size:i,children:(0,n.tZ)(c,{size:"md"})}):(0,n.tZ)(a.Z,{className:t,width:`${i}px`,height:`${i}px`,shape:"circle"})}d.displayName="ActivityAvatar";const l=(0,s.Z)("span",{target:"ef4o3hd1"})("display:flex;justify-content:center;align-items:center;width:",(e=>e.size),"px;height:",(e=>e.size),"px;background-color:",(e=>e.theme.textColor),";color:",(e=>e.theme.background),";border-radius:50%;"),c=(0,s.Z)(i.iW,{target:"ef4o3hd0"})({name:"1p2ly5v",styles:"padding-bottom:3px"})},"./app/components/charts/components/visualMap.tsx":(e,t,r)=>{"use strict";function s(e){return e}r.d(t,{Z:()=>s}),r("../node_modules/echarts/lib/component/visualMap.js")},"./app/components/charts/eventsGeoRequest.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var s=r("../node_modules/react/index.js"),o=r("./app/utils/dates.tsx"),a=r("./app/utils/discover/eventView.tsx"),i=r("./app/utils/discover/genericDiscoverQuery.tsx"),n=r("./app/utils/toArray.tsx"),d=r("./app/utils/usePrevious.tsx");const l=e=>{let{api:t,organization:r,yAxis:l,query:c,orderby:p,projects:u,period:m,start:h,end:y,environments:g,referrer:v,children:x,dataset:b}=e;const f=(0,s.useMemo)((()=>a.ZP.fromSavedQuery({id:void 0,name:"",version:2,fields:(0,n.Z)(l),query:c,orderby:p??"",projects:u,range:m??"",start:h?(0,o.v5)(h):void 0,end:y?(0,o.v5)(y):void 0,environment:g,dataset:b})),[l,c,p,u,m,h,y,g,b]),[Z,w]=(0,s.useState)(void 0),[C,j]=(0,s.useState)(!1),[A,D]=(0,s.useState)(!1),q=(0,d.Z)(t),z=(0,d.Z)(f),_=(0,d.Z)(r.slug),k=(0,d.Z)(v);return(0,s.useEffect)((()=>{let e=!0;return D(!1),q===t&&z===f&&_===r.slug&&k===v||j(!0),(0,i.AA)(t,`/organizations/${r.slug}/events-geo/`,{...f.generateQueryStringObject(),referrer:v}).then((t=>{e&&(w([t[0]]),j(!1))})).catch((()=>{e&&(D(!0),j(!1))})),()=>{e=!1}}),[t,f,r.slug,v,q,z,_,k]),x({errored:A,loading:!Z&&!A,reloading:C,tableData:Z})}},"./app/components/charts/lineChart.tsx":(e,t,r)=>{"use strict";r.d(t,{w:()=>i});var s=r("./app/components/charts/series/lineSeries.tsx"),o=r("./app/components/charts/baseChart.tsx"),a=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{series:t,seriesOptions:r,...i}=e;return(0,a.tZ)(o.Z,{...i,series:t.map((e=>{let{seriesName:t,data:o,dataArray:a,...i}=e;return(0,s.Z)({...r,...i,name:t,data:a||o?.map((e=>{let{value:t,name:r}=e;return[r,t]})),animation:!1,animationThreshold:1,animationDuration:0})}))})}i.displayName="LineChart"},"./app/components/charts/worldMapChart.tsx":(e,t,r)=>{"use strict";r.d(t,{y:()=>v});var s=r("../node_modules/react/index.js"),o=r("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),a=r("../node_modules/echarts/lib/core/echarts.js"),i=r("../node_modules/lodash/max.js"),n=r.n(i),d=r("./app/components/charts/components/visualMap.tsx");r("../node_modules/echarts/lib/chart/map.js");var l=r("./app/components/charts/baseChart.tsx"),c=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const p=1.3,u=1.1,m=.9,h=10.97,y=-12,g=9.71;function v(e){let{series:t,seriesOptions:i,fromDiscover:v,fromDiscoverQueryList:x,...b}=e;const f=(0,o.u)(),[Z,w]=(0,s.useState)((()=>({countryToCodeMap:null,map:null,codeToCountryMap:null})));if((0,s.useEffect)((()=>{let e=!1;return e||async function(){try{const[e,t]=await Promise.all([r.e("app_data_countryCodesMap_tsx").then(r.bind(r,"./app/data/countryCodesMap.tsx")),r.e("app_data_world_json").then(r.t.bind(r,"./app/data/world.json",19))]),s=e.default,o=t.default;a.je?.("sentryWorld",o);const i={};for(const e in o)i[s[e]]=e;w({countryToCodeMap:s,map:o,codeToCountryMap:i})}catch{}}(),()=>{e=!0}}),[]),null===Z.countryToCodeMap||null===Z.map)return null;const C=t.map((e=>{let{seriesName:t,data:r,...s}=e;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{map:""};return{roam:!0,...e,emphasis:{label:{show:!1},...e.emphasis},type:"map"}}({...i,...s,map:"sentryWorld",name:t,nameMap:Z.countryToCodeMap??void 0,aspectScale:.85,zoom:v?u:x?m:p,center:[h,x?y:g],itemStyle:{areaColor:f.gray200,borderColor:f.backgroundSecondary},emphasis:{itemStyle:{areaColor:f.pink300},label:{show:!1}},data:r,silent:x,roam:!x})})),j=n()(t.map((e=>{let{data:t}=e;return n()(t.map((e=>{let{value:t}=e;return t})))})))||1;return(0,c.tZ)(l.Z,{options:{backgroundColor:x?void 0:f.background,visualMap:[(0,d.Z)({show:!x,left:v?void 0:"right",right:v?5:void 0,min:0,max:j,inRange:{color:[f.purple200,f.purple300]},text:["High","Low"],textStyle:{color:f.textColor},calculable:!1})]},...b,yAxis:null,xAxis:null,series:C,tooltip:{formatter:e=>{const{marker:t,name:r,value:s}=Array.isArray(e)?e[0]:e;if(isNaN(s))return"";const o="number"==typeof s?s.toLocaleString():"";return[`<div class="tooltip-series tooltip-series-solo">\n               <div><span class="tooltip-label">${t} <strong>${Z.codeToCountryMap?.[r]||r}</strong></span> ${o}</div>\n            </div>`,'<div class="tooltip-arrow"></div>'].join("")}},height:v?400:void 0})}v.displayName="WorldMapChart"},"./app/components/loading/loadingContainer.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=r("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),a=r("./app/components/loadingIndicator.tsx"),i=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function n(e){let{isLoading:t=!1,isReloading:r=!1,maskBackgroundColor:s,className:a,children:n}=e;const p=(0,o.u)(),u=t||r;return(0,i.BX)(d,{className:a,children:[u&&(0,i.BX)("div",{children:[(0,i.tZ)(l,{isReloading:r,maskBackgroundColor:s??p.white}),(0,i.tZ)(c,{})]}),n]})}n.displayName="LoadingContainer";const d=(0,s.Z)("div",{target:"eh2paf42"})({name:"bjn8wh",styles:"position:relative"}),l=(0,s.Z)("div",{target:"eh2paf41"})("position:absolute;z-index:1;background-color:",(e=>e.maskBackgroundColor),";width:100%;height:100%;opacity:",(e=>e.isReloading?"0.6":"1"),";"),c=(0,s.Z)(a.Z,{target:"eh2paf40"})({name:"1aa909c",styles:"position:absolute;z-index:3;width:100%"})},"./app/components/switchButton.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=r("../node_modules/react/index.js"),a=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{forwardedRef:t,size:r="sm",isActive:s,forceActiveColor:o,isLoading:i,isDisabled:n,toggle:d,id:l,name:c,className:m,...h}=e;return(0,a.tZ)(p,{ref:t,id:l,name:c,type:"button",className:m,onClick:n?void 0:d,role:"checkbox","aria-checked":s,isLoading:i,disabled:n,isActive:s,size:r,"data-test-id":"switch",...h,children:(0,a.tZ)(u,{isDisabled:n,isActive:s,forceActiveColor:o,size:r})})}i.displayName="Switch";const n=e=>"sm"===e.size?16:24,d=e=>n(e)-("sm"===e.size?4:8),l=e=>"sm"===e.size?1:3,c=e=>e.isActive?l(e)+.875*n(e):l(e),p=(0,s.Z)("button",{target:"e1slsb9u1"})("display:inline-block;background:none;padding:0;border:1px solid ",(e=>e.theme.border),";position:relative;box-shadow:inset ",(e=>e.theme.dropShadowMedium),";height:",n,"px;width:",(e=>1.875*n(e)),"px;border-radius:",n,"px;transition:border 0.1s,box-shadow 0.1s;&[disabled]{cursor:not-allowed;}&:focus,&.focus-visible{outline:none;border-color:",(e=>e.theme.focusBorder),";box-shadow:",(e=>e.theme.focusBorder)," 0 0 0 1px;}"),u=(0,s.Z)("span",{target:"e1slsb9u0"})("display:block;position:absolute;border-radius:50%;transition:0.25s all ease;top:",l,"px;transform:translateX(",c,"px);width:",d,"px;height:",d,"px;background:",(e=>e.isActive||e.forceActiveColor?e.theme.active:e.theme.border),";opacity:",(e=>e.isDisabled?.4:null),";"),m=(0,o.forwardRef)(((e,t)=>(0,a.tZ)(i,{...e,forwardedRef:t})))},"./app/views/discover/landing.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{DiscoverLanding:()=>_e,default:()=>Me});var s=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(r("../node_modules/core-js/modules/es.array.push.js"),r("../node_modules/react-router/es/index.js")),i=r("../node_modules/lodash/isEqual.js"),n=r.n(i),d=r("../node_modules/lodash/pick.js"),l=r.n(d),c=r("./app/components/acl/feature.tsx"),p=r("./app/components/alert.tsx"),u=r("./app/components/breadcrumbs.tsx"),m=r("./app/components/button.tsx"),h=r("./app/components/compactSelect/index.tsx"),y=r("./app/components/deprecatedAsyncComponent.tsx"),g=r("./app/components/layouts/thirds.tsx"),v=r("./app/components/searchBar.tsx"),x=r("./app/components/sentryDocumentTitle.tsx"),b=r("./app/components/switchButton.tsx"),f=r("./app/locale.tsx"),Z=r("./app/styles/space.tsx"),w=r("./app/utils/analytics.tsx"),C=r("./app/utils/discover/eventView.tsx"),j=r("./app/utils/discover/urls.tsx"),A=r("./app/utils/queryString.tsx"),D=r("./app/utils/withOrganization.tsx"),q=r("../node_modules/react/index.js"),z=r("../node_modules/moment/moment.js"),_=r.n(z),k=r("./app/actionCreators/pageFilters.tsx"),S=r("./app/components/dropdownMenu/index.tsx"),Q=r("./app/components/emptyStateWarning.tsx"),M=r("./app/components/pagination.tsx"),P=r("./app/components/timeSince.tsx"),B=r("./app/icons/index.tsx"),L=r("./app/utils/parseLinkHeader.tsx"),N=r("./app/utils/withApi.tsx"),T=r("./app/views/discover/savedQuery/utils.tsx"),R=(r("../node_modules/core-js/modules/es.error.cause.js"),r("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js")),Y=r("./app/components/charts/areaChart.tsx"),E=r("./app/components/charts/barChart.tsx"),X=r("./app/components/charts/eventsGeoRequest.tsx"),$=r("./app/components/charts/eventsRequest.tsx"),G=r("./app/components/charts/lineChart.tsx"),F=r("./app/components/charts/utils.tsx"),O=r("./app/components/charts/worldMapChart.tsx"),U=r("./app/components/loading/loadingContainer.tsx"),V=r("./app/components/loadingIndicator.tsx"),W=r("./app/utils/dates.tsx"),I=r("./app/utils/discover/charts.tsx"),H=r("./app/utils/discover/fields.tsx"),J=r("./app/utils/discover/types.tsx"),K=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class ee extends q.Component{shouldComponentUpdate(e){return!n()(this.getRefreshProps(this.props),this.getRefreshProps(e))}getRefreshProps(e){const{organization:t,location:r,eventView:s,yAxis:o}=e,a=s.getEventsAPIPayload(r),i=a.query,n=a.start?(0,W.hC)(a.start):null,d=a.end?(0,W.hC)(a.end):null,l=a.statsPeriod,c=s.getDisplayMode(),p=c===J.DC.TOP5||c===J.DC.DAILYTOP5,u=c===J.DC.DAILYTOP5||c===J.DC.DAILY,m=p?a.field:void 0,h=p?J.hY:void 0,y=p?(0,A.ro)(a.sort):void 0,g="bar"===c?"low":"high";return{organization:t,apiPayload:a,query:i,start:n,end:d,period:l,interval:u?"1d":s.interval?s.interval:(0,F.ZS)({start:n,end:d,period:l},g),project:s.project,environment:s.environment,yAxis:o??s.getYAxis(),field:m,topEvents:h,orderby:y,showDaily:u,expired:s.expired,name:s.name,display:c}}getChartType(e){let{showDaily:t}=e;return t?"bar":"area"}getChartComponent(e){switch(e){case"bar":return E.v;case"line":return G.w;case"area":return Y.T;default:throw new Error(`Unknown multi plot type for ${e}`)}}render(){const{theme:e,api:t,referrer:r}=this.props,{query:s,start:o,end:a,period:i,interval:n,organization:d,project:l,environment:c,yAxis:p,field:u,topEvents:m,orderby:h,showDaily:y,expired:g,name:v,display:x}=this.getRefreshProps(this.props);return x===J.DC.WORLDMAP?(0,K.tZ)(X.Z,{api:t,organization:d,yAxis:p,query:s,orderby:h,projects:l,period:i,start:o,end:a,environments:c,referrer:r,children:e=>{let{errored:t,loading:r,tableData:s}=e;if(t)return(0,K.tZ)(te,{children:(0,K.tZ)(B.FC,{color:"gray300",size:"md"})});if(r)return(0,K.tZ)(te,{children:(0,K.tZ)(V.Z,{mini:!0})});const{data:o,title:a}=(0,F.JT)(s),i={height:100,series:[{seriesName:a,data:o}],fromDiscoverQueryList:!0};return(0,K.tZ)(O.y,{...i})}}):(0,K.tZ)($.Z,{organization:d,api:t,query:s,start:o,end:a,period:i,interval:n,project:l,environment:c,includePrevious:!1,yAxis:p,field:u,topEvents:m,orderby:h,expired:g,name:v,referrer:r,hideError:!0,partial:!0,children:t=>{let{loading:r,timeseriesData:s,results:o,errored:a,errorMessage:i}=t;if(a)return(0,K.BX)(te,{children:[(0,K.tZ)(B.FC,{color:"gray300",size:"md"}),(0,K.tZ)(re,{children:i})]});if(r)return(0,K.tZ)(te,{children:(0,K.tZ)(V.Z,{mini:!0})});const n=s??o??[],d="bar"===x?x:this.getChartType({showDaily:y,yAxis:Array.isArray(p)?p[0]:p,timeseriesData:n}),l=n.map((e=>({...e,lineStyle:{opacity:"line"===d?1:0}}))),c=m&&m+1===n.length,u=n.length?[...e.charts.getColorPalette(n.length-2-(c?1:0))]:void 0;u&&u.length&&c&&u.push(e.chartOther);const h={colors:u,height:150,series:[...l],xAxis:{show:!1,axisPointer:{show:!1}},yAxis:{show:!0,axisLine:{show:!1},axisLabel:{color:e.chartLabel,fontFamily:e.text.family,fontSize:12,formatter:e=>(0,I.gu)(e,(0,H.Px)(Array.isArray(p)?p[0]:p),!0),inside:!0,showMinLabel:!1,showMaxLabel:!1},splitNumber:3,splitLine:{show:!1},zlevel:e.zIndex.header},tooltip:{show:!1},toolBox:{show:!1},grid:{left:0,top:0,right:0,bottom:0,containLabel:!1},stacked:"number"==typeof m&&m>0||Array.isArray(p)&&p.length>1},g=this.getChartComponent(d);return(0,K.tZ)(g,{...h})}})}}ee.displayName="MiniGraph";const te=(0,o.Z)((e=>(0,K.tZ)(U.Z,{...e,maskBackgroundColor:"transparent"})),{target:"e1m7wqi11"})({name:"khkb4p",styles:"height:150px;display:flex;justify-content:center;align-items:center"}),re=(0,o.Z)("div",{target:"e1m7wqi10"})("color:",(e=>e.theme.gray300),";margin-left:4px;"),se=(0,N.Z)((0,R.b)(ee));var oe=r("./app/components/activity/item/avatar.tsx"),ae=r("./app/components/card.tsx"),ie=r("./app/components/errorBoundary.tsx"),ne=r("./app/components/links/link.tsx");class de extends q.PureComponent{constructor(){super(...arguments),(0,s.Z)(this,"handleClick",(()=>{const{onEventClick:e}=this.props;e?.()}))}render(){const{title:e,subtitle:t,queryDetail:r,renderContextMenu:s,renderGraph:o,createdBy:a,dateStatus:i}=this.props;return(0,K.tZ)(ne.Z,{"data-test-id":`card-${e}`,onClick:this.handleClick,to:this.props.to,children:(0,K.BX)(pe,{interactive:!0,children:[(0,K.BX)(ue,{children:[(0,K.BX)(ce,{children:[(0,K.tZ)(me,{children:e}),(0,K.tZ)(he,{children:r})]}),(0,K.tZ)(le,{children:a?(0,K.tZ)(oe.q,{type:"user",user:a,size:34}):(0,K.tZ)(oe.q,{type:"system",size:34})})]}),(0,K.tZ)(ye,{children:(0,K.tZ)(be,{mini:!0,children:o()})}),(0,K.BX)(ge,{children:[(0,K.BX)(ve,{children:[t,i?(0,K.BX)(xe,{children:[(0,f.t)("Edited")," ",i]}):null]}),s&&s()]})]})})}}de.displayName="QueryCard";const le=(0,o.Z)("span",{target:"em58jqy10"})("border:3px solid ",(e=>e.theme.border),";border-radius:50%;height:min-content;"),ce=(0,o.Z)("div",{target:"em58jqy9"})("flex-grow:1;overflow:hidden;margin-right:",(0,Z.D)(1),";"),pe=(0,o.Z)(ae.Z,{target:"em58jqy8"})({name:"1h9y2eg",styles:"justify-content:space-between;height:100%;&:focus,&:hover{top:-1px;}"}),ue=(0,o.Z)("div",{target:"em58jqy7"})("display:flex;padding:",(0,Z.D)(1.5)," ",(0,Z.D)(2),";"),me=(0,o.Z)("div",{target:"em58jqy6"})((e=>e.theme.text.cardTitle),";color:",(e=>e.theme.headingColor),";",(e=>e.theme.overflowEllipsis),";font-weight:initial;"),he=(0,o.Z)("div",{target:"em58jqy5"})("font-family:",(e=>e.theme.text.familyMono),";font-size:",(e=>e.theme.fontSizeSmall),";color:",(e=>e.theme.gray300),";line-height:1.5;",(e=>e.theme.overflowEllipsis),";"),ye=(0,o.Z)("div",{target:"em58jqy4"})("background:",(e=>e.theme.backgroundSecondary),";max-height:150px;height:100%;overflow:hidden;"),ge=(0,o.Z)("div",{target:"em58jqy3"})("display:flex;justify-content:space-between;align-items:center;padding:",(0,Z.D)(1)," ",(0,Z.D)(2),";"),ve=(0,o.Z)("div",{target:"em58jqy2"})("font-size:",(e=>e.theme.fontSizeSmall),";display:grid;grid-column-gap:",(0,Z.D)(1),";",(e=>e.theme.overflowEllipsis),";color:",(e=>e.theme.textColor),";"),xe=(0,o.Z)("span",{target:"em58jqy1"})("color:",(e=>e.theme.subText),";padding-left:",(0,Z.D)(1),";"),be=(0,o.Z)(ie.Z,{target:"em58jqy0"})({name:"qu9742",styles:"margin-bottom:100px"}),fe=de;var Ze=r("./app/views/discover/utils.tsx");class we extends q.Component{constructor(){super(...arguments),(0,s.Z)(this,"handleDeleteQuery",(e=>{const{api:t,organization:r,onQueryChange:s,location:o,savedQueries:i}=this.props;(0,T.Uc)(t,r,e).then((()=>{1===i.length&&o.query.cursor?a.browserHistory.push({pathname:o.pathname,query:{...o.query,cursor:void 0}}):s()}))})),(0,s.Z)(this,"handleDuplicateQuery",((e,t)=>{const{api:r,location:s,organization:o,onQueryChange:i}=this.props;(e=e.clone()).name=`${e.name} copy`,(0,T.b2)(r,o,e,t).then((()=>{i(),a.browserHistory.push({pathname:s.pathname,query:{}})}))}))}componentDidMount(){(0,k.Z5)()}renderQueries(){const{pageLinks:e,renderPrebuilt:t}=this.props,r=(0,L.Z)(e||"");let s=[];return!t||r.previous&&!1!==r.previous.results||(s=s.concat(this.renderPrebuiltQueries())),s=s.concat(this.renderSavedQueries()),0===s.filter((e=>e)).length?(0,K.tZ)(De,{children:(0,K.tZ)("p",{children:(0,f.t)("No saved queries match that filter")})}):s}renderDropdownMenu(e){return(0,K.tZ)(S.h,{items:e,trigger:e=>(0,K.tZ)(Ae,{...e,"aria-label":(0,f.t)("Query actions"),size:"xs",borderless:!0,onClick:t=>{t.stopPropagation(),t.preventDefault(),e.onClick?.(t)},icon:(0,K.tZ)(B.YR,{direction:"down",size:"sm"}),"data-test-id":"menu-trigger"}),position:"bottom-end",offset:4})}renderPrebuiltQueries(){const{api:e,location:t,organization:r,savedQuerySearchQuery:s,router:o}=this.props,a=(0,Ze.Ur)(r),i="string"==typeof s&&s.length>0,n=i?s.toLowerCase():"";return a.map(((s,a)=>{const d=C.ZP.fromNewQueryWithLocation(s,t);if(i&&d.name&&!d.name.toLowerCase().includes(n))return null;const l=(0,f.t)("Last ")+d.statsPeriod,p=_()(d.start).format("MMM D, YYYY h:mm A")+" - "+_()(d.end).format("MMM D, YYYY h:mm A"),u=d.getResultsViewUrlTarget(r.slug),m=[{key:"add-to-dashboard",label:(0,f.t)("Add to Dashboard"),onAction:()=>(0,Ze.F_)({eventView:d,location:t,query:s,organization:r,yAxis:s?.yAxis,router:o})},{key:"set-as-default",label:(0,f.t)("Set as Default"),onAction:()=>{(0,T.RF)(e,r,d.toNewQuery()),(0,w.Gi)("discover_v2.set_as_default",{organization:r,source:"context-menu",type:"prebuilt-query"})}}];return(0,K.tZ)(fe,{to:u,title:d.name,subtitle:d.statsPeriod?l:p,queryDetail:d.query,createdBy:d.createdBy,renderGraph:()=>(0,K.tZ)(se,{location:t,eventView:d,organization:r,referrer:"api.discover.homepage.prebuilt"}),onEventClick:()=>{(0,w.Gi)("discover_v2.prebuilt_query_click",{organization:r,query_name:d.name})},renderContextMenu:()=>(0,K.tZ)(c.Z,{organization:r,features:["dashboards-edit"],children:e=>{let{hasFeature:t}=e;return t&&this.renderDropdownMenu(m)}})},`${a}-${d.name}`)}))}renderSavedQueries(){const{api:e,savedQueries:t,location:r,organization:s,router:o}=this.props;return t&&Array.isArray(t)&&0!==t.length?t.map(((t,a)=>{const i=C.ZP.fromSavedQuery(t),n=(0,f.t)("Last ")+i.statsPeriod,d=_()(i.start).format("MMM D, YYYY h:mm A")+" - "+_()(i.end).format("MMM D, YYYY h:mm A"),l=i.getResultsViewShortUrlTarget(s.slug),p=(0,K.tZ)(P.Z,{date:t.dateUpdated}),u=`api.discover.${i.getDisplayMode()}-chart`,m=a=>[...a?[{key:"add-to-dashboard",label:(0,f.t)("Add to Dashboard"),onAction:()=>(0,Ze.F_)({eventView:i,location:r,query:t,organization:s,yAxis:t?.yAxis??i.yAxis,router:o})}]:[],{key:"set-as-default",label:(0,f.t)("Set as Default"),onAction:()=>{(0,T.RF)(e,s,i.toNewQuery()),(0,w.Gi)("discover_v2.set_as_default",{organization:s,source:"context-menu",type:"saved-query"})}},{key:"duplicate",label:(0,f.t)("Duplicate Query"),onAction:()=>this.handleDuplicateQuery(i,(0,A.qP)(t.yAxis))},{key:"delete",label:(0,f.t)("Delete Query"),priority:"danger",onAction:()=>this.handleDeleteQuery(i)}];return(0,K.tZ)(fe,{to:l,title:i.name,subtitle:i.statsPeriod?n:d,queryDetail:i.query,createdBy:i.createdBy,dateStatus:p,onEventClick:()=>{(0,w.Gi)("discover_v2.saved_query_click",{organization:s})},renderGraph:()=>(0,K.tZ)(se,{location:r,eventView:i,organization:s,referrer:u,yAxis:t.yAxis&&t.yAxis.length?t.yAxis:["count()"]}),renderContextMenu:()=>(0,K.tZ)(c.Z,{organization:s,features:["dashboards-edit"],children:e=>{let{hasFeature:t}=e;return this.renderDropdownMenu(m(t))}})},`${a}-${i.id}`)})):[]}render(){const{pageLinks:e}=this.props;return(0,K.BX)(q.Fragment,{children:[(0,K.tZ)(je,{children:this.renderQueries()}),(0,K.tZ)(Ce,{pageLinks:e,onCursor:(e,t,r,s)=>{const o=Number(e?.split(":")?.[1]??0),i={...r,cursor:e};o<=0&&-1===s&&delete i.cursor,a.browserHistory.push({pathname:t,query:i})}})]})}}we.displayName="QueryList";const Ce=(0,o.Z)(M.Z,{target:"e1gxha1n3"})({name:"1azpx8r",styles:"margin-bottom:20px"}),je=(0,o.Z)("div",{target:"e1gxha1n2"})("display:grid;grid-template-columns:minmax(100px, 1fr);gap:",(0,Z.D)(2),";@media (min-width: ",(e=>e.theme.breakpoints.medium),"){grid-template-columns:repeat(2, minmax(100px, 1fr));}@media (min-width: ",(e=>e.theme.breakpoints.large),"){grid-template-columns:repeat(3, minmax(100px, 1fr));}"),Ae=(0,o.Z)(m.zx,{target:"e1gxha1n1"})("transform:translateX(",(0,Z.D)(1),");"),De=(0,o.Z)(Q.Z,{target:"e1gxha1n0"})({name:"1wygoze",styles:"grid-column:1/4"}),qe=(0,N.Z)(we),ze=[{label:(0,f.t)("My Queries"),value:"myqueries"},{label:(0,f.t)("Recently Edited"),value:"-dateUpdated"},{label:(0,f.t)("Query Name (A-Z)"),value:"name"},{label:(0,f.t)("Date Created (Newest)"),value:"-dateCreated"},{label:(0,f.t)("Date Created (Oldest)"),value:"dateCreated"},{label:(0,f.t)("Most Outdated"),value:"dateUpdated"},{label:(0,f.t)("Most Popular"),value:"mostPopular"},{label:(0,f.t)("Recently Viewed"),value:"recentlyViewed"}];class _e extends y.Z{constructor(){super(...arguments),(0,s.Z)(this,"state",{loading:!0,reloading:!1,error:!1,errors:{},renderPrebuilt:(0,Ze.tG)(),savedQueries:null,savedQueriesPageLinks:""}),(0,s.Z)(this,"shouldReload",!0),(0,s.Z)(this,"handleQueryChange",(()=>{this.fetchData({reloading:!0})})),(0,s.Z)(this,"handleSearchQuery",(e=>{const{location:t}=this.props;a.browserHistory.push({pathname:t.pathname,query:{...t.query,cursor:void 0,query:String(e).trim()||void 0}})})),(0,s.Z)(this,"handleSortChange",(e=>{const{location:t,organization:r}=this.props;(0,w.Gi)("discover_v2.change_sort",{organization:r,sort:e}),a.browserHistory.push({pathname:t.pathname,query:{...t.query,cursor:void 0,sort:e}})})),(0,s.Z)(this,"togglePrebuilt",(()=>{const{renderPrebuilt:e}=this.state;this.setState({renderPrebuilt:!e},(()=>{(0,Ze.u)(!e),this.fetchData({reloading:!0})}))}))}getSavedQuerySearchQuery(){const{location:e}=this.props;return(0,A.ro)(e.query.query,"").trim()}getActiveSort(){const{location:e}=this.props,t=(0,A.ro)(e.query.sort,"myqueries");return ze.find((e=>e.value===t))||ze[0]}getEndpoints(){const{organization:e,location:t}=this.props,r=(0,Ze.Ur)(e),s=this.getSavedQuerySearchQuery(),o=(0,A.ro)(t.query.cursor);let a=9;const i=this.state?this.state.renderPrebuilt:(0,Ze.tG)();if(!o&&i)if(s&&s.length>0){const e=s.toLowerCase(),o=r.reduce(((r,s)=>{const o=C.ZP.fromNewQueryWithLocation(s,t);return o.name&&o.name.toLowerCase().includes(e)?r+1:r}),0);a=Math.max(1,a-o)}else a=Math.max(1,a-r.length);const n={cursor:o,query:`version:2 name:"${s}"`,per_page:a.toString(),sortBy:this.getActiveSort().value};return o||delete n.cursor,[["savedQueries",`/organizations/${e.slug}/discover/saved/`,{query:n}]]}componentDidUpdate(e){const t=["sort","cursor","query"];!n()(l()(e.location.query,t),l()(this.props.location.query,t))&&this.fetchData()}renderActions(){const e=this.getActiveSort(),{renderPrebuilt:t,savedQueries:r}=this.state;return(0,K.BX)(Qe,{children:[(0,K.tZ)(Se,{defaultQuery:"",query:this.getSavedQuerySearchQuery(),placeholder:(0,f.t)("Search saved queries"),onSearch:this.handleSearchQuery}),(0,K.BX)(ke,{children:["Show Prebuilt",(0,K.tZ)(b.Z,{isActive:t,isDisabled:t&&0===(r??[]).length,size:"lg",toggle:this.togglePrebuilt})]}),(0,K.tZ)(h.Z,{triggerProps:{prefix:(0,f.t)("Sort By")},value:e.value,options:ze,onChange:e=>this.handleSortChange(e.value),position:"bottom-end"})]})}renderNoAccess(){return(0,K.tZ)(g.T3,{withPadding:!0,children:(0,K.tZ)(p.bZ,{type:"warning",children:(0,f.t)("You don't have access to this feature")})})}renderBody(){const{location:e,organization:t,router:r}=this.props,{savedQueries:s,savedQueriesPageLinks:o,renderPrebuilt:a}=this.state;return(0,K.tZ)(qe,{pageLinks:o,savedQueries:s??[],savedQuerySearchQuery:this.getSavedQuerySearchQuery(),renderPrebuilt:a,location:e,organization:t,onQueryChange:this.handleQueryChange,router:r})}renderBreadcrumbs(){return(0,K.tZ)(u.Z,{crumbs:[{key:"discover-homepage",label:(0,f.t)("Discover"),to:(0,j.zR)(this.props.organization)},{key:"discover-saved-queries",label:(0,f.t)("Saved Queries")}]})}render(){const{organization:e}=this.props,t=`/organizations/${e.slug}/discover/homepage/`;return(0,K.tZ)(c.Z,{organization:e,features:["discover-query"],renderDisabled:this.renderNoAccess,children:(0,K.tZ)(x.Z,{title:(0,f.t)("Discover"),orgSlug:e.slug,children:(0,K.BX)(g.T3,{children:[(0,K.BX)(g.h4,{children:[(0,K.tZ)(g.oB,{children:this.renderBreadcrumbs()}),(0,K.tZ)(g.kP,{children:(0,K.tZ)(m.zx,{"data-test-id":"build-new-query",to:t,size:"sm",priority:"primary",onClick:()=>{(0,w.Gi)("discover_v2.build_new_query",{organization:e})},children:(0,f.t)("Build a new query")})})]}),(0,K.tZ)(g.uT,{children:(0,K.BX)(g.or,{fullWidth:!0,children:[this.renderActions(),this.renderComponent()]})})]})})})}}_e.displayName="DiscoverLanding";const ke=(0,o.Z)("label",{target:"e7ih3za2"})("display:flex;align-items:center;gap:",(0,Z.D)(1.5),";font-weight:normal;margin:0;"),Se=(0,o.Z)(v.Z,{target:"e7ih3za1"})({name:"1ff36h2",styles:"flex-grow:1"}),Qe=(0,o.Z)("div",{target:"e7ih3za0"})("display:grid;gap:",(0,Z.D)(2),";grid-template-columns:auto max-content min-content;align-items:center;margin-bottom:",(0,Z.D)(2),";@media (max-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:auto;}"),Me=(0,D.Z)(_e)},"../node_modules/lodash/negate.js":e=>{e.exports=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}},"../node_modules/lodash/omitBy.js":(e,t,r)=>{var s=r("../node_modules/lodash/_baseIteratee.js"),o=r("../node_modules/lodash/negate.js"),a=r("../node_modules/lodash/pickBy.js");e.exports=function(e,t){return a(e,o(s(t)))}}}]);
//# sourceMappingURL=../sourcemaps/app_views_discover_landing_tsx-node_modules_lodash_omitBy_js.b96394a7291c4ffda38911b7867ae68f.js.map