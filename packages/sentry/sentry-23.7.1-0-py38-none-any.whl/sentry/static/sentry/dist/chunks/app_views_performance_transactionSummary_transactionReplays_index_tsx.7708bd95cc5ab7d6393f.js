"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_transactionSummary_transactionReplays_index_tsx"],{"./app/views/performance/transactionSummary/transactionReplays/index.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var s=n("./app/components/acl/feature.tsx"),a=n("./app/components/alert.tsx"),r=n("./app/components/layouts/thirds.tsx"),i=n("./app/locale.tsx"),o=n("./app/utils/useOrganization.tsx"),p=n("../node_modules/react/index.js"),l=n("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),c=n("./app/components/loadingIndicator.tsx"),u=n("./app/utils/discover/eventView.tsx"),d=n("./app/utils/discover/fields.tsx"),y=n("./app/utils/replays/hooks/useReplayList.tsx"),m=n("./app/utils/useLocation.tsx"),v=n("./app/utils/useMedia.tsx"),f=n("./app/utils/useProjects.tsx"),g=n("./app/views/performance/transactionSummary/pageLayout.tsx"),h=n("./app/views/performance/transactionSummary/tabs.tsx"),x=n("./app/views/replays/replayTable/index.tsx"),w=n("./app/views/replays/replayTable/types.tsx"),Z=n("../node_modules/@sentry/browser/node_modules/@sentry/core/esm/exports.js"),R=n("./app/utils/discover/genericDiscoverQuery.tsx"),S=n("./app/utils/queryString.tsx"),b=n("./app/utils/replays/fetchReplayList.tsx"),E=n("./app/utils/useApi.tsx"),I=n("./app/views/replays/types.tsx");const T=function(e){let{location:t,organization:n,replayIdsEventView:s}=e;const a=(0,E.Z)(),[r,i]=(0,p.useState)({events:[],pageLinks:null,replayIds:void 0}),[o,l]=(0,p.useState)(),{cursor:c}=t.query,d=(0,p.useCallback)((async()=>{try{const[{data:e},t,r]=await(0,R.AA)(a,`/organizations/${n.slug}/events/`,s.getEventsAPIPayload({query:{cursor:c}}));i({pageLinks:r?.getResponseHeader("Link")??"",replayIds:e.map((e=>String(e.replayId))),events:e||[]})}catch(e){Z.Tb(e),l(e)}}),[a,c,n.slug,s]),y=(0,p.useMemo)((()=>r.replayIds?u.ZP.fromSavedQuery({id:"",name:"",version:2,fields:(0,I.t)(n),projects:[],query:`id:[${String(r.replayIds)}]`,orderby:(0,S.ro)(t.query.sort,b.y)}):null),[t.query.sort,r.replayIds,n]);return(0,p.useEffect)((()=>{d()}),[d]),{data:y?{events:r.events,replayRecordsEventView:y}:null,fetchError:o,isFetching:!o&&!r.replayIds,pageLinks:r.pageLinks}},j=function(e){let{events:t,replays:n}=e;const s=n?.map((e=>{const n=t.reduce(((t,n)=>n.replayId!==e.id?t:t["transaction.duration"]?n["transaction.duration"]>t["transaction.duration"]?n:t:n),{});return{...e,txEvent:n??{}}}));return s};var k=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function L(){const e=(0,m.T)(),t=(0,o.Z)(),{projects:n}=(0,f.Z)();return(0,k.tZ)(g.ZP,{location:{...e,query:{...e.query,statsPeriod:"14d"}},organization:t,projects:n,tab:h.Z.REPLAYS,getDocumentTitle:_,generateEventView:N,childComponent:q})}function _(e){return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,i.t)("Replays")].join(" — "):[(0,i.t)("Summary"),(0,i.t)("Replays")].join(" — ")}function N(e){let{location:t,transactionName:n}=e;const s=["replayId","count()","transaction.duration","trace","timestamp",...d.$4,d.zD];return u.ZP.fromSavedQuery({id:"",name:"Replay events within a transaction",version:2,fields:s,query:`event.type:transaction transaction:"${n}" !replayId:""`,projects:[Number(t.query.project)]})}function q(e){let{eventView:t,location:n,organization:s,setError:a}=e;const{data:i,fetchError:o,isFetching:l,pageLinks:u}=T({replayIdsEventView:t,location:n,organization:s});if((0,p.useEffect)((()=>{a(o?.message??o)}),[a,o]),!i)return l?(0,k.tZ)(r.or,{fullWidth:!0,children:(0,k.tZ)(c.Z,{})}):(0,k.tZ)(p.Fragment,{children:null});const{events:d,replayRecordsEventView:y}=i;return(0,k.tZ)(z,{eventView:y,events:d,organization:s,pageLinks:u})}function z(e){let{eventView:t,events:n,organization:s}=e;const a=(0,p.useMemo)((()=>({query:{}})),[]),i=(0,l.u)(),o=(0,v.Z)(`(min-width: ${i.breakpoints.small})`),{replays:c,isFetching:u,fetchError:d}=(0,y.Z)({eventView:t,location:a,organization:s}),m=j({replays:c,events:n});return(0,k.tZ)(r.or,{fullWidth:!0,children:(0,k.tZ)(x.Z,{fetchError:d,isFetching:u,replays:m,sort:void 0,visibleColumns:[w.f.REPLAY,...o?[w.f.SLOWEST_TRANSACTION]:[],w.f.OS,w.f.BROWSER,w.f.DURATION,w.f.COUNT_ERRORS,w.f.ACTIVITY]})})}L.displayName="TransactionReplays",q.displayName="ReplaysContentWrapper",z.displayName="ReplaysContent";const A=L;function C(){return(0,k.tZ)(r.T3,{withPadding:!0,children:(0,k.tZ)(a.bZ,{type:"warning",children:(0,i.t)("You don't have access to this feature")})})}function V(){const e=(0,o.Z)();return(0,k.tZ)(s.Z,{features:["session-replay"],organization:e,renderDisabled:C,children:(0,k.tZ)(A,{})})}C.displayName="renderNoAccess",V.displayName="TransactionReplaysContainer";const P=V}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_transactionReplays_index_tsx.87c04b22e21c95556508a991510e554a.js.map