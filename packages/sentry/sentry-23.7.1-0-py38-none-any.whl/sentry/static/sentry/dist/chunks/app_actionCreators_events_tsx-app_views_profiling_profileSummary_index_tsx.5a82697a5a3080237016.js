"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_actionCreators_events_tsx-app_views_profiling_profileSummary_index_tsx"],{"./app/actionCreators/events.tsx":(e,t,s)=>{s.d(t,{A5:()=>x,JE:()=>y,MD:()=>f,eV:()=>g,lI:()=>m});var r=s("../node_modules/lodash/pick.js"),o=s.n(r),n=s("./app/actionCreators/indicator.tsx"),a=s("./app/components/charts/utils.tsx"),i=s("./app/locale.tsx"),l=s("./app/utils/getPeriod.tsx"),u=s("./app/utils/performance/constants.tsx"),c=s("./app/utils/queryClient.tsx"),p=s("./app/utils/useApi.tsx"),d=s("./app/utils/useOrganization.tsx");const m=(e,t)=>{let{organization:s,project:r,environment:o,team:n,period:i,start:u,end:c,interval:p,comparisonDelta:d,includePrevious:m,query:g,yAxis:y,field:h,topEvents:f,orderby:x,partial:j,withoutZerofill:v,referrer:b,queryBatching:S,generatePathname:Z,queryExtras:q,excludeOther:w,includeAllArgs:P,dataset:k,useOnDemandMetrics:_}=t;const I=Z?.(s)??`/organizations/${s.slug}/events-stats/`,E=(0,a.Sw)(m,i),T={includeAllArgs:P,query:{...Object.fromEntries(Object.entries({interval:p,comparisonDelta:d,project:r,environment:o,team:n,query:g,yAxis:y,field:h,topEvents:f,orderby:x,partial:j?"1":void 0,withoutZerofill:v?"1":void 0,referrer:b||"api.organization-event-stats",excludeOther:w?"1":void 0,dataset:k,useOnDemandMetrics:_}).filter((e=>{let[,t]=e;return void 0!==t}))),...(0,l.X)({period:i,start:u,end:c},{shouldDoublePeriod:E}),...q}};return S?.batchRequest?S.batchRequest(e,I,T):e.requestPromise(I,T)};function g(e,t,s){const r={...o()(s,[...Object.values(u.s),"cursor"]),query:s.query};return e.requestPromise(`/organizations/${t}/events-facets/`,{query:r,includeAllArgs:!0})}function y(e,t,s){const r={...o()(s,Object.values(u.s)),query:s.query};return e.requestPromise(`/organizations/${t}/events-meta/`,{query:r}).then((e=>e.count))}const h=e=>{let{orgSlug:t,projectSlug:s,eventId:r}=e;return[`/projects/${t}/${s}/events/${r}/attachments/`]},f=function(e){let{orgSlug:t,projectSlug:s,eventId:r}=e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,d.Z)();return(0,c.WE)([`/projects/${t}/${s}/events/${r}/attachments/`],{staleTime:1/0,...o,enabled:(n.features?.includes("event-attachments")??!1)&&!1!==o.enabled})},x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=(0,p.Z)({persistInFlight:!0}),s=(0,c.NL)(),r={...e,mutationFn:e=>{let{orgSlug:s,projectSlug:r,eventId:o,attachmentId:n}=e;return t.requestPromise(`/projects/${s}/${r}/events/${o}/attachments/${n}/`,{method:"DELETE"})},onMutate:async t=>{await s.cancelQueries(h(t));const r=(0,c.nE)(s,h(t));return(0,c.XN)(s,h(t),(e=>Array.isArray(e)?e.filter((e=>e?.id!==t.attachmentId)):e)),e.onMutate?.(t),{previous:r}},onError:(t,r,o)=>{(0,n.Iw)((0,i.t)("An error occurred while deleting the attachment")),o&&(0,c.XN)(s,h(r),o.previous),e.onError?.(t,r,o)}};return(0,c.Db)(r)}},"./app/components/events/searchBar.tsx":(e,t,s)=>{s.d(t,{Z:()=>T}),s("../node_modules/core-js/modules/es.error.cause.js");var r=s("../node_modules/react/index.js"),o=s("../node_modules/lodash/assign.js"),n=s.n(o),a=s("../node_modules/lodash/flatten.js"),i=s.n(a),l=s("../node_modules/lodash/memoize.js"),u=s.n(l),c=s("../node_modules/lodash/omit.js"),p=s.n(c),d=s("./app/actionCreators/tags.tsx"),m=s("./app/components/smartSearchBar/index.tsx"),g=s("./app/constants/index.tsx"),y=s("./app/types/index.tsx"),h=s("./app/utils.tsx"),f=s("./app/utils/discover/fields.tsx"),x=s("./app/utils/fields/index.ts"),j=s("./app/utils/measurements/measurements.tsx"),v=s("./app/utils/useApi.tsx"),b=s("./app/utils/withTags.tsx"),S=s("./app/views/dashboards/utils.tsx"),Z=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const q=new RegExp(`^${g.c$}|\\${g.ir}`,"g"),w=new Set(Object.keys(f.wZ)),P=Object.keys(f.wZ).reduce(((e,t)=>(e[t]={...f.wZ[t],kind:x.IV.FIELD},e)),{}),k=p()(P,f.J8),_=f.$4.reduce(((e,t)=>(e[t]={name:t,kind:x.IV.METRICS},e)),{}),I=Object.keys(f.jg).reduce(((e,t)=>(e[t]={...f.jg[t],kind:x.IV.FIELD},e)),{});function E(e){const{maxSearchItems:t,organization:s,tags:o,omitTags:a,fields:l,projectIds:c,includeSessionTagsValues:g,maxMenuHeight:b,customMeasurements:E}=e,T=(0,v.Z)(),M=(0,r.useMemo)((()=>(e=>e?.length?e.reduce(((e,t)=>(w.has(t.field)||(0,f.GO)(t.field)||(0,S.nk)(t.field)||(e[t.field]={key:t.field,name:t.field,kind:x.IV.FUNCTION}),e)),{}):[])(l)),[l]),F=(0,r.useMemo)((()=>Object.keys(o).reduce(((e,t)=>(e[t]={...o[t],kind:x.IV.TAG},e)),{})),[o]);(0,r.useEffect)((()=>{O.cache.clear?.()}),[c]);const O=u()(((e,t,r)=>{const o=c?.map(String);return(0,f.h1)(e.key)||(0,f.Xr)(e.key)?Promise.resolve([]):(0,x.bn)(e.key)?Promise.resolve(x.BF):(0,d.Fo)({api:T,orgSlug:s.slug,tagKey:e.key,search:t,projectIds:o,endpointParams:r,includeTransactions:!0,includeSessions:g}).then((e=>i()(e.filter((e=>{let{name:t}=e;return(0,h.ri)(t)})).map((e=>{let{name:t}=e;return t})))),(()=>{throw new Error("Unable to fetch event field values")}))}),((e,t)=>{let{key:s}=e;return`${s}-${t}`})),z=e=>{const t=((e,t)=>{const s=Object.keys(e).reduce(((t,s)=>(t[s]={...e[s],kind:x.IV.MEASUREMENT},t)),{});return t?Object.keys(t).reduce(((e,s)=>(e[s]={...t[s],kind:x.IV.MEASUREMENT},e)),s):s})(e,E),r=s.features.includes("performance-view")?Object.assign({},t,M,_,P):Object.assign({},k);return n()(r,F,P,I),r.has={key:x.Sh.HAS,name:"Has property",values:Object.keys(r).sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),predefined:!0,kind:x.IV.FIELD},a&&a.length>0?p()(r,a):r};return(0,Z.tZ)(j.Z,{children:s=>{let{measurements:r}=s;return(0,Z.tZ)(m.Z,{hasRecentSearches:!0,savedSearchType:y.L4.EVENT,onGetTagValues:O,supportedTags:z(r),prepareQuery:e=>e.replace(q,""),maxSearchItems:t,excludedTags:[x.Sh.ENVIRONMENT,x.Sh.TOTAL_COUNT],maxMenuHeight:b??300,customPerformanceMetrics:E,...e})}})}E.displayName="SearchBar";const T=(0,b.Z)(E)},"./app/components/profiling/profilingBreadcrumbs.tsx":(e,t,s)=>{s.d(t,{u:()=>c}),s("../node_modules/core-js/modules/es.error.cause.js");var r=s("../node_modules/react/index.js"),o=s("../node_modules/lodash/omit.js"),n=s.n(o),a=s("./app/components/breadcrumbs.tsx"),i=s("./app/locale.tsx"),l=s("./app/utils/profiling/routes.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c(e){let{organization:t,trails:s}=e;const o=(0,r.useMemo)((()=>s.map((e=>function(e,t){let{organization:s}=t;switch(e.type){case"landing":return{to:(0,l.XR)({query:n()(e.payload.query,["cursor","query"]),orgSlug:s.slug}),label:(0,i.t)("Profiling"),preservePageFilters:!0};case"profile summary":return{to:(0,l.R0)({query:n()(e.payload.query,["cursor","query"]),orgSlug:s.slug,projectSlug:e.payload.projectSlug,transaction:e.payload.transaction}),label:(0,i.t)("Profile Summary"),preservePageFilters:!0};case"flamechart":return{to:(0,l.TH)({query:e.payload.query,orgSlug:s.slug,projectSlug:e.payload.projectSlug,profileId:e.payload.profileId}),label:e.payload.transaction,preservePageFilters:!0};default:throw new Error(`Unknown breadcrumb type: ${JSON.stringify(e)}`)}}(e,{organization:t})))),[t,s]);return(0,u.tZ)(a.Z,{crumbs:o})}c.displayName="ProfilingBreadcrumbs"},"./app/utils/getPeriod.tsx":(e,t,s)=>{s.d(t,{X:()=>i}),s("../node_modules/core-js/modules/es.error.cause.js");var r=s("../node_modules/moment/moment.js"),o=s.n(r),n=s("./app/constants/index.tsx"),a=s("./app/utils/dates.tsx");function i(e){let{period:t,start:s,end:r}=e,{shouldDoublePeriod:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t||s||r||(t=n.GY),t){if(!i)return{statsPeriod:t};const[,e,s]=t.match(/([0-9]+)([mhdw])/);return{statsPeriod:`${2*parseInt(e,10)}${s}`}}if(!s||!r)throw new Error("start and end required");const l=(0,a.v5)(s),u=(0,a.v5)(r);if(i){const e=o()(r).diff(o()(s)),t=o()(s).subtract(e);return{start:(0,a.v5)(t),end:u}}return{start:l,end:u}}},"./app/utils/profiling/hooks/useCurrentProjectFromRouteParam.tsx":(e,t,s)=>{s.d(t,{y:()=>n});var r=s("./app/utils/useParams.tsx"),o=s("./app/utils/useProjects.tsx");function n(){const e=(0,r.U)(),t=(0,o.Z)({limit:1,slugs:[e?.projectId]});return t.projects?.[0]??null}},"./app/utils/withTags.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/react/index.js"),n=s("./app/stores/tagStore.tsx"),a=s("./app/utils/getDisplayName.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{tags:n.Z.getState()}),(0,r.Z)(this,"unsubscribe",n.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...s}=this.props;return(0,i.tZ)(e,{tags:t??this.state.tags,...s})}}return t.displayName="WithTags",(0,r.Z)(t,"displayName",`withTags(${(0,a.Z)(e)})`),t}},"./app/views/profiling/profileSummary/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>B});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),n=s("../node_modules/react-router/es/index.js"),a=s("./app/components/button.tsx"),i=s("./app/components/datePageFilter.tsx"),l=s("./app/components/environmentPageFilter.tsx"),u=s("./app/components/events/searchBar.tsx"),c=s("./app/components/idBadge/index.tsx"),p=s("./app/components/layouts/thirds.tsx"),d=s("./app/components/organizations/pageFilterBar.tsx"),m=s("./app/components/organizations/pageFilters/container.tsx"),g=s("./app/components/profiling/profilingBreadcrumbs.tsx"),y=s("./app/components/sentryDocumentTitle.tsx"),h=s("./app/components/smartSearchBar/index.tsx"),f=s("./app/constants/index.tsx"),x=s("./app/locale.tsx"),j=s("./app/styles/space.tsx"),v=s("./app/utils.tsx"),b=s("./app/utils/analytics.tsx"),S=s("./app/utils/discover/eventView.tsx"),Z=s("./app/utils/discover/fields.tsx"),q=s("./app/utils/profiling/hooks/useCurrentProjectFromRouteParam.tsx"),w=s("./app/utils/profiling/hooks/useProfileEvents.tsx"),P=s("./app/utils/profiling/hooks/useProfileFilters.tsx"),k=s("./app/utils/queryString.tsx"),_=s("./app/utils/tokenizeSearch.tsx"),I=s("./app/utils/useOrganization.tsx"),E=s("./app/utils/withPageFilters.tsx"),T=s("./app/views/discover/tags.tsx"),M=s("./app/views/performance/transactionSummary/utils.tsx"),F=s("./app/views/profiling/utils.tsx"),O=s("./app/views/profiling/profileSummary/content.tsx"),z=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function N(e){const t=(0,I.Z)(),s=(0,q.y)(),r=t.features.includes("profiling-using-transactions");(0,o.useEffect)((()=>{(0,b.Gi)("profiling_views.profile_summary",{organization:t,project_platform:s?.platform,project_id:s?.id})}),[t]);const j=(0,k.ro)(e.location.query.transaction),E=(0,o.useMemo)((()=>(0,k.ro)(e.location.query.query,"")),[e.location.query.query]),N=(0,o.useMemo)((()=>{const e=new _.MY(E);return(0,v.ri)(j)&&e.setFilterValues("transaction",[j]),Object.keys(e.filters).forEach((t=>{(0,Z.h1)(t)&&e.removeFilter(t)})),e.formatString()}),[E,j]),B=(0,w.G)({fields:["count()"],sort:{key:"count()",order:"desc"},referrer:"api.profiling.profile-summary-totals",query:N,enabled:r}),V=(0,o.useMemo)((()=>"success"!==B.status?null:B.data?.data?.[0]?.["count()"]||null),[B]),A=(0,o.useMemo)((()=>{const e=new _.MY("");return(0,v.ri)(j)&&e.setFilterValues("transaction_name",[j]),e.formatString()}),[j]),C=(0,P.J)({query:A,selection:e.selection,disabled:r}),D=s&&j&&(0,M.e1)({orgSlug:t.slug,transaction:j,projectID:s.id,query:{query:N}}),X=(0,o.useCallback)((t=>{n.browserHistory.push({...e.location,query:{...e.location.query,query:t||void 0,cursor:void 0}})}),[e.location]),R=(0,o.useMemo)((()=>[{type:"landing",payload:{query:e.location.query}},{type:"profile summary",payload:{projectSlug:s?.slug??"",query:e.location.query,transaction:j??""}}]),[e.location.query,s?.slug,j]),L=(0,o.useMemo)((()=>{const t=S.ZP.fromNewQueryWithLocation({id:void 0,version:2,name:j||"",fields:[],query:N,projects:s?[parseInt(s.id,10)]:[]},e.location);return t.additionalConditions.setFilterValues("has",["profile.id"]),t}),[e.location,s,N,j]);return(0,z.tZ)(y.Z,{title:(0,x.t)("Profiling â€” Profile Summary"),orgSlug:t.slug,children:(0,z.tZ)(m.Z,{shouldForceProject:(0,v.ri)(s),forceProject:s,specificProjectSlugs:(0,v.ri)(s)?[s.slug]:[],defaultSelection:r?{datetime:F.NN}:void 0,children:(0,z.tZ)(p.T3,{children:s&&j&&(0,z.BX)(o.Fragment,{children:[(0,z.BX)(p.h4,{children:[(0,z.BX)(p.oB,{children:[(0,z.tZ)(g.u,{organization:t,trails:R}),(0,z.BX)(p.Dx,{children:[s?(0,z.tZ)(c.Z,{project:s,avatarSize:28,hideName:!0,avatarProps:{hasTooltip:!0,tooltip:s.slug}}):null,j]})]}),D&&(0,z.tZ)(p.kP,{children:(0,z.tZ)(a.zx,{to:D,size:"sm",children:(0,x.t)("View Transaction Summary")})})]}),(0,z.BX)(p.uT,{children:[(0,z.BX)(p.or,{fullWidth:!r,children:[(0,z.BX)($,{children:[(0,z.BX)(d.Z,{condensed:!0,children:[(0,z.tZ)(l.Z,{}),(0,z.tZ)(i.Z,{alignDropdown:"left"})]}),r?(0,z.tZ)(u.Z,{searchSource:"profile_summary",organization:t,projectIds:L.project,query:E,onSearch:X,maxQueryLength:f.dI}):(0,z.tZ)(h.Z,{organization:t,hasRecentSearches:!0,searchSource:"profile_summary",supportedTags:C,query:E,onSearch:X,maxQueryLength:f.dI})]}),(0,z.tZ)(O.J,{location:e.location,project:s,selection:e.selection,transaction:j,query:N})]}),r&&(0,z.tZ)(p.MF,{children:(0,z.tZ)(T.Z,{generateUrl:function(t,s){return{...e.location,query:(0,v.ZT)(e.location.query,{key:(0,Z.ZC)(t),value:s})}},totalValues:V,eventView:L,organization:t,location:e.location})})]})]})})})})}N.displayName="ProfileSummaryPage";const $=(0,r.Z)("div",{target:"e1dzn5ix0"})("display:grid;gap:",(0,j.D)(2),";grid-template-columns:min-content auto;margin-bottom:",(0,j.D)(2),";"),B=(0,E.Z)(N)}}]);
//# sourceMappingURL=../sourcemaps/app_actionCreators_events_tsx-app_views_profiling_profileSummary_index_tsx.a49ba1ae1d454101b760747c2b0c91b5.js.map