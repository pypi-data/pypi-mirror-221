"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_organizationAuditLog_index_tsx"],{"./app/components/activity/item/avatar.tsx":(e,t,s)=>{s.d(t,{q:()=>l});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("./app/components/avatar/userAvatar.tsx"),r=s("./app/components/placeholder.tsx"),a=s("./app/icons/index.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){let{className:t,type:s,user:n,size:a=38}=e;return n?(0,o.tZ)(i.Z,{user:n,size:a,className:t}):"system"===s?(0,o.tZ)(d,{className:t,size:a,children:(0,o.tZ)(c,{size:"md"})}):(0,o.tZ)(r.Z,{className:t,width:`${a}px`,height:`${a}px`,shape:"circle"})}l.displayName="ActivityAvatar";const d=(0,n.Z)("span",{target:"ef4o3hd1"})("display:flex;justify-content:center;align-items:center;width:",(e=>e.size),"px;height:",(e=>e.size),"px;background-color:",(e=>e.theme.textColor),";color:",(e=>e.theme.background),";border-radius:50%;"),c=(0,n.Z)(a.iW,{target:"ef4o3hd0"})({name:"1p2ly5v",styles:"padding-bottom:3px"})},"./app/views/settings/organizationAuditLog/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>F}),s("../node_modules/core-js/modules/es.array.push.js");var n=s("../node_modules/react/index.js"),i=s("../node_modules/react-router/es/index.js"),r=s("../node_modules/@sentry/browser/node_modules/@sentry/core/esm/exports.js"),a=s("./app/actionCreators/indicator.tsx"),o=s("./app/utils/queryString.tsx"),l=s("./app/utils/useApi.tsx"),d=s("./app/utils/useOrganization.tsx"),c=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),p=s("./app/components/activity/item/avatar.tsx"),u=s("./app/components/avatar/userAvatar.tsx"),g=s("./app/components/dateTime.tsx"),m=s("./app/components/forms/controls/selectControl.tsx"),h=s("./app/components/links/link.tsx"),y=s("./app/components/pagination.tsx"),Z=s("./app/components/panels/panelTable.tsx"),v=s("./app/components/tag.tsx"),x=s("./app/components/tooltip.tsx"),b=s("./app/locale.tsx"),j=s("./app/styles/space.tsx"),f=s("./app/utils/dates.tsx"),L=s("./app/utils/useProjects.tsx"),w=s("./app/views/settings/components/settingsPageHeader.tsx"),S=s("./app/views/settings/projectPerformance/projectPerformance.tsx"),k=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const _={width:36,height:36,marginRight:8},z=e=>e?.isSuperuser?(0,k.BX)($,{"data-test-id":"actor-name",children:[e.name,(0,k.tZ)(P,{children:(0,b.t)("Sentry Staff")})]}):void 0!==e?(0,k.tZ)($,{"data-test-id":"actor-name",children:e.name}):null,T=e=>e?.map((e=>e.startsWith("rule.")?{label:e.replace("rule.","issue-alert."),value:e}:e.startsWith("alertrule.")?{label:e.replace("alertrule.","metric-alert."),value:e}:{label:e,value:e})).sort(((e,t)=>e.label.localeCompare(t.label)));function A(e){let{entry:t,orgSlug:s}=e;const{projects:n}=(0,L.Z)(),i=n.find((e=>e.id===String(t.data.id)));return t.event.startsWith("rule.")?(0,k.tZ)(X,{children:t.note.replace("rule","issue alert rule")}):i?"project.create"===t.event?(0,k.tZ)(X,{children:(0,b._N)("Created project [projectSettingsLink]",{projectSettingsLink:(0,k.tZ)(h.Z,{to:`/settings/${s}/projects/${i.slug}/`,children:t.data.slug})})}):"project.edit"===t.event?t.data.old_slug&&t.data.new_slug?(0,k.tZ)(X,{children:(0,b._N)("Renamed project slug from [old-slug] to [new-slug]",{"old-slug":t.data.old_slug,"new-slug":(0,k.tZ)(h.Z,{to:`/settings/${s}/projects/${t.data.new_slug}/`,children:t.data.new_slug})})}):(0,k.tZ)(X,{children:(0,b._N)("Edited project [projectSettingsLink] [note]",{projectSettingsLink:(0,k.tZ)(h.Z,{to:`/settings/${s}/projects/${i.slug}/`,children:t.data.slug}),note:t.note.replace("edited project settings ","")})}):"project.change-performance-issue-detection"===t.event?(0,k.tZ)(X,{children:(0,b._N)("Edited project [projectSettingsLink] [note]",{projectSettingsLink:(0,k.BX)(h.Z,{to:`/settings/${s}/projects/${i.slug}/performance/#${S.bG}`,children:[t.data.slug," performance issue detector settings"]}),note:t.note.replace("edited project performance issue detector settings ","")})}):"sampling_priority.enabled"===t.event?(0,k.tZ)(X,{children:(0,b._N)('Enabled retention priority "[biasLabel]" in project [samplingInProjectSettingsLink]',{samplingInProjectSettingsLink:(0,k.tZ)(h.Z,{to:`/settings/${s}/projects/${i.slug}/performance/`,children:t.data.slug}),biasLabel:S.Yw[t.data.name]})}):"sampling_priority.disabled"===t.event?(0,k.tZ)(X,{children:(0,b._N)('Disabled retention priority "[biasLabel]" in project [samplingInProjectSettingsLink]',{samplingInProjectSettingsLink:(0,k.tZ)(h.Z,{to:`/settings/${s}/projects/${i.slug}/performance/`,children:t.data.slug}),biasLabel:S.Yw[t.data.name]})}):(0,k.tZ)(X,{children:t.note}):(0,k.tZ)(X,{children:t.note})}function C(e){let{isLoading:t,pageLinks:s,entries:i,eventType:r,eventTypes:a,onCursor:o,onEventSelect:l}=e;const c=(0,f.gn)(),p=(0,d.Z)(),m=i&&i.length>0,h=(0,k.tZ)(q,{clearable:!0,isDisabled:t,name:"eventFilter",value:r,placeholder:(0,b.t)("Select Action: "),options:T(a),onChange:e=>{l(e?.value)}});return(0,k.BX)("div",{children:[(0,k.tZ)(w.Z,{title:(0,b.t)("Audit Log"),action:h}),(0,k.tZ)(Z.Z,{headers:[(0,b.t)("Member"),(0,b.t)("Action"),(0,b.t)("IP"),(0,b.t)("Time")],isEmpty:!m&&0===i?.length,emptyMessage:(0,b.t)("No audit entries available"),isLoading:t,children:(i??[]).map((e=>{return e?(0,k.BX)(n.Fragment,{children:[(0,k.BX)(E,{children:[(0,k.tZ)("div",{children:(s=e.actor,s?.isSuperuser||"Sentry"===s?.name&&void 0===s?.email?(0,k.tZ)(N,{type:"system",size:36}):void 0!==s?(0,k.tZ)(u.Z,{style:_,user:s}):null)}),(0,k.BX)(B,{children:[z(e.actor),(0,k.tZ)(A,{entry:e,orgSlug:p.slug})]})]}),(0,k.tZ)(D,{children:(0,k.tZ)(W,{children:(t=e.event,t.startsWith("rule.")?t.replace("rule.","issue-alert."):t.startsWith("alertrule.")?t.replace("alertrule.","metric-alert."):t)})}),(0,k.tZ)(D,{children:e.ipAddress&&(0,k.tZ)(I,{children:(0,k.tZ)(x.u,{title:e.ipAddress,disabled:e.ipAddress.length<=15,children:(0,k.tZ)(W,{children:e.ipAddress})})})}),(0,k.BX)(H,{children:[(0,k.tZ)(g.Z,{dateOnly:!0,date:e.dateCreated}),(0,k.tZ)(g.Z,{timeOnly:!0,format:c?"HH:mm zz":"LT zz",date:e.dateCreated})]})]},e.id):null;var t,s}))}),s&&(0,k.tZ)(y.Z,{pageLinks:s,onCursor:o})]})}A.displayName="AuditNote",C.displayName="AuditLogList";const N=(0,c.Z)(p.q,{target:"eiotc6t10"})("margin-right:",(0,j.D)(1),";"),$=(0,c.Z)("strong",{target:"eiotc6t9"})("font-size:",(e=>e.theme.fontSizeMedium),";"),P=(0,c.Z)(v.Z,{target:"eiotc6t8"})("padding:",(0,j.D)(1),";"),q=(0,c.Z)(m.Z,{target:"eiotc6t7"})({name:"xu0q36",styles:"width:250px"}),E=(0,c.Z)("div",{target:"eiotc6t6"})("display:flex;align-items:center;line-height:1.2;font-size:",(e=>e.theme.fontSizeSmall),";min-width:250px;"),B=(0,c.Z)("div",{target:"eiotc6t5"})({name:"16mmcnu",styles:"display:flex;flex-direction:column;justify-content:center"}),X=(0,c.Z)("div",{target:"eiotc6t4"})("font-size:",(e=>e.theme.fontSizeSmall),";word-break:break-word;margin-top:",(0,j.D)(.5),";"),D=(0,c.Z)("div",{target:"eiotc6t3"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),I=(0,c.Z)("div",{target:"eiotc6t2"})((e=>e.theme.overflowEllipsis),";min-width:90px;"),W=(0,c.Z)("code",{target:"eiotc6t1"})("font-size:",(e=>e.theme.fontSizeMedium),";white-space:no-wrap;"),H=(0,c.Z)("div",{target:"eiotc6t0"})("display:grid;grid-template-rows:auto auto;gap:",(0,j.D)(1),";font-size:",(e=>e.theme.fontSizeMedium),";"),M=C;function O(e){let{location:t}=e;const[s,c]=(0,n.useState)({entryList:[],entryListPageLinks:null,eventType:(0,o.ro)(t.query.event),eventTypes:[],isLoading:!0}),p=(0,d.Z)(),u=(0,l.Z)();(0,n.useEffect)((()=>{const e=(0,o.ro)(t.query.event);c((t=>({...t,eventType:e})))}),[t.query]);const g=(0,n.useCallback)((async()=>{c((e=>({...e,isLoading:!0})));try{const e={cursor:s.currentCursor,event:s.eventType};e.cursor||delete e.cursor,e.event||delete e.event,c((e=>({...e,isLoading:!0})));const[t,n,i]=await u.requestPromise(`/organizations/${p.slug}/audit-logs/`,{method:"GET",includeAllArgs:!0,query:e});c((e=>({...e,entryList:t.rows,eventTypes:t.options,isLoading:!1,entryListPageLinks:i?.getResponseHeader("Link")??null})))}catch(e){401!==e.status&&403!==e.status&&r.Tb(e),c((e=>({...e,isLoading:!1}))),(0,a.Iw)("Unable to load audit logs.")}}),[u,p.slug,s.currentCursor,s.eventType]);return(0,n.useEffect)((()=>{g()}),[g]),(0,k.tZ)(n.Fragment,{children:(0,k.tZ)(M,{entries:s.entryList,pageLinks:s.entryListPageLinks,eventType:s.eventType,eventTypes:s.eventTypes,onEventSelect:e=>{c((t=>({...t,eventType:e}))),i.browserHistory.push({pathname:t.pathname,query:{...t.query,event:e}})},isLoading:s.isLoading,onCursor:e=>{c((t=>({...t,currentCursor:e})))}})})}O.displayName="OrganizationAuditLog";const F=O}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationAuditLog_index_tsx.9237b95cccb57a8c5eeed78508deb1e6.js.map