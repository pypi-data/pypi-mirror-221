(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_profiling_content_tsx"],{"./app/components/charts/lineChart.tsx":(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var r=n("./app/components/charts/series/lineSeries.tsx"),i=n("./app/components/charts/baseChart.tsx"),s=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){let{series:t,seriesOptions:n,...o}=e;return(0,s.tZ)(i.Z,{...o,series:t.map((e=>{let{seriesName:t,data:i,dataArray:s,...o}=e;return(0,r.Z)({...n,...o,name:t,data:s||i?.map((e=>{let{value:t,name:n}=e;return[n,t]})),animation:!1,animationThreshold:1,animationDuration:0})}))})}o.displayName="LineChart"},"./app/components/events/searchBar.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>N}),n("../node_modules/core-js/modules/es.error.cause.js");var r=n("../node_modules/react/index.js"),i=n("../node_modules/lodash/assign.js"),s=n.n(i),o=n("../node_modules/lodash/flatten.js"),a=n.n(o),l=n("../node_modules/lodash/memoize.js"),c=n.n(l),d=n("../node_modules/lodash/omit.js"),p=n.n(d),u=n("./app/actionCreators/tags.tsx"),m=n("./app/components/smartSearchBar/index.tsx"),g=n("./app/constants/index.tsx"),h=n("./app/types/index.tsx"),f=n("./app/utils.tsx"),x=n("./app/utils/discover/fields.tsx"),Z=n("./app/utils/fields/index.ts"),y=n("./app/utils/measurements/measurements.tsx"),w=n("./app/utils/useApi.tsx"),b=n("./app/utils/withTags.tsx"),v=n("./app/views/dashboards/utils.tsx"),k=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const j=new RegExp(`^${g.c$}|\\${g.ir}`,"g"),S=new Set(Object.keys(x.wZ)),_=Object.keys(x.wZ).reduce(((e,t)=>(e[t]={...x.wZ[t],kind:Z.IV.FIELD},e)),{}),z=p()(_,x.J8),T=x.$4.reduce(((e,t)=>(e[t]={name:t,kind:Z.IV.METRICS},e)),{}),C=Object.keys(x.jg).reduce(((e,t)=>(e[t]={...x.jg[t],kind:Z.IV.FIELD},e)),{});function F(e){const{maxSearchItems:t,organization:n,tags:i,omitTags:o,fields:l,projectIds:d,includeSessionTagsValues:g,maxMenuHeight:b,customMeasurements:F}=e,N=(0,w.Z)(),P=(0,r.useMemo)((()=>(e=>e?.length?e.reduce(((e,t)=>(S.has(t.field)||(0,x.GO)(t.field)||(0,v.nk)(t.field)||(e[t.field]={key:t.field,name:t.field,kind:Z.IV.FUNCTION}),e)),{}):[])(l)),[l]),B=(0,r.useMemo)((()=>Object.keys(i).reduce(((e,t)=>(e[t]={...i[t],kind:Z.IV.TAG},e)),{})),[i]);(0,r.useEffect)((()=>{q.cache.clear?.()}),[d]);const q=c()(((e,t,r)=>{const i=d?.map(String);return(0,x.h1)(e.key)||(0,x.Xr)(e.key)?Promise.resolve([]):(0,Z.bn)(e.key)?Promise.resolve(Z.BF):(0,u.Fo)({api:N,orgSlug:n.slug,tagKey:e.key,search:t,projectIds:i,endpointParams:r,includeTransactions:!0,includeSessions:g}).then((e=>a()(e.filter((e=>{let{name:t}=e;return(0,f.ri)(t)})).map((e=>{let{name:t}=e;return t})))),(()=>{throw new Error("Unable to fetch event field values")}))}),((e,t)=>{let{key:n}=e;return`${n}-${t}`})),E=e=>{const t=((e,t)=>{const n=Object.keys(e).reduce(((t,n)=>(t[n]={...e[n],kind:Z.IV.MEASUREMENT},t)),{});return t?Object.keys(t).reduce(((e,n)=>(e[n]={...t[n],kind:Z.IV.MEASUREMENT},e)),n):n})(e,F),r=n.features.includes("performance-view")?Object.assign({},t,P,T,_):Object.assign({},z);return s()(r,B,_,C),r.has={key:Z.Sh.HAS,name:"Has property",values:Object.keys(r).sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),predefined:!0,kind:Z.IV.FIELD},o&&o.length>0?p()(r,o):r};return(0,k.tZ)(y.Z,{children:n=>{let{measurements:r}=n;return(0,k.tZ)(m.Z,{hasRecentSearches:!0,savedSearchType:h.L4.EVENT,onGetTagValues:q,supportedTags:E(r),prepareQuery:e=>e.replace(j,""),maxSearchItems:t,excludedTags:[Z.Sh.ENVIRONMENT,Z.Sh.TOTAL_COUNT],maxMenuHeight:b??300,customPerformanceMetrics:F,...e})}})}F.displayName="SearchBar";const N=(0,b.Z)(F)},"./app/components/onboardingPanel.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=n("./app/components/panels/panel.tsx"),s=n("./app/styles/space.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){let{image:t,noCenter:n,children:r,...s}=e;return(0,o.tZ)(i.Z,{...s,children:(0,o.BX)(l,{children:[t?(0,o.tZ)(d,{children:t}):null,(0,o.tZ)(c,{centered:!t&&!n,children:r})]})})}a.displayName="OnboardingPanel";const l=(0,r.Z)("div",{target:"euclof22"})("padding:",(0,s.D)(3),";position:relative;@media (min-width: ",(e=>e.theme.breakpoints.small),"){display:flex;align-items:center;flex-direction:row;justify-content:center;flex-wrap:wrap;min-height:300px;max-width:1000px;margin:0 auto;}@media (min-width: ",(e=>e.theme.breakpoints.medium),"){min-height:350px;}"),c=(0,r.Z)("div",{target:"euclof21"})("min-width:0;z-index:1;",(e=>e.centered?"text-align: center;":"")," ",(e=>e.centered?"max-width: 600px;":""),"@media (min-width: ",(e=>e.theme.breakpoints.small),"){flex:2;}"),d=(0,r.Z)(c,{target:"euclof20"})("position:relative;min-height:100px;max-width:300px;min-width:150px;margin:",(0,s.D)(2)," auto;@media (min-width: ",(e=>e.theme.breakpoints.small),"){flex:1;margin:",(0,s.D)(3),";max-width:auto;}"),p=a},"./app/utils/withTags.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=n("../node_modules/react/index.js"),s=n("./app/stores/tagStore.tsx"),o=n("./app/utils/getDisplayName.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends i.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{tags:s.Z.getState()}),(0,r.Z)(this,"unsubscribe",s.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...n}=this.props;return(0,a.tZ)(e,{tags:t??this.state.tags,...n})}}return t.displayName="WithTags",(0,r.Z)(t,"displayName",`withTags(${(0,o.Z)(e)})`),t}},"./app/views/profiling/content.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>At});var r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(n("../node_modules/core-js/modules/es.array.push.js"),n("../node_modules/react/index.js")),s=n("../node_modules/react-router/es/index.js"),o=n("./app/components/alert.tsx"),a=n("./app/components/button.tsx"),l=n("./app/components/datePageFilter.tsx"),c=n("./app/components/environmentPageFilter.tsx"),d=n("./app/components/events/searchBar.tsx"),p=n("./app/components/layouts/thirds.tsx"),u=n("./app/components/organizations/pageFilterBar.tsx"),m=n("./app/components/organizations/pageFilters/container.tsx"),g=n("./app/components/pageHeadingQuestionTooltip.tsx"),h=n("./app/components/pagination.tsx"),f=n("./app/components/hookOrDefault.tsx");const x=(0,f.Z)({hookName:"component:profiling-billing-banner"}),Z=(0,f.Z)({hookName:"component:profiling-upgrade-plan-button"}),y=(0,f.Z)({hookName:"component:profiling-am1-or-mmx-upgrade"});var w=n("./app/components/profiling/profileEventsTable.tsx"),b=n("./app/components/projectPageFilter.tsx"),v=n("./app/components/sentryDocumentTitle.tsx"),k=n("./app/components/sidebar/types.tsx"),j=n("./app/components/smartSearchBar/index.tsx"),S=n("./app/constants/index.tsx"),_=n("./app/constants/pageFilters.tsx"),z=n("./app/locale.tsx"),T=n("./app/stores/sidebarPanelStore.tsx"),C=n("./app/styles/space.tsx"),F=n("./app/utils/analytics.tsx"),N=n("./app/utils/discover/eventView.tsx"),P=n("./app/utils/profiling/hooks/useProfileEvents.tsx"),B=n("./app/utils/profiling/hooks/useProfileFilters.tsx"),q=n("./app/utils/profiling/hooks/utils.tsx"),E=n("./app/utils/queryString.tsx"),L=n("./app/utils/useOrganization.tsx"),X=n("./app/utils/usePageFilters.tsx"),D=n("./app/utils/useProjects.tsx"),M=n("./app/views/profiling/utils.tsx"),I=(n("../node_modules/core-js/modules/es.error.cause.js"),n("../node_modules/lodash/omit.js")),O=n.n(I),H=n("./app/components/compactSelect/index.tsx"),A=n("./app/utils/tokenizeSearch.tsx"),V=n("./app/utils/useRouter.tsx"),W=n("./app/utils/useSyncedLocalStorageState.tsx"),G=n("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),R=n("../node_modules/lodash/partition.js"),$=n.n(R),Q=n("./app/components/charts/chartZoom.tsx"),U=n("./app/components/charts/lineChart.tsx"),K=n("./app/components/count.tsx"),Y=n("./app/components/emptyStateWarning.tsx"),J=n("./app/components/idBadge/index.tsx"),ee=n("./app/components/links/link.tsx"),te=n("./app/components/loadingIndicator.tsx"),ne=n("./app/components/performanceDuration.tsx"),re=n("./app/components/textOverflow.tsx"),ie=n("./app/components/tooltip.tsx"),se=n("./app/icons/index.tsx"),oe=n("./app/utils/discover/charts.tsx"),ae=n("./app/components/organizations/pageFilters/parse.tsx"),le=n("./app/utils/queryClient.tsx"),ce=n("./app/utils/profiling/routes.tsx"),de=n("./app/utils/useLocation.tsx"),pe=n("./app/components/charts/styles.tsx"),ue=n("./app/components/panels/panel.tsx"),me=n("./app/utils.tsx");const ge=(0,r.Z)(ue.Z,{target:"ehwgfdy7"})((e=>(0,me.ri)(e.height)&&`height: ${e.height};`)," display:flex;flex-direction:column;padding-top:",(0,C.D)(2),";"),he=(0,r.Z)("div",{target:"ehwgfdy6"})("display:grid;grid-auto-flow:column;grid-template-columns:1fr auto;grid-template-rows:26px auto;padding-left:",(0,C.D)(2),";padding-right:",(0,C.D)(2),";"),fe=(0,r.Z)(pe.ws,{target:"ehwgfdy5"})({name:"bjn8wh",styles:"position:relative"}),xe=(0,r.Z)("div",{target:"ehwgfdy4"})("color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeMedium),";display:inline-block;"),Ze=(0,r.Z)("div",{target:"ehwgfdy3"})({name:"1je9ejj",styles:"flex:1 1 auto;display:flex;flex-direction:column;justify-content:center"}),ye=(0,r.Z)("div",{target:"ehwgfdy2"})({name:"8xmdsf",styles:"display:flex;align-items:center;justify-content:center;flex:1 1 auto;.loading{margin:0 auto;}"}),we=(0,r.Z)("ul",{target:"ehwgfdy1"})("padding:",(0,C.D)(1)," 0 0 0;margin:0;list-style-type:none;flex:1 1 auto;"),be=(0,r.Z)("li",{target:"ehwgfdy0"})("line-height:",(e=>e.theme.text.lineHeightBody),";display:flex;align-items:center;gap:",(0,C.D)(1),";border-top:1px solid ",(e=>e.theme.border),";padding:",(0,C.D)(1)," ",(0,C.D)(2),";font-size:",(e=>e.theme.fontSizeMedium),";");var ve=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const ke=3,je="fnTrendCursor";function Se(e){let{cursorName:t=je,header:n,trendFunction:r,trendType:o,widgetHeight:a,userQuery:l}=e;const c=(0,de.T)(),[d,p]=(0,i.useState)(0),u=(0,i.useMemo)((()=>(0,E.ro)(c.query[t])),[t,c.query]),m=(0,i.useCallback)(((e,n,r)=>{s.browserHistory.push({pathname:n,query:{...r,[t]:e}})}),[t]),g=function(e){let{cursor:t,datetime:n,projects:r,enabled:i,limit:s,query:o,refetchOnMount:a,trendFunction:l,trendType:c}=e;const d=(0,L.Z)(),{selection:p}=(0,X.Z)(),u=`/organizations/${d.slug}/profiling/function-trends/`,m={query:{project:r||p.projects,environment:p.environments,...(0,ae.fK)(n??p.datetime),function:l,trend:c,query:o,per_page:s,cursor:t}};return(0,le.WE)([u,m],{staleTime:0,refetchOnWindowFocus:!1,refetchOnMount:a,retry:!1,enabled:i})}({trendFunction:r,trendType:o,query:l,limit:ke,cursor:u});(0,i.useEffect)((()=>{p(0)}),[g.data]);const h=(g.data?.length||0)>0,f=g.isLoading,x=g.isError;return(0,ve.BX)(ge,{height:a,children:[(0,ve.tZ)(_e,{header:n,handleCursor:m,pageLinks:g.getResponseHeader?.("Link")??null,trendType:o}),(0,ve.BX)(Ze,{children:[f&&(0,ve.tZ)(ye,{children:(0,ve.tZ)(te.Z,{})}),x&&(0,ve.tZ)(ye,{children:(0,ve.tZ)(se.FC,{"data-test-id":"error-indicator",color:"gray300",size:"lg"})}),!x&&!f&&!h&&(0,ve.tZ)(Y.Z,{children:"regression"===o?(0,ve.tZ)("p",{children:(0,z.t)("No regressed functions detected")}):(0,ve.tZ)("p",{children:(0,z.t)("No improved functions detected")})}),h&&(0,ve.tZ)(we,{children:(g.data??[]).map(((e,t)=>(0,ve.tZ)(ze,{trendFunction:r,trendType:o,isExpanded:t===d,setExpanded:()=>p(t),func:e},`${e.project}-${e.function}-${e.package}`)))})]})]})}function _e(e){let{handleCursor:t,header:n,pageLinks:r,trendType:i}=e;switch(i){case"regression":return(0,ve.BX)(he,{children:[n??(0,ve.tZ)(fe,{children:(0,z.t)("Most Regressed Functions")}),(0,ve.tZ)(xe,{children:(0,z.t)("Functions by most regressed.")}),(0,ve.tZ)(Ne,{pageLinks:r,size:"xs",onCursor:t})]});case"improvement":return(0,ve.BX)(he,{children:[n??(0,ve.tZ)(fe,{children:(0,z.t)("Most Improved Functions")}),(0,ve.tZ)(xe,{children:(0,z.t)("Functions by most improved.")}),(0,ve.tZ)(Ne,{pageLinks:r,size:"xs",onCursor:t})]});default:throw new Error((0,z.t)("Unknown trend type"))}}function ze(e){let{func:t,isExpanded:n,setExpanded:r,trendFunction:s,trendType:o}=e;const l=(0,L.Z)(),{projects:c}=(0,D.Z)(),d=c.find((e=>e.id===t.project)),[p,u]=(0,i.useMemo)((()=>$()(t.worst,(e=>{let[n,r]=e;return n<=t.breakpoint}))),[t]);let m=(0,ve.tZ)(ne.Z,{nanoseconds:t.aggregate_range_1,abbreviation:!0}),g=(0,ve.tZ)(ne.Z,{nanoseconds:t.aggregate_range_2,abbreviation:!0});function h(){switch(o){case"improvement":(0,F.Gi)("profiling_views.go_to_flamegraph",{organization:l,source:"profiling.function_trends.improvement"});break;case"regression":(0,F.Gi)("profiling_views.go_to_flamegraph",{organization:l,source:"profiling.function_trends.regression"});break;default:throw new Error("Unknown trend type")}}if(d&&p.length>=2&&u.length>=2){const e=(0,ce.TH)({orgSlug:l.slug,projectSlug:d.slug,profileId:p[p.length-2][1],query:{frameName:t.function,framePackage:t.package}});m=(0,ve.tZ)(ee.Z,{to:e,onClick:h,children:m});const n=(0,ce.TH)({orgSlug:l.slug,projectSlug:d.slug,profileId:u[u.length-2][1],query:{frameName:t.function,framePackage:t.package}});g=(0,ve.tZ)(ee.Z,{to:n,onClick:h,children:g})}return(0,ve.BX)(i.Fragment,{children:[(0,ve.BX)(Pe,{children:[d&&(0,ve.tZ)(ie.u,{title:d.name,children:(0,ve.tZ)(J.Z,{project:d,avatarSize:16,hideName:!0})}),(0,ve.tZ)(Be,{children:(0,ve.tZ)(ie.u,{title:t.package,children:t.function})}),(0,ve.tZ)(ie.u,{title:(0,z._N)("Appeared [count] times.",{count:(0,ve.tZ)(K.Z,{value:t["count()"]})}),children:(0,ve.BX)(Ee,{children:[m,(0,ve.tZ)(se.CC,{direction:"right",size:"xs"}),g]})}),(0,ve.tZ)(a.zx,{icon:(0,ve.tZ)(se.g6,{size:"xs",direction:n?"up":"down"}),"aria-label":(0,z.t)("Expand"),"aria-expanded":n,size:"zero",borderless:!0,onClick:()=>r()})]}),n&&(0,ve.tZ)(qe,{children:(0,ve.tZ)(Te,{func:t,trendFunction:s})})]})}function Te(e){let{func:t,trendFunction:n}=e;const{selection:r}=(0,X.Z)(),s=(0,V.Z)(),o=(0,G.u)(),a=(0,i.useMemo)((()=>{const e={data:t.stats.data.map((e=>{let[t,n]=e;return{name:1e3*t,value:n[0].count/1e6}})),seriesName:n,color:Ce(t.change,o)},r=1e3*t.stats.data[0][0],i=1e3*t.breakpoint,s=1e3*t.stats.data[t.stats.data.length-1][0],a={data:[],color:o.textColor,seriesName:"dividing line",markLine:{}};a.markLine={data:[{xAxis:i}],label:{show:!1},lineStyle:{color:o.textColor,type:"solid",width:2},symbol:["none","none"],tooltip:{show:!1},silent:!0};const l={data:[],color:o.textColor,seriesName:"before line",markLine:{}};l.markLine={data:[[{value:"Past",coord:[r,t.aggregate_range_1/1e6]},{coord:[i,t.aggregate_range_1/1e6]}]],label:{fontSize:11,show:!0,color:o.textColor,silent:!0,formatter:"Past",position:"insideStartTop"},lineStyle:{color:o.textColor,type:"dashed",width:1},symbol:["none","none"],tooltip:{formatter:Fe((0,z.t)("Past Baseline"),t.aggregate_range_1)}};const c={data:[],color:o.textColor,seriesName:"after line",markLine:{}};return c.markLine={data:[[{value:"Present",coord:[i,t.aggregate_range_2/1e6]},{coord:[s,t.aggregate_range_2/1e6]}]],label:{fontSize:11,show:!0,color:o.textColor,silent:!0,formatter:"Present",position:"insideEndBottom"},lineStyle:{color:o.textColor,type:"dashed",width:1},symbol:["none","none"],tooltip:{formatter:Fe((0,z.t)("Present Baseline"),t.aggregate_range_2)}},[e,a,l,c]}),[t,n,o]),l=(0,i.useMemo)((()=>({height:150,grid:{top:"10px",bottom:"0px",left:"10px",right:"10px"},yAxis:{axisLabel:{color:o.chartLabel,formatter:e=>(0,oe.gu)(e,"duration")}},xAxis:{show:!1},tooltip:{valueFormatter:e=>(0,oe.CX)(e,"duration")}})),[o.chartLabel]);return(0,ve.tZ)(Q.Z,{router:s,...r.datetime,children:e=>(0,ve.tZ)(U.w,{...e,...l,series:a})})}function Ce(e,t){switch(e){case"improvement":return t.green300;case"regression":return t.red300;default:throw new Error("Unknown trend type")}}function Fe(e,t){return['<div class="tooltip-series tooltip-series-solo">',"<div>",`<span class="tooltip-label"><strong>${e}</strong></span>`,(0,oe.CX)(t/1e6,"duration"),"</div>","</div>",'<div class="tooltip-arrow"></div>'].join("")}Se.displayName="FunctionTrendsWidget",ze.displayName="FunctionTrendsEntry",Te.displayName="FunctionTrendsChart";const Ne=(0,r.Z)(h.Z,{target:"eulfq9u4"})({name:"ti75j2",styles:"margin:0"}),Pe=(0,r.Z)(be,{target:"eulfq9u3"})({name:"nk2pj",styles:"display:grid;grid-template-columns:auto 1fr auto auto"}),Be=(0,r.Z)(re.Z,{target:"eulfq9u2"})({name:"mkkf9p",styles:"flex:1 1 auto"}),qe=(0,r.Z)("div",{target:"eulfq9u1"})({name:"mkkf9p",styles:"flex:1 1 auto"}),Ee=(0,r.Z)("span",{target:"eulfq9u0"})("color:",(e=>e.theme.gray300),";display:flex;align-items:center;gap:",(0,C.D)(1),";");var Le=n("./app/components/scoreBar.tsx"),Xe=n("./app/constants/chartPalette.tsx"),De=n("./app/utils/profiling/hooks/useProfileFunctions.tsx");const Me=3,Ie="slowFnCursor";function Oe(e){let{cursorName:t=Ie,header:n,userQuery:r,widgetHeight:o}=e;const a=(0,de.T)(),[l,c]=(0,i.useState)(0),d=(0,i.useMemo)((()=>(0,E.ro)(a.query[t])),[t,a.query]),p=(0,i.useCallback)(((e,n,r)=>{s.browserHistory.push({pathname:n,query:{...r,[t]:e}})}),[t]),u=(0,De.W)({fields:Ve,referrer:"api.profiling.suspect-functions.list",sort:{key:"sum()",order:"desc"},query:r,limit:Me,cursor:d}),m=(u.data?.data?.length||0)>0,g=(0,De.W)({fields:We,referrer:"api.profiling.suspect-functions.totals",sort:{key:"sum()",order:"desc"},query:r,limit:Me,projects:u.isFetched?[...new Set((u.data?.data??[]).map((e=>e["project.id"])))]:[],enabled:u.isFetched&&m}),h=u.isLoading||m&&g.isLoading,f=u.isError||g.isError;return(0,ve.BX)(ge,{height:o,children:[(0,ve.BX)(he,{children:[n??(0,ve.tZ)(fe,{children:(0,z.t)("Suspect Functions")}),(0,ve.tZ)(xe,{children:(0,z.t)("Slowest functions by total time spent.")}),(0,ve.tZ)(Re,{pageLinks:u.getResponseHeader?.("Link")??null,size:"xs",onCursor:p})]}),(0,ve.BX)(Ze,{children:[h&&(0,ve.tZ)(ye,{children:(0,ve.tZ)(te.Z,{})}),f&&(0,ve.tZ)(ye,{children:(0,ve.tZ)(se.FC,{"data-test-id":"error-indicator",color:"gray300",size:"lg"})}),!f&&!h&&!m&&(0,ve.tZ)(Y.Z,{children:(0,ve.tZ)("p",{children:(0,z.t)("No functions found")})}),m&&g.isFetched&&(0,ve.tZ)($e,{children:(u.data?.data??[]).map(((e,t)=>{const n=g.data?.data?.find((t=>t["project.id"]===e["project.id"])),i=n?.["sum()"]??e["sum()"];return(0,ve.tZ)(Ae,{isExpanded:t===l,setExpanded:()=>c(t),func:e,totalDuration:i,query:r??""},`${e["project.id"]}-${e.package}-${e.function}`)}))})]})]})}Oe.displayName="SlowestFunctionsWidget";const He=10;function Ae(e){let{func:t,isExpanded:n,query:r,setExpanded:s,totalDuration:o}=e;const l=(0,L.Z)(),{projects:c}=(0,D.Z)(),d=c.find((e=>e.id===String(t["project.id"]))),p=Math.ceil((t["sum()"]??0)/o*He),u=new Array(He).fill([Xe.$[0][0]]),m=(0,i.useMemo)((()=>{const e=new A.MY(r);return e.setFilterValues("project.id",[String(t["project.id"])]),e.setFilterValues("fingerprint",[String(t.fingerprint)]),e.formatString()}),[t,r]),g=(0,De.W)({fields:Ge,referrer:"api.profiling.suspect-functions.transactions",sort:{key:"sum()",order:"desc"},query:m,limit:5,enabled:n});return(0,ve.BX)(i.Fragment,{children:[(0,ve.BX)(Qe,{children:[d&&(0,ve.tZ)(ie.u,{title:d.name,children:(0,ve.tZ)(J.Z,{project:d,avatarSize:16,hideName:!0})}),(0,ve.tZ)(Ue,{children:(0,ve.tZ)(ie.u,{title:t.package,children:t.function})}),(0,ve.tZ)(ie.u,{title:(0,z._N)("Appeared [count] times for a total self time of [totalSelfTime]",{count:(0,ve.tZ)(K.Z,{value:t["count()"]}),totalSelfTime:(0,ve.tZ)(ne.Z,{nanoseconds:t["sum()"],abbreviation:!0})}),children:(0,ve.tZ)(Le.Z,{score:p,palette:u,size:20,radius:0})}),(0,ve.tZ)(a.zx,{icon:(0,ve.tZ)(se.g6,{size:"xs",direction:n?"up":"down"}),"aria-label":(0,z.t)("Expand"),"aria-expanded":n,size:"zero",borderless:!0,onClick:()=>s()})]}),n&&(0,ve.BX)(i.Fragment,{children:[g.isError&&(0,ve.tZ)(ye,{children:(0,ve.tZ)(se.FC,{"data-test-id":"error-indicator",color:"gray300",size:"lg"})}),g.isLoading&&(0,ve.tZ)(ye,{children:(0,ve.tZ)(te.Z,{})}),g.isFetched&&(0,ve.BX)(Ke,{"data-test-id":"transactions-list",children:[(0,ve.tZ)(Ye,{children:(0,ve.tZ)(re.Z,{children:(0,z.t)("Transaction")})}),(0,ve.tZ)(Ye,{align:"right",children:(0,ve.tZ)(re.Z,{children:(0,z.t)("Count")})}),(0,ve.tZ)(Ye,{align:"right",children:(0,ve.tZ)(re.Z,{children:(0,z.t)("Total Self Time")})}),(g.data?.data??[]).map((e=>{const n=e["examples()"];let r=(0,ve.tZ)(i.Fragment,{children:e.transaction});if(d&&n.length){const e=(0,ce.TH)({orgSlug:l.slug,projectSlug:d.slug,profileId:n[0],query:{frameName:t.function,framePackage:t.package}});r=(0,ve.tZ)(ee.Z,{to:e,onClick:()=>{(0,F.Gi)("profiling_views.go_to_flamegraph",{organization:l,source:"profiling.global_suspect_functions"})},children:r})}return(0,ve.BX)(i.Fragment,{children:[(0,ve.tZ)(Je,{children:(0,ve.tZ)(re.Z,{children:r})}),(0,ve.tZ)(Je,{align:"right",children:(0,ve.tZ)(K.Z,{value:e["count()"]})}),(0,ve.tZ)(Je,{align:"right",children:(0,ve.tZ)(ne.Z,{nanoseconds:e["sum()"],abbreviation:!0})})]},e.transaction)}))]})]})]})}Ae.displayName="SlowestFunctionEntry";const Ve=["project.id","fingerprint","package","function","count()","sum()"],We=["project.id","sum()"],Ge=["transaction","count()","sum()","examples()"],Re=(0,r.Z)(h.Z,{target:"e19xep7z6"})({name:"ti75j2",styles:"margin:0"}),$e=(0,r.Z)(we,{target:"e19xep7z5"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),Qe=(0,r.Z)(be,{target:"e19xep7z4"})({name:"nk2pj",styles:"display:grid;grid-template-columns:auto 1fr auto auto"}),Ue=(0,r.Z)(re.Z,{target:"e19xep7z3"})({name:"mkkf9p",styles:"flex:1 1 auto"}),Ke=(0,r.Z)("div",{target:"e19xep7z2"})("flex:1 1 auto;display:grid;grid-template-columns:minmax(0, 1fr) auto auto;grid-template-rows:18px auto auto auto auto auto;column-gap:",(0,C.D)(1),";padding:",(0,C.D)(0)," ",(0,C.D)(2),";"),Ye=(0,r.Z)("span",{target:"e19xep7z1"})("text-transform:uppercase;font-size:",(e=>e.theme.fontSizeExtraSmall),";font-weight:600;color:",(e=>e.theme.subText),";text-align:",(e=>e.align),";"),Je=(0,r.Z)("div",{target:"e19xep7z0"})("font-size:",(e=>e.theme.fontSizeSmall),";text-align:",(e=>e.align),";padding:",(0,C.D)(.5)," 0px;");function et(e){let{cursorName:t,defaultWidget:n,storageKey:r,widgetHeight:s}=e;const o=(0,V.Z)(),[a,l]=(0,W.g)(r,n),c=(0,i.useCallback)((e=>{const n=O()(o.location.query,[t]);o.push({pathname:o.location.pathname,query:n}),l(e.value)}),[t,o,l]),d=(0,i.useMemo)((()=>{const e=new A.MY("");return e.setFilterValues("is_application",["1"]),e.formatString()}),[]),p=(0,ve.tZ)(nt,{value:a,options:tt,onChange:c,triggerProps:{borderless:!0,size:"zero"},offset:4});switch(a){case"slowest functions":return(0,ve.tZ)(Oe,{cursorName:t,header:p,userQuery:d,widgetHeight:s});case"regressed functions":return(0,ve.tZ)(Se,{cursorName:t,header:p,trendFunction:"p95()",trendType:"regression",userQuery:d,widgetHeight:s});case"improved functions":return(0,ve.tZ)(Se,{cursorName:t,header:p,trendFunction:"p95()",trendType:"improvement",userQuery:d,widgetHeight:s});default:throw new Error("unknown widget type")}}const tt=[{label:(0,z.t)("Suspect Functions"),value:"slowest functions"},{label:(0,z.t)("Most Regressed Functions"),value:"regressed functions"},{label:(0,z.t)("Most Improved Functions"),value:"improved functions"}],nt=(0,r.Z)(H.Z,{target:"e5woqc30"})({name:"lo8vg0",styles:">button{border:None;padding:0;}"});var rt=n("./app/views/profiling/landing/profileCharts.tsx"),it=n("./app/components/charts/areaChart.tsx"),st=n("./app/utils/profiling/hooks/useProfileEventsStats.tsx");const ot=["p99()","p95()","p75()","p50()"];function at(e){let{chartHeight:t,header:n,referrer:r,selection:s,userQuery:o,widgetHeight:a}=e;const l=(0,V.Z)(),c=(0,G.u)(),d=(0,st.z)({query:o,referrer:r,yAxes:ot}),p=(0,i.useMemo)((()=>{if("success"!==d.status)return[];const e=d.data[0].timestamps.map((e=>1e3*e));return d.data[0].data.map((t=>{if(e.length!==t.values.length)throw new Error("Invalid stats response");return{data:t.values.map(((t,n)=>({name:e[n],value:t??0}))),seriesName:t.axis}})).sort(((e,t)=>ot.indexOf(e.seriesName)-ot.indexOf(t.seriesName)))}),[d]),u=(0,i.useMemo)((()=>({height:t,grid:{top:"16px",left:"24px",right:"24px",bottom:"16px"},xAxis:{type:"time"},yAxis:{scale:!0,axisLabel:{color:c.chartLabel,formatter:e=>(0,oe.gu)(e,"duration")}},tooltip:{valueFormatter:e=>(0,oe.CX)(e,"duration")},legend:{right:16,top:12,data:ot.slice()}})),[t,c.chartLabel]);return(0,ve.BX)(ge,{height:a,children:[(0,ve.BX)(he,{children:[n??(0,ve.tZ)(fe,{children:(0,z.t)("Profiles by Percentiles")}),(0,ve.tZ)(xe,{children:(0,z.t)("P50(), P75(), P95(), P99() over time")})]}),(0,ve.tZ)(Ze,{children:(0,ve.tZ)(Q.Z,{router:l,...s?.datetime,children:e=>(0,ve.tZ)(it.T,{...e,...u,series:p,isGroupedByDate:!0,showTimeInTooltip:!0})})})]})}at.displayName="ProfilesChartWidget";var lt=n("../node_modules/platformicons/build/index.js"),ct=n("./app/components/profiling/flex.tsx"),dt=n("./app/components/profiling/functionsMiniGrid.tsx"),pt=n("./app/components/profiling/textTruncateOverflow.tsx"),ut=n("./app/utils/discover/fields.tsx"),mt=n("./app/utils/profiling/hooks/useProfilingTransactionQuickSummary.tsx"),gt=n("./app/utils/profiling/units/units.ts");const ht=["transaction","project.id","last_seen()","p95()","count()"];function ft(){const e=(0,P.G)({fields:ht,sort:{key:"p95()",order:"desc"},limit:3,query:"count():>3",referrer:"api.profiling.landing-slowest-transaction-panel"}),[t,n]=(0,i.useState)(null),r=(0,i.useMemo)((()=>e.data?.data??[]),[e.data]),s=(0,i.useMemo)((()=>r.map((e=>e.transaction))),[r]);if(s.length>0&&!s.includes(t)){const e=s[0];n(e)}const{isLoading:o}=e,a=!o&&r&&r.length>0;return(0,ve.tZ)(bt,{children:(0,ve.BX)(ct.k,{column:!0,h:"100%",children:[(0,ve.BX)(ct.k,{column:!0,p:(0,C.D)(1.5),children:[(0,ve.tZ)(vt,{children:(0,z.t)("Slowest Transactions")}),(0,ve.tZ)(kt,{children:(0,z.t)("Slowest transactions that could use some optimization.")})]}),(o||!a)&&(0,ve.tZ)(ct.k,{column:!0,align:"center",justify:"center",h:"100%",children:o?(0,ve.tZ)(te.Z,{}):!a&&(0,ve.tZ)(ct.k.Item,{children:(0,ve.BX)(Y.Z,{children:[(0,ve.tZ)("p",{children:(0,z.t)("No results found")}),(0,ve.tZ)(zt,{children:(0,z.t)("Transactions may not be listed due to the filters above or a low number of profiles.")})]})})}),r?.map((r=>(0,ve.tZ)(yt,{transaction:r,open:r.transaction===t,onOpen:()=>n(r.transaction),units:e.data?.meta.units},r.transaction)))]})})}ft.displayName="ProfilingSlowestTransactionsPanel";var xt={name:"e0dnmk",styles:"cursor:pointer"},Zt={name:"1x8xwk",styles:"max-width:fit-content"};function yt(e){let{transaction:t,open:n,onOpen:r,units:s}=e;const{query:o}=(0,de.T)(),l=(0,L.Z)(),c=(0,D.Z)(),d=(0,i.useMemo)((()=>c.projects.find((e=>e.id===String(t["project.id"])))),[c.projects,t]);if(!d&&!c.fetching&&c.projects.length>0)return null;const p="p95()",u=(0,gt.fr)(s?.[p]??s?.[(0,ut.LY)(p)]??"nanoseconds","milliseconds");return(0,ve.BX)(jt,{children:[(0,ve.BX)(ct.k,{justify:"space-between",gap:(0,C.D)(1),children:[(0,ve.tZ)(lt.v,{platform:d?.platform??"default"}),(0,ve.tZ)(ct.k.Item,{grow:1,onClick:r,css:xt,children:(0,ve.tZ)("div",{css:Zt,children:(0,ve.tZ)(ee.Z,{to:(0,ce.R0)({query:o,orgSlug:l.slug,projectSlug:d?.slug,transaction:t.transaction}),onClick:()=>{(0,F.Gi)("profiling_views.go_to_transaction",{source:"slowest_transaction_panel",organization:l})},children:(0,ve.tZ)(pt.W,{children:t.transaction})})})}),(0,ve.tZ)(ne.Z,{milliseconds:u(t[p]),abbreviation:!0}),(0,ve.tZ)(a.zx,{borderless:!0,size:"zero",onClick:r,children:(0,ve.tZ)(se.g6,{direction:n?"up":"down",size:"xs"})})]}),(0,ve.tZ)(St,{style:{height:n?160:0},children:n&&d&&(0,ve.tZ)(wt,{transaction:String(t.transaction),organization:l,project:d})})]},t.transaction)}function wt(e){const{transaction:t,project:n,organization:r}=e,{functionsQuery:i,functions:s}=(0,mt.d)({transaction:t,project:n,referrer:"api.profiling.landing-slowest-transaction-panel",skipLatestProfile:!0,skipSlowestProfile:!0});return i.isLoading?(0,ve.tZ)(dt.q8,{}):!s||s&&0===s.length?(0,ve.tZ)(dt.EA,{}):(0,ve.tZ)(_t,{children:(0,ve.tZ)(dt.nL,{functions:s,organization:r,project:n,onLinkClick:()=>(0,F.Gi)("profiling_views.go_to_flamegraph",{organization:r,source:"slowest_transaction_panel"})})})}yt.displayName="SlowestTransactionPanelItem",wt.displayName="PanelItemFunctionsMiniGrid";const bt=(0,r.Z)(ue.Z,{target:"e6nc0wg6"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),vt=(0,r.Z)("span",{target:"e6nc0wg5"})("font-size:",(e=>e.theme.text.cardTitle.fontSize),";font-weight:",(e=>e.theme.text.cardTitle.fontWeight),";line-height:",(e=>e.theme.text.cardTitle.lineHeight),";"),kt=(0,r.Z)("span",{target:"e6nc0wg4"})("color:",(e=>e.theme.subText),";"),jt=(0,r.Z)("div",{target:"e6nc0wg3"})("padding:",(0,C.D)(1)," ",(0,C.D)(1.5),";border-top:1px solid ",(e=>e.theme.border),";"),St=(0,r.Z)("div",{target:"e6nc0wg2"})({name:"1kt23o3",styles:"transition:height 0.1s ease;width:100%;overflow:hidden"}),_t=(0,r.Z)("div",{target:"e6nc0wg1"})("padding-top:",(0,C.D)(1.5),";"),zt=(0,r.Z)("div",{target:"e6nc0wg0"})("font-size:",(e=>e.theme.fontSizeMedium),";");var Tt=n("./images/spot/profiling-empty-state.svg"),Ct=n("./app/components/buttonBar.tsx"),Ft=n("./app/components/onboardingPanel.tsx");function Nt(e){return(0,ve.BX)(Ft.Z,{image:(0,ve.tZ)(Pt,{src:Tt}),children:[e.content?e.content:(0,ve.BX)(i.Fragment,{children:[(0,ve.tZ)("h3",{children:(0,z.t)("Function level insights")}),(0,ve.tZ)("p",{children:(0,z.t)("Discover slow-to-execute or resource intensive functions within your application")})]}),(0,ve.tZ)(Bt,{gap:1,children:e.children})]})}Nt.displayName="ProfilingOnboardingPanel";const Pt=(0,r.Z)("img",{target:"eb17yy31"})("@media (min-width: ",(e=>e.theme.breakpoints.small),"){user-select:none;position:absolute;top:0;bottom:0;width:220px;margin-top:auto;margin-bottom:auto;transform:translateX(-50%);left:50%;}@media (min-width: ",(e=>e.theme.breakpoints.large),"){transform:translateX(-55%);width:300px;min-width:300px;}@media (min-width: ",(e=>e.theme.breakpoints.xlarge),"){transform:translateX(-60%);width:380px;min-width:380px;}@media (min-width: ",(e=>e.theme.breakpoints.xxlarge),"){transform:translateX(-65%);width:420px;min-width:420px;}"),Bt=(0,r.Z)(Ct.ZP,{target:"eb17yy30"})({name:"vpj881",styles:"grid-template-columns:repeat(auto-fit, minmax(130px, max-content))"}),qt="leftCursor",Et="rightCursor",Lt=[qt,Et];function Xt(e){let{location:t}=e;const n=(0,L.Z)(),{selection:r}=(0,X.Z)(),f=(0,E.ro)(t.query.cursor),C=(0,E.ro)(t.query.query,""),I=n.features.includes("profiling-using-transactions"),O=I?Mt:Dt,H=(0,q.k)((0,E.ro)(t.query.sort),O,{key:"p95()",order:"desc"}),A=(0,B.J)({query:"",selection:r,disabled:I}),{projects:V}=(0,D.Z)(),W=(0,P.G)({cursor:f,fields:O,query:C,sort:H,referrer:"api.profiling.landing-table"}),G="error"===W.status?(0,q.Z)(W.error):null;(0,i.useEffect)((()=>{(0,F.Gi)("profiling_views.landing",{organization:n})}),[n]);const R=(0,i.useCallback)((e=>{s.browserHistory.push({...t,query:{...t.query,cursor:void 0,query:e||void 0}})}),[t]),$=(0,i.useCallback)((()=>{(0,F.Gi)("profiling_views.onboarding",{organization:n}),T.Z.activatePanel(k.z.PROFILING_ONBOARDING)}),[n]),Q=(0,i.useMemo)((()=>{if(0===r.projects.length||r.projects[0]===_.mP)return V.every((e=>!e.hasProfiles));const e=new Set(V.filter((e=>e.hasProfiles)).map((e=>e.id)));return r.projects.every((t=>!e.has(String(t))))}),[r.projects,V]),U=(0,i.useMemo)((()=>{const e=N.ZP.fromNewQueryWithLocation({id:void 0,version:2,name:(0,z.t)("Profiling"),fields:[],query:C,projects:r.projects},t);return e.additionalConditions.setFilterValues("has",["profile.id"]),e}),[t,C,r.projects]);return(0,ve.tZ)(v.Z,{title:(0,z.t)("Profiling"),orgSlug:n.slug,children:(0,ve.tZ)(m.Z,{defaultSelection:I?{datetime:M.NN}:void 0,children:(0,ve.BX)(p.T3,{children:[(0,ve.tZ)(x,{organization:n}),(0,ve.tZ)(p.h4,{children:(0,ve.tZ)(p.oB,{children:(0,ve.BX)(p.Dx,{children:[(0,z.t)("Profiling"),(0,ve.tZ)(g.u,{docsUrl:"https://docs.sentry.io/product/profiling/",title:(0,z.t)("Profiling collects detailed information in production about the functions executing in your application and how long they take to run, giving you code-level visibility into your hot paths.")})]})})}),(0,ve.tZ)(p.uT,{children:(0,ve.BX)(p.or,{fullWidth:!0,children:[G&&(0,ve.tZ)(o.bZ,{type:"error",showIcon:!0,children:G}),(0,ve.BX)(It,{children:[(0,ve.BX)(u.Z,{condensed:!0,children:[(0,ve.tZ)(b.Z,{resetParamsOnChange:Lt}),(0,ve.tZ)(c.Z,{resetParamsOnChange:Lt}),(0,ve.tZ)(l.Z,{alignDropdown:"left",resetParamsOnChange:Lt})]}),I?(0,ve.tZ)(d.Z,{searchSource:"profile_summary",organization:n,projectIds:U.project,query:C,onSearch:R,maxQueryLength:S.dI}):(0,ve.tZ)(j.Z,{organization:n,hasRecentSearches:!0,searchSource:"profile_landing",supportedTags:A,query:C,onSearch:R,maxQueryLength:S.dI})]}),Q?(0,ve.BX)(Nt,{content:(0,ve.tZ)(y,{organization:n,fallback:(0,ve.BX)(i.Fragment,{children:[(0,ve.tZ)("h3",{children:(0,z.t)("Function level insights")}),(0,ve.tZ)("p",{children:(0,z.t)("Discover slow-to-execute or resource intensive functions within your application")})]})}),children:[(0,ve.tZ)(Z,{organization:n,priority:"primary",fallback:(0,ve.tZ)(a.zx,{onClick:$,priority:"primary",children:(0,z.t)("Set Up Profiling")}),children:(0,z.t)("Update plan")}),(0,ve.tZ)(a.zx,{href:"https://docs.sentry.io/product/profiling/",external:!0,children:(0,z.t)("Read Docs")})]}):(0,ve.BX)(i.Fragment,{children:[n.features.includes("profiling-global-suspect-functions")?(0,ve.BX)(i.Fragment,{children:[(0,ve.tZ)(at,{chartHeight:150,referrer:"api.profiling.landing-chart",userQuery:C,selection:r}),(0,ve.BX)(Ht,{children:[(0,ve.tZ)(et,{cursorName:qt,widgetHeight:"340px",defaultWidget:"slowest functions",query:C,storageKey:"profiling-landing-widget-0"}),(0,ve.tZ)(et,{cursorName:Et,widgetHeight:"340px",defaultWidget:"regressed functions",query:C,storageKey:"profiling-landing-widget-1"})]})]}):(0,ve.BX)(Ot,{children:[(0,ve.tZ)(ft,{}),(0,ve.tZ)(rt.A,{referrer:"api.profiling.landing-chart",query:C,selection:r,hideCount:!0})]}),(0,ve.tZ)(w.Q,{columns:O.slice(),data:"success"===W.status?W.data:null,error:"error"===W.status?(0,z.t)("Unable to load profiles"):null,isLoading:"loading"===W.status,sort:H,sortableColumns:new Set(O)}),(0,ve.tZ)(h.Z,{pageLinks:"success"===W.status?W.getResponseHeader?.("Link")??null:null})]})]})})]})})})}Xt.displayName="ProfilingContent";const Dt=["transaction","project.id","last_seen()","p75()","p95()","p99()","count()"],Mt=[...Dt,"user_misery()"],It=(0,r.Z)("div",{target:"emzmz062"})("display:grid;gap:",(0,C.D)(2),";grid-template-columns:min-content auto;margin-bottom:",(0,C.D)(2),";"),Ot=(0,r.Z)("div",{target:"emzmz061"})("display:grid;grid-template-columns:minmax(0, 1fr) 1fr;gap:",(0,C.D)(2),";@media (max-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:minmax(0, 1fr);}"),Ht=(0,r.Z)("div",{target:"emzmz060"})("display:grid;grid-template-columns:1fr 1fr;gap:",(0,C.D)(2),";@media (max-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:1fr;}"),At=Xt},"../node_modules/lodash/assign.js":(e,t,n)=>{var r=n("../node_modules/lodash/_assignValue.js"),i=n("../node_modules/lodash/_copyObject.js"),s=n("../node_modules/lodash/_createAssigner.js"),o=n("../node_modules/lodash/isArrayLike.js"),a=n("../node_modules/lodash/_isPrototype.js"),l=n("../node_modules/lodash/keys.js"),c=Object.prototype.hasOwnProperty,d=s((function(e,t){if(a(t)||o(t))i(t,l(t),e);else for(var n in t)c.call(t,n)&&r(e,n,t[n])}));e.exports=d},"./images/spot/profiling-empty-state.svg":(e,t,n)=>{"use strict";e.exports=n.p+"assets/profiling-empty-state.3d9aa14c30fece51de56.svg"}}]);
//# sourceMappingURL=../sourcemaps/app_views_profiling_content_tsx.b862b61240f457d964fd879586f3b066.js.map