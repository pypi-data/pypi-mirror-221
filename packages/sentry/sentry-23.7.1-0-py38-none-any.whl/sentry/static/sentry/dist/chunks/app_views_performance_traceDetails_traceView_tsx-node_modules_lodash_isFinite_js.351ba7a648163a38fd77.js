(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_traceDetails_traceView_tsx-node_modules_lodash_isFinite_js"],{"./app/utils/discover/discoverQuery.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>l,_:()=>o});var r=n("./app/utils/discover/genericDiscoverQuery.tsx"),s=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function i(e){return(0,s.tZ)(r.ZP,{route:"events",shouldRefetchData:a,afterFetch:(e,t)=>{const{fields:n,...r}=e.meta??{};return{...e,meta:{...n,...r}}},...e})}function o(e){const t=(0,r.JC)({route:"events",shouldRefetchData:a,afterFetch:(e,t)=>{const{fields:n,...r}=e.meta??{};return{...e,meta:{...n,...r}}},...e}),n=t.response?.getResponseHeader("Link")??void 0;return{...t,pageLinks:n}}i.displayName="DiscoverQuery";const l=i},"./app/views/performance/traceDetails/styles.tsx":(e,t,n)=>{"use strict";n.d(t,{$G:()=>D,CB:()=>m.wh,Iq:()=>f,LA:()=>b,RB:()=>y,W3:()=>Z,X2:()=>m.X2,Z9:()=>x,cC:()=>v,pH:()=>g,qD:()=>m.iF,uI:()=>w});var r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=n("./app/components/events/eventTags/eventTagsPill.tsx"),a=n("./app/components/events/interfaces/spans/header.tsx"),i=n("./app/components/panels/panel.tsx"),o=n("./app/components/pills.tsx"),l=n("./app/components/searchBar.tsx"),c=n("./app/styles/space.tsx"),d=n("./app/utils.tsx"),p=n("./app/utils/queryString.tsx"),h=n("./app/views/performance/transactionSummary/utils.tsx"),u=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),m=n("./app/components/events/interfaces/spans/spanDetail.tsx");const g=(0,r.Z)("div",{target:"evb4dv48"})({name:"7whenc",styles:"display:flex;width:100%"}),f=(0,r.Z)(l.Z,{target:"evb4dv47"})({name:"1ff36h2",styles:"flex-grow:1"}),v=(0,r.Z)(a.il,{target:"evb4dv46"})("border-top:none;border-bottom:1px solid ",(e=>e.theme.border),";position:sticky;top:0;z-index:1;"),x=(0,r.Z)("div",{target:"evb4dv45"})("display:grid;grid-template-columns:1fr;gap:",(0,c.D)(3),";margin-bottom:",(0,c.D)(2),";@media (min-width: ",(e=>e.theme.breakpoints.medium),"){grid-template-columns:max-content max-content;grid-row-gap:0;}"),Z=(0,r.Z)("div",{target:"evb4dv44"})({name:"13udsys",styles:"height:100%"}),w=(0,r.Z)("div",{target:"evb4dv43"})({name:"1wr20zt",styles:"overflow-x:hidden;border-bottom-left-radius:3px;border-bottom-right-radius:3px"}),b=(0,r.Z)(i.Z,{target:"evb4dv42"})({name:"1vsyufa",styles:"height:100%;overflow:auto"}),y=(0,r.Z)("span",{target:"evb4dv41"})("margin-right:",(0,c.D)(.75),";display:flex;flex-direction:column;justify-content:center;"),T=(0,r.Z)(o.Z,{target:"evb4dv40"})("padding-top:",(0,c.D)(1.5),";");function D(e){let{location:t,organization:n,transaction:r}=e;const{tags:a}=r;if(!a||a.length<=0)return null;const i=n.slug;return(0,u.BX)("tr",{children:[(0,u.tZ)("td",{className:"key",children:"Tags"}),(0,u.tZ)("td",{className:"value",children:(0,u.tZ)(T,{children:a.map(((e,a)=>{const{pathname:o,query:l}=(0,h.e1)({orgSlug:i,transaction:r.transaction,projectID:String(r.project_id),query:{...t.query,query:(0,p.os)(t.query.query,e.key,e.value)}});return(0,u.tZ)(s.Z,{tag:e,projectSlug:r.project_slug,projectId:r.project_id.toString(),organization:n,query:l,streamPath:o},(0,d.ri)(e.key)?e.key:`tag-pill-${a}`)}))})})]})}D.displayName="Tags"},"./app/views/performance/traceDetails/traceNotFound.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=n("../node_modules/react/index.js"),a=n("./app/components/alert.tsx"),i=n("./app/components/links/link.tsx"),o=n("./app/components/loadingError.tsx"),l=n("./app/components/loadingIndicator.tsx"),c=n("./app/components/performance/waterfall/rowDetails.tsx"),d=n("./app/locale.tsx"),p=n("./app/styles/space.tsx"),h=n("./app/utils/discover/discoverQuery.tsx"),u=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e){let{meta:t,traceEventView:n,traceSlug:r,organization:p,location:m}=e;if(0===(t?.transactions??0)&&(t?.errors??0)>0){const e=n.withColumns([{kind:"field",field:"project"},{kind:"field",field:"title"},{kind:"field",field:"issue.id"},{kind:"field",field:"level"}]);return e.query=`trace:${r} !event.type:transaction `,(0,u.tZ)(h.Z,{eventView:e,orgSlug:p.slug,location:m,referrer:"api.trace-view.errors-view",children:e=>{let{isLoading:t,tableData:n,error:r}=e;return t?(0,u.tZ)(l.Z,{}):r?(0,u.tZ)(a.bZ,{type:"error",showIcon:!0,children:(0,u.tZ)(g,{children:(0,d._N)("The trace cannot be shown when all events are errors. An error occurred when attempting to fetch these error events: [error]",{error:r.message})})}):(0,u.BX)(a.bZ,{type:"error",showIcon:!0,children:[(0,u.tZ)(g,{children:(0,d.t)("The trace cannot be shown when all events are errors.")}),(0,u.tZ)(c.TV,{"data-test-id":"trace-view-errors",children:n?.data.map((e=>(0,u.BX)(s.Fragment,{children:[(0,u.tZ)(c._U,{level:e.level}),(0,u.tZ)(c.wE,{children:e.level}),(0,u.tZ)(c.St,{children:(0,u.tZ)(i.Z,{to:`/organizations/${p.slug}/issues/${e["issue.id"]}/events/${e.id}?referrer=performance-trace-not-found`,children:e.title})})]},e.id)))})]})}})}return(0,u.tZ)(o.Z,{message:(0,d.t)("The trace you are looking for was not found.")})}m.displayName="TraceNotFound";const g=(0,r.Z)("div",{target:"effixob0"})("margin-bottom:",(0,p.D)(1),";"),f=m},"./app/views/performance/traceDetails/traceView.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>ue}),n("../node_modules/core-js/modules/es.array.push.js");var r=n("../node_modules/react/index.js"),s=n("../node_modules/@sentry/browser/node_modules/@sentry/core/esm/hub.js"),a=n("./app/components/events/interfaces/spans/dividerHandlerManager.tsx"),i=n("./app/components/events/interfaces/spans/measurementsPanel.tsx"),o=n("./app/components/events/interfaces/spans/scrollbarManager.tsx"),l=n("./app/components/events/interfaces/spans/utils.tsx"),c=n("./app/components/performance/waterfall/messageRow.tsx"),d=n("./app/components/performance/waterfall/miniHeader.tsx"),p=n("./app/components/performance/waterfall/utils.tsx"),h=n("./app/locale.tsx"),u=n("./app/utils/analytics.tsx"),m=n("./app/views/performance/traceDetails/styles.tsx"),g=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),f=n("./app/components/assistant/guideAnchor.tsx"),v=n("./app/components/count.tsx"),x=n("./app/components/events/interfaces/spans/styles.tsx"),Z=n("./app/components/idBadge/projectBadge.tsx"),w=n("./app/components/performance/waterfall/constants.tsx"),b=n("./app/components/performance/waterfall/row.tsx"),y=n("./app/components/performance/waterfall/rowBar.tsx"),T=n("./app/components/performance/waterfall/rowDivider.tsx"),D=n("./app/components/performance/waterfall/rowTitle.tsx"),_=n("./app/components/performance/waterfall/treeConnector.tsx"),C=n("./app/components/tooltip.tsx"),B=n("./app/utils.tsx"),S=n("./app/utils/performance/quickTrace/utils.tsx"),j=n("./app/utils/projects.tsx"),I=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),O=n("../node_modules/react-router/es/index.js"),X=n("../node_modules/lodash/omit.js"),R=n.n(X),E=n("./app/components/alert.tsx"),k=n("./app/components/button.tsx"),M=n("./app/components/copyToClipboardButton.tsx"),V=n("./app/components/dateTime.tsx"),z=n("./app/components/links/link.tsx"),$=n("./app/components/performance/waterfall/rowDetails.tsx"),A=n("./app/components/quickTrace/utils.tsx"),G=n("./app/constants/pageFilters.tsx"),H=n("./app/styles/space.tsx"),N=n("./app/utils/discover/urls.tsx"),F=n("./app/utils/getDynamicText.tsx"),P=n("./app/utils/performance/urls.ts"),L=n("./app/utils/performance/vitals/constants.tsx"),q=n("./app/utils/performanceForSentry/index.tsx"),U=n("./app/utils/profiling/routes.tsx"),W=n("./app/views/performance/transactionSummary/utils.tsx"),Q=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class Y extends r.Component{constructor(){super(...arguments),(0,g.Z)(this,"scrollBarIntoView",(e=>t=>{t.preventDefault();const n=`#txn-${e}`;this.props.scrollIntoView(),O.browserHistory.push({...this.props.location,hash:n})}))}componentDidMount(){const{organization:e,transaction:t}=this.props;(0,u.Gi)("performance_views.trace_view.open_transaction_details",{organization:e,operation:t["transaction.op"],transaction:t.transaction})}renderTransactionErrors(){const{organization:e,transaction:t}=this.props,{errors:n,performance_issues:r}=t;return n.length+r.length===0?null:(0,Q.tZ)(E.bZ,{system:!0,type:"error",expand:[...n,...r].map((t=>(0,Q.BX)($.TV,{children:[(0,Q.tZ)($._U,{level:t.level}),(0,Q.tZ)($.wE,{children:t.level}),(0,Q.tZ)($.St,{children:(0,Q.tZ)(z.Z,{to:(0,A.F7)(t,e),children:t.title})})]},t.event_id))),children:(0,Q.tZ)($.CM,{children:(0,h.tn)("%s issue occurred in this transaction.","%s issues occurred in this transaction.",n.length+r.length)})})}renderGoToTransactionButton(){const{location:e,organization:t,transaction:n}=this.props,r=(0,N.JE)({id:n.event_id,project:n.project_slug}),s=(0,P.D)(t.slug,r,n.transaction,R()(e.query,Object.values(G.V)));return(0,Q.tZ)(K,{size:"xs",to:s,children:(0,h.t)("View Event")})}renderGoToSummaryButton(){const{location:e,organization:t,transaction:n}=this.props,r=(0,W.e1)({orgSlug:t.slug,transaction:n.transaction,query:R()(e.query,Object.values(G.V)),projectID:String(n.project_id)});return(0,Q.tZ)(K,{size:"xs",to:r,children:(0,h.t)("View Summary")})}renderGoToProfileButton(){const{organization:e,transaction:t}=this.props;if(!t.profile_id)return null;const n=(0,U.O$)({orgSlug:e.slug,projectSlug:t.project_slug,profileId:t.profile_id});return(0,Q.tZ)(K,{size:"xs",to:n,onClick:function(){(0,u.Gi)("profiling_views.go_to_flamegraph",{organization:e,source:"performance.trace_view"})},children:(0,h.t)("View Profile")})}renderMeasurements(){const{transaction:e}=this.props,{measurements:t={}}=e,n=Object.keys(t).filter((e=>Boolean(L.r9[`measurements.${e}`]))).sort();return n.length<=0?null:(0,Q.tZ)(r.Fragment,{children:n.map((e=>(0,Q.tZ)(m.X2,{title:L.r9[`measurements.${e}`]?.name,children:`${Number(t[e].value.toFixed(3)).toLocaleString()}ms`},e)))})}renderTransactionDetail(){const{location:e,organization:t,transaction:n}=this.props,s=Math.min(n.start_timestamp,n.timestamp),a=Math.max(n.start_timestamp,n.timestamp),{start:i,end:o}=(0,l.Zv)(s,a),c=`${Number((1e3*(a-s)).toFixed(3)).toLocaleString()}ms`;return(0,Q.tZ)(m.qD,{children:(0,Q.tZ)("table",{className:"table key-value",children:(0,Q.BX)("tbody",{children:[(0,Q.BX)(m.X2,{title:(0,Q.tZ)(J,{onClick:this.scrollBarIntoView(n.event_id),children:(0,h.t)("Event ID")}),extra:this.renderGoToTransactionButton(),children:[n.event_id,(0,Q.tZ)(M.m,{borderless:!0,size:"zero",iconSize:"xs",text:`${window.location.href.replace(window.location.hash,"")}#txn-${n.event_id}`})]}),(0,Q.tZ)(m.X2,{title:"Transaction",extra:this.renderGoToSummaryButton(),children:n.transaction}),(0,Q.tZ)(m.X2,{title:"Transaction Status",children:n["transaction.status"]}),(0,Q.tZ)(m.X2,{title:"Span ID",children:n.span_id}),n.profile_id&&(0,Q.tZ)(m.X2,{title:"Profile ID",extra:this.renderGoToProfileButton(),children:n.profile_id}),(0,Q.tZ)(m.X2,{title:"Project",children:n.project_slug}),(0,Q.tZ)(m.X2,{title:"Start Date",children:(0,F.Z)({fixed:"Mar 19, 2021 11:06:27 AM UTC",value:(0,Q.BX)(r.Fragment,{children:[(0,Q.tZ)(V.Z,{date:1e3*s}),` (${i})`]})})}),(0,Q.tZ)(m.X2,{title:"End Date",children:(0,F.Z)({fixed:"Mar 19, 2021 11:06:28 AM UTC",value:(0,Q.BX)(r.Fragment,{children:[(0,Q.tZ)(V.Z,{date:1e3*a}),` (${o})`]})})}),(0,Q.tZ)(m.X2,{title:"Duration",children:c}),(0,Q.tZ)(m.X2,{title:"Operation",children:n["transaction.op"]||""}),this.renderMeasurements(),(0,Q.tZ)(m.$G,{location:e,organization:t,transaction:n})]})})})}render(){return(0,Q.tZ)(q.C6,{id:"TransactionDetail",children:(0,Q.BX)(m.CB,{onClick:e=>{e.stopPropagation()},children:[this.renderTransactionErrors(),this.renderTransactionDetail()]})})}}Y.displayName="TransactionDetail";const J=(0,I.Z)("a",{target:"ehk3o3f1"})("display:flex;color:",(e=>e.theme.textColor),";:hover{color:",(e=>e.theme.textColor),";}"),K=(0,I.Z)(k.zx,{target:"ehk3o3f0"})("position:absolute;top:",(0,H.D)(.75),";right:",(0,H.D)(.5),";"),ee=Y;class te extends r.Component{constructor(){super(...arguments),(0,g.Z)(this,"state",{showDetail:!1}),(0,g.Z)(this,"transactionRowDOMRef",(0,r.createRef)()),(0,g.Z)(this,"transactionTitleRef",(0,r.createRef)()),(0,g.Z)(this,"spanContentRef",null),(0,g.Z)(this,"toggleDisplayDetail",(()=>{const{transaction:e}=this.props;(0,S.Ci)(e)&&this.setState((e=>({showDetail:!e.showDetail})))})),(0,g.Z)(this,"handleWheel",(e=>{if(Math.abs(e.deltaY)>Math.abs(e.deltaX))return;if(e.preventDefault(),e.stopPropagation(),Math.abs(e.deltaY)===Math.abs(e.deltaX))return;const{onWheel:t}=this.props;t(e.deltaX)})),(0,g.Z)(this,"scrollIntoView",(()=>{const e=this.transactionRowDOMRef.current;if(!e)return;const t=e.getBoundingClientRect().top+window.scrollY;this.setState({showDetail:!0},(()=>window.scrollTo(0,t)))}))}componentDidMount(){const{location:e,transaction:t}=this.props;"event_id"in t&&(0,l.KQ)(t.event_id)===e.hash&&this.scrollIntoView(),this.transactionTitleRef.current&&this.transactionTitleRef.current.addEventListener("wheel",this.handleWheel,{passive:!1})}componentWillUnmount(){this.transactionTitleRef.current&&this.transactionTitleRef.current.removeEventListener("wheel",this.handleWheel)}getCurrentOffset(){const{transaction:e}=this.props,{generation:t}=e;return ne(t)}renderMeasurements(){const{measurements:e,generateBounds:t}=this.props;return e?(0,Q.tZ)(r.Fragment,{children:Array.from(e.values()).map((e=>{const n=Object.values(e.marks)[0],{timestamp:r}=n,s=(0,l.vu)(r,t);return(0,B.ri)(s.left)&&(0,B.ri)(s.width)&&s.isSpanVisibleInView?(0,Q.tZ)(x.a,{style:{left:`clamp(0%, ${(0,p.yI)(s.left||0)}, calc(100% - 1px))`},failedThreshold:e.failedThreshold},String(r)):null}))}):null}renderConnector(e){const{continuingDepths:t,isExpanded:n,isOrphan:r,isLast:s,transaction:a}=this.props,{generation:i}=a,o=(0,S.Ci)(a)?a.event_id:a.traceSlug;if(0===i)return e?(0,Q.tZ)(_.UV,{style:{right:"15px",height:"10px",bottom:"-5px",top:"auto"},orphanBranch:!1}):null;const l=t.map((e=>{let{depth:t,isOrphanDepth:n}=e;if(i-t<=1)return null;const r=-1*ne(i-t-1)-2;return(0,Q.tZ)(_.UV,{style:{left:r},orphanBranch:n},`${o}-${t}`)}));return e&&n&&l.push((0,Q.tZ)(_.UV,{style:{right:"15px",height:"10px",bottom:s?`-${w.dN/2+1}px`:"0",top:"auto"},orphanBranch:!1},`${o}-last`)),(0,Q.tZ)(_.DN,{isLast:s,hasToggler:e,orphanBranch:r,children:l})}renderToggle(e){const{isExpanded:t,transaction:n,toggleExpandedState:r}=this.props,{children:s,generation:a}=n,i=this.getCurrentOffset();if(s.length<=0)return(0,Q.tZ)(_.rw,{style:{left:`${i}px`},children:this.renderConnector(!1)});const o=0===a;return(0,Q.BX)(_.rw,{style:{left:`${i}px`},hasToggler:!0,children:[this.renderConnector(!0),(0,Q.BX)(_.U1,{disabled:o,isExpanded:t,errored:e,onClick:e=>{e.stopPropagation(),o||r()},children:[(0,Q.tZ)(v.Z,{value:s.length}),!o&&(0,Q.tZ)("div",{children:(0,Q.tZ)(_.jd,{direction:t?"up":"down"})})]})]})}renderTitle(e){const{organization:t,transaction:n,addContentSpanBarRef:s,removeContentSpanBarRef:a}=this.props,i=this.getCurrentOffset(),o=!!(0,S.Ci)(n)&&n.errors.length+n.performance_issues.length>0,l=(0,S.Ci)(n)?(0,Q.BX)(r.Fragment,{children:[(0,Q.tZ)(j.Z,{orgId:t.slug,slugs:[n.project_slug],children:e=>{let{projects:t}=e;const r=t.find((e=>e.slug===n.project_slug));return(0,Q.tZ)(m.RB,{children:(0,Q.tZ)(C.u,{title:n.project_slug,children:(0,Q.tZ)(Z.Z,{project:r||{slug:n.project_slug},avatarSize:16,hideName:!0})})})}}),(0,Q.BX)(D.rv,{errored:o,children:[(0,Q.BX)("strong",{children:[n["transaction.op"]," — "]}),n.transaction]})]}):(0,Q.BX)(D.rv,{errored:!1,children:[(0,Q.tZ)("strong",{children:"Trace — "}),n.traceSlug]});return(0,Q.BX)(D.mw,{ref:e=>{e?(s(e),this.spanContentRef=e):a(this.spanContentRef)},children:[this.renderToggle(o),(0,Q.tZ)(D.Wh,{style:{left:`${i}px`,width:"100%"},children:l})]})}renderDivider(e){if(this.state.showDetail)return(0,Q.tZ)(T.xN,{showDetail:!0,style:{position:"absolute"}});const{addDividerLineRef:t}=e;return(0,Q.tZ)(T.xN,{ref:t(),style:{position:"absolute"},onMouseEnter:()=>{e.setHover(!0)},onMouseLeave:()=>{e.setHover(!1)},onMouseOver:()=>{e.setHover(!0)},onMouseDown:e.onDragStart,onClick:e=>{e.stopPropagation()}})}renderGhostDivider(e){const{dividerPosition:t,addGhostDividerLineRef:n}=e;return(0,Q.tZ)(T.Hr,{style:{width:`calc(${(0,p.yI)(t)} + 0.5px)`,display:"none"},children:(0,Q.tZ)(T.xN,{ref:n(),style:{right:0},className:"hovering",onClick:e=>{e.stopPropagation()}})})}renderErrorBadge(){const{transaction:e}=this.props;return(0,S.Ci)(e)&&e.errors.length+e.performance_issues.length?(0,Q.tZ)(T.cS,{}):null}renderRectangle(){const{transaction:e,traceInfo:t,barColor:n}=this.props,{showDetail:r}=this.state,s=Math.abs(t.endTimestamp-t.startTimestamp)||1,a=Math.abs(e.start_timestamp-t.startTimestamp)/s,i=Math.abs(e.timestamp-e.start_timestamp),o=i/s;return(0,Q.BX)(y.e,{style:{backgroundColor:n,left:`min(${(0,p.yI)(a||0)}, calc(100% - 1px))`,width:(0,p.yI)(o||0)},children:[this.renderPerformanceIssues(),(0,Q.tZ)(y.R,{durationDisplay:(0,p.ud)({left:a,width:o}),showDetail:r,children:(0,p.bQ)(i)})]})}renderPerformanceIssues(){const{transaction:e,barColor:t}=this.props;if(!(0,S.Ci)(e))return null;const n=[],r=Math.abs(e.timestamp-e.start_timestamp)||1;for(let s=0;s<e.performance_issues.length;s++){const a=e.performance_issues[s],i=Math.abs(a.start-e.start_timestamp)/r,o=Math.abs(a.end-a.start)/r;n.push((0,Q.tZ)(y.e,{style:{backgroundColor:t,left:`min(${(0,p.yI)(i||0)}, calc(100% - 1px))`,width:(0,p.yI)(o||0)},spanBarType:w.il.AFFECTED}))}return n}renderHeader(e){let{dividerHandlerChildrenProps:t,scrollbarManagerChildrenProps:n}=e;const{hasGuideAnchor:r,index:s}=this.props,{showDetail:a}=this.state,{dividerPosition:i}=t;return(0,Q.BX)(b.Qc,{showDetail:a,children:[(0,Q.tZ)(b.E5,{"data-test-id":"transaction-row-title","data-type":"span-row-cell",style:{width:`calc(${(0,p.yI)(i)} - 0.5px)`,paddingTop:0},showDetail:a,onClick:this.toggleDisplayDetail,ref:this.transactionTitleRef,children:(0,Q.tZ)(f.Z,{target:"trace_view_guide_row",disabled:!r,children:this.renderTitle(n)})}),(0,Q.BX)(T.kP,{children:[this.renderDivider(t),this.renderErrorBadge()]}),(0,Q.BX)(b.E5,{"data-test-id":"transaction-row-duration","data-type":"span-row-cell",showStriping:s%2!=0,style:{width:`calc(${(0,p.yI)(1-i)} - 0.5px)`,paddingTop:0},showDetail:a,onClick:this.toggleDisplayDetail,children:[(0,Q.tZ)(b.EF,{}),(0,Q.BX)(f.Z,{target:"trace_view_guide_row_details",disabled:!r,children:[this.renderRectangle(),this.renderMeasurements()]})]}),!a&&this.renderGhostDivider(t)]})}renderDetail(){const{location:e,organization:t,isVisible:n,transaction:r}=this.props,{showDetail:s}=this.state;return(0,S.Ci)(r)&&n&&s?(0,Q.tZ)(ee,{location:e,organization:t,transaction:r,scrollIntoView:this.scrollIntoView}):null}render(){const{isVisible:e,transaction:t}=this.props,{showDetail:n}=this.state;return(0,Q.BX)(b.X2,{ref:this.transactionRowDOMRef,visible:e,showBorder:n,cursor:(0,S.Ci)(t)?"pointer":"default",children:[(0,Q.tZ)(o.$6,{children:e=>(0,Q.tZ)(a.$,{children:t=>this.renderHeader({dividerHandlerChildrenProps:t,scrollbarManagerChildrenProps:e})})}),this.renderDetail()]})}}function ne(e){return e*(_.Ll/2)+0}te.displayName="TransactionBar";const re=te;class se extends r.Component{constructor(){super(...arguments),(0,g.Z)(this,"state",{isExpanded:!0}),(0,g.Z)(this,"toggleExpandedState",(()=>{this.setState((e=>{let{isExpanded:t}=e;return{isExpanded:!t}}))}))}componentDidUpdate(e,t){t.isExpanded!==this.state.isExpanded&&this.props.updateScrollState()}render(){const{location:e,organization:t,transaction:n,traceInfo:s,continuingDepths:a,isOrphan:i,isLast:o,index:l,isVisible:c,hasGuideAnchor:d,renderedChildren:p,barColor:h,addContentSpanBarRef:u,removeContentSpanBarRef:m,onWheel:g,measurements:f,generateBounds:v}=this.props,{isExpanded:x}=this.state;return(0,Q.BX)(r.Fragment,{children:[(0,Q.tZ)(re,{location:e,organization:t,measurements:f,generateBounds:v,index:l,transaction:n,traceInfo:s,continuingDepths:a,isOrphan:i,isLast:o,isExpanded:x,toggleExpandedState:this.toggleExpandedState,isVisible:c,hasGuideAnchor:d,barColor:h,addContentSpanBarRef:u,removeContentSpanBarRef:m,onWheel:g}),x&&p]})}}se.displayName="TransactionGroup";const ae=(0,o.Iw)(se);var ie=n("./app/views/performance/traceDetails/utils.tsx"),oe=n("./app/components/discover/discoverFeature.tsx");function le(e){let{traceInfo:t,traceEventView:n,organization:r,meta:s}=e;const a=t.transactions.size,i=s?.transactions??a;if(null===i||a>=i)return null;const o=n.getResultsViewUrlTarget(r.slug);return(0,Q.tZ)(c.V,{children:(0,h._N)("Limited to a view of [count] transactions. To view the full list, [discover].",{count:a,discover:(0,Q.tZ)(oe.Z,{children:e=>{let{hasFeature:t}=e;return(0,Q.tZ)(z.Z,{disabled:!t,to:o,children:(0,h.t)("Open in Discover")})}})})})}le.displayName="LimitExceededMessage";const ce=le;var de=n("./app/views/performance/traceDetails/traceNotFound.tsx");function pe(e){let{isVisible:t,numberOfHiddenTransactionsAbove:n}=e;return!t||n<1?null:(0,Q.tZ)(c.V,{children:(0,Q.tZ)("span",{children:1===n?(0,h._N)("[numOfTransaction] hidden transaction",{numOfTransaction:(0,Q.tZ)("strong",{children:n})}):(0,h._N)("[numOfTransaction] hidden transactions",{numOfTransaction:(0,Q.tZ)("strong",{children:n})})},"trace-info-message")})}function he(e){return(0,l.IG)({traceStartTimestamp:e.startTimestamp,traceEndTimestamp:e.endTimestamp,viewStart:0,viewEnd:1})}function ue(e){let{location:t,meta:n,organization:c,traces:h,traceSlug:g,traceEventView:f,filteredTransactionIds:v,...x}=e;const Z=s.Gd().getScope()?.getTransaction(),w=Z?.startChild({op:"trace.render",description:"trace-view-content"});function b(e,n){let{continuingDepths:s,isOrphan:a,isLast:i,index:o,numberOfHiddenTransactionsAbove:d,traceInfo:u,hasGuideAnchor:m}=n;const{children:g,event_id:f}=e,x=e.generation+1,Z=function(e,t){return!t||t.has(e.event_id)}(e,v),w=g.reduce(((e,t,n)=>{const r=n===g.length-1,i=t.children.length>0,o=b(t,{continuingDepths:!r&&i?[...s,{depth:x,isOrphanDepth:a}]:s,isOrphan:a,isLast:r,index:e.lastIndex+1,numberOfHiddenTransactionsAbove:e.numberOfHiddenTransactionsAbove,traceInfo:u,hasGuideAnchor:!1});return e.lastIndex=o.lastIndex,e.numberOfHiddenTransactionsAbove=o.numberOfHiddenTransactionsAbove,e.renderedChildren.push(o.transactionGroup),e}),{renderedChildren:[],lastIndex:o,numberOfHiddenTransactionsAbove:Z?0:d+1});return{transactionGroup:(0,Q.BX)(r.Fragment,{children:[(0,Q.tZ)(pe,{isVisible:Z,numberOfHiddenTransactionsAbove:d}),(0,Q.tZ)(ae,{location:t,organization:c,traceInfo:u,transaction:{...e,generation:x},measurements:h&&h.length>0?(0,l.is)(h[0],he(u)):void 0,generateBounds:he(u),continuingDepths:s,isOrphan:a,isLast:i,index:o,isVisible:Z,hasGuideAnchor:m,renderedChildren:w.renderedChildren,barColor:(0,p.hd)(e["transaction.op"])})]},f),lastIndex:w.lastIndex,numberOfHiddenTransactionsAbove:w.numberOfHiddenTransactionsAbove}}(0,r.useEffect)((()=>{(0,u.Gi)("performance_views.trace_view.view",{organization:c})}),[c]);const y=(0,r.createRef)(),T=(0,r.createRef)();if(null===h||h.length<=0)return(0,Q.tZ)(de.Z,{meta:n,traceEventView:f,traceSlug:g,location:t,organization:c});const D=x.traceInfo||(0,ie.Rg)(h),_={index:1,numberOfHiddenTransactionsAbove:0,traceInfo:D,transactionGroups:[]},{transactionGroups:C,numberOfHiddenTransactionsAbove:B}=h.reduce(((e,t,n)=>{const r=n===h.length-1,s=t.children.length>0,a=!r&&null!==h[n+1].parent_span_id,i=b(t,{...e,isOrphan:!(0,ie.uM)(t),isLast:r,continuingDepths:!r&&s?[{depth:0,isOrphanDepth:a}]:[],hasGuideAnchor:0===n});return e.index=i.lastIndex+1,e.numberOfHiddenTransactionsAbove=i.numberOfHiddenTransactionsAbove,e.transactionGroups.push(i.transactionGroup),e}),_),S=he(D),j=Object.keys(h[0].measurements??{}).length>0?(0,l.is)(h[0],S):void 0,I=(0,Q.tZ)(m.W3,{children:(0,Q.tZ)(a.z,{interactiveLayerRef:y,children:(0,Q.tZ)(a.$,{children:e=>{let{dividerPosition:r}=e;return(0,Q.tZ)(o.zt,{dividerPosition:r,interactiveLayerRef:T,children:(0,Q.BX)(m.LA,{children:[(0,Q.BX)(m.cC,{children:[(0,Q.tZ)(o.$6,{children:e=>{let{virtualScrollbarRef:t,scrollBarAreaRef:n,onDragStart:s,onScroll:a}=e;return(0,Q.BX)(d.cs,{ref:T,style:{width:`calc(${(0,p.yI)(r)} - 0.5px)`},onScroll:a,children:[(0,Q.tZ)("div",{style:{width:0,height:"1px"},ref:n}),(0,Q.tZ)(d.Qk,{"data-type":"virtual-scrollbar",ref:t,onMouseDown:s,children:(0,Q.tZ)(d.v6,{})})]})}}),(0,Q.tZ)(d._i,{}),j?(0,Q.tZ)(i.Z,{measurements:j,generateBounds:S,dividerPosition:r}):null]}),(0,Q.BX)(m.uI,{ref:y,children:[(0,Q.tZ)(ae,{location:t,organization:c,traceInfo:D,transaction:{traceSlug:g,generation:0,"transaction.duration":D.endTimestamp-D.startTimestamp,children:h,start_timestamp:D.startTimestamp,timestamp:D.endTimestamp},measurements:j,generateBounds:S,continuingDepths:[],isOrphan:!1,isLast:!1,index:0,isVisible:!0,hasGuideAnchor:!1,renderedChildren:C,barColor:(0,p.hd)("")}),(0,Q.tZ)(pe,{isVisible:!0,numberOfHiddenTransactionsAbove:B}),(0,Q.tZ)(ce,{traceInfo:D,organization:c,traceEventView:f,meta:n})]})]})})}})})});return w?.finish(),I}pe.displayName="TraceHiddenMessage"},"../node_modules/lodash/isFinite.js":(e,t,n)=>{var r=n("../node_modules/lodash/_root.js").isFinite;e.exports=function(e){return"number"==typeof e&&r(e)}}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_traceDetails_traceView_tsx-node_modules_lodash_isFinite_js.81648395bd5d0db9cb0d2532953ec6be.js.map