"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_traceDetails_index_tsx-app_views_performance_vitalDetail_utils_tsx"],{"./app/utils/fuzzySearch.tsx":(e,t,r)=>{r.d(t,{I:()=>n}),r("../node_modules/core-js/modules/es.error.cause.js");const s={includeScore:!0,includeMatches:!0,threshold:.4,location:0,distance:75,minMatchCharLength:2};async function n(e,t){if(!t.keys)throw new Error("You need to define `options.keys`");return new((await r.e("vendors-node_modules_fuse_js_dist_fuse_esm_js").then(r.bind(r,"../node_modules/fuse.js/dist/fuse.esm.js"))).default)(e,{...s,...t})}},"./app/utils/performance/quickTrace/traceFullQuery.tsx":(e,t,r)=>{r.d(t,{H:()=>u,g:()=>d});var s=r("../node_modules/react/index.js"),n=r("./app/utils/discover/genericDiscoverQuery.tsx"),a=r("./app/utils/performance/quickTrace/utils.tsx"),i=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){let{detailed:t,eventId:r,...s}=e;const n=(0,a.eF)(s);return n.detailed=t?"1":"0",r&&(n.event_id=r),n}function c(e){let{children:t}=e;return(0,i.tZ)(s.Fragment,{children:t({isLoading:!1,error:null,traces:null,type:"full"})})}function l(e){let{traceId:t,start:r,end:s,statsPeriod:l,children:d,...u}=e;if(!t)return(0,i.tZ)(c,{children:d});const p=(0,a._Z)({start:r,end:s,statsPeriod:l});return(0,i.tZ)(n.ZP,{route:`events-trace/${t}`,getRequestPayload:o,eventView:p,...u,children:e=>{let{tableData:t,...r}=e;return d({traces:t||null,type:"full",...r})}})}function d(e){return(0,i.tZ)(l,{...e,detailed:!1})}function u(e){return(0,i.tZ)(l,{...e,detailed:!0})}c.displayName="EmptyTrace",l.displayName="GenericTraceFullQuery",d.displayName="TraceFullQuery",u.displayName="TraceFullDetailedQuery"},"./app/utils/performance/quickTrace/traceMetaQuery.tsx":(e,t,r)=>{r.d(t,{Z:()=>c});var s=r("../node_modules/react/index.js"),n=r("./app/utils/discover/genericDiscoverQuery.tsx"),a=r("./app/utils/performance/quickTrace/utils.tsx"),i=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){let{traceId:t,start:r,end:o,statsPeriod:c,children:l,...d}=e;if(!t)return(0,i.tZ)(s.Fragment,{children:l({isLoading:!1,error:null,meta:null})});const u=(0,a._Z)({start:r,end:o,statsPeriod:c});return(0,i.tZ)(n.ZP,{route:`events-trace-meta/${t}`,getRequestPayload:a.eF,eventView:u,...d,children:e=>{let{tableData:t,...r}=e;return l({meta:t,...r})}})}o.displayName="TraceMetaQuery";const c=o},"./app/views/performance/traceDetails/index.tsx":(e,t,r)=>{r.r(t),r.d(t,{default:()=>H});var s=r("../node_modules/react/index.js"),n=r("./app/components/layouts/thirds.tsx"),a=r("./app/components/noProjectMessage.tsx"),i=r("./app/components/organizations/pageFilters/parse.tsx"),o=r("./app/components/sentryDocumentTitle.tsx"),c=r("./app/constants/pageFilters.tsx"),l=r("./app/locale.tsx"),d=r("./app/utils/discover/eventView.tsx"),u=r("./app/utils/discover/genericDiscoverQuery.tsx"),p=r("./app/utils/performance/quickTrace/traceFullQuery.tsx"),h=r("./app/utils/performance/quickTrace/traceMetaQuery.tsx"),m=r("./app/utils/queryString.tsx"),g=r("./app/utils/withApi.tsx"),f=r("./app/utils/withOrganization.tsx"),Z=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),x=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),y=(r("../node_modules/core-js/modules/es.array.push.js"),r("./app/components/alert.tsx")),v=r("./app/components/assistant/guideAnchor.tsx"),w=r("./app/components/buttonBar.tsx"),T=r("./app/components/discoverButton.tsx"),P=r("./app/components/links/externalLink.tsx"),b=r("./app/components/loadingError.tsx"),S=r("./app/components/loadingIndicator.tsx"),D=r("./app/components/timeSince.tsx"),C=r("./app/styles/space.tsx"),R=r("./app/utils.tsx"),F=r("./app/utils/analytics.tsx"),L=r("./app/utils/formatters.tsx"),A=r("./app/utils/fuzzySearch.tsx"),I=r("./app/utils/getDynamicText.tsx"),_=r("./app/utils/performance/quickTrace/utils.tsx"),E=r("./app/utils/performanceForSentry/index.tsx"),k=r("./app/views/performance/breadcrumb.tsx"),j=r("./app/views/performance/transactionDetails/styles.tsx"),O=r("./app/views/performance/traceDetails/styles.tsx"),M=r("./app/views/performance/traceDetails/traceNotFound.tsx"),q=r("./app/views/performance/traceDetails/traceView.tsx"),z=r("./app/views/performance/traceDetails/utils.tsx"),V=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class Q extends s.Component{constructor(){super(...arguments),(0,Z.Z)(this,"state",{searchQuery:void 0,filteredTransactionIds:void 0}),(0,Z.Z)(this,"fuse",null),(0,Z.Z)(this,"traceViewRef",(0,s.createRef)()),(0,Z.Z)(this,"virtualScrollbarContainerRef",(0,s.createRef)()),(0,Z.Z)(this,"handleTransactionFilter",(e=>{this.setState({searchQuery:e||void 0},this.filterTransactions)})),(0,Z.Z)(this,"filterTransactions",(()=>{const{traces:e}=this.props,{filteredTransactionIds:t,searchQuery:r}=this.state;if(!r||null===e||e.length<=0||!(0,R.ri)(this.fuse))return void(void 0!==t&&this.setState({filteredTransactionIds:void 0}));const s=this.fuse.search(r).filter((e=>{let{matches:t}=e;return t?.length})).map((e=>{let{item:t}=e;return t.transaction.event_id})),n=e.flatMap((e=>(0,_.xB)(e,(e=>{let{event_id:t,span_id:s}=e;return t.includes(r)||s.includes(r)})))).map((e=>e.event_id));this.setState({filteredTransactionIds:new Set([...s,...n])})}))}componentDidMount(){this.initFuse()}componentDidUpdate(e){this.props.traces!==e.traces&&this.initFuse()}async initFuse(){if((0,R.ri)(this.props.traces)&&this.props.traces.length>0){const e=this.props.traces.flatMap((e=>(0,_.S2)(e,((e,t)=>{const r=[t["transaction.op"],t.transaction,t.project_slug];return e.push({transaction:t,indexed:r}),e}),[])));this.fuse=await(0,A.I)(e,{keys:["indexed"],includeMatches:!0,threshold:.6,location:0,distance:100,maxPatternLength:32})}}renderTraceLoading(){return(0,V.tZ)(S.Z,{})}renderTraceRequiresDateRangeSelection(){return(0,V.tZ)(b.Z,{message:(0,l.t)("Trace view requires a date range selection.")})}renderSearchBar(){return(0,V.tZ)(O.pH,{children:(0,V.tZ)(O.Iq,{defaultQuery:"",query:this.state.searchQuery||"",placeholder:(0,l.t)("Search for transactions"),onSearch:this.handleTransactionFilter})})}renderTraceHeader(e){const{meta:t}=this.props,r=t?.errors??e.errors.size,s=t?.performance_issues??e.performanceIssues.size;return(0,V.BX)(O.Z9,{children:[(0,V.tZ)(v.Z,{target:"trace_view_guide_breakdown",children:(0,V.tZ)(j.U,{headingText:(0,l.t)("Event Breakdown"),tooltipText:(0,l.t)("The number of transactions and issues there are in this trace."),bodyText:(0,l._N)("[transactions]  |  [errors]",{transactions:(0,l.tn)("%s Transaction","%s Transactions",t?.transactions??e.transactions.size),errors:(0,l.tn)("%s Issue","%s Issues",r+s)}),subtext:(0,l.tn)("Across %s project","Across %s projects",t?.projects??e.projects.size)})}),(0,V.tZ)(j.U,{headingText:(0,l.t)("Total Duration"),tooltipText:(0,l.t)("The time elapsed between the start and end of this trace."),bodyText:(0,L.g9)(e.endTimestamp-e.startTimestamp,2,!0),subtext:(0,I.Z)({value:(0,V.tZ)(D.Z,{date:1e3*(e.endTimestamp||0)}),fixed:"5 days ago"})})]})}renderTraceWarnings(){const{traces:e}=this.props,{roots:t,orphans:r}=(e??[]).reduce(((e,t)=>((0,z.uM)(t)?e.roots++:e.orphans++,e)),{roots:0,orphans:0});let s=null;return 0===t&&r>0?s=(0,V.tZ)(y.bZ,{type:"info",showIcon:!0,children:(0,V.tZ)(P.Z,{href:"https://docs.sentry.io/product/performance/trace-view/#orphan-traces-and-broken-subtraces",children:(0,l.t)("A root transaction is missing. Transactions linked by a dashed line have been orphaned and cannot be directly linked to the root.")})}):1===t&&r>0?s=(0,V.tZ)(y.bZ,{type:"info",showIcon:!0,children:(0,V.tZ)(P.Z,{href:"https://docs.sentry.io/product/performance/trace-view/#orphan-traces-and-broken-subtraces",children:(0,l.t)("This trace has broken subtraces. Transactions linked by a dashed line have been orphaned and cannot be directly linked to the root.")})}):t>1&&(s=(0,V.tZ)(y.bZ,{type:"info",showIcon:!0,children:(0,V.tZ)(P.Z,{href:"https://docs.sentry.io/product/sentry-basics/tracing/trace-view/#multiple-roots",children:(0,l.t)("Multiple root transactions have been found with this trace ID.")})})),s}renderContent(){const{dateSelected:e,isLoading:t,error:r,organization:n,location:a,traceEventView:i,traceSlug:o,traces:c,meta:l}=this.props;if(!e)return this.renderTraceRequiresDateRangeSelection();if(t)return this.renderTraceLoading();if(null!==r||null===c||c.length<=0)return(0,V.tZ)(M.Z,{meta:l,traceEventView:i,traceSlug:o,location:a,organization:n});const d=(0,z.Rg)(c);return(0,V.BX)(s.Fragment,{children:[this.renderTraceWarnings(),this.renderTraceHeader(d),this.renderSearchBar(),(0,V.tZ)(N,{children:(0,V.tZ)(E.oF,{id:"PerformanceDetails-TraceView",hasData:!!c.length,children:(0,V.tZ)(q.Z,{filteredTransactionIds:this.state.filteredTransactionIds,traceInfo:d,location:a,organization:n,traceEventView:i,traceSlug:o,traces:c,meta:l})})})]})}render(){const{organization:e,location:t,traceEventView:r,traceSlug:a}=this.props;return(0,V.BX)(s.Fragment,{children:[(0,V.BX)(n.h4,{children:[(0,V.BX)(n.oB,{children:[(0,V.tZ)(k.Z,{organization:e,location:t,traceSlug:a}),(0,V.tZ)(n.Dx,{"data-test-id":"trace-header",children:(0,l.t)("Trace ID: %s",a)})]}),(0,V.tZ)(n.kP,{children:(0,V.tZ)(w.ZP,{gap:1,children:(0,V.tZ)(T.Z,{size:"sm",to:r.getResultsViewUrlTarget(e.slug),onClick:()=>{(0,F.Gi)("performance_views.trace_view.open_in_discover",{organization:e})},children:(0,l.t)("Open in Discover")})})})]}),(0,V.tZ)(n.uT,{children:(0,V.tZ)(n.or,{fullWidth:!0,children:this.renderContent()})})]})}}Q.displayName="TraceDetailsContent";const N=(0,x.Z)("div",{target:"epic5s0"})("margin-top:",(0,C.D)(2),";"),B=Q;class G extends s.Component{getDocumentTitle(){return[(0,l.t)("Trace Details"),(0,l.t)("Performance")].join(" — ")}getTraceSlug(){const{traceSlug:e}=this.props.params;return"string"==typeof e?e.trim():""}getDateSelection(){const{location:e}=this.props,t=(0,i.fK)(e.query,{allowAbsolutePageDatetime:!0});return{start:(0,m.ro)(t.start),end:(0,m.ro)(t.end),statsPeriod:(0,m.ro)(t.statsPeriod)}}getTraceEventView(){const e=this.getTraceSlug(),{start:t,end:r,statsPeriod:s}=this.getDateSelection();return d.ZP.fromSavedQuery({id:void 0,name:`Events with Trace ID ${e}`,fields:["title","event.type","project","timestamp"],orderby:"-timestamp",query:`trace:${e}`,projects:[c.mP],version:2,start:t,end:r,range:s})}renderContent(){const{location:e,organization:t,params:r}=this.props,s=this.getTraceSlug(),{start:n,end:a,statsPeriod:i}=this.getDateSelection(),o=Boolean(i||n&&a),c=n=>{let{isLoading:a,error:i,traces:c,meta:l}=n;return(0,V.tZ)(B,{location:e,organization:t,params:r,traceSlug:s,traceEventView:this.getTraceEventView(),dateSelected:o,isLoading:a,error:i,traces:c,meta:l})};return o?(0,V.tZ)(p.H,{location:e,orgSlug:t.slug,traceId:s,start:n,end:a,statsPeriod:i,children:r=>(0,V.tZ)(h.Z,{location:e,orgSlug:t.slug,traceId:s,start:n,end:a,statsPeriod:i,children:e=>c({isLoading:r.isLoading||e.isLoading,error:r.error||e.error,traces:r.traces,meta:e.meta})})}):c({isLoading:!1,error:new u.o("date selection not specified"),traces:null,meta:null})}render(){const{organization:e}=this.props;return(0,V.tZ)(o.Z,{title:this.getDocumentTitle(),orgSlug:e.slug,children:(0,V.tZ)(n.T3,{children:(0,V.tZ)(a.Z,{organization:e,children:this.renderContent()})})})}}G.displayName="TraceSummary";const H=(0,f.Z)((0,g.Z)(G))},"./app/views/performance/vitalDetail/utils.tsx":(e,t,r)=>{r.d(t,{EX:()=>F,MN:()=>m,Np:()=>Z,SP:()=>g,Uy:()=>v,Ve:()=>w,W0:()=>D,a7:()=>S,cD:()=>R,eE:()=>h,fL:()=>f,i4:()=>x,iF:()=>y,il:()=>b,jo:()=>P,q4:()=>T,vk:()=>C});var s=r("./app/components/charts/components/markLine.tsx"),n=r("./app/components/charts/utils.tsx"),a=r("./app/icons/index.tsx"),i=r("./app/locale.tsx"),o=r("./app/utils/discover/charts.tsx"),c=r("./app/utils/discover/fields.tsx"),l=r("./app/utils/fields/index.ts"),d=r("./app/utils/performance/vitals/constants.tsx"),u=r("./app/utils/queryString.tsx"),p=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const h={[l.Zl.FP]:3e3,[l.Zl.FCP]:3e3,[l.Zl.LCP]:4e3,[l.Zl.FID]:300,[l.Zl.CLS]:.25},m={[l.Zl.FP]:1e3,[l.Zl.FCP]:1e3,[l.Zl.LCP]:2500,[l.Zl.FID]:100,[l.Zl.CLS]:.1};let g;!function(e){e.POOR="Poor",e.MEH="Meh",e.GOOD="Good"}(g||(g={}));const f={[g.POOR]:"red300",[g.MEH]:"yellow300",[g.GOOD]:"green300"},Z={[g.POOR]:(0,p.tZ)(a.pY,{color:f[g.POOR]}),[g.MEH]:(0,p.tZ)(a.tC,{color:f[g.MEH]}),[g.GOOD]:(0,p.tZ)(a.O1,{color:f[g.GOOD]})};function x(e){let{orgSlug:t,vitalName:r,projectID:s,query:n}=e;const a=function(e){let{orgSlug:t}=e;return`/organizations/${t}/performance/vitaldetail/`}({orgSlug:t});return{pathname:a,query:{vitalName:r,project:s,environment:n.environment,statsPeriod:n.statsPeriod,start:n.start,end:n.end,query:n.query}}}function y(e){const t=(0,u.ro)(e.query.vitalName);return Object.values(l.Zl).find((e=>e===t))||l.Zl.LCP}function v(e){return e===l.Zl.CLS?(0,i.t)("CLS p75"):(0,i.t)("Duration p75")}function w(e){const t=h[e];return`compare_numeric_aggregate(${(0,c.LY)(`p75(${e})`)},greater,${t})`}function T(e){const t=m[e];return`compare_numeric_aggregate(${(0,c.LY)(`p75(${e})`)},greater,${t})`}const P={[l.Zl.FCP]:(0,i.t)("First Contentful Paint"),[l.Zl.CLS]:(0,i.t)("Cumulative Layout Shift"),[l.Zl.FID]:(0,i.t)("First Input Delay"),[l.Zl.LCP]:(0,i.t)("Largest Contentful Paint")},b={[l.Zl.FCP]:(0,i.t)("First Contentful Paint (FCP) measures the amount of time the first content takes to render in the viewport. Like FP, this could also show up in any form from the document object model (DOM), such as images, SVGs, or text blocks. At the moment, there is support for FCP in the following browsers:"),[l.Zl.CLS]:(0,i.t)("Cumulative Layout Shift (CLS) is the sum of individual layout shift scores for every unexpected element shift during the rendering process. Imagine navigating to an article and trying to click a link before the page finishes loading. Before your cursor even gets there, the link may have shifted down due to an image rendering. Rather than using duration for this Web Vital, the CLS score represents the degree of disruptive and visually unstable shifts. At the moment, there is support for CLS in the following browsers:"),[l.Zl.FID]:(0,i.t)("First Input Delay (FID) measures the response time when the user tries to interact with the viewport. Actions maybe include clicking a button, link or other custom Javascript controller. It is key in helping the user determine if a page is usable or not. At the moment, there is support for FID in the following browsers:"),[l.Zl.LCP]:(0,i.t)("Largest Contentful Paint (LCP) measures the render time for the largest content to appear in the viewport. This may be in any form from the document object model (DOM), such as images, SVGs, or text blocks. It’s the largest pixel area in the viewport, thus most visually defining. LCP helps developers understand how long it takes to see the main content on the page. At the moment, there is support for LCP in the following browsers:")},S={[l.Zl.FCP]:"FCP",[l.Zl.CLS]:"CLS",[l.Zl.FID]:"FID",[l.Zl.LCP]:"LCP"},D={[l.Zl.FCP]:"custom",[l.Zl.CLS]:"cls",[l.Zl.FID]:"fid",[l.Zl.LCP]:"lcp"};function C(e){let t=-1/0;for(const{data:r}of e)for(const e of r)t=Math.max(t,e.value);return t}const R={[l.Zl.LCP]:[d.AR.CHROME,d.AR.EDGE,d.AR.OPERA],[l.Zl.FID]:[d.AR.CHROME,d.AR.EDGE,d.AR.OPERA,d.AR.FIREFOX,d.AR.SAFARI,d.AR.IE],[l.Zl.CLS]:[d.AR.CHROME,d.AR.EDGE,d.AR.OPERA],[l.Zl.FP]:[d.AR.CHROME,d.AR.EDGE,d.AR.OPERA],[l.Zl.FCP]:[d.AR.CHROME,d.AR.EDGE,d.AR.OPERA,d.AR.FIREFOX,d.AR.SAFARI],[l.Zl.TTFB]:[d.AR.CHROME,d.AR.EDGE,d.AR.OPERA,d.AR.FIREFOX,d.AR.SAFARI,d.AR.IE]};function F(e){let{theme:t,location:r,vital:a,yAxis:d}=e;const p="false"!==(0,u.ro)(r.query.utc),g=h[a],f=m[a];return{vitalPoor:g,vitalMeh:f,legend:{right:10,top:0,selected:(0,n.RI)(r)},chartOptions:{grid:{left:"5px",right:"10px",top:"35px",bottom:"0px"},seriesOptions:{showSymbol:!1},tooltip:{trigger:"axis",valueFormatter:(e,t)=>(0,o.CX)(e,(0,c.Px)(a===l.Zl.CLS?t:d))},yAxis:{min:0,max:g,axisLabel:{color:t.chartLabel,showMaxLabel:!1,formatter:e=>(0,o.gu)(e,(0,c.Px)(d))}}},markLines:[{seriesName:"Thresholds",type:"line",data:[],markLine:(0,s.Z)({silent:!0,lineStyle:{color:t.red300,type:"dashed",width:1.5},label:{show:!0,position:"insideEndTop",formatter:(0,i.t)("Poor")},data:[{yAxis:g}]})},{seriesName:"Thresholds",type:"line",data:[],markLine:(0,s.Z)({silent:!0,lineStyle:{color:t.yellow300,type:"dashed",width:1.5},label:{show:!0,position:"insideEndTop",formatter:(0,i.t)("Meh")},data:[{yAxis:f}]})}],utc:p}}}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_traceDetails_index_tsx-app_views_performance_vitalDetail_utils_tsx.0880f94f5d98d701d58c50e61eddc684.js.map