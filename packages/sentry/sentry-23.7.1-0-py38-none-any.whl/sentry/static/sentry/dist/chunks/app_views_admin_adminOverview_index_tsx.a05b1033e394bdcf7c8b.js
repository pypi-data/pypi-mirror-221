"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_admin_adminOverview_index_tsx"],{"./app/components/panels/panelHeader.tsx":(e,t,s)=>{s.d(t,{Z:()=>o});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),i=s("./app/styles/space.tsx");const n=e=>{let{disablePadding:t,hasButtons:s}=e;return(0,a.iv)("padding:",s?(0,i.D)(1):(0,i.D)(2)," ",t?0:(0,i.D)(2),";","")},o=(0,r.Z)("div",{target:"e1dzfr4k0"})("display:flex;align-items:center;justify-content:space-between;color:",(e=>e.lightText?e.theme.gray300:e.theme.gray400),";font-size:",(e=>e.theme.fontSizeSmall),";font-weight:600;text-transform:uppercase;border-bottom:1px solid ",(e=>e.theme.border),";border-radius:calc(",(e=>e.theme.panelBorderRadius)," - 1px) calc(",(e=>e.theme.panelBorderRadius)," - 1px) 0 0;background:",(e=>e.theme.backgroundSecondary),";line-height:1;position:relative;",n,";")},"./app/views/admin/adminOverview/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});var r=s("../node_modules/react/index.js"),a=s("./app/components/panels/panel.tsx"),i=s("./app/components/panels/panelBody.tsx"),n=s("./app/components/panels/panelHeader.tsx"),o=s("./app/components/sentryDocumentTitle.tsx"),p=s("./app/locale.tsx"),l=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=s("./app/components/charts/miniBarChart.tsx"),d=s("./app/components/loadingError.tsx"),h=s("./app/components/loadingIndicator.tsx"),m=s("./app/utils/theme.tsx"),u=s("./app/utils/withApi.tsx"),x=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const v={error:!1,loading:!0,rawData:{"client-api.all-versions.responses.2xx":[],"client-api.all-versions.responses.4xx":[],"client-api.all-versions.responses.5xx":[]}};class Z extends r.Component{constructor(){super(...arguments),(0,l.Z)(this,"state",v),(0,l.Z)(this,"fetchData",(()=>{["client-api.all-versions.responses.2xx","client-api.all-versions.responses.4xx","client-api.all-versions.responses.5xx"].forEach((e=>{this.props.api.request("/internal/stats/",{method:"GET",data:{since:this.props.since,resolution:this.props.resolution,key:e},success:t=>{this.setState((s=>{const r=s.rawData;return r[e]=t,{rawData:r}}),this.requestFinished)},error:()=>{this.setState({error:!0})}})}))})),(0,l.Z)(this,"requestFinished",(()=>{const{rawData:e}=this.state;e["client-api.all-versions.responses.2xx"]&&e["client-api.all-versions.responses.4xx"]&&e["client-api.all-versions.responses.5xx"]&&this.setState({loading:!1})}))}UNSAFE_componentWillMount(){this.fetchData()}UNSAFE_componentWillReceiveProps(e){this.props.since!==e.since&&this.setState(v,this.fetchData)}processRawSeries(e){return e.map((e=>({name:1e3*e[0],value:e[1]})))}getChartSeries(){const{rawData:e}=this.state;return[{seriesName:"2xx",data:this.processRawSeries(e["client-api.all-versions.responses.2xx"]),color:m.ZP.green200},{seriesName:"4xx",data:this.processRawSeries(e["client-api.all-versions.responses.4xx"]),color:m.ZP.blue300},{seriesName:"5xx",data:this.processRawSeries(e["client-api.all-versions.responses.5xx"]),color:m.ZP.red200}]}render(){const{loading:e,error:t}=this.state;if(e)return(0,x.tZ)(h.Z,{});if(t)return(0,x.tZ)(d.Z,{onRetry:this.fetchData});const s=this.getChartSeries(),r=s.map((e=>{let{color:t}=e;return t}));return(0,x.tZ)(c.Z,{series:s,colors:r,height:110,stacked:!0,isGroupedByDate:!0,showTimeInTooltip:!0,labelYAxisExtents:!0})}}Z.displayName="ApiChart";const g=(0,u.Z)(Z),w={error:!1,loading:!0,rawData:{"events.total":[],"events.dropped":[]},stats:{received:[],rejected:[]}};class D extends r.Component{constructor(){super(...arguments),(0,l.Z)(this,"state",w),(0,l.Z)(this,"fetchData",(()=>{["events.total","events.dropped"].forEach((e=>{this.props.api.request("/internal/stats/",{method:"GET",data:{since:this.props.since,resolution:this.props.resolution,key:e},success:t=>{this.setState((s=>{const r=s.rawData;return r[e]=t,{rawData:r}}),this.requestFinished)},error:()=>{this.setState({error:!0})}})}))}))}UNSAFE_componentWillMount(){this.fetchData()}UNSAFE_componentWillReceiveProps(e){this.props.since!==e.since&&this.setState(w,this.fetchData)}requestFinished(){const{rawData:e}=this.state;e["events.total"]&&e["events.dropped"]&&this.processOrgData()}processOrgData(){const{rawData:e}=this.state,t={},s={},r=[0,0];e["events.total"].forEach(((a,i)=>{const n=a[1],o=e["events.dropped"][i]?.[1],p=a[0];void 0===t[p]?(t[p]=n,s[p]=o):(t[p]+=n,s[p]+=o),n>0&&(r[0]+=n,r[1]+=1)})),this.setState({stats:{rejected:Object.keys(s).map((e=>({name:1e3*parseInt(e,10),value:s[e]||0}))),accepted:Object.keys(t).map((e=>({name:1e3*parseInt(e,10),value:t[e]-s[e]})))},loading:!1})}getChartSeries(){const{stats:e}=this.state;return[{seriesName:(0,p.t)("Accepted"),data:e.accepted,color:m.ZP.blue300},{seriesName:(0,p.t)("Dropped"),data:e.rejected,color:m.ZP.red200}]}render(){const{loading:e,error:t}=this.state;if(e)return(0,x.tZ)(h.Z,{});if(t)return(0,x.tZ)(d.Z,{onRetry:this.fetchData});const s=this.getChartSeries(),r=s.map((e=>{let{color:t}=e;return t}));return(0,x.tZ)(c.Z,{series:s,colors:r,height:110,stacked:!0,isGroupedByDate:!0,showTimeInTooltip:!0,labelYAxisExtents:!0})}}D.displayName="EventChart";const b=(0,u.Z)(D);function f(){const e=(new Date).getTime()/1e3-604800;return(0,x.tZ)(o.Z,{title:(0,p.t)("Admin Overview"),children:(0,x.BX)(r.Fragment,{children:[(0,x.tZ)("h3",{children:(0,p.t)("System Overview")}),(0,x.BX)(a.Z,{children:[(0,x.tZ)(n.Z,{children:(0,p.t)("Event Throughput")}),(0,x.tZ)(i.Z,{withPadding:!0,children:(0,x.tZ)(b,{since:e,resolution:"1h"})})]},"events"),(0,x.BX)(a.Z,{children:[(0,x.tZ)(n.Z,{children:(0,p.t)("API Responses")}),(0,x.tZ)(i.Z,{withPadding:!0,children:(0,x.tZ)(g,{since:e,resolution:"1h"})})]},"api")]})})}f.displayName="AdminOverview";const S=f}}]);
//# sourceMappingURL=../sourcemaps/app_views_admin_adminOverview_index_tsx.132c8c45d5a7294027ea24e88dfee981.js.map