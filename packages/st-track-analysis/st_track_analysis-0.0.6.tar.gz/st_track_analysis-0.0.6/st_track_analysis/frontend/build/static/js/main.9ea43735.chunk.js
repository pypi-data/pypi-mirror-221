(this.webpackJsonpstreamlit_component_template=this.webpackJsonpstreamlit_component_template||[]).push([[0],{204:function(e,t,n){},205:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=205},212:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(50),c=n.n(i),o=n(79),s=n(18),l=n(11),u=n(158),d=n(305),h=n(310),f=new Map([[0,"green"],[1,"purple"],[4,"red"],[18,"cyan"],[34,"pink"]]),j="Pedestrian",b="Bicycle",m="Light vehicle",g="Heavy vehicle",O="Unknown",x=[j,b,m,g,O];function v(e){return 0===e?O:1===e?b:4===e?j:18===e?m:34===e?g:O}var p=n(35),k=n.n(p),y=n(103),w=n(34),T=n(12),M=n(7),L=n(8),C=n(4),S=n(5),I=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(C.a)(this,e),this._pos=void 0,this._pos=[t,n,r]}return Object(S.a)(e,[{key:"x",get:function(){return this._pos[0]},set:function(e){this._pos[0]=e}},{key:"y",get:function(){return this._pos[1]},set:function(e){this._pos[1]=e}},{key:"z",get:function(){return this._pos[2]},set:function(e){this._pos[2]=e}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z}},{key:"distanceTo",value:function(e){return Math.sqrt(Math.pow(e.x-this.x,2)+Math.pow(e.y-this.y,2)+Math.pow(e.z-this.z,2))}}],[{key:"cross",value:function(t,n){return new e(t.y*n.z-t.z*n.y,t.z*n.x-t.x*n.z,t.x*n.y-t.y*n.x)}}]),e}(),_=function(e){Object(M.a)(n,e);var t=Object(L.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return Object(C.a)(this,n),(e=t.call(this,r,a,i))._angles=void 0,e._angles=[c,o,s],e}return Object(S.a)(n,[{key:"yaw",get:function(){return this._angles[0]},set:function(e){this._angles[0]=e}},{key:"pitch",get:function(){return this._angles[1]},set:function(e){this._angles[1]=e}},{key:"roll",get:function(){return this._angles[2]},set:function(e){this._angles[2]=e}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z&&this.yaw===e.yaw&&this.pitch===e.pitch&&this.roll===e.roll}}]),n}(I);n(204),n(28);function D(){var e=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return e[0][0]=1,e[1][1]=1,e[2][2]=1,e[3][3]=1,e}function R(e,t){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var a=0;a<4;a++)n[r][a]=e[r][0]*t[0][a]+e[r][1]*t[1][a]+e[r][2]*t[2][a]+e[r][3]*t[3][a];return n}function N(e,t){var n=new I;return n.x=e[0][0]*t.x+e[0][1]*t.y+e[0][2]*t.z+e[0][3],n.y=e[1][0]*t.x+e[1][1]*t.y+e[1][2]*t.z+e[1][3],n.z=e[2][0]*t.x+e[2][1]*t.y+e[2][2]*t.z+e[2][3],n}function z(e,t){var n=Math.cos(t),r=Math.sin(t),a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return a[0][0]=1,a[1][1]=n,a[1][2]=-r,a[2][1]=r,a[2][2]=n,a[3][3]=1,R(a,e)}function H(e,t){var n=Math.cos(t),r=Math.sin(t),a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return a[0][0]=n,a[0][2]=r,a[1][1]=1,a[2][0]=-r,a[2][2]=n,a[3][3]=1,R(a,e)}function E(e,t){var n=Math.cos(t),r=Math.sin(t),a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];return a[0][0]=n,a[0][1]=-r,a[1][0]=r,a[1][1]=n,a[2][2]=1,a[3][3]=1,R(a,e)}function P(e,t,n,r){return e=z(e=H(e=E(e,t),n),r)}function W(e,t,n,r){var a=JSON.parse(JSON.stringify(e));return a[0][0]+=e[3][0]*t,a[0][1]+=e[3][1]*t,a[0][2]+=e[3][2]*t,a[0][3]+=e[3][3]*t,a[1][0]+=e[3][0]*n,a[1][1]+=e[3][1]*n,a[1][2]+=e[3][2]*n,a[1][3]+=e[3][3]*n,a[2][0]+=e[3][0]*r,a[2][1]+=e[3][1]*r,a[2][2]+=e[3][2]*r,a[2][3]+=e[3][3]*r,a}function F(e,t,n,r){var a=JSON.parse(JSON.stringify(e));return a[0][0]*=t,a[0][1]*=t,a[0][2]*=t,a[0][3]*=t,a[1][0]*=n,a[1][1]*=n,a[1][2]*=n,a[1][3]*=n,a[2][0]*=r,a[2][1]*=r,a[2][2]*=r,a[2][3]*=r,a}function B(e,t,n,r){return[(r=N(Y(e,t,n),r)).x,r.y]}function Y(e,t,n){var r=D();return r=W(r,-e.pos.x,-e.pos.y,-e.pos.z),r=W(r=F(r=P(r,-e.pos.yaw,-e.pos.pitch,-e.pos.roll),t/e.width,n/e.height,1),.5*t-.5,.5*n-.5,0)}var G=n(2),J=function(e){var t=e.WIDTH,n=e.HEIGHT,a=e.scale,i=e.tracks,c=e.ground,o=e.showId,s=e.selectedTracks,u=e.filters;return Object(G.jsx)("svg",{width:t,height:n,style:{transform:"scale(".concat(a,")"),transformOrigin:"top left",overflow:"visible"},children:Object(r.useMemo)((function(){return i.map((function(e){if(u.filterSelected===s.has(e.id)){var r=f.get(e.type),a=B(c,t,n,e.startPos()),i=Object(l.a)(a,2),d=i[0],h=i[1],j=B(c,t,n,e.endPos()),b=Object(l.a)(j,2),m=b[0],g=b[1];return Object(G.jsxs)("g",{children:[Object(G.jsx)("path",{d:e.pathString(c,t,n,u.onlyConfirmed,u.markMeasurements,u.markEstimated),stroke:r||"black",fill:"none"}),Object(G.jsx)("circle",{cx:d,cy:h,r:4,fill:"green",strokeWidth:"4"}),Object(G.jsx)("circle",{cx:m,cy:g,r:4,fill:"red",strokeWidth:"4"}),o&&Object(G.jsx)("text",{x:m,y:g,fill:"white",fontFamily:"sans-serif",fontSize:10,children:e.id})]},e.id)}}))}),[i,c,o,s,u])})},q=n(146),V=n.n(q),U=n(302),A=n(316),K=n(317),Q=n(318),X=n(307),Z=function(e){var t=e.filters,n=e.onMarkMeasurements,r=e.onMarkEstimated,a=e.onMarkOnlyConfirmed,i=e.onMarkTrackId,c=e.onMarkLines;return Object(G.jsx)(A.a,{sx:{margin:0,marginLeft:2},component:"fieldset",variant:"standard",children:Object(G.jsxs)(K.a,{children:[Object(G.jsx)(Q.a,{control:Object(G.jsx)(X.a,{checked:t.markMeasurements,onChange:n}),label:"Mark measurements"}),Object(G.jsx)(Q.a,{control:Object(G.jsx)(X.a,{checked:t.markEstimated,onChange:r}),label:"Mark estimated"}),Object(G.jsx)(Q.a,{control:Object(G.jsx)(X.a,{checked:t.onlyConfirmed,onChange:a}),label:"Show only confirmed"}),Object(G.jsx)(Q.a,{control:Object(G.jsx)(X.a,{checked:t.trackId,onChange:i}),label:"Show track id"}),Object(G.jsx)(Q.a,{control:Object(G.jsx)(X.a,{checked:t.showLines,onChange:c}),label:"Show lines"})]})})},$=n(319),ee=n(119),te=n(320),ne=n(309),re=n(300),ae=n(324),ie=n(290),ce=n(279),oe=n(280),se=n(281),le=function(e){var t=e.tracks,n=e.selectedTracks,r=e.onTrackSelect;return Object(G.jsx)(G.Fragment,{children:t.map((function(e){return Object(G.jsxs)(ce.a,{onClick:function(t){return r(t,e)},children:[Object(G.jsx)(oe.a,{children:Object(G.jsx)(X.a,{edge:"start",checked:n.has(e.id),tabIndex:-1,disableRipple:!0})}),Object(G.jsx)(se.a,{style:{width:"33.3%"},primary:e.id}),Object(G.jsx)(se.a,{style:{width:"33.3%"},primary:Math.round(e.length())}),Object(G.jsx)(se.a,{style:{width:"33.3%"},primary:v(e.type)})]},e.id)}))})},ue=function(e){var t=e.tracks,n=e.switchLeftLabel,a=e.switchRightLabel,i=e.selectedTracks,c=e.onSwitch,o=e.onTrackSelect,s=["Id","Length","Type"],u=Object(r.useState)(s[0]),d=Object(l.a)(u,2),h=d[0],f=d[1];function j(e,t){return e.id-t.id}function b(e,t){return e.length()-t.length()}function m(e,t){return e.type-t.type}return Object(G.jsx)("div",{style:{marginTop:10},children:Object(G.jsxs)($.a,{sx:{width:"100%",maxWidth:500,bgcolor:"background.paper",position:"relative",overflow:"auto",maxHeight:400,"& ul":{padding:0},borderRadius:1},dense:!0,subheader:Object(G.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginRight:20,marginLeft:20,minHeight:60},children:[Object(G.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(G.jsx)(ee.a,{children:n}),Object(G.jsx)(te.a,{onChange:c}),Object(G.jsx)(ee.a,{children:a})]}),Object(G.jsxs)(A.a,{children:[Object(G.jsx)(ne.a,{id:"demo-simple-select-label",children:"Filter on"}),Object(G.jsx)(re.a,{sx:{height:40,width:100},labelId:"demo-simple-select-label",id:"demo-simple-select",value:h,label:"Filter on",onChange:function(e){var t;t=e.target.value,s.includes(t)&&f(e.target.value)},children:s.map((function(e){return Object(G.jsx)(ae.a,{value:e,children:e})}))})]})]}),component:"nav","aria-label":"tracks list",children:[Object(G.jsx)(ie.a,{sx:{borderBottomWidth:3}}),Object(G.jsx)(le,{tracks:function(e,t){return e.sort(function(e){switch(e){case"Id":default:return j;case"Length":return b;case"Type":return m}}(t))}(t,h),selectedTracks:i,onTrackSelect:o})]})})},de=function(e){var t=e.label,n=e.image,a=e.WIDTH,i=e.HEIGHT,c=e.tracks,o=e.ground,u=Object(r.useState)(window.innerWidth/a/2),d=Object(l.a)(u,2),f=d[0],j=d[1],b=Object(r.useState)(!0),m=Object(l.a)(b,2),g=m[0],O=m[1],x=Object(r.useState)({markMeasurements:!1,markEstimated:!1,onlyConfirmed:!1,trackId:!1,showLines:!1,filterSelected:!1}),v=Object(l.a)(x,2),p=v[0],k=v[1],y=Object(r.useState)(new Set),w=Object(l.a)(y,2),M=w[0],L=w[1];return Object(G.jsxs)("div",{children:[Object(G.jsxs)("div",{className:"control-container",children:[Object(G.jsxs)(h.a,{onClick:function(){return O((function(e){return!e}))},sx:{marginRight:1},variant:"text",children:["Version ",t]}),g&&Object(G.jsx)(U.a,{value:f,"aria-label":"Default",valueLabelDisplay:"auto",onChange:function(e,t){"number"===typeof t&&j(t)},min:0,max:4,step:.01,color:"primary",className:"slider",style:{width:300,margin:0}})]}),g&&Object(G.jsxs)("div",{style:{overflow:"hidden",display:"flex"},children:[Object(G.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(G.jsx)(V.a,{children:Object(G.jsx)("div",{className:"image-container",style:{width:a*f,height:i*f,backgroundImage:"url(".concat(n,")")},children:Object(G.jsx)(J,{tracks:c,WIDTH:a,HEIGHT:i,scale:f,showId:p.trackId,ground:o,selectedTracks:M,filters:p})})}),Object(G.jsx)(ue,{tracks:Object(T.a)(c),switchLeftLabel:"Hide",switchRightLabel:"Show",selectedTracks:M,onSwitch:function(e){k((function(t){return Object(s.a)(Object(s.a)({},t),{},{filterSelected:e.target.checked})}))},onTrackSelect:function(e,t){M.has(t.id)?L((function(e){return e.delete(t.id),new Set(e)})):L((function(e){return e.add(t.id),new Set(e)}))}})]}),Object(G.jsx)(Z,{filters:p,onMarkMeasurements:function(e){k((function(t){return Object(s.a)(Object(s.a)({},t),{},{markMeasurements:e.target.checked})}))},onMarkEstimated:function(e){k((function(t){return Object(s.a)(Object(s.a)({},t),{},{markEstimated:e.target.checked})}))},onMarkOnlyConfirmed:function(e){k((function(t){return Object(s.a)(Object(s.a)({},t),{},{onlyConfirmed:e.target.checked})}))},onMarkTrackId:function(e){k((function(t){return Object(s.a)(Object(s.a)({},t),{},{trackId:e.target.checked})}))},onMarkLines:function(e){k((function(t){return Object(s.a)(Object(s.a)({},t),{},{showLines:e.target.checked})}))}})]})]})},he=function(){function e(t,n,r,a,i,c){Object(C.a)(this,e),this.id=void 0,this.startTime=void 0,this.endTime=void 0,this.coordinates=void 0,this.estimated=void 0,this.type=void 0,this.id=t,this.startTime=k()(n),this.endTime=k()(r),this.coordinates=a[0].map((function(e,t){return new I(e,a[1][t],0)})),this.estimated=i.map((function(e){return 1==e})),this.type=c}return Object(S.a)(e,[{key:"getEstimated",value:function(){var e=this;return this.coordinates.filter((function(t,n){return e.estimated[n]}))}},{key:"getConfirmed",value:function(){var e=this;return this.coordinates.filter((function(t,n){return!e.estimated[n]}))}},{key:"toGround",value:function(e,t,n){return this.coordinates.map((function(r){return B(e,t,n,r)}))}},{key:"startPos",value:function(){return this.coordinates[0]}},{key:"endPos",value:function(){return this.coordinates[this.coordinates.length-1]}},{key:"length",value:function(){return this.startPos().distanceTo(this.endPos())}},{key:"pathString",value:function(e,t,n,r,a,i){var c=this,o=B(e,t,n,this.startPos()),s=Object(l.a)(o,2),u=s[0],d=s[1],h="M ".concat(u," ").concat(d," "),f=this.toGround(e,t,n);return f.forEach((function(e,t){var n=Object(l.a)(e,2),o=n[0],s=n[1],u=c.estimated[t];if((!r||!u)&&(h+="L ".concat(o," ").concat(s," "),0!==t&&(a&&!u||i&&u))){var d=u?3:6,j=Object(l.a)(f[t-1],2),b=j[0],m=j[1],g=Math.sqrt(Math.pow(b-o,2)+Math.pow(m-s,2)),O=0===g?1:g,x=[(s-m)/O,(b-o)/O],v=.707,p=x[0]*v-x[1]*v,k=x[0]*v+x[1]*v;h+="L ".concat(o+p*d," ").concat(s+k*d," L ").concat(o," ").concat(s," L ").concat(o-k*d," ").concat(s+p*d," L ").concat(o," ").concat(s," ")}})),h}}]),e}(),fe=function(e){var t=e.fromTime,n=e.toTime,r=e.showType,a=e.filterLength,i=Object(o.useRenderData)(),c=i.args.images,s=i.args.shapes,l=i.args.grounds,u=i.args.names,d=l.map((function(e){return{pos:Object(w.a)(_,Object(T.a)(e[0])),height:e[1],width:e[2]}})),h=i.args.tracks,f=h.map((function(e){return e.map((function(e){return Object(w.a)(he,Object(T.a)(e))})).filter((function(e){return function(e,t,n,r,a){return!e.startTime.isBefore(t)&&!e.endTime.isAfter(n)&&!!r.includes(v(e.type))&&(!a.filter||!(e.length()<a.minLength||e.length()>a.maxLength))}(e,t,n,r,a)}))})),j=f.map((function(e,t){return Object(G.jsx)(de,{image:c[t],HEIGHT:s[t][0],WIDTH:s[t][1],tracks:e,label:u[t],ground:d[t]},c[t])}));return Object(G.jsx)("div",{style:{display:"flex",flexDirection:"row"},children:Object(G.jsxs)("div",{style:{flexDirection:"row",flexWrap:"wrap"},children:[j.map((function(e){return e})),Object(G.jsx)("div",{style:{height:1e4}})]})})},je=n(311),be=n(153),me=n(298),ge=n(299),Oe=n(291),xe=function(e){var t=e.data,n=e.changeDate,r=e.changeTime,a=e.changeInterval;return Object(G.jsxs)(be.a,{dateAdapter:Oe.a,children:[Object(G.jsx)(me.a,{label:"Date",format:"YYYY-MM-DD",value:t.date,onChange:n,sx:{backgroundColor:"background.default",borderRadius:1,marginRight:2}}),Object(G.jsx)(ge.a,{label:"From time",value:t.fromTime,onChange:r,ampm:!1,sx:{backgroundColor:"background.default",borderRadius:1,marginRight:2}}),Object(G.jsx)(je.a,{label:"Interval in minutes",id:"outlined-start-adornment",sx:{width:"25ch",backgroundColor:"background.default",borderRadius:1,margin:0,marginRight:2},value:t.interval,onChange:a})]})},ve=n(312),pe=function(e){var t=e.data,n=e.handleChange,r={PaperProps:{style:{maxHeight:224,width:250}}};return Object(G.jsxs)(A.a,{sx:{m:1,width:300,margin:0},children:[Object(G.jsx)(ne.a,{id:"demo-multiple-name-label",children:"Show types"}),Object(G.jsx)(re.a,{labelId:"demo-multiple-name-label",id:"demo-multiple-name",multiple:!0,value:t.showType,onChange:n,input:Object(G.jsx)(ve.a,{label:"Show types"}),renderValue:function(e){return e.join(", ")},MenuProps:r,sx:{backgroundColor:"background.default"},children:x.map((function(e){return Object(G.jsxs)(ae.a,{value:e,children:[Object(G.jsx)(X.a,{checked:t.showType.indexOf(e)>-1}),Object(G.jsx)(se.a,{primary:e})]},e)}))})]})},ke=function(e){var t=e.data,n=e.checkFilterBox,r=e.changeMinLength,a=e.changeMaxLength;return Object(G.jsxs)("div",{children:[Object(G.jsx)(Q.a,{control:Object(G.jsx)(X.a,{checked:t.filterLength.filter,onChange:n}),label:"Filter length",style:{margin:0,marginTop:10}}),t.filterLength.filter&&Object(G.jsxs)("div",{style:{marginTop:10},children:[Object(G.jsx)(je.a,{label:"Minimum length",id:"outlined-start-adornment",sx:{m:1,width:"25ch",backgroundColor:"background.default",borderRadius:1,margin:0,marginRight:2},value:t.filterLength.minLength,onChange:r}),Object(G.jsx)(je.a,{label:"Maximum length",id:"outlined-start-adornment",sx:{m:1,width:"25ch",backgroundColor:"background.default",borderRadius:1,margin:0,marginRight:2},value:t.filterLength.maxLength,onChange:a})]})]})},ye=function(){var e=Object(o.useRenderData)(),t=k()(e.args.date),n={date:t,fromTime:t,interval:0,showType:x,filterLength:{filter:!1,minLength:0,maxLength:100}},a=Object(r.useState)(n),i=Object(l.a)(a,2),c=i[0],f=i[1],j=e.theme,b=Object(u.a)({palette:{primary:{main:null===j||void 0===j?void 0:j.primaryColor},common:{black:null===j||void 0===j?void 0:j.base},text:{primary:null===j||void 0===j?void 0:j.textColor,secondary:null===j||void 0===j?void 0:j.textColor},action:{active:"#fff"},background:{default:null===j||void 0===j?void 0:j.secondaryBackgroundColor,paper:null===j||void 0===j?void 0:j.secondaryBackgroundColor}}});Object(r.useEffect)((function(){c.date.isValid()&&y.Streamlit.setComponentValue(c.date.format("YYYY-MM-DD"))}),[c.date]);return Object(G.jsx)(d.a,{theme:b,children:Object(G.jsxs)("div",{style:{marginTop:30},children:[Object(G.jsx)(xe,{data:c,changeDate:function(e){e&&f((function(t){return t.date=e,Object(s.a)({},t)}))},changeTime:function(e){e&&f((function(t){return t.fromTime=e,Object(s.a)({},t)}))},changeInterval:function(e){var t=Number(e.target.value);isNaN(t)||f((function(e){return e.interval=t,Object(s.a)({},e)}))}}),Object(G.jsx)(pe,{data:c,handleChange:function(e){var t=e.target.value;f((function(e){return e.showType="string"===typeof t?t.split(","):t,Object(s.a)({},e)}))}}),Object(G.jsx)(ke,{data:c,checkFilterBox:function(e){f((function(t){return t.filterLength.filter=e.target.checked,Object(s.a)({},t)}))},changeMinLength:function(e){var t=Number(e.target.value);isNaN(t)||f((function(e){return e.filterLength.minLength=t,Object(s.a)({},e)}))},changeMaxLength:function(e){var t=Number(e.target.value);isNaN(t)||f((function(e){return e.filterLength.maxLength=t,Object(s.a)({},e)}))}}),Object(G.jsxs)("div",{style:{margin:0,marginTop:10},children:[Object(G.jsx)(h.a,{sx:{marginRight:2,backgroundColor:"background.default"},onClick:function(){f((function(e){return e.fromTime=e.fromTime.subtract(e.interval,"minutes"),Object(s.a)({},e)}))},children:"<"}),Object(G.jsx)(h.a,{sx:{marginRight:2,backgroundColor:"background.default"},onClick:function(){f((function(e){return e.fromTime=e.fromTime.add(e.interval,"minutes"),Object(s.a)({},e)}))},children:">"})]}),Object(G.jsx)(fe,{fromTime:c.fromTime,toTime:c.fromTime.add(c.interval,"minutes"),showType:c.showType,filterLength:c.filterLength})]})})};console.warn=function(){},c.a.render(Object(G.jsx)(a.a.StrictMode,{children:Object(G.jsx)(o.StreamlitProvider,{children:Object(G.jsx)(ye,{})})}),document.getElementById("root"))}},[[212,1,2]]]);
//# sourceMappingURL=main.9ea43735.chunk.js.map