"use strict";(self.webpackChunk_infuseai_piperider_ui=self.webpackChunk_infuseai_piperider_ui||[]).push([[953],{5462:function(e,n,t){t.d(n,{B:function(){return u}});var i=t(82175),r=t(37932),a=t(33660),o=t(7615),l=t(46569),s=t(93354),d=t(15887),c=["title","children","allowModalPopup"];function u(e){var n=e.title,t=e.children,u=e.allowModalPopup,h=(0,r.Z)(e,c),x=(0,a.qY)();return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(o.kC,(0,i.Z)((0,i.Z)({bg:"whiteAlpha.700",rounded:"md",onClick:function(){return u&&x.onOpen()}},h),{},{children:t})),u&&(0,d.jsx)(s.W,(0,i.Z)((0,i.Z)({},x),{},{size:"full",title:n,footer:(0,d.jsx)(o.kC,{mt:6,w:"100%",direction:"row",justify:"center",children:(0,d.jsx)(l.zx,{colorScheme:"blue",mr:3,onClick:x.onClose,children:"Close"})}),children:t}))]})}},45871:function(e,n,t){t.d(n,{UZ:function(){return x}});var i=t(82175),r=t(2397),a=t(6125),o=t(45505),l=t(32221),s=t(94361),d=t(58188),c=t(86252),u=t(15887),h="#4780A8";function x(e){var n=e.quantileData,t=e.animation,x=void 0!==t&&t;(0,c.Z)(),r.kL.register(a.LU,a.aS,r.f$,r.uw);var m=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=Object.assign({},n),r=(0,s.uB)(e),a=r.max,o=r.min,c=r.mean,u=r.q1,x=r.q3,m=[{text:"box region",fillStyle:d.k8},{text:"p50",fillStyle:h}];return(0,i.Z)({responsive:!0,maintainAspectRatio:!1,layout:{padding:10},indexAxis:"y",scales:{x:{offset:!0},y:{display:!1}},plugins:{legend:{position:"bottom",labels:{boxHeight:10,boxWidth:10,padding:15,generateLabels:function(){return m.map((function(e){return{lineWidth:0,text:e.text,fillStyle:e.fillStyle}}))}}},tooltip:{callbacks:{label:function(){var e=(0,l.J8)(o),n=(0,l.J8)(a),t=(0,l.J8)(c),i=(0,l.J8)(u),r=(0,l.J8)(x);return"MIN: ".concat(e," / P25: ").concat(i," / P50 (median): ").concat(t," / P75: ").concat(r," / MAX: ").concat(n)}}}}},t)}(n,{animation:x}),f=function(e){var n=(0,s.uB)(e),t=n.max,i=n.min,r=n.mean,a=n.q1,o=n.q3;return{labels:[""],datasets:[{data:[{min:i,q1:a,mean:r,q3:o,max:t,median:r,items:[],outliers:[]}],borderWidth:1,itemRadius:1,medianColor:h,meanBackgroundColor:h,backgroundColor:d.k8,borderColor:d.Q,hitPadding:10}]}}(n);return(0,u.jsx)(o.kL,{type:"boxplot",data:f,options:m,plugins:[r.De,r.u]},Date.now())}},53018:function(e,n,t){t.d(n,{$:function(){return xe}});var i=t(7615),r=t(1831),a=t(31756),o=t(15887),l=(0,a.createContext)(!1),s=function(e){var n=e.cloud,t=e.children;return(0,o.jsx)(l.Provider,{value:n,children:t})};var d=t(61431),c=t(33660),u=t(38723),h=t(88050),x=t(46569),m=t(53579),f=t(86629),p=t(40485),g=t(82904),v=t(52912),j=t(64947),b=t(39e3);function y(e){var n=e.items,t=e.singleOnly,r=(0,a.useState)(0),l=(0,d.Z)(r,2)[1],s=(0,g.TH)(),c=(0,d.Z)(s,2),u=c[0],h=c[1];if(!n)return(0,o.jsx)(o.Fragment,{});var x=function e(n){var t,i,r=(0,p.Z)(null!==(t=null===n||void 0===n?void 0:n.items)&&void 0!==t?t:[]);try{for(r.s();!(i=r.n()).done;){var a=i.value;if(a.changeStatus)return!0;if(e(a))return!0}}catch(o){r.e(o)}finally{r.f()}return!1},m=function e(n){var r=n.type,a=n.name,s=n.items;if("folder"!==n.type||n.items&&0!==n.items.length){var d=!!n.expanded,c=s&&s.length>0,m=d?j.bTu:j.Tfp,f=n.changeStatus,p=!1;d||f||!x(n)||(f="modified");var g=(0,b.Mr)(f),y=g.icon,C=g.color,S=j.QoU,k=(0,b.yk)(r).icon;if(k)S=k;else if("database"===r)S=j.bGz;else if("schema"===r)S=j.QoU;else if("table"===r)S=j.aCJ;else if(r.startsWith("column_")){var Z=r.slice("column_".length);S=(0,b.MM)(Z).icon}else"metric_list"===r?S=v.NMh:"test_list"===r?S=j._rq:"overview"===r&&(S=v.xng);var w,O=n.path===u;if("model"===r||"table"===r||"source"===r||"seed"===r)p=0===(null!==(w=n.items)&&void 0!==w?w:[]).length;return(0,o.jsxs)(i.HC,{children:[(0,o.jsxs)(i.kC,{_hover:{bg:O?"piperider.400":"gray.100"},rounded:"md",cursor:"pointer",fontSize:"sm",color:O?"white":p?"gray":"inherit",bg:O?"piperider.400":"inherit",onClick:function(){!function(e){e.items&&e.items.length>0&&(e.expanded=!e.expanded,l((function(e){return e+1}))),e.path&&h(e.path)}(n)},alignItems:"center",px:2,children:[(0,o.jsx)(i.DE,{as:m,visibility:c?"visible":"hidden"}),(0,o.jsx)(i.DE,{as:S,mr:1}),(0,o.jsx)(i.xv,{flex:1,children:a}),!t&&f&&(0,o.jsx)(i.DE,{as:y,color:O?"white":C})]}),d&&s&&s.length>0&&(0,o.jsx)(i.aV,{ml:4,spacing:1,my:1,children:s.map((function(n){return e(n)}))})]},a)}};return(0,o.jsx)(i.aV,{spacing:2,children:n.map((function(e){return m(e)}))})}var C=t(82175),S=t(11060),k=t(88081),Z=t(21519),w=t(20177),O=t(96979),T=t(24333),_=(t(2309),t(21102)),N=t(67745),F=t(74389),M=t(97348),z=t(48685),L=t(85525),E=t(5322),D=t(12599),A=t(96969),H=t(70102),R="#1a7f37",P="#cf222e",B="darkorange",I=[["nulls_p","Missing%","percent"],["distinct_p","Distinct%","percent"],["duplicates_p","Duplicates%","percent"],["min","Min","decimal"],["max","Max","decimal"],["avg","Avg","decimal"],["min_length","Min Len.","decimal"],["max_length","Max Len.","decimal"],["avg_length","Avg Len.","decimal"]];function q(e){var n,t=e.baseColumn,r=e.targetColumn,a=e.stat,l=null!==r&&void 0!==r?r:t;if("string"===(null===l||void 0===l?void 0:l.type)&&("min"===a||"max"===a||"avg"===a))return(0,o.jsx)(o.Fragment,{});if("datetime"===(null===l||void 0===l?void 0:l.type)&&("min"===a||"max"===a))return(0,o.jsx)(o.Fragment,{});var s=null!==(n=I.find((function(e){return(0,d.Z)(e,1)[0]===a})))&&void 0!==n?n:[void 0,void 0,"decimal"],c=(0,d.Z)(s,3)[2],u=(0,A.U)(t,r,a,c),h=u.statValueF,x=u.statDiff,m=u.statDiffF;return(0,o.jsxs)(i.gC,{flex:"0 1 60px",alignItems:"flex-end",spacing:0,fontSize:"xs",children:[(0,o.jsx)(i.xv,{textAlign:"right",children:h}),void 0!==x&&(0,o.jsxs)(i.xu,{textAlign:"right",children:[x<0?(0,o.jsx)(D.AS,{}):(0,o.jsx)(D.$l,{}),m]})]})}function W(e){var n,t,r=e.singleOnly,l=e.isOpen,s=e.onClose,c=z.nq.getState().tableColumnsOnly,u=void 0===c?[]:c,x=(0,E.e$)().uniqueId,m=(0,a.useState)(I[0][0]),f=(0,d.Z)(m,2),p=f[0],g=f[1],v=null===(n=I.find((function(e){return(0,d.Z)(e,1)[0]===p})))||void 0===n?void 0:n[1];if(!l)return(0,o.jsx)(o.Fragment,{});var j=u.find((function(e){return(0,d.Z)(e,1)[0]===x}));if(!j)return(0,o.jsxs)(o.Fragment,{children:["`No data found for '$",x,"'`"]});var y=(0,d.Z)(j,2)[1],C=y.base,S=y.target||C;return null!==S&&void 0!==S&&S.__columns?(0,o.jsxs)(i.kC,{direction:"column",width:"100%",style:{background:"white",width:"600px",borderLeft:"1px solid lightgray"},children:[(0,o.jsx)(F.P,{onClick:function(){s&&s()}}),(0,o.jsx)(M.xJ,{width:"100%",children:(0,o.jsxs)(M.iA,{variant:"simple",size:"sm",children:[(0,o.jsx)(M.hr,{children:(0,o.jsxs)(M.Tr,{children:[!r&&(0,o.jsx)(M.Th,{width:0}),(0,o.jsx)(M.Th,{children:"Column"}),(0,o.jsx)(M.Th,{children:"Type"}),"all"!==p&&(0,o.jsx)(M.Th,{width:"100px",cursor:"pointer",children:(0,o.jsxs)(N.v2,{children:[(0,o.jsxs)(N.j2,{as:i.xv,children:[v,(0,o.jsx)(D.v4,{})]}),(0,o.jsxs)(N.qy,{children:[I.map((function(e){var n=(0,d.Z)(e,2),t=n[0],i=n[1];return(0,o.jsx)(N.sN,{onClick:function(){g(t)},children:i},t)})),(0,o.jsx)(N.R,{}),(0,o.jsx)(N.sN,{onClick:function(){g("all")},children:"All Stats"},"all")]})]})}),"all"===p&&I.map((function(e){var n=(0,d.Z)(e,2),t=n[0],i=n[1];return(0,o.jsx)(M.Th,{onClick:function(){g(t)},cursor:"pointer",children:i})}))]})}),(0,o.jsx)(M.p3,{children:null===S||void 0===S||null===(t=S.__columns)||void 0===t?void 0:t.map((function(e){var n,t,a,l,s=(0,d.Z)(e,3),c=s[0],u=s[1],x=u.base,m=u.target,f=(s[2],m||x),g=(0,b.MM)(null===f||void 0===f?void 0:f.type).icon,v=void 0;if(!r){var j=(0,H.zM)(x,m);"added"===j?(v=L.Nbv,l=R):"removed"===j?(v=L.sFB,l=P):"implicit"===j?(v=L.UGs,l="#9a6700"):l="inherit"}return(0,o.jsxs)(M.Tr,{_hover:{bg:"blackAlpha.50",cursor:"inherit"},"data-cy":"table-list-schema-item",color:l,children:[!r&&(0,o.jsx)(M.Td,{children:v&&(0,o.jsx)(h.JO,{as:v})}),(0,o.jsx)(M.Td,{maxW:"200px",children:(0,o.jsxs)(i.xv,{as:"span",fontSize:"xs",noOfLines:1,whiteSpace:"nowrap",title:null!==(n=null===x||void 0===x?void 0:x.name)&&void 0!==n?n:z.Nj,children:[(0,o.jsx)(h.JO,{as:g,mr:"2"}),null!==(t=null===f||void 0===f?void 0:f.name)&&void 0!==t?t:z.Nj]})}),(0,o.jsx)(M.Td,{borderRightColor:"gray.200",children:(0,o.jsx)(i.xv,{as:"span",fontSize:"xs",children:null!==(a=null===f||void 0===f?void 0:f.schema_type)&&void 0!==a?a:z.Nj})}),"all"!==p&&(0,o.jsx)(M.Td,{borderRightColor:"gray.200",children:(0,o.jsx)(q,{baseColumn:x,targetColumn:m,stat:p})}),"all"===p&&I.map((function(e){var n=(0,d.Z)(e,1)[0];return(0,o.jsx)(M.Td,{borderRightColor:"gray.200",children:(0,o.jsx)(q,{baseColumn:x,targetColumn:m,stat:n})})}))]},c)}))})]})})]}):(0,o.jsx)(o.Fragment,{})}var G=t(41370),J=t(44576);var U=t(73661),V=t.n(U),K=300,$=60,Q=20,Y=function(){var e=(0,Z.Z)((0,k.Z)().mark((function e(n,t){var i,r,a,o,l,s,c;return(0,k.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],a=[],o=[],l=t.isLayout||!0,s=t.layoutLibrary||"dagre",i="selected"===t.filterBy?new Set(te(n,t.selected)):"changed"===t.filterBy?new Set(ne(n)):new Set(Object.keys(n)),Object.entries(n).forEach((function(e){var n=(0,d.Z)(e,2),r=n[0],o=n[1];if(i.has(r)&&"test"!==o.type){var l={id:r,position:{x:0,y:0},data:(0,C.Z)((0,C.Z)({},o),t.nodeOverrides),draggable:!0,type:"customNode"};a.push(l)}})),a.forEach((function(e){var n=e.data;Object.entries(n.dependsOn).forEach((function(e){var r=(0,d.Z)(e,2),a=r[0],l=r[1];i.has(a)&&o.push({source:a,target:n.uniqueId,id:"".concat(n.uniqueId," -> ").concat(a),type:"customEdge",data:(0,C.Z)((0,C.Z)({},l),t.edgeOverrides)})}))})),t.groupBy&&a.forEach((function(e){var n=e.data,i=void 0,a=void 0;switch(t.groupBy){case"type":i="group-".concat(n.type),a=n.type;break;case"package":n.packageName&&(i="group-".concat(n.packageName),a=n.packageName);break;case"tag:piperider":n.tags.includes("piperider")&&(i="group-piperider",a="piperider");break;case"filepath":if(n.filePath&&n.filePath.split("/").length>1&&"model"===n.type){var o=n.filePath.split("/")[0];i="group-".concat(o),a=o}}i&&a&&(r.find((function(e){return e.id===i}))||r.push({id:i,position:{x:0,y:0},data:{label:"Group: ".concat(a)},type:"customGroup"}),e.parentNode=i,e.extent="parent",e.expandParent=!0,e.draggable=!1)})),c={nodes:r.concat(a),edges:o},l&&("dagre"===s?(r.length>0?re(r,a,o,"LR"):ie(a,o,"LR"),c={nodes:r.concat(a),edges:o}):"subflow"===s&&(ie(a,o,"LR"),ae(r,a))),e.abrupt("return",c);case 12:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),X=function e(n,t){var i=n[t],r=[t];return Object.keys(i.dependsOn).length>0&&Object.keys(i.dependsOn).forEach((function(t){r.push.apply(r,(0,S.Z)(e(n,t)))})),r},ee=function e(n,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=n[t],a=[];return i&&a.push(t),Object.keys(r.children).length>0&&Object.keys(r.children).forEach((function(t){a.push.apply(a,(0,S.Z)(e(n,t,!0)))})),a},ne=function(e){var n=new Set,t=new Set;return Object.entries(e).forEach((function(i){var r=(0,d.Z)(i,2),a=r[0],o=r[1];if(void 0!==o.changeStatus&&null!==o.changeStatus){n.add(a);var l,s=(0,p.Z)(ee(e,a));try{for(s.s();!(l=s.n()).done;){var c=l.value;t.add(c)}}catch(u){s.e(u)}finally{s.f()}}})),t.forEach((function(e){n.add(e)})),Array.from(n)},te=function(e,n){return n?[].concat((0,S.Z)(X(e,n)),(0,S.Z)(ee(e,n))):[]},ie=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"LR",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r="LR"===t,a=new(V().graphlib.Graph);a.setDefaultEdgeLabel((function(){return{}})),a.setGraph({rankdir:t}),e.forEach((function(e){a.setNode(e.id,{width:K,height:$})})),n.forEach((function(e){a.setEdge(e.source,e.target)})),V().layout(a),e.forEach((function(e){var n=a.node(e.id);return e.targetPosition=r?"left":"top",e.sourcePosition=r?"right":"bottom",e.position={x:n.x-150+i,y:n.y-30+i},e}))},re=function(e,n,t){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"LR",r="LR"===i,a=new(V().graphlib.Graph);a.setDefaultEdgeLabel((function(){return{}})),a.setGraph({rankdir:i,nodesep:100,ranksep:100}),e.forEach((function(e){var r=n.filter((function(n){return n.parentNode===e.id})),o=t.filter((function(e){return r.map((function(e){return e.id})).includes(e.source)&&r.map((function(e){return e.id})).includes(e.target)}));ie(r,o,i,Q);var l=Math.max.apply(Math,(0,S.Z)(r.map((function(e){return e.position.x+K}))))+Q,s=Math.max.apply(Math,(0,S.Z)(r.map((function(e){return e.position.y+$}))))+Q;a.setNode(e.id,{width:l,height:s}),e.style={width:l,height:s},t.forEach((function(n){o.includes(n)?n.data.group=e.id:n.data.group=void 0}))})),n.forEach((function(e){void 0===e.parentNode&&a.setNode(e.id,{width:K,height:$})})),t.forEach((function(e){var t,i;if(!e.data.group){var r=(null===(t=n.find((function(n){return n.id===e.source})))||void 0===t?void 0:t.parentNode)||e.source,o=(null===(i=n.find((function(n){return n.id===e.target})))||void 0===i?void 0:i.parentNode)||e.target;console.log("Group edge",r,o),a.setEdge(r,o)}})),V().layout(a),e.forEach((function(e){var n=a.node(e.id);e.targetPosition=r?w.Ly.Left:w.Ly.Top,e.sourcePosition=r?w.Ly.Right:w.Ly.Bottom,e.position={x:n.x-n.width/2,y:n.y-n.height/2}})),n.forEach((function(e){if(!e.parentNode){var n=a.node(e.id);e.targetPosition=r?w.Ly.Left:w.Ly.Top,e.sourcePosition=r?w.Ly.Right:w.Ly.Bottom,e.position={x:n.x-150,y:n.y-30}}}))},ae=function(e,n){e.forEach((function(e){e.position.x=Math.min.apply(Math,(0,S.Z)(n.filter((function(n){return n.parentNode===e.id})).map((function(e){return e.position.x}))))-Q,e.position.y=Math.min.apply(Math,(0,S.Z)(n.filter((function(n){return n.parentNode===e.id})).map((function(e){return e.position.y}))))-Q,e.style={width:Math.max.apply(Math,(0,S.Z)(n.filter((function(n){return n.parentNode===e.id})).map((function(e){return e.position.x+K}))))-e.position.x+Q,height:Math.max.apply(Math,(0,S.Z)(n.filter((function(n){return n.parentNode===e.id})).map((function(e){return e.position.y+$}))))-e.position.y},n.forEach((function(n){n.parentNode===e.id&&(n.position.x-=e.position.x,n.position.y-=e.position.y)}))}))},oe=t(1352),le=t(95282),se={customNode:function(e){var n,t,r,a,l,s,c=e.data,u=c.singleOnly,x=c.stat,m=c.isHighlighted,f=(0,g.TH)(),p=(0,d.Z)(f,1)[0],v=c.path===p,j=null===c||void 0===c?void 0:c.type,y=!1,C=(0,b.yk)(j),S=C.color,k=C.icon;"source"!==j&&"seed"!==j&&"model"!==j||(y=void 0===(null===(r=null!==(l=c.target)&&void 0!==l?l:c.base)||void 0===r||null===(a=r.__table)||void 0===a?void 0:a.row_count));var Z,O=c.changeStatus,T="inherit",_="inherit",N="solid";u||(Z=(0,b.Mr)(O).icon,T=(0,b.Mr)(O).color,"added"===O?(s="added",N="dashed"):"modified"===O?s="explict change":"implicit"===O?s="implicit change":"removed"===O?(s="removed",N="dashed"):T=y?"gray":"black");var F=1,M=T,z="white",L="unset";v&&(F=1,M=B,z="piperider.400",T="white"),m&&(F=1,M=B,L="0px 5px 15px #00000040");var E=null===c||void 0===c?void 0:c.name,D=(0,J.k)({base:null===c||void 0===c?void 0:c.base,target:null===c||void 0===c?void 0:c.target,stat:x}),A=D.statValue,H=D.statValueF;return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(i.kC,{width:"300px",_hover:{backgroundColor:v?z:"gray.100"},borderColor:M,borderWidth:F,borderStyle:N,backgroundColor:z,borderRadius:3,boxShadow:L,padding:0,children:[(0,o.jsx)(G.u,{label:j,children:(0,o.jsx)(i.kC,{backgroundColor:S,padding:2,borderRightWidth:F,borderColor:M,borderStyle:N,alignItems:"top",children:(0,o.jsx)(h.JO,{as:k})})}),(0,o.jsxs)(i.gC,{flex:"1 0 auto",mx:"1",width:"100px",children:[(0,o.jsxs)(i.kC,{width:"100%",textAlign:"left",flex:"1",fontWeight:_,p:1,alignItems:"center",children:[(0,o.jsx)(i.xu,{flex:"1",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:v?"white":"inherit",children:(0,o.jsx)(G.u,{label:E,children:E})}),!u&&O&&(0,o.jsx)(G.u,{label:s,children:(0,o.jsx)(i.kC,{children:(0,o.jsx)(h.JO,{color:T,as:Z,fontWeight:_,flex:"0 0 20px"})})}),u&&x&&void 0!==A&&(0,o.jsx)(i.xv,{fontWeight:"bold",textAlign:"right",fontSize:"sm",children:H})]}),!u&&x&&void 0!==A&&(0,o.jsx)(i.xu,{width:"100%",children:(0,o.jsx)(i.xv,{textAlign:"right",fontSize:"sm",color:v?"white":"inherit",children:(0,o.jsx)(J.h,{base:null===c||void 0===c?void 0:c.base,target:null===c||void 0===c?void 0:c.target,stat:x,isActive:v})})})]}),Object.keys(null!==(n=null===c||void 0===c?void 0:c.dependsOn)&&void 0!==n?n:{}).length>0&&(0,o.jsx)(w.HH,{type:"target",position:w.Ly.Left}),Object.keys(null!==(t=null===c||void 0===c?void 0:c.children)&&void 0!==t?t:{}).length>0&&(0,o.jsx)(w.HH,{type:"source",position:w.Ly.Right})]})})},customGroup:function(e){var n=e.data;return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(i.kC,{style:{height:"100%",position:"relative",backgroundColor:"#B3B3B340",borderRadius:"5px"},children:(0,o.jsx)("label",{style:{position:"absolute",bottom:0,right:0,textAlign:"right",margin:"5px"},children:n.label})})})}},de={customEdge:function(e){var n=e.sourceX,t=e.sourceY,i=e.targetX,r=e.targetY,a=e.sourcePosition,l=e.targetPosition,s=e.style,c=void 0===s?{}:s,u=e.markerEnd,h=e.data,x=(0,C.Z)({},c);x.storke="gray",null!==h&&void 0!==h&&h.singleOnly||(null!==h&&void 0!==h&&h.from.includes("target")?null!==h&&void 0!==h&&h.from.includes("base")||(x.stroke=R,x.strokeDasharray="5"):(x.stroke=P,x.strokeDasharray="5")),null!==h&&void 0!==h&&h.isHighlighted&&(x.stroke=B);var m=(0,w.OQ)({sourceX:n,sourceY:t,sourcePosition:a,targetX:i,targetY:r,targetPosition:l}),f=(0,d.Z)(m,1)[0];return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(w.u5,{path:f,markerEnd:u,style:(0,C.Z)((0,C.Z)({},x),c)})})}};function ce(e){var n=e.singleOnly,t=(0,w._K)(),r=f.n.getState().lineageGraph,l=void 0===r?{}:r,s=(0,w.Rr)([]),u=(0,d.Z)(s,3),h=u[0],m=u[1],p=u[2],v=(0,w.ll)([]),j=(0,d.Z)(v,3),b=j[0],y=j[1],F=j[2],M=(0,c.qY)(),z=M.isOpen,L=M.onOpen,A=M.onClose,H=(0,E.e$)().uniqueId,R=(0,g.TH)(),P=(0,d.Z)(R,2)[1],B=(0,a.useState)(n?void 0:"changed"),I=(0,d.Z)(B,2),q=I[0],G=I[1],J=(0,a.useState)(H),U=(0,d.Z)(J,2),V=U[0],K=U[1],$=(0,a.useState)("dagre"),Q=(0,d.Z)($,2),ne=Q[0],te=Q[1],ie=(0,a.useState)(""),re=(0,d.Z)(ie,2),ae=re[0],ce=re[1],ue=(0,a.useState)(""),he=(0,d.Z)(ue,2),xe=he[0],me=he[1];(0,oe.m)({eventName:le.FP.PAGE_VIEW,eventProperties:{type:n?le.ll:le.bB,page:"lineage-graph"}});var fe=(0,a.useCallback)((function(e,n){var t=n.data;null!==t&&void 0!==t&&t.path&&P((null===t||void 0===t?void 0:t.path)||""),"source"!==t.type&&"seed"!==t.type&&t.type}),[L]),pe=(0,a.useCallback)((function(){G("changed")}),[G]),ge=(0,a.useCallback)((function(){K(H),G("selected")}),[H,K,G]),ve=(0,a.useCallback)((function(){G(void 0)}),[G]),je=(0,a.useCallback)((function(){G(n?void 0:"changed"),ce(""),te("dagre"),me(""),t.fitView({maxZoom:1})}),[G,ce,te,me,t,n]);return(0,a.useEffect)((function(){var e=function(){var e=(0,Z.Z)((0,k.Z)().mark((function e(){var i,r,a;return(0,k.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(l,{nodeOverrides:{singleOnly:n||!1,isHighlighted:!1,stat:ae},edgeOverrides:{singleOnly:n||!1},layoutLibrary:ne,filterBy:q,selected:V,groupBy:xe||void 0});case 2:i=e.sent,r=i.nodes,a=i.edges,m(r),y(a),setTimeout((function(){return t.fitView({maxZoom:1})}),0);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[l,m,y,n,ne,xe,ae,q,V,t]),(0,o.jsxs)(i.kC,{flexDirection:"column",style:{width:"100%",height:"calc(100vh - 160px)"},children:[(0,o.jsxs)(i.kC,{flex:"1",children:[(0,o.jsxs)(w.x$,{nodes:h,edges:b,nodeTypes:se,edgeTypes:de,onNodesChange:p,onEdgesChange:F,onNodeClick:fe,onNodeMouseEnter:function(e,n){return function(e){var n=[].concat((0,S.Z)(X(l,e.id)),(0,S.Z)(ee(l,e.id))),t=b.filter((function(e){return n.includes(e.source)&&n.includes(e.target)}));y(b.map((function(e){return t.includes(e)?(0,C.Z)((0,C.Z)({},e),{},{data:(0,C.Z)((0,C.Z)({},e.data),{},{isHighlighted:!0})}):e}))),m(h.map((function(e){return n.includes(e.id)?(0,C.Z)((0,C.Z)({},e),{},{data:(0,C.Z)((0,C.Z)({},e.data),{},{isHighlighted:!0})}):e})))}(n)},onNodeMouseLeave:function(){return y(b.map((function(e){return(0,C.Z)((0,C.Z)({},e),{},{data:(0,C.Z)((0,C.Z)({},e.data),{},{isHighlighted:!1})})}))),void m(h.map((function(e){return(0,C.Z)((0,C.Z)({},e),{},{data:(0,C.Z)((0,C.Z)({},e.data),{},{isHighlighted:!1})})})))},onNodeContextMenu:function(e,n){e.preventDefault(),console.log("context menu")},minZoom:.1,fitView:!0,children:[(0,o.jsx)(O.Z,{showInteractive:!1}),(0,o.jsx)(T.a,{nodeStrokeWidth:3,zoomable:!0,pannable:!0}),void 0!==q&&(0,o.jsx)(w.s_,{position:"top-left",children:(0,o.jsxs)(i.xv,{fontSize:"sm",children:["selected"===q&&(h.length>0?"Active node and its depedencies.":"No active node."),"changed"===q&&(h.length>0?"Changed nodes and their downstreams.":"No changed nodes found.")," ",(0,o.jsx)(i.rU,{color:"blue",onClick:function(){ve()},children:"Show all nodes"})]})})]}),(0,o.jsx)(W,{singleOnly:n,isOpen:z,onClose:A})]}),(0,o.jsxs)(i.kC,{flex:"0 0 60px",bg:"gray.100",gap:3,px:10,py:2,border:"0px solid lightgray",borderTopWidth:1,alignItems:"center",children:[(0,o.jsxs)(i.xu,{p:2,children:[(0,o.jsx)(i.xv,{fontSize:"sm",color:"gray",children:"Stat"}),(0,o.jsxs)(_.Ph,{value:ae,fontSize:"sm",variant:"unstyled",onChange:function(e){var n=e.target.value||"";ce(n)},children:[(0,o.jsx)("option",{value:"",children:"No stat"}),(0,o.jsx)("option",{value:"execution_time",children:"Execution time"}),(0,o.jsx)("option",{value:"row_count",children:"Row count"})]})]}),(0,o.jsx)(i.LZ,{}),(0,o.jsxs)(x.hE,{size:"sm",isAttached:!0,variant:"outline",borderRadius:"md",borderWidth:"1px",children:[(0,o.jsx)(x.zx,{_hover:{bg:"gray.200"},onClick:je,children:"Reset"}),(0,o.jsxs)(N.v2,{children:[(0,o.jsx)(N.j2,{as:x.hU,icon:(0,o.jsx)(D.v4,{}),_hover:{bg:"gray.200"}}),(0,o.jsxs)(N.qy,{children:[(0,o.jsx)(N.sN,{fontSize:"sm",onClick:ve,children:"All nodes"}),!n&&(0,o.jsx)(N.sN,{fontSize:"sm",onClick:pe,children:"Change only"}),(0,o.jsx)(N.sN,{fontSize:"sm",onClick:ge,children:"Focus active"})]})]})]})]})]})}function ue(e){var n=e.singleOnly;return(0,o.jsx)(w.tV,{children:(0,o.jsx)(ce,{singleOnly:n})})}function he(e){var n=e.singleOnly,t=f.n.getState(),r=t.isLegacy,s=t.projectTree,p=t.databaseTree,j=t.expandTreeForPath,b=(0,g.TH)(),C=(0,d.Z)(b,1)[0],S=(0,a.useState)(-1),k=(0,d.Z)(S,2),Z=k[0],w=k[1],O=(0,c.qY)(),T=O.isOpen,_=O.onOpen,N=O.onClose,F=(0,a.useContext)(l);return(0,a.useEffect)((function(){"/ssr"!==C&&Z<0&&(j(C),w(0))}),[C,Z,j]),r?(0,o.jsx)(i.xu,{mt:5,children:(0,o.jsx)(y,{items:s,singleOnly:n})}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(u.mQ,{index:Z,onChange:function(e){j(C),w(e)},children:[(0,o.jsxs)(u.td,{children:[(0,o.jsxs)(u.OK,{children:[(0,o.jsx)(h.JO,{as:v.$nz,mr:2}),"Project"]}),(0,o.jsxs)(u.OK,{children:[(0,o.jsx)(h.JO,{as:v.i1q,mr:2}),"Database"]})]}),(0,o.jsxs)(u.nP,{children:[(0,o.jsx)(u.x4,{children:(0,o.jsx)(y,{items:s,singleOnly:n})}),(0,o.jsx)(u.x4,{children:(0,o.jsx)(y,{items:p,singleOnly:n})})]})]}),F&&(0,o.jsx)(x.zx,{style:{position:"fixed",bottom:0,right:0},onClick:_,children:"Show Graph"}),(0,o.jsxs)(m.u_,{isOpen:T,onClose:N,size:"xl",children:[(0,o.jsx)(m.ZA,{}),(0,o.jsxs)(m.hz,{maxW:"calc(100vw - 200px)",backgroundColor:"#f6f6f6",children:[(0,o.jsxs)(m.xB,{borderBottom:2,backgroundColor:"gray.100",border:"0 solid lightgray",borderBottomWidth:1,children:[(0,o.jsx)(i.xv,{fontSize:"sm",children:"Lineage Graph"}),(0,o.jsx)(m.ol,{})]}),(0,o.jsx)(m.fe,{p:0,children:(0,o.jsx)(ue,{singleOnly:n})})]})]})]})}function xe(e){var n=e.children,t=e.sideNavTop,a=void 0===t?"0px":t,l=e.cloud,d=e.singleOnly;return(0,o.jsx)(s,{cloud:!0===l,children:(0,o.jsxs)(i.rj,{width:"100%",h:"100%",templateColumns:"minmax(200px, 400px) 1px minmax(420px, 100%)",children:[(0,o.jsx)(i.P4,{overflowY:"auto",position:"sticky",top:a,maxHeight:"calc(100vh - ".concat(a,")"),children:(0,o.jsx)(he,{singleOnly:d})}),(0,o.jsx)(i.iz,{orientation:"vertical"}),(0,o.jsx)(i.P4,{maxHeight:r.t4,width:"100%",h:"100%",p:9,children:n})]})})}},11288:function(e,n,t){t.d(n,{T:function(){return l}});var i=t(7615),r=t(46569),a=t(82904),o=t(15887);function l(){return(0,o.jsxs)(i.kC,{direction:"column",width:"100%",minH:"100vh",justifyContent:"center",alignItems:"center",children:[(0,o.jsx)(i.X6,{fontSize:"3xl",children:"404, Not Found!"}),(0,o.jsx)(r.zx,{mt:4,children:(0,o.jsx)(a.rU,{href:"/",children:"Back to Home"})})]})}},96969:function(e,n,t){function i(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"decimal";if(void 0!==e){if("decimal"===n)return new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:2}).format(e);if("percent"===n)return new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2}).format(e);if("duration"===n){var t=e<0?"-":"",i=Math.abs(e),r=Math.floor(i%60),a=Math.floor(i/60%60),o=Math.floor(i/3600),l=new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),s=new Intl.NumberFormat("en-US",{minimumIntegerDigits:2});return i<10?"".concat(t).concat(l.format(i),'"'):i<60?"".concat(t).concat(r,'"'):i<3600?"".concat(t).concat(a,"'").concat(s.format(r),'"'):"".concat(t).concat(o,"h").concat(s.format(a),"'").concat(s.format(r),'"')}}}function r(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"decimal",a=void 0!==n&&n.hasOwnProperty(t)?n[t]:void 0,o=void 0!==e&&e.hasOwnProperty(t)?e[t]:void 0,l=null!==a&&void 0!==a?a:o;if(void 0===l)return{statValueF:"-"};var s=i(l,r);if(void 0===o||void 0===a)return{statValue:l,statValueF:s};var d=a-o;"duration"===r&&Math.abs(d)<.01&&(d=0);var c=i(d,r);return{statValue:l,statValueF:s,statDiff:d,statDiffF:c}}t.d(n,{U:function(){return r}})},53695:function(e,n,t){t.d(n,{g:function(){return L}});var i=t(61431),r=t(11060),a=t(82175),o=t(7615),l=t(38723),s=t(26468),d=t(67745),c=t(88050),u=t(46569),h=t(31756),x=t(59439),m=t(24321),f=t(86629),p=t(12158),g=t(97348),v=t(41370),j=t(52912),b=t(82904),y=t(39e3),C=t(15887);function S(e){var n=e.value,t=e.changeStatus,i=(0,y.Mr)(t),r=i.icon,a=i.color;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(c.JO,{as:r,color:a})," ",(0,C.jsx)(o.xv,{ml:1,children:n})]})}function k(e){var n=e.added,t=e.removed,i=e.modified,r=e.implicit,a=[],l=!0;return n&&(a.push(l?(0,C.jsx)(C.Fragment,{children:"("}):(0,C.jsx)(o.xu,{pr:2,children:","})),a.push((0,C.jsx)(S,{value:n,changeStatus:"added"})),l=!1),t&&(a.push(l?(0,C.jsx)(C.Fragment,{children:"("}):(0,C.jsx)(o.xu,{pr:2,children:","})),a.push((0,C.jsx)(S,{value:t,changeStatus:"removed"})),l=!1),i&&(a.push(l?(0,C.jsx)(C.Fragment,{children:"("}):(0,C.jsx)(o.xu,{pr:2,children:","})),a.push((0,C.jsx)(S,{value:i,changeStatus:"modified"})),l=!1),r&&(a.push(l?(0,C.jsx)(C.Fragment,{children:"("}):(0,C.jsx)(o.xu,{pr:2,children:","})),a.push((0,C.jsx)(S,{value:r,changeStatus:"implicit"})),l=!1),l||a.push((0,C.jsx)(C.Fragment,{children:")"})),(0,C.jsx)(o.xu,{display:"inline-block",children:(0,C.jsx)(o.kC,{alignItems:"center",justifyContent:"center",children:a})})}var Z=t(44576);function w(e){var n=e.tableColumnsOnly,t=e.sortMethod,r=e.handleSortChange,a=e.singleOnly;return(0,C.jsx)(g.xJ,{children:(0,C.jsxs)(g.iA,{variant:"simple",children:[(0,C.jsx)(g.hr,{children:(0,C.jsxs)(g.Tr,{children:[!a&&(0,C.jsx)(g.Th,{p:0,width:"30px"}),(0,C.jsxs)(g.Th,{pl:0,children:["Name"," ",(0,C.jsx)(v.u,{label:"sort by ".concat(t," order"),children:(0,C.jsx)(u.hU,{"aria-label":"Sort",icon:"alphabet"===t?(0,C.jsx)(j.Llq,{}):(0,C.jsx)(j.yzb,{}),onClick:r,size:"sm",ml:"1"})})]}),(0,C.jsx)(g.Th,{children:"Columns"}),(0,C.jsx)(g.Th,{isNumeric:!0,children:"Rows"}),(0,C.jsx)(g.Th,{isNumeric:!0,children:"Execution Time"})]})}),(0,C.jsx)(g.p3,{fontSize:"sm",children:n.map((function(e,n){var t=(0,i.Z)(e,3),r=t[1],l=r.base,s=r.target,d=t[2],u=null!==l&&void 0!==l?l:s;if(!u)return(0,C.jsx)(C.Fragment,{});var h=(0,y.Mr)(d.changeStatus),x=h.icon,m=h.color;return(0,C.jsxs)(g.Tr,{children:[!a&&(0,C.jsx)(g.Td,{p:0,children:(0,C.jsx)(o.kC,{alignContent:"center",children:x&&(0,C.jsx)(c.JO,{color:m,as:x})})}),(0,C.jsx)(g.Td,{pl:0,children:(0,C.jsx)(b.rU,{href:"/".concat(u.resource_type,"s/").concat(u.unique_id),children:u.name})}),(0,C.jsxs)(g.Td,{children:["".concat(Object.keys((null===u||void 0===u?void 0:u.columns)||{}).length),!a&&(0,C.jsx)(k,{added:d.added,removed:d.deleted,modified:d.changed})]}),(0,C.jsx)(g.Td,{textAlign:"right",fontSize:"sm",children:(0,C.jsx)(Z.h,{base:l,target:s,stat:"row_count"})}),(0,C.jsx)(g.Td,{textAlign:"right",fontSize:"sm",children:(0,C.jsx)(Z.h,{base:l,target:s,stat:"execution_time"})})]})}))})]})})}var O=t(64947);function T(e){var n=e.name,t=e.value,i=e.tip;return(0,C.jsxs)(o.gC,{alignItems:"flex-start",children:[(0,C.jsxs)(o.xv,{fontSize:"sm",color:"gray",children:[n,i&&(0,C.jsx)(v.u,{label:i,children:(0,C.jsx)(o.xu,{display:"inline-block",children:(0,C.jsx)(c.JO,{mx:"2px",as:O.H33,boxSize:3})})})]}),(0,C.jsx)(o.xv,{fontSize:"l",children:t})]})}function _(e){var n=e.tableColumnsOnly,t=(e.noImpacted,n.reduce((function(e,n){var t=(0,i.Z)(n,3),r=(t[0],t[1]),a=(r.base,r.target),o=t[2],l=o.changeStatus,s=o.impacted;return{total:e.total+(a?1:0),added:e.added+("added"===l?1:0),removed:e.removed+("removed"===l?1:0),modified:e.modified+("modified"===l?1:0),impacted:e.impacted+(s?1:0),implicit:e.implicit+("implicit"===l?1:0)}}),{total:0,added:0,removed:0,modified:0,impacted:0,implicit:0})),r=t.total,a=t.added,l=t.removed,s=t.modified,d=t.impacted,c=t.implicit;return(0,C.jsxs)(o.rj,{templateColumns:"repeat(4, 1fr)",gap:6,children:[(0,C.jsx)(T,{name:"Total",value:r}),(0,C.jsx)(T,{name:"Explicit Changes",value:(0,C.jsxs)(C.Fragment,{children:[a+l+s," ",(0,C.jsx)(k,{added:a,removed:l,modified:s})," "]}),tip:"Code change or config change"}),(0,C.jsx)(T,{name:"Impacted",value:d,tip:"Explicit changes and their downstream"}),(0,C.jsx)(T,{name:"Implicit Changes",value:c,tip:"Any detected changes which are not explicit changed"})]})}function N(e){var n=e.tableColumnsOnly,t=e.sortMethod,r=e.handleSortChange,a=e.singleOnly;return(0,C.jsx)(g.xJ,{children:(0,C.jsxs)(g.iA,{variant:"simple",children:[(0,C.jsx)(g.hr,{children:(0,C.jsxs)(g.Tr,{children:[!a&&(0,C.jsx)(g.Th,{p:0,width:"30px"}),(0,C.jsxs)(g.Th,{pl:0,children:["Name"," ",(0,C.jsx)(v.u,{label:"sort by ".concat(t," order"),children:(0,C.jsx)(u.hU,{"aria-label":"Sort",icon:"alphabet"===t?(0,C.jsx)(j.Llq,{}):(0,C.jsx)(j.yzb,{}),onClick:r,size:"sm",ml:"1"})})]}),(0,C.jsx)(g.Th,{children:"Queries"})]})}),(0,C.jsx)(g.p3,{fontSize:"sm",children:n.map((function(e,n){var t=(0,i.Z)(e,3),r=t[1],l=r.base,s=r.target,d=t[2],u=null!==l&&void 0!==l?l:s;if(!u)return(0,C.jsx)(C.Fragment,{});var h=(0,y.Mr)(d.changeStatus),x=h.icon,m=h.color;return(0,C.jsxs)(g.Tr,{children:[!a&&(0,C.jsx)(g.Td,{p:0,children:(0,C.jsx)(o.kC,{alignContent:"center",children:x&&(0,C.jsx)(c.JO,{color:m,as:x})})}),(0,C.jsx)(g.Td,{pl:0,children:(0,C.jsx)(b.rU,{href:"/metrics/".concat(u.unique_id),children:u.name})}),(0,C.jsxs)(g.Td,{children:["".concat(Object.keys((null===u||void 0===u?void 0:u.__queries)||{}).length),(0,C.jsx)(k,{added:d.added,removed:d.deleted,modified:d.changed})]})]})}))})]})})}function F(e,n){var t=(0,y.Mr)(n),i=t.icon,r=t.color;return(0,C.jsx)(d.ii,{value:n||"noChange",children:(0,C.jsxs)(o.kC,{alignItems:"center",gap:1,children:[i&&(0,C.jsx)(c.JO,{as:i,color:r}),(0,C.jsx)(o.xu,{children:e})]})})}function M(e){var n=e.filterOptions,t=e.setFilterOptions,i=n.changeStatus,o=[];return i.has("added")&&i.has("removed")&&i.has("modified")&&i.has("implicit")&&(o=i.has("noChange")?["all"]:["changed"]),(0,C.jsxs)(d.v2,{closeOnSelect:!1,children:[(0,C.jsx)(d.j2,{as:u.hU,icon:(0,C.jsx)(x.r0X,{}),size:"md",variant:"outline"}),(0,C.jsxs)(d.qy,{minWidth:"240px",children:[(0,C.jsxs)(d.__,{type:"checkbox",value:o,children:[(0,C.jsx)(d.ii,{value:"changed",onClick:function(){t((0,a.Z)((0,a.Z)({},n),{},{changeStatus:new Set(["added","removed","modified","implicit"])}))},children:"Change only"}),(0,C.jsx)(d.ii,{value:"all",onClick:function(){t((0,a.Z)((0,a.Z)({},n),{},{changeStatus:new Set(["added","removed","modified","implicit","noChange"])}))},children:"All nodes"})]}),(0,C.jsx)(d.R,{}),(0,C.jsxs)(d.__,{type:"checkbox",value:(0,r.Z)(Array.from(i)),onChange:function(e){t((0,a.Z)((0,a.Z)({},n),{},{changeStatus:new Set(e)}))},children:[F("Added","added"),F("Removed","removed"),F("Modified","modified"),F("Implicit","implicit"),F("No change")]})]})]})}var z={changeStatus:new Set(["added","removed","modified","implicit"])};function L(e){var n=e.singleOnly,t=f.n.getState(),d=t.tableColumnsOnly,u=void 0===d?[]:d,x=t.lineageGraph,g=(0,h.useState)("topology"),v=(0,i.Z)(g,2),j=v[0],b=v[1],S=(0,h.useState)(0),k=(0,i.Z)(S,2),Z=k[0],O=k[1],T=(0,h.useState)(z),F=(0,i.Z)(T,2),L=F[0],E=F[1],D=function(){b("alphabet"===j?"topology":"alphabet")},A=function(e){var n={};e.forEach((function(e){var t,r=(0,i.Z)(e,3),a=(r[0],r[1]),o=a.base,l=a.target,s=r[2],d=null!==l&&void 0!==l?l:o,c=null!==(t=null===d||void 0===d?void 0:d.resource_type)&&void 0!==t?t:"";n[c]||(n[c]={total:0,changed:0}),n[c].total+=1,s.changeStatus&&(n[c].changed+=1)}));var t=[];return n.model&&t.push((0,a.Z)({resourceType:"model",name:"Models",icon:(0,y.yk)("model").icon},n.model)),n.seed&&t.push((0,a.Z)({resourceType:"seed",name:"Seeds",icon:(0,y.yk)("seed").icon},n.seed)),n.source&&t.push((0,a.Z)({resourceType:"source",name:"Sources",icon:(0,y.yk)("source").icon},n.source)),n.metric&&t.push((0,a.Z)({resourceType:"metric",name:"Metrics",icon:(0,y.yk)("metric").icon},n.metric)),t}(u),H=A[Z].resourceType,R=(0,h.useMemo)((function(){var e=u.filter((function(e){var n=(0,i.Z)(e,2),t=(n[0],n[1]),r=t.base,a=t.target,o=null!==a&&void 0!==a?a:r;return(null===o||void 0===o?void 0:o.resource_type)===H}));return"topology"===j&&x?function(e,n){var t=(0,m.zX)(Object.keys(n),(function(e){var t=n[e].children;return Object.keys(t)})),i={};e.forEach((function(e){i[e[0]]=e}));var r=[];return t.forEach((function(e){i[e]&&r.push(i[e])})),r}(e,x):function(e){function n(e){var n,t=(0,i.Z)(e,2),r=(t[0],t[1]),a=r.base,o=r.target,l=null!==o&&void 0!==o?o:a;return null!==(n=null===l||void 0===l?void 0:l.name)&&void 0!==n?n:""}var t=(0,r.Z)(e);return t.sort((function(e,t){var i=n(e).toLowerCase(),r=n(t).toLowerCase();return i.localeCompare(r)})),t}(e)}),[H,j,u,x]),P=R.filter((function(e){var t,r=(0,i.Z)(e,3),a=r[1],o=a.base,l=a.target,s=r[2],d=null!==o&&void 0!==o?o:l;if(!d)return!1;if(L.search&&!(null!==(t=null===d||void 0===d?void 0:d.name)&&void 0!==t?t:"").includes(L.search))return!1;if(!n){if(!L.changeStatus.has("noChange")&&null===s.changeStatus)return!1;if(!L.changeStatus.has("added")&&"added"===s.changeStatus)return!1;if(!L.changeStatus.has("removed")&&"removed"===s.changeStatus)return!1;if(!L.changeStatus.has("modified")&&"modified"===s.changeStatus)return!1;if(!L.changeStatus.has("implicit")&&"implicit"===s.changeStatus)return!1}return!0}));return(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)(o.kC,{direction:"column",w:"100%",minHeight:"650px",children:[(0,C.jsxs)(o.kC,{w:"100%",children:[(0,C.jsx)(o.X6,{fontSize:24,children:"Overview"}),(0,C.jsx)(o.LZ,{})]}),(0,C.jsx)(l.mQ,{onChange:O,mb:4,children:(0,C.jsx)(l.td,{children:A.map((function(e){return(0,C.jsxs)(l.OK,{children:[(0,C.jsx)(c.JO,{as:e.icon,mr:1}),e.name,!n&&e.changed>0&&(0,C.jsx)(s.Vp,{size:"sm",bg:"red.400",color:"white",ml:2,children:e.changed})]})}))})}),!n&&(0,C.jsx)(_,{tableColumnsOnly:R,noImpacted:"source"===H||"seed"===H}),(0,C.jsxs)(o.kC,{alignContent:"stretch",gap:3,my:2,children:[(0,C.jsx)(p.f,{onChange:function(e){E((0,a.Z)((0,a.Z)({},L),{},{search:e}))},placeholder:"Search ".concat(H,"s")}),!n&&(0,C.jsx)(M,{filterOptions:L,setFilterOptions:E})]}),"metric"===H&&(0,C.jsx)(N,{tableColumnsOnly:P,sortMethod:j,handleSortChange:D,singleOnly:n}),("model"===H||"seed"===H||"source"===H)&&(0,C.jsx)(w,{tableColumnsOnly:P,sortMethod:j,handleSortChange:D,singleOnly:n})]})})}},26564:function(e,n,t){t.d(n,{O:function(){return C}});var i=t(82175),r=t(61431),a=t(37932),o=t(12599),l=t(33660),s=t(7615),d=t(97348),c=t(34054),u=t(41370),h=t(6783),x=t(94240),m=t(31756),f=t(1831),p=t(89408),g=t(53554),v=t(83512),j=t(15887),b=["comparableAssertions","filterByTableOnly","filterString","setFilterString","caseSensitiveFilter","singleOnly","tableSize"],y=["status"];function C(e){var n=e.comparableAssertions,t=e.filterByTableOnly,C=e.filterString,S=void 0===C?"":C,k=(e.setFilterString,e.caseSensitiveFilter),Z=e.singleOnly,w=e.tableSize,O=(0,a.Z)(e,b),T=(0,l.qY)(),_=(0,h.Cl)(),N=(0,m.useState)([]),F=(0,r.Z)(N,2),M=F[0],z=F[1],L=(0,m.useState)([]),E=(0,r.Z)(L,2),D=E[0],A=E[1],H=(0,m.useState)(),R=(0,r.Z)(H,2),P=R[0],B=R[1];(0,m.useEffect)((function(){var e,t=(null===n||void 0===n||null===(e=n.target)||void 0===e?void 0:e.map((function(e,t){var r,o,l=(null===n||void 0===n||null===(r=n.base)||void 0===r?void 0:r[t])||{},s=(l.status,(0,a.Z)(l,y)),d=null===n||void 0===n||null===(o=n.base)||void 0===o?void 0:o[t];return(0,i.Z)((0,i.Z)({},e||s||{}),{},{status:Z?null===d||void 0===d?void 0:d.status:null===e||void 0===e?void 0:e.status,baseStatus:null===d||void 0===d?void 0:d.status,baseRef:d,targetStatus:null===e||void 0===e?void 0:e.status,targetRef:e})})).sort((function(e){return"failed"===e.status?-1:1})))||[];z(t)}),[]);var I=Z?[_.accessor("status",{cell:function(e){return e.getValue()},header:"Status",enableGlobalFilter:!1})]:[_.accessor("baseStatus",{cell:function(e){return e.getValue()},header:"Base Status",enableGlobalFilter:!1}),_.accessor("targetStatus",{cell:function(e){return e.getValue()},header:"Target Status",enableGlobalFilter:!1})],q=Z?[_.accessor("expected",{cell:function(e){return e.getValue()},header:"Expected"}),_.accessor("actual",{cell:function(e){return"dbt"===e.row.original.source?e.row.original.message:e.getValue()},header:"Actual"})]:[],W=(0,m.useMemo)((function(){return[].concat(I,[{accessorFn:function(e){var n,t;return"".concat(null!==(n=e.table)&&void 0!==n?n:"",".").concat(null!==(t=e.column)&&void 0!==t?t:"")},id:"testSubject",header:"Test Subject"},_.accessor("name",{cell:function(e){var n,t;return null!==(n=null!==(t=e.row.original.display_name)&&void 0!==t?t:e.getValue())&&void 0!==n?n:e.row.original.id},header:"Assertion"})],q,[_.accessor("source",{cell:function(e){return e.getValue()},header:"Source",enableGlobalFilter:!1})])}),[]),G=(0,x.b7)({columns:W,data:M,getCoreRowModel:(0,h.sC)(),getSortedRowModel:(0,h.tj)(),onSortingChange:A,state:{sorting:D}});return 0===M.length?(0,j.jsx)(s.kC,{direction:"column",justifyContent:"center",alignItems:"center",children:(0,j.jsx)(v.J,{text:"No Tests Available"})}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(d.xJ,(0,i.Z)((0,i.Z)({},O),{},{children:(0,j.jsxs)(d.iA,{variant:"simple",size:w,children:[(0,j.jsx)(d.hr,{children:(0,j.jsxs)(d.Tr,{children:[G.getFlatHeaders().map((function(e){var n=(0,j.jsx)(c.m$.span,{pl:"4",pos:"absolute",right:0,children:e.column.getIsSorted()?"desc"===e.column.getIsSorted()?(0,j.jsx)(o.AS,{"aria-label":"sorted descending"}):(0,j.jsx)(o.$l,{"aria-label":"sorted ascending"}):null}),t=Boolean(e.id.match(/status/gi));return(0,j.jsxs)(d.Th,{pos:"relative",onClick:e.column.getToggleSortingHandler(),_hover:{cursor:"pointer"},textAlign:t?"center":"left",px:t?0:2,children:[(0,x.ie)(e.column.columnDef.header,e.getContext()),n]},e.id)})),!Z&&(0,j.jsx)(d.Th,{textAlign:"center",children:"View"})]})}),(0,j.jsx)(d.p3,{children:G.getSortedRowModel().rows.filter((function(e){var n=e.original,i=new RegExp(S,"g".concat(k?"":"i"));return t?(n.table||"")===S:!S||(((null===n||void 0===n?void 0:n.name)||"").search(i)>-1||(n.table||"").search(i)>-1||(n.column||"").search(i)>-1)})).map((function(e){var n,t=e.original,i=t.id,r=t.table,a=t.column,o=t.name,l=t.expected,c=t.actual,h=t.source,x=t.targetStatus,m=t.baseStatus,g=t.baseRef,v=t.targetRef,b=t.message,y=t.display_name,C="".concat(null!==r&&void 0!==r?r:"").concat(a?"."+a:""),S=(0,f.sG)(l),k=(0,f.sG)("piperider"===h?c:b),w=null!==(n=null!==y&&void 0!==y?y:o)&&void 0!==n?n:i;return(0,j.jsxs)(d.Tr,{children:[(0,j.jsx)(d.Td,{children:(0,j.jsx)(s.kC,{justifyContent:"center",children:(0,j.jsx)(p.Op,{status:m})})}),!Z&&(0,j.jsx)(d.Td,{children:(0,j.jsx)(s.kC,{justifyContent:"center",children:(0,j.jsx)(p.Op,{status:x})})}),(0,j.jsx)(d.Td,{maxWidth:"16em",px:2,children:(0,j.jsx)(u.u,{label:C,children:(0,j.jsx)(s.xv,{fontSize:"sm",noOfLines:1,textOverflow:"ellipsis",children:C})})}),(0,j.jsx)(d.Td,{maxWidth:"16em",px:2,children:(0,j.jsx)(u.u,{label:w,children:(0,j.jsx)(s.xv,{noOfLines:1,textOverflow:"ellipsis",children:w})})}),Z&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(d.Td,{px:2,children:(0,j.jsx)(u.u,{label:S,children:(0,j.jsx)(s.EK,{maxWidth:"14em",noOfLines:1,color:"gray.700",children:S})})}),(0,j.jsx)(d.Td,{px:2,children:(0,j.jsx)(u.u,{label:k,children:(0,j.jsx)(s.EK,{maxWidth:"14em",noOfLines:1,color:(Z?"failed"===m:"failed"===x)?"red.500":"gray.700",children:k})})})]}),(0,j.jsx)(d.Td,{px:2,children:h}),!Z&&(0,j.jsx)(d.Td,{textAlign:"center",onClick:function(){B({assertionSource:h||(null===g||void 0===g?void 0:g.source),assertionName:o||(null===g||void 0===g?void 0:g.name),base:g,target:v}),T.onOpen()},children:(0,j.jsx)(s.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},e.id)}))})]})})),(0,j.jsx)(g.E,(0,i.Z)((0,i.Z)({},T),{},{data:P,onClose:function(){T.onClose(),B(void 0)}}))]})}},44163:function(e,n,t){t.d(n,{l:function(){return j}});var i=t(61431),r=t(12599),a=t(7615),o=t(26468),l=t(41370),s=t(88050),d=t(21102),c=t(31756),u=t(48685),h=t(11060),x=t(2397),m=t(45505),f=(t(78989),t(4911)),p=t(15887);function g(e){var n,t=e.data,r=void 0===t?[]:t,a=e.isHorizontal,o=e.stacked,l=e.hasDimensions;x.kL.register(x.ZL,x.f$,x.uw,x.u);var s=[],d=Array.from(u.Uh.values()),c=!l&&2===r.length;r.forEach((function(e,t){var r,a=(null!==e&&void 0!==e?e:{}).data,o=void 0===a?[]:a,l=f.zip.apply(void 0,(0,h.Z)(o)),u=(0,i.Z)(l,2),x=u[0],m=u[1];n=null!==(r=n)&&void 0!==r?r:x;var p=(void 0===m?[]:m).map((function(e){return Number(null!==e&&void 0!==e?e:void 0)})),g=c?0===t?"Base":"Target":null===e||void 0===e?void 0:e.label;s.push({label:g,data:p,borderColor:d[t],backgroundColor:d[t]+"50"})}));var g={responsive:!0,maintainAspectRatio:!1,indexAxis:a?"y":"x",plugins:{tooltip:{mode:"index",position:"nearest",intersect:!1,callbacks:{title:function(e){var n=(0,i.Z)(e,1)[0].label,t=n.lastIndexOf(",");return n.slice(0,t)},labelColor:function(e){var n=e.datasetIndex;return{borderColor:u.wC,backgroundColor:d[n]}}}},legend:{position:"bottom",labels:{padding:10,boxWidth:30,generateLabels:function(e){return e.data.datasets.map((function(e,n){return{fillStyle:d[n],text:"".concat(e.label)}}))}}}},scales:{x:{stacked:o},y:{stacked:o}}},v={datasets:s,labels:n};return(0,p.jsx)(m.$Q,{plugins:[x.De],data:v,options:g})}function v(e){var n=e.data,t=void 0===n?[]:n,r=e.timeGrain,a=e.fill,o=e.stacked,l=e.hasDimensions;x.kL.register(x.jn,x.od,x.RM,x.f$,x.uw,x.Gu,x.u);var s=[],d=Array.from(u.Uh.values()),c=!l&&2===t.length;t.forEach((function(e,n){var t=(null!==e&&void 0!==e?e:{}).data,r=void 0===t?[]:t,o=f.zip.apply(void 0,(0,h.Z)(r)),l=(0,i.Z)(o,2),x=l[0],m=l[1],p=(void 0===m?[]:m).map((function(e,n){return{x:x[n],y:Number(null!==e&&void 0!==e?e:void 0)}})),g=c?0===n?"Base":"Target":null===e||void 0===e?void 0:e.label;s.push({label:g,data:p,borderColor:d[n],pointBackgroundColor:d[n],spanGaps:!0,fill:a,backgroundColor:d[n]+"50",segment:{borderColor:function(e){return(0,u.im)(e,"rgb(0,0,0,0.2)")},borderDash:function(e){return(0,u.im)(e,[6,6])},backgroundColor:function(e){return(0,u.im)(e,"rgb(0,0,0,0.1)")}}})}));var g={responsive:!0,maintainAspectRatio:!1,plugins:{filler:{},tooltip:{mode:"index",position:"nearest",intersect:!1,callbacks:{title:function(e){var n=(0,i.Z)(e,1)[0].label,t=n.lastIndexOf(",");return n.slice(0,t)},labelColor:function(e){var n=e.datasetIndex;return{borderColor:u.wC,backgroundColor:d[n]}}}},legend:{position:"bottom",labels:{padding:10,boxWidth:30,generateLabels:function(e){return e.data.datasets.map((function(e,n){return{fillStyle:d[n],text:"".concat(e.label)}}))}}}},scales:{x:{type:"time",time:{unit:r}},y:{stacked:o}}},v={datasets:s};return(0,p.jsx)(m.x1,{plugins:[x.De],data:v,options:g})}function j(e){var n=e.data,t=n.base,u=n.target,h=e.singleOnly,x=(0,c.useState)("line"),m=(0,i.Z)(x,2),f=m[0],g=m[1],v=u||t,j=null===v||void 0===v?void 0:v.grain,y="-",C="-";if(v&&v.data.length>0){var S=null===v||void 0===v?void 0:v.data[0],k=null===v||void 0===v?void 0:v.data[v.data.length-1];y=String(S[0]),C=String(k[0])}return(0,p.jsxs)(a.xu,{p:3,children:[(0,p.jsxs)(a.xu,{pb:3,children:[(0,p.jsxs)(a.kC,{className:"widget-header",alignItems:"center",gap:2,mb:2,justifyContent:"space-between",children:[(0,p.jsxs)(a.kC,{alignItems:"center",gap:2,children:[(0,p.jsx)(o.Vp,{colorScheme:"blue",variant:"subtle",fontWeight:"medium",children:null===v||void 0===v?void 0:v.label}),(0,p.jsx)(l.u,{shouldWrapChildren:!0,label:null===v||void 0===v?void 0:v.description,placement:"right",children:(0,p.jsx)(s.JO,{as:r.sz})})]}),(0,p.jsx)(d.Ph,{w:"initial",size:"sm",value:f,onChange:function(e){return g(e.currentTarget.value)},children:[{type:"line",displayName:"Line Chart"},{type:"y-bar",displayName:"Bar Chart"}].map((function(e){return(0,p.jsx)("option",{value:e.type,children:e.displayName},e.type)}))})]}),(0,p.jsx)(a.kC,{children:(0,p.jsxs)(a.xv,{color:"gray.500",fontSize:"sm",children:["from ",y," to ",C]})})]}),(0,p.jsx)(a.kC,{h:"300px",maxW:"98%",children:b({selectedBMChartType:f,comparableBMData:{base:t,target:u},singleOnly:h,timeGrain:j})})]})}function b(e){var n=e.selectedBMChartType,t=e.singleOnly,i=e.timeGrain,r=e.comparableBMData,a=null!==r&&void 0!==r?r:{},o=a.base,l=a.target,s=t?[o]:[o,l];return"line"===n?(0,p.jsx)(v,{data:s,timeGrain:i}):"stacked-line"===n?(0,p.jsx)(v,{data:s,timeGrain:i,fill:!0,stacked:!0}):"y-bar"===n?(0,p.jsx)(g,{data:s}):"stacked-y-bar"===n?(0,p.jsx)(g,{data:s,stacked:!0}):"x-bar"===n?(0,p.jsx)(g,{data:s,isHorizontal:!0}):"stacked-x-bar"===n?(0,p.jsx)(g,{data:s,stacked:!0,isHorizontal:!0}):(0,u.Jt)()}},67708:function(e,n,t){t.d(n,{r:function(){return p}});var i=t(82175),r=t(37932),a=t(61431),o=t(7615),l=t(38723),s=t(90225),d=t.n(s),c=t(94361),u=t(5462),h=t(24777),x=t(31756),m=t(15887),f=["columnDatum","chartKind"];function p(e){var n=e.columnDatum,t=n||{},s=t.type,p=t.topk,g=t.histogram,v=t.trues,j=t.falses,b=(0,x.useState)(0),y=(0,a.Z)(b,2),C=y[0],S=y[1],k=d()(v)&&d()(j),Z=p&&s,w=g&&s,O="other"===s,T=k||w||Z||O,_="string"===s?h.d4:"Histogram";function N(e){var n=e.columnDatum,t=e.chartKind,a=(0,r.Z)(e,f);return(0,m.jsx)(u.B,(0,i.Z)((0,i.Z)({px:0,title:null===n||void 0===n?void 0:n.name},a),{},{children:(0,c.SH)(n,t)}))}function F(e){return"string"===typeof e&&["inf","-inf","nan"].includes(e)}return(0,m.jsx)(o.xu,{pb:10,width:"100%",children:T?(0,m.jsxs)(l.mQ,{isLazy:!0,index:C,onChange:function(e){return S(e)},children:[(0,m.jsxs)(l.td,{children:[Z&&(0,m.jsx)(l.OK,{children:"Top Categories"}),w&&(0,m.jsx)(l.OK,{children:_}),k&&(0,m.jsx)(l.OK,{children:"Boolean"}),O&&(0,m.jsx)(l.OK,{children:"Other"})]}),(0,m.jsxs)(l.nP,{children:[Z&&(0,m.jsx)(l.x4,{px:0,children:(0,m.jsx)(N,{columnDatum:n,chartKind:"topk"})}),w&&(0,m.jsx)(l.x4,{px:0,children:(0,m.jsx)(N,{columnDatum:n,chartKind:"histogram",minHeight:"300px",maxHeight:"300px"})}),k&&(0,m.jsx)(l.x4,{px:0,children:(0,m.jsx)(N,{columnDatum:n,chartKind:"pie",minHeight:"300px",maxHeight:"300px"})}),O&&(0,m.jsx)(l.x4,{px:0,children:(0,m.jsx)(N,{columnDatum:n,minHeight:"300px",maxHeight:"300px"})})]})]}):(0,c.y2)({valids:null===n||void 0===n?void 0:n.valids,infinite:F(null===n||void 0===n?void 0:n.max)||F(null===n||void 0===n?void 0:n.min),schema_type:null===n||void 0===n?void 0:n.schema_type})})}},12471:function(e,n,t){t.d(n,{t:function(){return c}});var i=t(7615),r=t(94361),a=t(56367),o=t(2448),l=t(3354),s=t(69175),d=t(15887);function c(e){var n=e.columnDatum,t=e.hasAnimation,c=(0,s.Wx)(n),u=!!t&&{};return(0,d.jsxs)(i.kC,{direction:"column",width:"100%",children:[(0,d.jsx)(i.xu,{h:"2em",flexGrow:1,children:c?(0,d.jsx)(a.Wi,{data:c,animation:u}):(0,r.y2)({})}),(0,d.jsxs)(i.xu,{children:[(0,d.jsx)(o.P,{columnDatum:n,width:"100%"}),(0,d.jsx)(l.Q,{columnDatum:n,width:"100%"})]})]})}},20962:function(e,n,t){t.d(n,{E:function(){return l}});var i=t(7615),r=t(94361),a=t(71958),o=t(15887);function l(e){var n=e.columnDatum;return(0,o.jsx)(i.xu,{width:"100%",children:n?(0,o.jsx)(a.Y,{columnDatum:n,width:"100%"}):(0,r.y2)({})})}},84641:function(e,n,t){t.d(n,{M:function(){return s}});var i=t(7615),r=t(94361),a=t(45871),o=t(65717),l=t(15887);function s(e){var n=e.columnDatum,t=n||{},s=t.p50,d=t.max,c=t.min,u=t.p25,h=t.p75;return(0,l.jsx)(i.xu,{minWidth:"0px",width:"100%",children:n?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.xu,{children:(0,l.jsx)(a.UZ,{quantileData:{p50:s,max:d,min:c,p25:u,p75:h}})}),(0,l.jsx)(o.d,{columnDatum:n})]}):(0,r.y2)({})})}},44576:function(e,n,t){t.d(n,{h:function(){return s},k:function(){return l}});var i=t(12599),r=t(7615),a=t(96969),o=t(15887);function l(e){var n=e.base,t=e.target,i=e.stat,r={};return"execution_time"===i?r=(0,a.U)(null===n||void 0===n?void 0:n.__runResult,null===t||void 0===t?void 0:t.__runResult,"execution_time","duration"):"row_count"===i&&(r=(0,a.U)(null===n||void 0===n?void 0:n.__table,null===t||void 0===t?void 0:t.__table,"row_count","decimal")),r}function s(e){var n,t=e.isActive,a=l(e),s=a.statValueF,d=a.statDiff,c=a.statDiffF;return n=d&&d<0?t?"white":"green.500":t?"white":"red.500",(0,o.jsxs)(r.xv,{children:[s,"\xa0",d?(0,o.jsxs)(r.xv,{as:"span",color:n,children:[d<0?(0,o.jsx)(i.AS,{}):(0,o.jsx)(i.$l,{}),c]}):(0,o.jsx)(o.Fragment,{})]})}},68794:function(e,n,t){t.d(n,{e0:function(){return l.e},gb:function(){return a.gb},Nj:function(){return r.Nj},QN:function(){return o.QN},rH:function(){return o.rH},Se:function(){return o.Se},Jt:function(){return i.Jt},im:function(){return i.ch}});t(89408),t(13344),t(5462),t(45871),t(56367),t(3517),t(88405);var i=t(94361),r=t(70669),a=t(85655),o=(t(62196),t(83129)),l=(t(26564),t(67708),t(12471),t(20962),t(90346));t(84641)},48685:function(e,n,t){t.d(n,{B1:function(){return a.B1},FP:function(){return a.FP},Jt:function(){return i.Jt},Nj:function(){return i.Nj},Se:function(){return i.Se},Uh:function(){return a.Uh},e0:function(){return i.e0},im:function(){return i.im},ll:function(){return a.ll},mq:function(){return r.mq},nq:function(){return a.nq},rH:function(){return i.rH},wC:function(){return a.wC}});var i=t(68794),r=t(82122),a=(t(47768),t(6708),t(1831))}}]);
//# sourceMappingURL=953.fcf2a90c.chunk.js.map