import{l as ee,L as te,a6 as le,r as $,c as V,E as x,H as s,o as ue,ao as D,b as ae,w as ne,v as i,A as B,j as t,y as u,N as C,J as m,q as f,x as p,D as _,k as oe,F as ie,B as se,I as w,z as M,G as L,a3 as re,M as de}from"./index-dcf0de03.js";import{L as me,s as pe}from"./ListviewItem-2c46c8ee.js";/* empty css                             */import{B as ve,L as c}from"./ListItem-6dad7331.js";import{C as fe}from"./Container-d623752d.js";import{A as J}from"./Alert-eb81bdeb.js";import{V as N}from"./VBadge-8be61727.js";import{V as K,a as _e}from"./VTabs-7c03bdc8.js";import{j as g,V as T}from"./VBtn-a0da5efe.js";import{V as O,c as ce,b as k}from"./VMenu-3bdd1b96.js";import{V as W,a as X}from"./VToolbar-dfba6de4.js";import{a as ge,V as be}from"./VCard-111cabcf.js";import{b}from"./VListItem-943ee224.js";import{V as ye}from"./VDialog-ccbfddc9.js";import"./MediaItemThumb.vue_vue_type_style_index_0_lang-b38d9ae1.js";import"./VCheckboxBtn-d54a899d.js";import"./index-0afee102.js";/* empty css              */const qe=w("br",null,null,-1),Ce={key:0},Fe=ee({__name:"PlayerQueue",setup(ke){const{t:Y}=te(),S=le(),A=$(0),r=$(),h=$(!1),I=$([]),y=$([]),e=V(()=>{if(x.selectedPlayer)return s.queues[x.selectedPlayer.active_source]}),Z=V(()=>{if(e.value)return e.value.current_item}),E=V(()=>e.value?y.value.slice(e.value.current_index):[]),z=V(()=>e.value?y.value.slice(0,e.value.current_index):[]),Q=V(()=>A.value==1?z.value:E.value);ue(()=>{const l=s.subscribe_multi([D.QUEUE_UPDATED,D.QUEUE_ITEMS_UPDATED],a=>{var n;a.object_id==((n=e.value)==null?void 0:n.queue_id)&&(a.event==D.QUEUE_ITEMS_UPDATED?j():P())});ae(l)});const j=async function(){e.value?(y.value=[],await s.getPlayerQueueItems(e.value.queue_id,l=>{console.log("chunk",l.length),y.value.push(...l)})):y.value=[]},R=function(l){r.value=l,h.value=!0},F=function(l){U(),S.push({name:l.media_type,params:{itemId:l.item_id,provider:l.provider}})},q=function(l,a){U(),!(!l||!e.value)&&(a=="play_now"?s.queueCommandPlayIndex(e==null?void 0:e.value.queue_id,l.queue_item_id):a=="move_next"?s.queueCommandMoveNext(e==null?void 0:e.value.queue_id,l.queue_item_id):a=="up"?s.queueCommandMoveUp(e==null?void 0:e.value.queue_id,l.queue_item_id):a=="down"?s.queueCommandMoveDown(e==null?void 0:e.value.queue_id,l.queue_item_id):a=="delete"&&s.queueCommandDelete(e==null?void 0:e.value.queue_id,l.queue_item_id))},P=function(){I.value=[{label:"settings.player_settings",labelArgs:[],action:()=>{S.push(`/settings/editplayer/${e.value.queue_id}`)},icon:"mdi-cog-outline"},{label:"queue_clear",labelArgs:[],action:()=>{s.queueCommandClear(e.value.queue_id)},icon:"mdi-cancel"},{label:e.value.shuffle_enabled?"shuffle_enabled":"shuffle_disabled",labelArgs:[],action:()=>{s.queueCommandShuffleToggle(e.value.queue_id)},icon:e.value.shuffle_enabled?"mdi-shuffle":"mdi-shuffle-disabled"},{label:"repeat_mode",labelArgs:[Y(`repeatmode.${e.value.repeat_mode}`)],action:()=>{s.queueCommandRepeatToggle(e.value.queue_id)},icon:e.value.shuffle_enabled?"mdi-repeat":"mdi-repeat-off"},{label:e.value.crossfade_enabled?"crossfade_enabled":"crossfade_disabled",labelArgs:[],action:()=>{s.queueCommandCrossfadeToggle(e.value.queue_id)},icon:e.value.crossfade_enabled?"mdi-swap-horizontal-bold":"mdi-swap-horizontal"}]},U=function(){r.value=void 0,h.value=!1};return ne(()=>e.value,l=>{l&&(j(),P())},{immediate:!0}),(l,a)=>(i(),B("section",null,[t(W,{variant:"flat",color:"transparent",style:{height:"50px"}},{title:u(()=>{var n;return[C(m(l.$t("queue"))+" | "+m((n=f(x).selectedPlayer)==null?void 0:n.display_name)+" ",1),f(L)("bp1")?_("",!0):(i(),p(N,{key:0,color:"grey",content:E.value.length,inline:""},null,8,["content"]))]}),append:u(()=>[f(L)("bp1")?(i(),p(_e,{key:0,modelValue:A.value,"onUpdate:modelValue":a[0]||(a[0]=n=>A.value=n),"show-arrows":"",grow:""},{default:u(()=>[t(K,{value:0},{default:u(()=>[C(m(l.$t("queue_next_items"))+" ",1),t(N,{color:"grey",content:E.value.length,inline:""},null,8,["content"])]),_:1}),t(K,{value:1},{default:u(()=>[C(m(l.$t("queue_previous_items"))+" ",1),t(N,{color:"grey",content:z.value.length,inline:""},null,8,["content"])]),_:1})]),_:1},8,["modelValue"])):_("",!0),I.value&&I.value.length>0?(i(),p(ce,{key:1,location:"bottom end"},{activator:u(({props:n})=>[t(ve,oe({icon:"",style:{right:"3px"}},n),{default:u(()=>[t(g,{icon:"mdi-dots-vertical"})]),_:2},1040)]),default:u(()=>[t(O,null,{default:u(()=>[(i(!0),B(ie,null,se(I.value.filter(n=>n.hide!=!0),(n,o)=>(i(),p(c,{key:o,title:l.$t(n.label,n.labelArgs),disabled:n.disabled==!0,onClick:d=>n.action?n.action():""},{prepend:u(()=>[t(b,{icon:n.icon},null,8,["icon"])]),_:2},1032,["title","disabled","onClick"]))),128))]),_:1})]),_:1})):_("",!0)]),_:1}),t(fe,null,{default:u(()=>{var n;return[e.value&&((n=e.value)==null?void 0:n.radio_source.length)>0?(i(),p(J,{key:0,icon:"mdi-radio-tower"},{default:u(()=>{var o,d,v,G;return[w("b",null,m(l.$t("queue_radio_enabled")),1),qe,C(" "+m(l.$t("queue_radio_based_on",[l.$t((o=e.value)==null?void 0:o.radio_source[0].media_type)]))+" ",1),w("b",null,[w("a",{onClick:a[1]||(a[1]=we=>{var H;return e.value?F((H=e.value)==null?void 0:H.radio_source[0]):""})},m((d=e.value)==null?void 0:d.radio_source[0].name),1)]),((v=e.value)==null?void 0:v.radio_source.length)>1?(i(),B("span",Ce," (+"+m(((G=e.value)==null?void 0:G.radio_source.length)-1)+")",1)):_("",!0)]}),_:1})):_("",!0),t(f(pe),{items:Q.value,"item-size":60,"key-field":"queue_item_id","page-mode":""},{default:u(({item:o})=>{var d;return[(i(),p(me,{key:o.uri,item:o.media_item,"show-disc-number":!1,"show-track-number":!1,"show-duration":!0,"show-library":!0,"show-menu":!0,"show-provider":!1,"show-album":!1,"show-checkboxes":!1,"is-selected":!1,"show-details":!1,"parent-item":o,"is-disabled":o.queue_item_id==((d=Z.value)==null?void 0:d.queue_item_id),ripple:"",onMenu:v=>R(o),onClick:v=>q(o,"play_now"),onContextmenu:M(v=>R(o),["right","prevent"])},{append:u(()=>[f(L)("bp1")?(i(),p(T,{key:0,variant:"plain",ripple:"",icon:"mdi-arrow-up",title:l.$t("queue_move_up"),onClick:[v=>f(s).queueCommandMoveUp(e.value.queue_id,o.queue_item_id),a[2]||(a[2]=M(()=>{},["prevent"])),a[3]||(a[3]=M(()=>{},["stop"]))]},null,8,["title","onClick"])):_("",!0),t(T,{icon:"mdi-arrow-down",title:l.$t("queue_move_down"),onClick:M(v=>f(s).queueCommandMoveDown(e.value.queue_id,o.queue_item_id),["prevent"])},null,8,["title","onClick"])]),_:2},1032,["item","parent-item","is-disabled","onMenu","onClick","onContextmenu"]))]}),_:1},8,["items"]),y.value.length==0?(i(),p(J,{key:1,type:"info"},{default:u(()=>[C(m(l.$t("no_content")),1)]),_:1})):_("",!0)]}),_:1}),t(ye,{modelValue:h.value,"onUpdate:modelValue":a[11]||(a[11]=n=>h.value=n),fullscreen:l.$vuetify.display.mobile,"min-height":"80%",scrim:!0},{default:u(()=>[t(ge,null,{default:u(()=>[t(W,{sense:"",dark:"",color:"primary"},{default:u(()=>[t(T,{icon:"mdi-play-circle-outline"}),r.value?(i(),p(X,{key:0,style:{"padding-left":"10px"}},{default:u(()=>{var n;return[w("b",null,m(f(re)(((n=r.value)==null?void 0:n.name)||"",l.$vuetify.display.mobile?20:150)),1)]}),_:1})):(i(),p(X,{key:1,style:{"padding-left":"10px"}},{default:u(()=>{var n;return[w("b",null,m(l.$t("settings")),1),C(" | "+m((n=e.value)==null?void 0:n.display_name),1)]}),_:1})),t(T,{icon:"mdi-close",dark:"",onClick:a[4]||(a[4]=n=>U())})]),_:1}),r.value?(i(),p(be,{key:0},{default:u(()=>[t(O,null,{default:u(()=>{var n,o;return[t(c,{title:l.$t("play_now"),onClick:a[5]||(a[5]=d=>q(r.value,"play_now"))},{prepend:u(()=>[t(b,{style:{"padding-right":"10px"}},{default:u(()=>[t(g,{icon:"mdi-play-circle-outline"})]),_:1})]),_:1},8,["title"]),t(k),t(c,{title:l.$t("play_next"),onClick:a[6]||(a[6]=d=>q(r.value,"move_next"))},{prepend:u(()=>[t(b,{style:{"padding-right":"10px"}},{default:u(()=>[t(g,{icon:"mdi-skip-next-circle-outline"})]),_:1})]),_:1},8,["title"]),t(k),t(c,{title:l.$t("queue_move_up"),onClick:a[7]||(a[7]=d=>q(r.value,"up"))},{prepend:u(()=>[t(b,{style:{"padding-right":"10px"}},{default:u(()=>[t(g,{icon:"mdi-arrow-up"})]),_:1})]),_:1},8,["title"]),t(k),t(c,{title:l.$t("queue_move_down"),onClick:a[8]||(a[8]=d=>q(r.value,"down"))},{prepend:u(()=>[t(b,{style:{"padding-right":"10px"}},{default:u(()=>[t(g,{icon:"mdi-arrow-down"})]),_:1})]),_:1},8,["title"]),t(k),t(c,{title:l.$t("queue_delete"),onClick:a[9]||(a[9]=d=>q(r.value,"delete"))},{prepend:u(()=>[t(b,{style:{"padding-right":"10px"}},{default:u(()=>[t(g,{icon:"mdi-delete"})]),_:1})]),_:1},8,["title"]),t(k),((o=(n=r.value)==null?void 0:n.media_item)==null?void 0:o.media_type)==f(de).TRACK?(i(),p(c,{key:0,title:l.$t("show_info"),onClick:a[10]||(a[10]=d=>{var v;return(v=r.value)!=null&&v.media_item?F(r.value.media_item):""})},{prepend:u(()=>[t(b,{style:{"padding-right":"10px"}},{default:u(()=>[t(g,{icon:"mdi-information-outline"})]),_:1})]),_:1},8,["title"])):_("",!0),t(k)]}),_:1})]),_:1})):_("",!0)]),_:1})]),_:1},8,["modelValue","fullscreen"])]))}});export{Fe as default};
