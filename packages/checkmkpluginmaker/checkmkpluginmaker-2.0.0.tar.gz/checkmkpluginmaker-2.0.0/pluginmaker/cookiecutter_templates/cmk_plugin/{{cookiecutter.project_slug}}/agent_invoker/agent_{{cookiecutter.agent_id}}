#!/usr/bin/env python3
# copy this file to local/share/check_mk/checks

# -----------------------------
# Function get params in this case is port, passed via WATO agent rule cunfiguration, hostname and ip addres of host, 
# for which agent will be invoked 
import json


def agent_myspecal_arguments(params, hostname, ipaddress):
    args = []
    args += ["-H", ipaddress]       # map to host in agent
    args += ["-C", params.get('community', 'FPTHCM123')]     # map to community in agent
    services = params.get('services', [])
    if services:
        args += ['-S', json.dumps(services)]
    return args

# -----------------------------
# register invoke function for our agent
# key value for this dictionary is name part from register datasource of our agent (name="special_agents:myspecial" remember?)
#
special_agent_info['{{cookiecutter.agent_id}}'] = agent_myspecal_arguments