"use strict";(self.webpackChunkjupyter_viz_extension=self.webpackChunkjupyter_viz_extension||[]).push([[759],{759:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var a=n(303),s=n(832),i=n(271),r=n.n(i),o=n(628),l=n.n(o),c=n(344),p=n(139);async function u(e,t={}){const n=p.ServerConnection.makeSettings(),a=c.URLExt.join(n.baseUrl,"jupyter-viz-extension",e);let s;try{s=await p.ServerConnection.makeRequest(a,t,n)}catch(e){throw new p.ServerConnection.NetworkError(e)}let i=await s.text();if(i.length>0)try{i=JSON.parse(i)}catch(e){console.log("Not a JSON response body.",s)}if(!s.ok)throw new p.ServerConnection.ResponseError(s,i.message||i);return i}function m(e,t){const n=document.createElement("label");return n.htmlFor=e,n.textContent=t,n}function d(e,t){const n=document.createElement("select");n.id=e;for(const e of t){const t=document.createElement("option");t.value=e,t.textContent=e,n.appendChild(t)}return n}function h(e,t,n,a=[]){const s=document.createElement("input");s.type=t,s.id=e,s.value=n,s.classList.add("form-input");for(const[e,t]of a)s.setAttribute(e,t);return s}class E extends s.Widget{constructor(){super(),this.fetchUserData=async()=>{const e=await u("user");for(const t of e.accounts){const e=document.createElement("option");e.value=t,e.textContent=t,this._accountElement.appendChild(e)}for(const t of e.partitions){const e=document.createElement("option");e.value=t,e.textContent=t,this._partitionElement.appendChild(e)}};const e=document.createElement("div");e.appendChild(m("account","Account: ")),e.appendChild(this._accountElement=d("account",[])),this.node.appendChild(e);const t=document.createElement("div");t.appendChild(m("partition","Partition: ")),t.appendChild(this._partitionElement=d("partition",[])),this.node.appendChild(t);const n=document.createElement("div");n.appendChild(m("nodes","Nodes: ")),n.appendChild(this._nodesElement=h("nodes","number","4",[["min","1"],["max","32"],["step","1"]])),this.node.appendChild(n);const a=document.createElement("div");a.appendChild(m("time","Time: ")),a.appendChild(this._timeElement=h("time","text","02:00:00")),this.node.appendChild(a),this.fetchUserData()}getValue(){return{account:this._accountElement.value,partition:this._partitionElement.value,nodes:Number(this._nodesElement.value),timeLimit:this._timeElement.value}}}class v extends i.Component{render(){return i.createElement("div",null,i.createElement("span",{style:{fontWeight:"bold"}},this.props.label,": "),i.createElement("span",null,this.props.value))}}class g extends i.Component{constructor(e){super(e)}render(){var e;const t=i.createElement(i.Fragment,null,i.createElement(v,{label:"Nodes",value:this.props.nodes.toString()}),i.createElement(v,{label:"Status",value:this.props.state}),i.createElement(v,{label:"Time",value:`${this.props.timeUsed} / ${this.props.timeLimit}`}));return i.createElement(i.Fragment,null,i.createElement(l(),{trigger:t},i.createElement(v,{label:"Project",value:this.props.account}),i.createElement(v,{label:"Partition",value:this.props.partition}),i.createElement(v,{label:"Nodes",value:this.props.nodes.toString()}),i.createElement(v,{label:"Port for Connection",value:null!==(e=this.props.url)&&void 0!==e?e:""})))}}class C extends i.Component{constructor(){super({}),this.fetchData=async()=>{this.setState({instaces:await u("paraview")})},this.newInstance=async()=>{const e=await(0,a.showDialog)({title:"Launch a new ParaView instance",body:new E});console.log(e.value),await u("paraview",{method:"POST",body:JSON.stringify(e.value)}),await this.fetchData()},this.state={instaces:[]},this.fetchData()}render(){return i.createElement(i.Fragment,null,i.createElement("h3",null,"Running ParaView backends:",i.createElement("button",{className:"launch-button",onClick:this.newInstance},"Launch")),i.createElement("div",{id:"paraview-instances",className:"instance-list"},this.state.instaces.map((e=>i.createElement(g,Object.assign({},e))))))}}class b extends i.Component{constructor(e){super(e),this.openInstance=()=>{window.open(this.props.url,"_blank","noreferrer")}}render(){return i.createElement("div",null,i.createElement(l(),{trigger:"State: Running"},i.createElement(v,{label:"Connected To Backend",value:this.props.url}),i.createElement(v,{label:"Root Directory",value:this.props.path})),i.createElement("button",{onClick:this.openInstance},"Open"))}}class w extends i.Component{constructor(e){super(e),this.launchInstance=async()=>{console.log("Launching trame app "+this.props.name);const e=await u("trame",{method:"POST",body:JSON.stringify({app_name:this.props.name})}),t=p.ServerConnection.makeSettings(),n=c.URLExt.join(t.baseUrl,"proxy",e.port.toString(),"index.html");this.setState({instances:[...this.state.instances,n]}),await(0,a.showErrorMessage)("Success",`Launched new trame instance on port ${e.port}`)},this.state={instances:[]}}render(){const e=i.createElement("div",null,i.createElement("b",null," ",this.props.name," "),i.createElement("br",null),"Running Instances: ",this.state.instances.length);return i.createElement(i.Fragment,null,i.createElement(l(),{trigger:e},i.createElement(v,{label:"Path",value:this.props.path}),i.createElement("h4",null,"Instances:",i.createElement("button",{className:"launch-button",onClick:this.launchInstance},"Launch")),i.createElement("div",{className:"instance-list"},this.state.instances.map((e=>i.createElement(b,{name:this.props.name,path:this.props.path,url:e}))))))}}class f extends i.Component{constructor(){super({}),this.fetchData=async()=>{this.setState({apps:await u("trame")})},this.state={apps:[]},this.fetchData()}render(){return i.createElement(i.Fragment,null,i.createElement("h3",null,"trame Apps:"),i.createElement("div",{id:"trame-instances",className:"instance-list"},this.state.apps.map((e=>i.createElement(w,{name:e.displayName,path:e.path})))))}}const S={id:"juviz-extension",autoStart:!0,activate:e=>{const t=new s.SplitPanel;t.orientation="vertical",t.id="juviz-sidepanel",t.title.iconClass="jp-ExtensionIcon jp-SideBar-tabIcon",t.title.caption="JuWiz";const n=a.ReactWidget.create(r().createElement(C,null));n.addClass("juviz-sidepanel-segment"),t.addWidget(n);const i=a.ReactWidget.create(r().createElement(f,null));i.addClass("juviz-sidepanel-segment"),t.addWidget(i),e.shell.add(t,"left")}}}}]);