Bootstrap: library
From: ubuntu:jammy

%files


%post
    export DEBIAN_FRONTEND=noninteractive


    apt-get update && apt-get install -y --no-install-recommends \
        curl \
        git \
        ca-certificates \
        build-essential \
        nvidia-cuda-toolkit \
        libhdf5-dev \
        libssl-dev \
        libzstd-dev \
        cmake \
        autoconf \
        wget \
        automake \
        python3
   
    ln -sf /usr/bin/python3 /usr/bin/python

    wget https://github.com/nanoporetech/dorado/archive/refs/tags/v0.3.1.tar.gz
    tar xvfz v0.3.1.tar.gz

    cd dorado-0.3.1
    #cmake -DCMAKE_PREFIX_PATH=/opt -S . -B cmake-build
    #cmake --build cmake-build --config Release -j 1
    #ctest --test-dir cmake-build
    #cmake --install cmake-build --prefix /opt


    # cleanup
    rm -rf /tmp/downloaded\_packages/ && \
    rm -rf /tmp/*.rds && \
    rm -rf /var/lib/apt/lists/*

%environment
    LANG=C.UTF-8
    LC_ALL=C.UTF-8
    export LANG LC_ALL

    export PATH=/dorado-0.3.1-linux-x64/bin/:${PATH}
